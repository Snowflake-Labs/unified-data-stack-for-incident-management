version: 2

models:
  - name: document_question_extracts
    description: "Question extracts from documents using AI_EXTRACT"
    config:
      meta:
        global_inm_policy_schema:
          schema:
            type: "object"
            properties:
                purpose: { description: "Purpose of this policy", type: "string" }
                objectives: { description: "Objectives achieved by this policy", type: "string" }
                policy_statement: { description: "Primary policy statement", type: "string" }
                in_scope_services: { description: "Services explicitly in scope", type: "array" }
                out_of_scope_services: { description: "Services explicitly out of scope", type: "array" }
                geographical_coverage: { description: "Countries/regions covered", type: "array" }
                business_units_in_scope: { description: "Business units covered by the policy", type: "array" }
                applicability_conditions: { description: "Conditions determining when policy applies", type: "array" }
                exclusions: { description: "Explicit exceptions to scope", type: "array" }
                definitions_and_glossary:
                    description: "Terms, acronyms, and reference standards"
                    type: "object"
                    properties:
                        defined_terms: { description: "Key defined terms", type: "array" }
                        acronyms: { description: "Acronyms used within the document", type: "array" }
                        reference_standards: { description: "Referenced standards and frameworks", type: "array" }
              
    columns:
      - name: relative_path
        description: "Path to the file on the stage"
        tests:
          - not_null

      - name: size
        description: "Size of the file in bytes"

      - name: last_modified
        description: "Timestamp when the file was last updated in the stage"

      - name: md5
        description: "MD5 checksum for the file"

      - name: etag
        description: "ETag header for the file"

      - name: file_url
        description: "Snowflake file URL to the file"

      - name: analysis_type
        description: "Type of analysis requested for the file"
        tests:
          - accepted_values:
              values: ['question']

      - name: extension
        description: "File extension parsed from the path"

      - name: question_extracts_json
        description: "JSON output from AI_EXTRACT following the `global_inm_policy_schema.json` format"
  
