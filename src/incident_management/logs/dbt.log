

============================== 15:12:43.328561 | 990a1491-bcb3-4689-9c5d-87f79ae688bc ==============================
[0m15:12:43.328561 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:12:43.329860 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m15:12:43.590120 [debug] [Dummy-1   ]: Set downloads directory='/tmp/dbt-downloads-bo4ptyy0'
[0m15:12:43.591132 [debug] [Dummy-1   ]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:12:43.812464 [debug] [Dummy-1   ]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:12:43.813629 [debug] [Dummy-1   ]: Making package registry request: GET https://hub.getdbt.com/api/v1/Snowflake-Labs/dbt_semantic_view.json
[0m15:12:43.997128 [debug] [Dummy-1   ]: Response from registry: GET https://hub.getdbt.com/api/v1/Snowflake-Labs/dbt_semantic_view.json 200
[0m15:12:44.006803 [info ] [Dummy-1   ]: Updating lock file in file path: /tmp/dbt/package-lock.yml
[0m15:12:44.009509 [debug] [Dummy-1   ]: Set downloads directory='/tmp/dbt-downloads-r77in6nx'
[0m15:12:44.011039 [info ] [Dummy-1   ]: Installing Snowflake-Labs/dbt_semantic_view
[0m15:12:44.436574 [info ] [Dummy-1   ]: Installed from version 1.0.3
[0m15:12:44.437188 [info ] [Dummy-1   ]: Up to date!
[0m15:12:44.439662 [debug] [Dummy-1   ]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2150646, "process_in_blocks": "0", "process_kernel_time": 0.89, "process_mem_max_rss": "397856", "process_out_blocks": "0", "process_user_time": 4.26}
[0m15:12:44.440431 [debug] [Dummy-1   ]: Command `cli deps` succeeded at 15:12:44.440140 after 1.22 seconds
[0m15:12:44.440993 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:13:13.401174 | 2aafbc4a-2eb5-4575-89dd-50053985e220 ==============================
[0m15:13:13.401174 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:13:13.402285 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:13:13.472329 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:13:13.781498 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:13:14.525265 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:13:14.527006 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:13:16.966174 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.v_qualify_slack_messages' (models/bronze_zone/v_qualify_slack_messages.sql) depends on a source named 'bronze_zone.users' which was not found
[0m15:13:16.968433 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.6631558, "process_in_blocks": "0", "process_kernel_time": 1.47, "process_mem_max_rss": "456992", "process_out_blocks": "0", "process_user_time": 6.8}
[0m15:13:16.969237 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:13:16.968947 after 3.66 seconds
[0m15:13:16.969934 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:15:24.179284 | 00f90ef4-f8b3-4e3d-b1f2-b287fead49cb ==============================
[0m15:15:24.179284 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:15:24.180378 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:15:24.251213 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:15:24.558549 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:15:25.302669 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:15:25.304461 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:15:27.729003 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.v_qualify_slack_messages' (models/bronze_zone/v_qualify_slack_messages.sql) depends on a source named 'bronze_zone.users' which was not found
[0m15:15:27.731287 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.6493266, "process_in_blocks": "0", "process_kernel_time": 1.21, "process_mem_max_rss": "450348", "process_out_blocks": "0", "process_user_time": 6.87}
[0m15:15:27.732076 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:15:27.731783 after 3.65 seconds
[0m15:15:27.732732 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:19:15.642255 | b93fb2b6-6f83-4390-9f6e-d07fa0cb660a ==============================
[0m15:19:15.642255 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:19:15.643573 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:19:15.719257 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:19:16.045839 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:19:16.820878 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:19:16.822329 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:19:18.479988 [error] [Dummy-1   ]: Encountered an error:
Parsing Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  No jinja in python model code is allowed
[0m15:19:18.482069 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.9435775, "process_in_blocks": "0", "process_kernel_time": 1.37, "process_mem_max_rss": "459032", "process_out_blocks": "0", "process_user_time": 6.16}
[0m15:19:18.482859 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:19:18.482560 after 2.94 seconds
[0m15:19:18.483608 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:20:29.732229 | 100732fe-e3f3-4771-9776-11001ee3b1cb ==============================
[0m15:20:29.732229 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:20:29.733340 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m15:20:29.803564 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:20:30.110661 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:20:30.893415 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:20:30.895063 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:20:33.352387 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.v_stg_servicenow_incidents' (models/bronze_zone/v_stg_servicenow_incidents.sql) depends on a source named 'servicenow.incident' which was not found
[0m15:20:33.354558 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.7193732, "process_in_blocks": "0", "process_kernel_time": 1.49, "process_mem_max_rss": "456680", "process_out_blocks": "0", "process_user_time": 6.63}
[0m15:20:33.355327 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:20:33.355031 after 3.72 seconds
[0m15:20:33.355972 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:22:29.132783 | 5ab5bdb2-6aa1-4a5c-b782-a9db3e7a4f04 ==============================
[0m15:22:29.132783 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:22:29.133925 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:22:29.206062 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:22:29.518111 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:22:30.302681 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:22:30.304101 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:22:32.761104 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.build_semantic_view' (models/activation/build_semantic_view.sql) depends on a source named '<source_name>.<table_name>' which was not found
[0m15:22:32.763412 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.7291534, "process_in_blocks": "0", "process_kernel_time": 1.31, "process_mem_max_rss": "457100", "process_out_blocks": "0", "process_user_time": 6.78}
[0m15:22:32.764199 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:22:32.763908 after 3.73 seconds
[0m15:22:32.764897 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:22:54.861744 | 39a7d734-a187-4e95-86c3-25817ceec97c ==============================
[0m15:22:54.861744 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:22:54.862883 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m15:22:54.935458 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:22:55.250791 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:22:56.034218 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:22:56.036614 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:22:58.543142 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.active_incidents' (models/gold_zone/active_incidents.sql) depends on a source named 'bronze_zone.incidents' which was not found
[0m15:22:58.545202 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.7819717, "process_in_blocks": "0", "process_kernel_time": 1.21, "process_mem_max_rss": "460560", "process_out_blocks": "0", "process_user_time": 6.89}
[0m15:22:58.545932 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:22:58.545651 after 3.78 seconds
[0m15:22:58.546561 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:27:04.619939 | 03750df2-1bed-45a8-be26-92d8d212992e ==============================
[0m15:27:04.619939 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:27:04.621220 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:27:04.697207 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:27:05.025401 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:27:05.825750 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:27:05.827262 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:27:07.453196 [error] [Dummy-1   ]: Encountered an error:
Compilation Error in model incidents (models/gold_zone/incidents.sql)
  unexpected '}', expected ')'
    line 25
      from {{(ref('v_qualify_slack_messages')}} lh
[0m15:27:07.455334 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.938486, "process_in_blocks": "0", "process_kernel_time": 1.27, "process_mem_max_rss": "455504", "process_out_blocks": "0", "process_user_time": 6.17}
[0m15:27:07.456188 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:27:07.455885 after 2.94 seconds
[0m15:27:07.456892 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:27:48.273515 | 76e05c14-c406-42de-a49e-bb106a69b500 ==============================
[0m15:27:48.273515 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:27:48.274681 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m15:27:48.347392 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:27:48.660711 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:27:49.436116 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:27:49.437439 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:27:52.241884 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m15:27:52.244608 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m15:27:52.457071 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m15:27:52.461596 [info ] [Dummy-1   ]: 
[0m15:27:52.462277 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m15:27:52.462769 [info ] [Dummy-1   ]: 
[0m15:27:52.463611 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m15:27:52.472187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m15:27:52.626767 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:27:52.627428 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:27:52.627935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:53.689787 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.062 seconds
[0m15:27:53.695667 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:27:53.696285 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m15:27:53.868936 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.172 seconds
[0m15:27:53.872585 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:27:53.873197 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:27:53.990250 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.116 seconds
[0m15:27:53.992893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m15:27:54.004794 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:27:54.005452 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:27:54.005950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:54.981928 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.976 seconds
[0m15:27:54.984463 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:27:54.985056 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m15:27:55.051307 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c02cff-0206-e1f0-0032-318704d6e3be
[0m15:27:55.051965 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:27:55.052633 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:27:55.053146 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:27:55.059877 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m15:27:55.060717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m15:27:55.061340 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m15:27:55.081421 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m15:27:55.082462 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m15:27:55.083528 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m15:27:55.084752 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m15:27:55.085588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m15:27:55.086215 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m15:27:55.098370 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m15:27:55.099315 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m15:27:55.100355 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m15:27:55.101512 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m15:27:55.102821 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m15:27:55.103452 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m15:27:55.117972 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m15:27:55.118947 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m15:27:55.120176 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m15:27:55.121330 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:27:55.122336 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m15:27:55.122942 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:27:55.141602 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m15:27:55.142568 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:27:55.143635 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:27:55.144775 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:27:55.145583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m15:27:55.146194 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:27:55.160635 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m15:27:55.161527 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:27:55.162561 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:27:55.163696 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:27:55.164464 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m15:27:55.165047 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:27:55.177577 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m15:27:55.178577 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:27:55.179622 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:27:55.180681 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:27:55.181463 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m15:27:55.182078 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:27:55.194659 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m15:27:55.195486 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:27:55.196478 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:27:55.197504 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:27:55.198298 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m15:27:55.198962 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:27:55.213001 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m15:27:55.213825 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:27:55.214835 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:27:55.215847 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:27:55.216641 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m15:27:55.217228 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:27:55.229283 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m15:27:55.230078 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:27:55.231059 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:27:55.232058 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:27:55.232810 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m15:27:55.233385 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:27:55.246987 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m15:27:55.247785 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:27:55.248804 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:27:55.249819 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:27:55.250559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m15:27:55.251142 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:27:55.263489 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m15:27:55.264271 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:27:55.265221 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:27:55.266231 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:27:55.266976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m15:27:55.267545 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:27:55.281066 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m15:27:55.281862 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:27:55.282845 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:27:55.283828 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:27:55.284564 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m15:27:55.285131 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:27:55.297172 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m15:27:55.297951 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:27:55.298980 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:27:55.299998 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:27:55.300748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m15:27:55.301331 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:27:55.316450 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m15:27:55.317251 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:27:55.318227 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:27:55.321393 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m15:27:55.322188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m15:27:55.322767 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m15:27:55.334167 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m15:27:55.335018 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m15:27:55.336180 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m15:27:55.337351 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m15:27:55.338159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m15:27:55.338889 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m15:27:55.372308 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m15:27:55.373199 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m15:27:55.374230 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m15:27:55.375381 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m15:27:55.376159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m15:27:55.376735 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m15:27:55.391476 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m15:27:55.392396 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m15:27:55.393401 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m15:27:55.395344 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m15:27:55.396238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m15:27:55.396816 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m15:27:55.408818 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m15:27:55.409640 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m15:27:55.410662 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m15:27:55.411769 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m15:27:55.412517 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m15:27:55.413096 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m15:27:55.426184 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m15:27:55.427007 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m15:27:55.427981 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m15:27:55.429112 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m15:27:55.430172 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m15:27:55.430753 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m15:27:55.443277 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m15:27:55.444164 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m15:27:55.445157 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m15:27:55.446240 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m15:27:55.446981 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m15:27:55.447564 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m15:27:55.461463 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m15:27:55.462345 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m15:27:55.463323 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m15:27:55.464453 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m15:27:55.465228 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m15:27:55.465803 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m15:27:55.477495 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m15:27:55.478368 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m15:27:55.479480 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m15:27:55.480565 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m15:27:55.481326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m15:27:55.481895 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m15:27:55.493997 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m15:27:55.494846 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m15:27:55.495989 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m15:27:55.497108 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m15:27:55.497874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m15:27:55.498529 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m15:27:55.511856 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m15:27:55.512714 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m15:27:55.513698 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m15:27:55.514837 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:27:55.515653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m15:27:55.516248 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:27:55.529074 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m15:27:55.529925 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:27:55.530923 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:27:55.531972 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:27:55.532730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m15:27:55.533301 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:27:55.546828 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m15:27:55.547637 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:27:55.548663 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:27:55.549702 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:27:55.550450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m15:27:55.551020 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:27:55.563325 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m15:27:55.564151 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:27:55.565128 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:27:55.566212 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:27:55.566980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m15:27:55.567549 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:27:55.581431 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m15:27:55.582287 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:27:55.583252 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:27:55.584298 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:27:55.585027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m15:27:55.585593 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:27:55.597852 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m15:27:55.598719 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:27:55.599682 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:27:55.600710 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:27:55.601450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m15:27:55.602024 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:27:55.614135 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m15:27:55.614915 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:27:55.615879 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:27:55.616930 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:27:55.617680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m15:27:55.618272 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:27:55.631977 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m15:27:55.632765 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:27:55.633712 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:27:55.634765 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:27:55.635501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m15:27:55.636067 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:27:55.647806 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m15:27:55.648638 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:27:55.649592 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:27:55.651998 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m15:27:55.652530 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m15:27:55.658230 [debug] [Dummy-1   ]: Command end result
[0m15:27:55.701142 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m15:27:55.703683 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m15:27:55.714106 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m15:27:55.716200 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 7.5425835, "process_in_blocks": "0", "process_kernel_time": 1.28, "process_mem_max_rss": "493632", "process_out_blocks": "0", "process_user_time": 8.35}
[0m15:27:55.716914 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 15:27:55.716635 after 7.54 seconds
[0m15:27:55.717474 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:45:18.940306 | 8c900d9c-4338-4b5b-8773-509c42ee1975 ==============================
[0m15:45:18.940306 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:45:18.941417 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:45:19.313314 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:45:20.056869 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:45:20.358930 [info ] [Dummy-1   ]: Unable to do partial parsing because profile has changed
[0m15:45:23.062010 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m15:45:23.064583 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m15:45:23.118650 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m15:45:23.122133 [info ] [Dummy-1   ]: 
[0m15:45:23.122708 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m15:45:23.123244 [info ] [Dummy-1   ]: 
[0m15:45:23.124151 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m15:45:23.132187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m15:45:23.289330 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m15:45:23.290050 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m15:45:23.290613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:24.142704 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.852 seconds
[0m15:45:24.156602 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m15:45:24.157244 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m15:45:24.157735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:24.937463 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.779 seconds
[0m15:45:24.940342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now create_incident_management_gold_zone)
[0m15:45:24.941141 [debug] [ThreadPool]: Creating schema "database: "incident_management"
schema: "gold_zone"
"
[0m15:45:24.954416 [debug] [ThreadPool]: Using snowflake connection "create_incident_management_gold_zone"
[0m15:45:24.955007 [debug] [ThreadPool]: On create_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "create_incident_management_gold_zone"} */
create schema if not exists incident_management.gold_zone
[0m15:45:24.955496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:25.720246 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.765 seconds
[0m15:45:25.724600 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m15:45:25.747781 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:45:25.748434 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:45:25.748992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:26.606556 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.857 seconds
[0m15:45:26.612272 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:45:26.612888 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m15:45:26.727525 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.114 seconds
[0m15:45:26.730227 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:45:26.730785 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:45:26.834865 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m15:45:26.837409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m15:45:26.849167 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:45:26.849735 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:45:26.850223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:27.670168 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.820 seconds
[0m15:45:27.672606 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:45:27.673185 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m15:45:27.753552 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.080 seconds
[0m15:45:27.755897 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:45:27.756436 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:45:27.845513 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m15:45:27.852601 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m15:45:27.853569 [info ] [Thread-2 (]: 1 of 13 START sql incremental model bronze_zone.users .......................... [RUN]
[0m15:45:27.854321 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m15:45:27.854902 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m15:45:27.874151 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m15:45:27.875029 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m15:45:27.950220 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m15:45:27.950977 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
create or replace  temporary view incident_management.bronze_zone.users__dbt_tmp
  
   as (
    

select 
    sm.MEMBERIDS[0] as id,
    sm.memberemails[0] as email,
    split(sm.memberemails[0], '@')[0] as first_name,
    split(sm.memberemails[0], '@')[1] as last_name,
    'reporter' as role,
    '' as department,
    '' as team,
    true as is_active,
    current_timestamp() as created_at,
    current_timestamp() as updated_at
from incident_management.bronze_zone.slack_members sm
  );
[0m15:45:27.951574 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:28.760452 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d11-0206-cee1-0032-318704d5be82
[0m15:45:28.761201 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MEMBERS' does not exist or not authorized.
[0m15:45:28.766474 [debug] [Thread-2 (]: Database Error in model users (models/bronze_zone/users.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MEMBERS' does not exist or not authorized.
[0m15:45:28.769804 [error] [Thread-2 (]: 1 of 13 ERROR creating sql incremental model bronze_zone.users ................. [[31mERROR[0m in 0.91s]
[0m15:45:28.770759 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m15:45:28.771897 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m15:45:28.772749 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.users' to be skipped because of status 'error'.  Reason: Database Error in model users (models/bronze_zone/users.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MEMBERS' does not exist or not authorized..
[0m15:45:28.773593 [info ] [Thread-2 (]: 2 of 13 START sql view model bronze_zone.v_qualify_new_documents ............... [RUN]
[0m15:45:28.775287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m15:45:28.775871 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m15:45:28.789789 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m15:45:28.790734 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m15:45:28.818609 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m15:45:28.820335 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m15:45:28.821037 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and contains(relative_path, 'pdf|docx|doc|txt|text|html|md|pptx|ppt|png|eml|jpg|jpeg|gif|bmp|tiff|tif|webp|htm')
and size > 0
  );
[0m15:45:28.821634 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:29.991522 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.170 seconds
[0m15:45:30.019284 [info ] [Thread-2 (]: 2 of 13 OK created sql view model bronze_zone.v_qualify_new_documents .......... [[32mSUCCESS 1[0m in 1.24s]
[0m15:45:30.020288 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m15:45:30.021407 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m15:45:30.022506 [info ] [Thread-2 (]: 3 of 13 START sql view model bronze_zone.v_qualify_slack_messages .............. [RUN]
[0m15:45:30.023202 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m15:45:30.023766 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m15:45:30.037837 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m15:45:30.038755 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m15:45:30.049236 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_slack_messages"
[0m15:45:30.053301 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_slack_messages"
[0m15:45:30.054360 [debug] [Thread-2 (]: On model.incident_management.v_qualify_slack_messages: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_slack_messages"} */
create or replace   view incident_management.bronze_zone.v_qualify_slack_messages
  
   as (
    

-- Only propagate messages from known reporters (users in channel)
with slack_messages_from_known_reporters as (
    select sm.*, r.id as reporter_id
    from incident_management.bronze_zone.slack_messages sm
    inner join incident_management.bronze_zone.users r on sm.username = split(r.email, '@')[0]
    where sm.clientmsgid is not null
    and to_date(sm.ingestts) >= to_date(current_timestamp())
)

-- Messages with attachments (with join to doc_metadata)
select 
    true as hasfiles,
    sm.type,
    sm.subtype,
    sm.team,
    sm.channel,
    sm.user,
    sm.username,
    sm.reporter_id,
    sm.text,
    sm.ts,
    sm.clientmsgid as slack_message_id,
    
    -- Attachment metadata from doc_metadata
    dm.file_id,
    dm.file_name, 
    dm.file_mimetype, 
    dm.file_size, 
    dm.staged_file_path,
    to_file('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', dm.staged_file_path) as attachment_file,
    case 
        -- When there is an attachment file and it is an image, use the image to extract the incident code
        when dm.staged_file_path is not null and fl_is_image(to_file('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', dm.staged_file_path)) then 
        ai_complete('claude-3-5-sonnet',
            prompt(
            $$
            Find the incident number that may be present either in the image {0} or in the text {1}. 
            Use the one in the image if found.Look for alphanumeric codes preceded by the keyword 'incident' (case-insensitive). 
            Examples: INC-12345, incident_001, INC-2025-001.
            Respond only in JSON format with a single key called 'incident_code'.
            Do not add any explanation in the response.
            $$, 
            attachment_file,
            text
            )
        )
        else null
    end as incident_number

from slack_messages_from_known_reporters sm
inner join incident_management.bronze_zone.doc_metadata dm 
on (sm.hasfiles and (sm.channel = dm.channel_id) and (sm.ts = dm.event_ts))

UNION ALL

-- Messages without attachments (no join to doc_metadata)
select 
    false as hasfiles,
    sm.type,
    sm.subtype,
    sm.team,
    sm.channel,
    sm.user,
    sm.username,
    sm.reporter_id,
    sm.text,
    sm.ts,
    sm.clientmsgid as slack_message_id,
    
    -- No attachment metadata for messages without files
    null as file_id,
    null as file_name, 
    null as file_mimetype, 
    null as file_size, 
    null as staged_file_path,
    null as attachment_file,
    case 
        -- Only use text to extract the incident code since there are no attachments
        when sm.text is not null then ai_complete('claude-3-5-sonnet',
                prompt(
                $$
                Extract incident codes from Slack text {0}. 
                Look for alphanumeric codes preceded by the keyword 'incident' (case-insensitive). 
                Examples: INC-12345, incident_001, INC-2025-001.
                Respond only in JSON format with a single key called 'incident_code'.
                Do not add any explanation in the response.
                $$, 
                text
            )
        )
        else null
    end as incident_number

from slack_messages_from_known_reporters sm
where not sm.hasfiles or sm.hasfiles is null
  );
[0m15:45:30.055256 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:30.814042 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d11-0206-cee1-0032-318704d5bec2
[0m15:45:30.814773 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MESSAGES' does not exist or not authorized.
[0m15:45:30.820258 [debug] [Thread-2 (]: Database Error in model v_qualify_slack_messages (models/bronze_zone/v_qualify_slack_messages.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MESSAGES' does not exist or not authorized.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/v_qualify_slack_messages.sql
[0m15:45:30.821650 [error] [Thread-2 (]: 3 of 13 ERROR creating sql view model bronze_zone.v_qualify_slack_messages ..... [[31mERROR[0m in 0.80s]
[0m15:45:30.822588 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m15:45:30.823659 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m15:45:30.824404 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.v_qualify_slack_messages' to be skipped because of status 'error'.  Reason: Database Error in model v_qualify_slack_messages (models/bronze_zone/v_qualify_slack_messages.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MESSAGES' does not exist or not authorized.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/v_qualify_slack_messages.sql.
[0m15:45:30.825245 [info ] [Thread-2 (]: 4 of 13 START sql table model bronze_zone.document_full_extracts ............... [RUN]
[0m15:45:30.826394 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now model.incident_management.document_full_extracts)
[0m15:45:30.826964 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m15:45:30.839842 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m15:45:30.840685 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m15:45:30.878679 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.document_full_extracts"
[0m15:45:30.880592 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_full_extracts"
[0m15:45:30.881300 [debug] [Thread-2 (]: On model.incident_management.document_full_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_full_extracts"} */
create or replace transient table incident_management.bronze_zone.document_full_extracts
         as
        (


with document_all_pages
as
(
    select
        *,
        AI_PARSE_DOCUMENT (
            TO_FILE('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS/full',relative_path),
            parse_mode => 'LAYOUT', 
            page_split => true
        ) as chunk
        FROM incident_management.bronze_zone.v_qualify_new_documents
        WHERE analysis_type = 'full'
)

select 
*,
f.value:content::STRING as page_content,
f.index::int as page_num
from document_all_pages,
LATERAL FLATTEN(input => chunk:pages) f;
[0m15:45:30.881896 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:31.582805 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d11-0206-cee1-0032-318704d5bee2
[0m15:45:31.583554 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 39 unexpected ';'.
[0m15:45:31.588538 [debug] [Thread-2 (]: Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 39 unexpected ';'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql
[0m15:45:31.590046 [error] [Thread-2 (]: 4 of 13 ERROR creating sql table model bronze_zone.document_full_extracts ...... [[31mERROR[0m in 0.76s]
[0m15:45:31.591046 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m15:45:31.592205 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m15:45:31.593014 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_full_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 39 unexpected ';'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql.
[0m15:45:31.593842 [info ] [Thread-2 (]: 5 of 13 START python table model bronze_zone.document_question_extracts ........ [RUN]
[0m15:45:31.594809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m15:45:31.595381 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m15:45:31.629164 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m15:45:31.630116 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m15:45:31.643787 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m15:45:31.646530 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m15:45:31.647615 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(relative_path: str):
    asset_path = dbt.config.get("asset_path")
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{dbt.config.get("docs_stage_path")}/qa'), F.col('relative_path')),
            get_response_format(F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m15:45:31.648597 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:36.252419 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d11-0206-cee1-0032-318704d5bf06
[0m15:45:36.253207 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
    df = model(dbt, session)
  File "_udf_code.py", line 39, in model
    get_response_format(F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    asset_path = dbt.config.get("asset_path")
NameError: name 'dbt' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m15:45:36.258505 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m15:45:36.259887 [error] [Thread-2 (]: 5 of 13 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.66s]
[0m15:45:36.260865 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m15:45:36.261988 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m15:45:36.262823 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m15:45:36.263582 [info ] [Thread-2 (]: 6 of 13 SKIP relation gold_zone.incidents ...................................... [[33mSKIP[0m]
[0m15:45:36.264510 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m15:45:36.266225 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m15:45:36.267048 [info ] [Thread-2 (]: 7 of 13 SKIP relation gold_zone.active_incidents ............................... [[33mSKIP[0m]
[0m15:45:36.267682 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m15:45:36.268699 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m15:45:36.269422 [info ] [Thread-2 (]: 8 of 13 SKIP relation gold_zone.closed_incidents ............................... [[33mSKIP[0m]
[0m15:45:36.270040 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m15:45:36.270919 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m15:45:36.271609 [info ] [Thread-2 (]: 9 of 13 SKIP relation gold_zone.incident_attachments ........................... [[33mSKIP[0m]
[0m15:45:36.272226 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m15:45:36.273129 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m15:45:36.273819 [info ] [Thread-2 (]: 10 of 13 SKIP relation gold_zone.incident_comment_history ...................... [[33mSKIP[0m]
[0m15:45:36.274437 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m15:45:36.275325 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m15:45:36.275994 [info ] [Thread-2 (]: 11 of 13 SKIP relation gold_zone.monthly_incident_trends ....................... [[33mSKIP[0m]
[0m15:45:36.276606 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m15:45:36.277506 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m15:45:36.278178 [info ] [Thread-2 (]: 12 of 13 SKIP relation bronze_zone.v_slack_msg_incident_number ................. [[33mSKIP[0m]
[0m15:45:36.278878 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m15:45:36.279820 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m15:45:36.280506 [info ] [Thread-2 (]: 13 of 13 SKIP relation gold_zone.weekly_incident_trends ........................ [[33mSKIP[0m]
[0m15:45:36.281149 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m15:45:36.283617 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m15:45:36.284214 [debug] [Dummy-1   ]: Connection 'create_incident_management_gold_zone' was properly closed.
[0m15:45:36.284685 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m15:45:36.285369 [info ] [Dummy-1   ]: 
[0m15:45:36.285902 [info ] [Dummy-1   ]: Finished running 4 incremental models, 6 table models, 3 view models in 0 hours 0 minutes and 13.16 seconds (13.16s).
[0m15:45:36.287841 [debug] [Dummy-1   ]: Command end result
[0m15:45:36.329792 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m15:45:36.332277 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m15:45:36.340259 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m15:45:36.340826 [info ] [Dummy-1   ]: 
[0m15:45:36.341480 [info ] [Dummy-1   ]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m15:45:36.341978 [info ] [Dummy-1   ]: 
[0m15:45:36.342667 [error] [Dummy-1   ]:   Database Error in model users (models/bronze_zone/users.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MEMBERS' does not exist or not authorized.
[0m15:45:36.343160 [info ] [Dummy-1   ]: 
[0m15:45:36.343808 [error] [Dummy-1   ]:   Database Error in model v_qualify_slack_messages (models/bronze_zone/v_qualify_slack_messages.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MESSAGES' does not exist or not authorized.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/v_qualify_slack_messages.sql
[0m15:45:36.344304 [info ] [Dummy-1   ]: 
[0m15:45:36.344986 [error] [Dummy-1   ]:   Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 39 unexpected ';'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql
[0m15:45:36.345494 [info ] [Dummy-1   ]: 
[0m15:45:36.346180 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m15:45:36.346714 [info ] [Dummy-1   ]: 
[0m15:45:36.347218 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=4 SKIP=8 TOTAL=13
[0m15:45:36.349059 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.50519, "process_in_blocks": "0", "process_kernel_time": 1.49, "process_mem_max_rss": "486768", "process_out_blocks": "0", "process_user_time": 8.34}
[0m15:45:36.349732 [debug] [Dummy-1   ]: Command `cli run` failed at 15:45:36.349465 after 17.51 seconds
[0m15:45:36.350292 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:49:18.903299 | 60dc5aab-949c-49c1-8e4f-84ea5d754972 ==============================
[0m15:49:18.903299 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:49:18.904469 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:49:19.292583 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:49:20.107565 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:49:20.497718 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:49:20.498896 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_slack_msg_incident_number.sql
[0m15:49:20.499663 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_full_extracts.sql
[0m15:49:20.500340 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/users.sql
[0m15:49:20.501033 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_slack_messages.sql
[0m15:49:21.217241 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m15:49:21.220165 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m15:49:21.271805 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m15:49:21.276338 [info ] [Dummy-1   ]: 
[0m15:49:21.277031 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m15:49:21.277555 [info ] [Dummy-1   ]: 
[0m15:49:21.278520 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m15:49:21.287206 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m15:49:21.453931 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:49:21.454726 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:49:21.455369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:22.289487 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.834 seconds
[0m15:49:22.295555 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:49:22.296250 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m15:49:22.387451 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.090 seconds
[0m15:49:22.390759 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:49:22.391444 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:49:22.504929 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m15:49:22.507449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m15:49:22.518217 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:49:22.519003 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:49:22.519638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:23.342020 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.822 seconds
[0m15:49:23.344617 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:49:23.345277 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m15:49:23.466529 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.121 seconds
[0m15:49:23.469528 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:49:23.470172 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:49:23.577656 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.107 seconds
[0m15:49:23.603841 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m15:49:23.604813 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m15:49:23.605502 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m15:49:23.625801 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m15:49:23.626850 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m15:49:23.628005 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m15:49:23.629323 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m15:49:23.630360 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m15:49:23.630991 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m15:49:23.643464 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m15:49:23.644479 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m15:49:23.645603 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m15:49:23.646818 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m15:49:23.648015 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m15:49:23.648713 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m15:49:23.663946 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m15:49:23.664905 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m15:49:23.666002 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m15:49:23.667181 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:49:23.668229 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m15:49:23.668951 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:49:23.692088 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m15:49:23.693039 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:49:23.694096 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:49:23.695290 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:49:23.696144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m15:49:23.696759 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:49:23.711194 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m15:49:23.712168 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:49:23.713250 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:49:23.714425 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:49:23.715219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m15:49:23.715820 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:49:23.728580 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m15:49:23.729577 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:49:23.730632 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:49:23.731752 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:49:23.732614 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m15:49:23.733258 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:49:23.747549 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m15:49:23.748583 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:49:23.749640 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:49:23.750729 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:49:23.751630 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m15:49:23.752263 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:49:23.900377 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m15:49:23.901348 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:49:23.902390 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:49:23.903484 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:49:23.904306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m15:49:23.904900 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:49:23.917535 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m15:49:23.918552 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:49:23.919706 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:49:23.920858 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:49:23.921680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m15:49:23.922319 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:49:23.936713 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m15:49:23.937764 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:49:23.938907 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:49:23.940039 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:49:23.940874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m15:49:23.941514 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:49:23.954522 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m15:49:23.955495 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:49:23.956535 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:49:23.957629 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:49:23.958575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m15:49:23.959292 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:49:23.974050 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m15:49:23.974999 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:49:23.976060 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:49:23.977148 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:49:23.977995 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m15:49:23.978701 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:49:23.991527 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m15:49:23.992459 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:49:23.993481 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:49:23.994617 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:49:23.995413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m15:49:23.996012 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:49:24.014216 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m15:49:24.015223 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:49:24.016263 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:49:24.017401 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m15:49:24.018236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m15:49:24.018988 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m15:49:24.031189 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m15:49:24.032158 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m15:49:24.033186 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m15:49:24.034348 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m15:49:24.035188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m15:49:24.035816 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m15:49:24.076136 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m15:49:24.077118 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m15:49:24.078150 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m15:49:24.079432 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m15:49:24.080256 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m15:49:24.080843 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m15:49:24.093785 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m15:49:24.094739 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m15:49:24.095767 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m15:49:24.097665 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m15:49:24.098623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m15:49:24.099243 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m15:49:24.111401 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m15:49:24.112314 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m15:49:24.113339 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m15:49:24.114511 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m15:49:24.115329 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m15:49:24.115916 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m15:49:24.130096 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m15:49:24.131022 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m15:49:24.132102 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m15:49:24.133266 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m15:49:24.134396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m15:49:24.134982 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m15:49:24.147774 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m15:49:24.148750 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m15:49:24.149790 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m15:49:24.150958 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m15:49:24.151761 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m15:49:24.152345 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m15:49:24.166805 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m15:49:24.167718 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m15:49:24.168825 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m15:49:24.169996 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m15:49:24.170798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m15:49:24.171387 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m15:49:24.183262 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m15:49:24.184123 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m15:49:24.185116 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m15:49:24.186271 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m15:49:24.187163 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m15:49:24.187806 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m15:49:24.200107 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m15:49:24.201008 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m15:49:24.204396 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m15:49:24.205586 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m15:49:24.206392 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m15:49:24.206976 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m15:49:24.218614 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m15:49:24.219539 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m15:49:24.220574 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m15:49:24.221704 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:49:24.222469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m15:49:24.223059 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:49:24.244064 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m15:49:24.245070 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:49:24.246161 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:49:24.247390 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:49:24.248334 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m15:49:24.249065 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:49:24.265466 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m15:49:24.266420 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:49:24.267482 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:49:24.268732 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:49:24.269547 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m15:49:24.270135 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:49:24.283181 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m15:49:24.284075 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:49:24.285088 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:49:24.286230 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:49:24.286998 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m15:49:24.287618 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:49:24.301799 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m15:49:24.302684 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:49:24.303714 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:49:24.304828 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:49:24.305594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m15:49:24.306185 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:49:24.318846 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m15:49:24.319726 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:49:24.320722 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:49:24.321819 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:49:24.322567 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m15:49:24.323152 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:49:24.337413 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m15:49:24.338320 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:49:24.339452 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:49:24.340559 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:49:24.341330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m15:49:24.341913 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:49:24.354665 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m15:49:24.355617 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:49:24.356627 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:49:24.357765 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:49:24.358607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m15:49:24.359241 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:49:24.371868 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m15:49:24.372821 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:49:24.373872 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:49:24.376457 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m15:49:24.377031 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m15:49:24.382885 [debug] [Dummy-1   ]: Command end result
[0m15:49:24.427552 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m15:49:24.430487 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m15:49:24.441434 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m15:49:24.443541 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.6405015, "process_in_blocks": "0", "process_kernel_time": 1.29, "process_mem_max_rss": "437588", "process_out_blocks": "0", "process_user_time": 6.92}
[0m15:49:24.444274 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 15:49:24.443992 after 5.64 seconds
[0m15:49:24.444847 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:03:46.110907 | 7443801a-b52e-440c-b8d8-62fb53356d5e ==============================
[0m16:03:46.110907 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:03:46.112210 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:03:46.524825 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:03:47.288556 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:03:47.723278 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:47.724544 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_new_documents.sql
[0m16:03:48.453479 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:03:48.456733 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:03:48.508085 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:03:48.512942 [info ] [Dummy-1   ]: 
[0m16:03:48.513667 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:03:48.514249 [info ] [Dummy-1   ]: 
[0m16:03:48.515259 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:03:48.549750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:03:48.732687 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:03:48.733517 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:03:48.734175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:49.586904 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.852 seconds
[0m16:03:49.593218 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:03:49.593928 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:03:49.721955 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.127 seconds
[0m16:03:49.725968 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:03:49.726735 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:03:49.823073 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m16:03:49.825884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:03:49.838723 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:03:49.839462 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:03:49.840070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:50.616366 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.776 seconds
[0m16:03:50.619156 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:03:50.619808 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:03:50.733001 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.112 seconds
[0m16:03:50.735563 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:03:50.736263 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:03:50.830240 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m16:03:50.856223 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:03:50.857167 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m16:03:50.857882 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:03:50.878936 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:03:50.880072 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:03:50.881310 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:03:50.882852 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:03:50.883974 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:03:50.884640 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:03:50.897023 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:03:50.898163 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:03:50.899693 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:03:50.901051 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:03:50.902330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:03:50.903055 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:03:50.916985 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:03:50.918098 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:03:50.919385 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:03:50.920841 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:03:50.922095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:03:50.922803 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:03:50.949737 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:03:50.950849 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:03:50.952052 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:03:50.953346 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:03:50.954310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:03:50.955138 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:03:50.968975 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:03:50.970092 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:03:50.971267 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:03:50.972621 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:03:50.973566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:03:50.974283 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:03:50.989583 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:03:50.990711 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:03:50.991893 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:03:50.993131 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:03:50.994133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:03:50.994790 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:03:51.008076 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:03:51.009217 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:03:51.010427 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:03:51.011696 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:03:51.012715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:03:51.013415 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:03:51.028512 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:03:51.029606 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:03:51.030810 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:03:51.032013 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:03:51.032980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:03:51.033620 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:03:51.047029 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:03:51.048001 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:03:51.049151 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:03:51.050465 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:03:51.051479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:03:51.052162 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:03:51.067367 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:03:51.068380 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:03:51.069557 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:03:51.070787 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:03:51.071693 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:03:51.072308 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:03:51.250775 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:03:51.251923 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:03:51.253059 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:03:51.254333 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:03:51.255287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:03:51.255972 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:03:51.269266 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:03:51.270376 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:03:51.271534 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:03:51.273159 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:03:51.274139 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:03:51.274812 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:03:51.290273 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:03:51.291282 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:03:51.292408 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:03:51.293664 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:03:51.294669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:03:51.295340 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:03:51.312072 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:03:51.313086 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:03:51.314291 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:03:51.315562 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:03:51.316672 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:03:51.318433 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:03:51.333909 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:03:51.334980 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:03:51.336151 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:03:51.337472 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:03:51.338452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:03:51.339114 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:03:51.379722 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:03:51.380736 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:03:51.381853 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:03:51.383108 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:03:51.384013 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:03:51.384668 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:03:51.401175 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:03:51.402202 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:03:51.403351 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:03:51.405465 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:03:51.406528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:03:51.407182 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:03:51.420064 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:03:51.421111 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:03:51.422303 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:03:51.423856 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:03:51.424765 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:03:51.425383 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:03:51.437296 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:03:51.438330 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:03:51.439506 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:03:51.440837 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:03:51.442071 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:03:51.442709 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:03:51.458380 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:03:51.459443 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:03:51.460565 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:03:51.461811 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:03:51.462759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:03:51.463418 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:03:51.476562 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:03:51.477637 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:03:51.478841 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:03:51.480104 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:03:51.481021 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:03:51.481690 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:03:51.495996 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:03:51.497098 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:03:51.498220 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:03:51.499597 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:03:51.500509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:03:51.501142 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:03:51.513874 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:03:51.514833 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:03:51.515922 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:03:51.517166 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:03:51.518074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:03:51.518725 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:03:51.532600 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:03:51.533543 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:03:51.534655 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:03:51.535956 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:03:51.536891 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:03:51.537524 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:03:51.559540 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:03:51.560548 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:03:51.561669 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:03:51.562949 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:03:51.563867 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:03:51.564494 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:03:51.579426 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:03:51.580398 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:03:51.581476 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:03:51.582737 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:03:51.583636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:03:51.584254 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:03:51.599920 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:03:51.600888 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:03:51.602022 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:03:51.603277 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:03:51.604165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:03:51.604785 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:03:51.618109 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:03:51.619148 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:03:51.620259 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:03:51.621573 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:03:51.622574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:03:51.623209 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:03:51.638323 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:03:51.639335 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:03:51.640433 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:03:51.641664 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:03:51.642568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:03:51.643189 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:03:51.656250 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:03:51.657199 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:03:51.658331 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:03:51.659639 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:03:51.660509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:03:51.661116 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:03:51.675967 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:03:51.676958 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:03:51.678084 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:03:51.679426 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:03:51.680338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:03:51.680965 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:03:51.694222 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:03:51.695207 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:03:51.696311 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:03:51.699048 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:03:51.699680 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:03:51.705622 [debug] [Dummy-1   ]: Command end result
[0m16:03:51.750851 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:03:51.753793 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:03:51.765424 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:03:51.767695 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.7631245, "process_in_blocks": "0", "process_kernel_time": 1.54, "process_mem_max_rss": "484896", "process_out_blocks": "0", "process_user_time": 7.05}
[0m16:03:51.768531 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:03:51.768189 after 5.76 seconds
[0m16:03:51.769179 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:09:25.757701 | e32c99eb-3e9e-4915-9c06-50c67b2c854a ==============================
[0m16:09:25.757701 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:09:25.759158 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:09:26.175832 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:09:26.913771 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:09:27.364413 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:09:27.365703 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_new_documents.sql
[0m16:09:28.086325 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:09:28.089651 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:09:28.140542 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:09:28.145212 [info ] [Dummy-1   ]: 
[0m16:09:28.145933 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:09:28.146474 [info ] [Dummy-1   ]: 
[0m16:09:28.147366 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:09:28.156460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:09:28.317758 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:09:28.318647 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:09:28.319386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:29.123942 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.804 seconds
[0m16:09:29.130339 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:09:29.131027 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:09:30.094877 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.963 seconds
[0m16:09:30.099245 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:09:30.099936 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:09:30.225489 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.125 seconds
[0m16:09:30.228448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:09:30.241278 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:09:30.242058 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:09:30.242673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:31.296025 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.053 seconds
[0m16:09:31.298826 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:09:31.299493 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:09:31.410807 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.111 seconds
[0m16:09:31.413399 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:09:31.414103 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:09:31.570676 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.156 seconds
[0m16:09:31.579359 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:09:31.580292 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m16:09:31.580982 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:09:31.601843 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:09:31.602882 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:09:31.604033 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:09:31.605402 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:09:31.606415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:09:31.607076 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:09:31.619616 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:09:31.620627 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:09:31.622038 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:09:31.623375 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:09:31.624593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:09:31.625271 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:09:31.639390 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:09:31.640407 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:09:31.641571 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:09:31.642968 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:09:31.644221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:09:31.644929 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:09:31.672057 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:09:31.673064 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:09:31.674230 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:09:31.675539 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:09:31.676479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:09:31.677116 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:09:31.690869 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:09:31.691869 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:09:31.692963 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:09:31.694259 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:09:31.695171 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:09:31.695809 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:09:31.711221 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:09:31.712229 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:09:31.713345 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:09:31.714631 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:09:31.715560 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:09:31.716185 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:09:31.729728 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:09:31.730801 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:09:31.731927 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:09:31.733115 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:09:31.734083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:09:31.734721 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:09:31.749816 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:09:31.750806 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:09:31.751937 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:09:31.753141 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:09:31.754076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:09:31.754717 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:09:31.768048 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:09:31.769141 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:09:31.770312 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:09:31.771539 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:09:31.772443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:09:31.773069 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:09:31.788536 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:09:31.789528 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:09:31.790686 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:09:31.791902 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:09:31.792793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:09:31.793413 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:09:31.967254 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:09:31.968287 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:09:31.969501 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:09:31.970729 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:09:31.971627 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:09:31.972246 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:09:31.985594 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:09:31.986611 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:09:31.987725 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:09:31.989298 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:09:31.990241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:09:31.990860 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:09:32.006386 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:09:32.007378 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:09:32.008571 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:09:32.009863 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:09:32.010772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:09:32.011396 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:09:32.028035 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:09:32.029126 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:09:32.030305 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:09:32.031614 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:09:32.032539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:09:32.033170 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:09:32.048173 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:09:32.049281 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:09:32.050422 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:09:32.051691 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:09:32.052548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:09:32.053161 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:09:32.093598 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:09:32.094750 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:09:32.095917 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:09:32.097242 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:09:32.098223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:09:32.098957 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:09:32.114648 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:09:32.115746 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:09:32.116913 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:09:32.119159 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:09:32.120357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:09:32.121018 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:09:32.133765 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:09:32.134852 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:09:32.135965 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:09:32.137501 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:09:32.138546 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:09:32.139215 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:09:32.151173 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:09:32.152182 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:09:32.153282 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:09:32.154593 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:09:32.155948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:09:32.156625 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:09:32.172629 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:09:32.173603 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:09:32.174785 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:09:32.176113 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:09:32.177044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:09:32.177670 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:09:32.190914 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:09:32.191908 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:09:32.193031 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:09:32.194340 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:09:32.195220 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:09:32.195855 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:09:32.210323 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:09:32.211296 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:09:32.212407 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:09:32.213668 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:09:32.214601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:09:32.215241 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:09:32.227939 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:09:32.229095 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:09:32.230266 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:09:32.231530 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:09:32.232417 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:09:32.233035 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:09:32.247142 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:09:32.248132 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:09:32.249332 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:09:32.250660 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:09:32.251550 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:09:32.252185 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:09:32.274469 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:09:32.275469 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:09:32.276595 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:09:32.277894 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:09:32.278943 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:09:32.279630 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:09:32.294700 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:09:32.295703 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:09:32.296845 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:09:32.298222 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:09:32.299281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:09:32.299932 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:09:32.315843 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:09:32.316872 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:09:32.318018 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:09:32.319413 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:09:32.320348 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:09:32.320987 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:09:32.334464 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:09:32.335429 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:09:32.336527 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:09:32.337800 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:09:32.338826 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:09:32.339485 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:09:32.354762 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:09:32.355748 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:09:32.356854 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:09:32.358128 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:09:32.359113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:09:32.359741 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:09:32.373054 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:09:32.374113 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:09:32.375249 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:09:32.376562 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:09:32.377470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:09:32.378183 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:09:32.393342 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:09:32.394350 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:09:32.395468 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:09:32.396735 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:09:32.397623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:09:32.398275 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:09:32.411682 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:09:32.412691 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:09:32.413818 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:09:32.416642 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:09:32.417260 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:09:32.423291 [debug] [Dummy-1   ]: Command end result
[0m16:09:32.469708 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:09:32.472723 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:09:32.484549 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:09:32.486845 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.8370533, "process_in_blocks": "0", "process_kernel_time": 1.35, "process_mem_max_rss": "482480", "process_out_blocks": "0", "process_user_time": 7.26}
[0m16:09:32.487651 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:09:32.487345 after 6.84 seconds
[0m16:09:32.488280 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:10:43.573904 | c2581932-6a91-4b68-a175-eb78a5563f30 ==============================
[0m16:10:43.573904 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:10:43.575160 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:10:43.982588 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:10:44.745615 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:10:45.184427 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:45.185194 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:45.404123 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:10:45.407421 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:10:45.484084 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:10:45.486218 [warn ] [Dummy-1   ]: The selection criterion '+bronze_zone.v_qualify_new_documents.sql' does not match any enabled nodes
[0m16:10:45.488452 [warn ] [Dummy-1   ]: Nothing to do. Try checking your model configs and model specification args
[0m16:10:45.491351 [debug] [Dummy-1   ]: Command end result
[0m16:10:45.537866 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:10:45.541006 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:10:45.545841 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:10:45.548208 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0785942, "process_in_blocks": "0", "process_kernel_time": 1.2, "process_mem_max_rss": "414048", "process_out_blocks": "0", "process_user_time": 5.49}
[0m16:10:45.549208 [debug] [Dummy-1   ]: Command `cli run` succeeded at 16:10:45.548862 after 2.08 seconds
[0m16:10:45.549936 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:11:06.590633 | b36b3dbf-7b33-4797-91d0-e2c1399d7be7 ==============================
[0m16:11:06.590633 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:11:06.591944 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:11:07.010577 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:11:07.769755 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:11:08.195687 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:08.196473 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:08.420091 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:11:08.423525 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:11:08.489080 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:11:08.492915 [info ] [Dummy-1   ]: 
[0m16:11:08.493693 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:11:08.494396 [info ] [Dummy-1   ]: 
[0m16:11:08.495473 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:11:08.498777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:11:08.675330 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:11:08.676106 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:11:08.676703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:09.599679 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.923 seconds
[0m16:11:09.610741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m16:11:09.636092 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:11:09.636809 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:11:09.637342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:10.602219 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.965 seconds
[0m16:11:10.608697 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:11:10.609448 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:11:10.703707 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.093 seconds
[0m16:11:10.706701 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:11:10.707412 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:11:10.898572 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.190 seconds
[0m16:11:10.901389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:11:10.914476 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:11:10.915148 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:11:10.915669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:11.804116 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.888 seconds
[0m16:11:11.806796 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:11:11.807519 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:11:11.887213 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.079 seconds
[0m16:11:11.890414 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:11:11.891168 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:11:12.012783 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m16:11:12.020700 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:11:12.021771 [info ] [Thread-2 (]: 1 of 1 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:11:12.022698 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:11:12.023367 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:11:12.043952 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:11:12.045125 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:11:12.107704 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:11:12.109919 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:11:12.110730 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:11:12.111408 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:11:13.254686 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.143 seconds
[0m16:11:13.293569 [info ] [Thread-2 (]: 1 of 1 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.27s]
[0m16:11:13.294719 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:11:13.298281 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:11:13.299086 [debug] [Dummy-1   ]: Connection 'model.incident_management.v_qualify_new_documents' was properly closed.
[0m16:11:13.299696 [info ] [Dummy-1   ]: 
[0m16:11:13.300262 [info ] [Dummy-1   ]: Finished running 1 view model in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m16:11:13.301320 [debug] [Dummy-1   ]: Command end result
[0m16:11:13.347959 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:11:13.351224 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:11:13.359954 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:11:13.360571 [info ] [Dummy-1   ]: 
[0m16:11:13.361331 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m16:11:13.361883 [info ] [Dummy-1   ]: 
[0m16:11:13.362482 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:11:13.364468 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8812003, "process_in_blocks": "0", "process_kernel_time": 1.53, "process_mem_max_rss": "442484", "process_out_blocks": "0", "process_user_time": 5.97}
[0m16:11:13.365236 [debug] [Dummy-1   ]: Command `cli run` succeeded at 16:11:13.364943 after 6.88 seconds
[0m16:11:13.365848 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:12:25.202855 | 58b3de11-86a6-44cd-803b-3f06b1f80fa2 ==============================
[0m16:12:25.202855 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:12:25.204149 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:12:25.618958 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:12:26.345706 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:12:26.778209 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:26.779179 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:27.001715 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:12:27.005066 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:12:27.071290 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:12:27.075215 [info ] [Dummy-1   ]: 
[0m16:12:27.075887 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:12:27.076395 [info ] [Dummy-1   ]: 
[0m16:12:27.077357 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:12:27.085481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:12:27.244235 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:12:27.244983 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:12:27.245548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:27.952617 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.707 seconds
[0m16:12:27.960207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m16:12:27.985323 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:12:27.986164 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:12:27.986820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:29.488882 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.502 seconds
[0m16:12:29.495264 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:12:29.496039 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:12:29.584696 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.088 seconds
[0m16:12:29.587361 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:12:29.588016 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:12:29.710805 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.122 seconds
[0m16:12:29.713497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:12:29.724818 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:12:29.725523 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:12:29.726094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:30.510822 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.784 seconds
[0m16:12:30.513593 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:12:30.514313 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:12:30.671610 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.157 seconds
[0m16:12:30.674603 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:12:30.675268 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:12:30.768572 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.092 seconds
[0m16:12:30.778194 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:12:30.779401 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:12:30.780251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m16:12:30.781386 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:12:30.801516 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:12:30.802662 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:12:30.865151 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:12:30.867300 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:12:30.868100 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:12:30.868934 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:12:31.996150 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.127 seconds
[0m16:12:32.034641 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.25s]
[0m16:12:32.035784 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:12:32.037989 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:12:32.039276 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:12:32.040176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:12:32.040897 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:12:32.083515 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:12:32.084625 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:12:32.129447 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:12:32.132639 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:12:32.133871 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(relative_path: str):
    asset_path = dbt.config.get("asset_path")
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{dbt.config.get("docs_stage_path")}/qa'), F.col('relative_path')),
            get_response_format(F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:12:32.134866 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:12:36.356377 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d2c-0206-d87f-0032-318704d7741a
[0m16:12:36.357248 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
    df = model(dbt, session)
  File "_udf_code.py", line 39, in model
    get_response_format(F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    asset_path = dbt.config.get("asset_path")
NameError: name 'dbt' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:12:36.363191 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:12:36.364846 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.32s]
[0m16:12:36.365953 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:12:36.367619 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:12:36.371092 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:12:36.371709 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m16:12:36.372212 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:12:36.372762 [info ] [Dummy-1   ]: 
[0m16:12:36.373331 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.30 seconds (9.30s).
[0m16:12:36.374625 [debug] [Dummy-1   ]: Command end result
[0m16:12:36.421439 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:12:36.424567 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:12:36.433369 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:12:36.434035 [info ] [Dummy-1   ]: 
[0m16:12:36.434775 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:12:36.435345 [info ] [Dummy-1   ]: 
[0m16:12:36.436177 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:12:36.436763 [info ] [Dummy-1   ]: 
[0m16:12:36.437305 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:12:36.439457 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.343254, "process_in_blocks": "0", "process_kernel_time": 1.37, "process_mem_max_rss": "438192", "process_out_blocks": "0", "process_user_time": 6.32}
[0m16:12:36.440235 [debug] [Dummy-1   ]: Command `cli run` failed at 16:12:36.439940 after 11.34 seconds
[0m16:12:36.440875 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:14:24.688904 | aa586803-8765-4748-aef6-e8219d10cfc6 ==============================
[0m16:14:24.688904 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:14:24.690273 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:14:25.095230 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:14:25.862754 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:14:26.294011 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:26.294751 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:26.511217 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:14:26.514251 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:14:26.575313 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:14:26.579944 [info ] [Dummy-1   ]: 
[0m16:14:26.580676 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:14:26.581244 [info ] [Dummy-1   ]: 
[0m16:14:26.582293 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:14:26.590162 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:14:26.747938 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:14:26.748891 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:14:26.749482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:27.625880 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.876 seconds
[0m16:14:27.631187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m16:14:27.655786 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:14:27.656465 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:14:27.657039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:28.415029 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.758 seconds
[0m16:14:28.421172 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:14:28.421894 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:14:28.537929 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.115 seconds
[0m16:14:28.540879 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:14:28.541553 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:14:28.642784 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m16:14:28.645491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:14:28.658168 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:14:28.658973 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:14:28.659565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:29.468567 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.809 seconds
[0m16:14:29.471281 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:14:29.471985 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:14:29.586466 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.114 seconds
[0m16:14:29.589075 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:14:29.589780 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:14:29.685466 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m16:14:29.692908 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:14:29.693974 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:14:29.695398 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:14:29.696138 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:14:29.715703 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:14:29.716715 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:14:29.777300 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:14:29.779445 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:14:29.780286 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:14:29.780981 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:14:30.989824 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.209 seconds
[0m16:14:31.026133 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.33s]
[0m16:14:31.027194 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:14:31.029372 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:14:31.030552 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:14:31.031384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:14:31.032028 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:14:31.072698 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:14:31.073729 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:14:31.117369 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:14:31.120521 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:14:31.121723 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(relative_path: str):
    asset_path = dbt.config.get("asset_path")
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{dbt.config.get("docs_stage_path")}/qa'), F.col('relative_path')),
            get_response_format(F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:14:31.122666 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:14:34.472851 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d2e-0206-cee1-0032-318704d764e6
[0m16:14:34.473672 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
    df = model(dbt, session)
  File "_udf_code.py", line 39, in model
    get_response_format(F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    asset_path = dbt.config.get("asset_path")
NameError: name 'dbt' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:14:34.479529 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:14:34.481138 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.45s]
[0m16:14:34.482213 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:14:34.483732 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:14:34.486945 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:14:34.487527 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:14:34.488067 [info ] [Dummy-1   ]: 
[0m16:14:34.488725 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.91 seconds (7.91s).
[0m16:14:34.490030 [debug] [Dummy-1   ]: Command end result
[0m16:14:34.535475 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:14:34.538463 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:14:34.546905 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:14:34.547512 [info ] [Dummy-1   ]: 
[0m16:14:34.548217 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:14:34.548937 [info ] [Dummy-1   ]: 
[0m16:14:34.549789 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:14:34.550387 [info ] [Dummy-1   ]: 
[0m16:14:34.550932 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:14:34.552898 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.969219, "process_in_blocks": "0", "process_kernel_time": 1.33, "process_mem_max_rss": "432296", "process_out_blocks": "0", "process_user_time": 6.15}
[0m16:14:34.553607 [debug] [Dummy-1   ]: Command `cli run` failed at 16:14:34.553328 after 9.97 seconds
[0m16:14:34.554231 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:15:37.430306 | 057505c4-6d24-4afb-8f68-7dd2bff28881 ==============================
[0m16:15:37.430306 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:15:37.431528 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:15:37.828337 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:15:38.563177 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:15:38.983295 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:38.984017 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:39.197474 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:15:39.200558 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:15:39.250469 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:15:39.254949 [info ] [Dummy-1   ]: 
[0m16:15:39.255694 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:15:39.256280 [info ] [Dummy-1   ]: 
[0m16:15:39.257320 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:15:39.266093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:15:39.429985 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:15:39.430695 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:15:39.431227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:40.424004 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.993 seconds
[0m16:15:40.430999 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:15:40.431765 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:15:40.556558 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.124 seconds
[0m16:15:40.559659 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:15:40.560307 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:15:40.648800 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m16:15:40.651507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:15:40.665399 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:15:40.666074 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:15:40.666591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:41.467423 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.801 seconds
[0m16:15:41.470221 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:15:41.470938 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:15:41.608673 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.137 seconds
[0m16:15:41.611130 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:15:41.611770 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:15:41.688287 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.076 seconds
[0m16:15:41.697410 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:15:41.698319 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m16:15:41.699126 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:15:41.717578 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:15:41.718692 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:15:41.719858 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:15:41.721186 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:15:41.722230 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:15:41.723001 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:15:41.736956 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:15:41.738015 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:15:41.739248 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:15:41.740585 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:15:41.741752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:15:41.742429 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:15:41.756186 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:15:41.757222 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:15:41.758478 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:15:41.759787 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:15:41.760960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:15:41.761615 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:15:41.786354 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:15:41.787339 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:15:41.788661 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:15:41.790013 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:15:41.790995 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:15:41.791629 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:15:41.806657 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:15:41.807638 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:15:41.808868 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:15:41.810163 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:15:41.811055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:15:41.811668 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:15:41.824801 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:15:41.825775 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:15:41.826831 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:15:41.827950 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:15:41.828999 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:15:41.829790 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:15:41.844188 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:15:41.845177 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:15:41.846238 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:15:41.847327 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:15:41.848208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:15:41.848924 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:15:41.862058 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:15:41.862995 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:15:41.864038 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:15:41.865156 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:15:41.865992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:15:41.866606 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:15:41.881271 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:15:41.882233 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:15:41.883284 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:15:41.884431 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:15:41.885284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:15:41.885886 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:15:41.898987 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:15:41.899901 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:15:41.900961 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:15:41.902029 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:15:41.902809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:15:41.903408 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:15:41.916347 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:15:41.917308 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:15:41.918425 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:15:41.919549 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:15:41.920367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:15:41.921119 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:15:41.935632 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:15:41.936592 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:15:41.937672 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:15:41.938857 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:15:41.939682 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:15:41.940255 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:15:41.953378 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:15:41.954433 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:15:41.955502 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:15:41.956677 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:15:41.957598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:15:41.958249 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:15:41.976068 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:15:41.977156 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:15:41.978259 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:15:41.979610 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:15:41.980585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:15:41.981247 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:15:41.993436 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:15:41.994429 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:15:41.995502 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:15:41.996690 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:15:41.997590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:15:41.998241 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:15:42.039060 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:15:42.040237 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:15:42.041479 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:15:42.042728 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:15:42.043665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:15:42.044429 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:15:42.057633 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:15:42.058688 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:15:42.059809 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:15:42.062082 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:15:42.063133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:15:42.063807 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:15:42.077958 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:15:42.079094 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:15:42.080234 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:15:42.081518 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:15:42.082399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:15:42.083090 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:15:42.095190 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:15:42.096333 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:15:42.097635 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:15:42.099007 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:15:42.100288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:15:42.100991 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:15:42.113925 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:15:42.114870 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:15:42.116033 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:15:42.117332 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:15:42.118308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:15:42.119214 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:15:42.280963 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:15:42.282156 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:15:42.283281 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:15:42.284589 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:15:42.285509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:15:42.286160 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:15:42.298173 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:15:42.299376 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:15:42.300466 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:15:42.301892 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:15:42.302795 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:15:42.303457 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:15:42.317752 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:15:42.318789 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:15:42.319847 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:15:42.321065 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:15:42.321952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:15:42.322606 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:15:42.334490 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:15:42.335401 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:15:42.336407 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:15:42.337671 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:15:42.338624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:15:42.339271 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:15:42.362965 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:15:42.363944 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:15:42.365056 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:15:42.366236 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:15:42.367089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:15:42.367683 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:15:42.382070 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:15:42.383088 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:15:42.384150 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:15:42.385363 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:15:42.386254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:15:42.386872 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:15:42.399786 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:15:42.400747 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:15:42.401794 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:15:42.402944 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:15:42.403786 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:15:42.404415 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:15:42.419680 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:15:42.420744 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:15:42.421846 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:15:42.423051 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:15:42.423898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:15:42.424497 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:15:42.437346 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:15:42.438300 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:15:42.439491 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:15:42.440643 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:15:42.441517 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:15:42.442158 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:15:42.457050 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:15:42.458074 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:15:42.459278 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:15:42.460541 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:15:42.461433 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:15:42.462035 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:15:42.475023 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:15:42.476075 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:15:42.477221 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:15:42.479239 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:15:42.480240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:15:42.481001 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:15:42.495956 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:15:42.497049 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:15:42.498185 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:15:42.519408 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:15:42.520075 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:15:42.525884 [debug] [Dummy-1   ]: Command end result
[0m16:15:42.570979 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:15:42.573906 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:15:42.585346 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:15:42.587544 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.259111, "process_in_blocks": "0", "process_kernel_time": 1.55, "process_mem_max_rss": "441300", "process_out_blocks": "0", "process_user_time": 6.37}
[0m16:15:42.588433 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:15:42.588065 after 5.26 seconds
[0m16:15:42.589173 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:17:05.915092 | 2deb9cf0-b555-4b83-ac39-9c18048dd9b8 ==============================
[0m16:17:05.915092 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:17:05.916479 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:17:06.335970 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:17:07.108994 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:17:07.547596 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:17:07.548306 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:17:07.769809 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:17:07.773205 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:17:07.835071 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:17:07.838954 [info ] [Dummy-1   ]: 
[0m16:17:07.839701 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:17:07.840254 [info ] [Dummy-1   ]: 
[0m16:17:07.841250 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:17:07.849327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:17:08.007268 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:17:08.007989 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:17:08.008911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:08.953220 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.944 seconds
[0m16:17:08.958706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m16:17:08.984498 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:17:08.985243 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:17:08.985810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:09.934713 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.949 seconds
[0m16:17:09.941106 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:17:09.941791 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:17:10.096728 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.154 seconds
[0m16:17:10.099876 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:17:10.100542 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:17:10.239885 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.139 seconds
[0m16:17:10.242640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:17:10.255497 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:17:10.256202 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:17:10.256722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:11.321608 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.065 seconds
[0m16:17:11.324355 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:17:11.325008 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:17:11.453885 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.128 seconds
[0m16:17:11.456559 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:17:11.457207 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:17:11.592911 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.135 seconds
[0m16:17:11.600670 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:17:11.601722 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:17:11.603139 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:17:11.603880 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:17:11.623865 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:17:11.624885 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:17:11.686341 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:17:11.688370 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:17:11.689311 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:17:11.690048 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:17:13.080976 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.391 seconds
[0m16:17:13.119527 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.51s]
[0m16:17:13.120636 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:17:13.122785 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:17:13.124093 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:17:13.124952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:17:13.125597 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:17:13.168011 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:17:13.169198 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:17:13.213858 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:17:13.216959 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:17:13.218176 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(relative_path: str):
    asset_path = dbt.config.get("asset_path")
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{dbt.config.get("docs_stage_path")}/qa'), F.col('relative_path')),
            get_response_format(F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:17:13.219311 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:17:17.516298 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d31-0206-cee1-0032-318704d765da
[0m16:17:17.517179 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
    df = model(dbt, session)
  File "_udf_code.py", line 39, in model
    get_response_format(F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    asset_path = dbt.config.get("asset_path")
NameError: name 'dbt' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:17:17.523217 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:17:17.525019 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.40s]
[0m16:17:17.526150 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:17:17.527758 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:17:17.531064 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:17:17.531682 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:17:17.532244 [info ] [Dummy-1   ]: 
[0m16:17:17.532801 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.69 seconds (9.69s).
[0m16:17:17.534074 [debug] [Dummy-1   ]: Command end result
[0m16:17:17.581099 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:17:17.584198 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:17:17.593027 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:17:17.593654 [info ] [Dummy-1   ]: 
[0m16:17:17.594430 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:17:17.594994 [info ] [Dummy-1   ]: 
[0m16:17:17.595830 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:17:17.596410 [info ] [Dummy-1   ]: 
[0m16:17:17.596953 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:17:17.599077 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.791387, "process_in_blocks": "0", "process_kernel_time": 1.4, "process_mem_max_rss": "433864", "process_out_blocks": "0", "process_user_time": 6.35}
[0m16:17:17.599874 [debug] [Dummy-1   ]: Command `cli run` failed at 16:17:17.599576 after 11.79 seconds
[0m16:17:17.600523 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:18:43.111063 | ccb497da-c85c-4b3a-8fa5-caafb61f9607 ==============================
[0m16:18:43.111063 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:18:43.112234 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:18:43.510231 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:18:44.285735 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:18:44.703261 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:18:44.703988 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:18:44.918244 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:18:44.921360 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:18:44.983017 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:18:44.986758 [info ] [Dummy-1   ]: 
[0m16:18:44.987473 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:18:44.988053 [info ] [Dummy-1   ]: 
[0m16:18:44.989046 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:18:44.996539 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:18:45.141391 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:18:45.142149 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:18:45.142720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:46.278949 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.136 seconds
[0m16:18:46.284278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m16:18:46.308790 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:18:46.309670 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:18:46.310244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:47.538042 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.228 seconds
[0m16:18:47.544195 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:18:47.544930 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:18:47.765673 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.220 seconds
[0m16:18:47.768223 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:18:47.769049 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:18:47.941596 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.172 seconds
[0m16:18:47.944174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:18:47.955077 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:18:47.955726 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:18:47.956223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:49.114007 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.158 seconds
[0m16:18:49.116607 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:18:49.117230 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:18:49.290045 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.172 seconds
[0m16:18:49.292847 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:18:49.293453 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:18:49.435037 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.141 seconds
[0m16:18:49.444549 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:18:49.445519 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:18:49.446347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m16:18:49.447416 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:18:49.466753 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:18:49.467768 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:18:49.529929 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:18:49.531970 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:18:49.532721 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:18:49.533363 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:18:50.949870 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.416 seconds
[0m16:18:50.986451 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.54s]
[0m16:18:50.987520 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:18:50.989697 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:18:50.990864 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:18:50.991683 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:18:50.992300 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:18:51.033163 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:18:51.034210 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:18:51.077930 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:18:51.081021 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:18:51.082202 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(relative_path: str):
    asset_path = dbt.config.get("asset_path")
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{dbt.config.get("docs_stage_path")}/qa'), F.col('relative_path')),
            get_response_format(F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:18:51.083130 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:18:54.634511 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d32-0206-e114-0032-318704d56f26
[0m16:18:54.635287 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
    df = model(dbt, session)
  File "_udf_code.py", line 39, in model
    get_response_format(F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    asset_path = dbt.config.get("asset_path")
NameError: name 'dbt' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:18:54.641006 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:18:54.642586 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.65s]
[0m16:18:54.643614 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:18:54.645099 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:18:54.648059 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:18:54.648735 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:18:54.649358 [info ] [Dummy-1   ]: 
[0m16:18:54.649967 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.66 seconds (9.66s).
[0m16:18:54.651255 [debug] [Dummy-1   ]: Command end result
[0m16:18:54.696381 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:18:54.699347 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:18:54.707670 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:18:54.708273 [info ] [Dummy-1   ]: 
[0m16:18:54.709059 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:18:54.709618 [info ] [Dummy-1   ]: 
[0m16:18:54.710495 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:18:54.711061 [info ] [Dummy-1   ]: 
[0m16:18:54.711599 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:18:54.713526 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.704956, "process_in_blocks": "0", "process_kernel_time": 1.15, "process_mem_max_rss": "436256", "process_out_blocks": "0", "process_user_time": 6.13}
[0m16:18:54.714290 [debug] [Dummy-1   ]: Command `cli run` failed at 16:18:54.713996 after 11.71 seconds
[0m16:18:54.714886 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:31:15.671690 | 2b75aeaa-8bce-4508-a768-1fc0e320338a ==============================
[0m16:31:15.671690 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:31:15.672868 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:31:16.065794 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:31:16.860298 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:31:17.283493 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:17.284208 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:17.497812 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:31:17.500997 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:31:17.562443 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:31:17.566144 [info ] [Dummy-1   ]: 
[0m16:31:17.566783 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:31:17.567315 [info ] [Dummy-1   ]: 
[0m16:31:17.568289 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:31:17.575977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:31:17.724822 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:31:17.725565 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:31:17.726138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:18.673208 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.947 seconds
[0m16:31:18.680453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m16:31:18.704534 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:31:18.705210 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:31:18.705819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:20.226470 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.520 seconds
[0m16:31:20.232586 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:31:20.233262 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:31:20.370174 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.136 seconds
[0m16:31:20.373171 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:31:20.373843 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:31:20.495896 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m16:31:20.498679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:31:20.511265 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:31:20.511966 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:31:20.512558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:21.416123 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.903 seconds
[0m16:31:21.418733 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:31:21.419404 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:31:22.313654 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.893 seconds
[0m16:31:22.316181 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:31:22.316790 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:31:22.453559 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m16:31:22.461307 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:31:22.462350 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:31:22.463715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:31:22.464414 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:31:22.483912 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:31:22.484919 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:31:22.545950 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:31:22.547971 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:31:22.548836 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:31:22.549516 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:31:23.845434 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.296 seconds
[0m16:31:23.882132 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.42s]
[0m16:31:23.883199 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:31:23.885300 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:31:23.886455 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:31:23.887264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:31:23.887900 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:31:23.928864 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:31:23.929882 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:31:23.973310 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:31:23.976347 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:31:23.977554 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(relative_path: str):
    asset_path = dbt.config.get("asset_path")
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{dbt.config.get("docs_stage_path")}/qa'), F.col('relative_path')),
            get_response_format(F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:31:23.978586 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:31:29.323705 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d3f-0206-e1f0-0032-318704d6ec1e
[0m16:31:29.324526 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
    df = model(dbt, session)
  File "_udf_code.py", line 39, in model
    get_response_format(F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    asset_path = dbt.config.get("asset_path")
NameError: name 'dbt' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:31:29.330376 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:31:29.332075 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 5.44s]
[0m16:31:29.333156 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:31:29.334706 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:31:29.337885 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:31:29.338567 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:31:29.339160 [info ] [Dummy-1   ]: 
[0m16:31:29.339728 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 11.77 seconds (11.77s).
[0m16:31:29.340987 [debug] [Dummy-1   ]: Command end result
[0m16:31:29.386561 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:31:29.389578 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:31:29.398001 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:31:29.398679 [info ] [Dummy-1   ]: 
[0m16:31:29.399380 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:31:29.399958 [info ] [Dummy-1   ]: 
[0m16:31:29.400770 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:31:29.401324 [info ] [Dummy-1   ]: 
[0m16:31:29.401851 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:31:29.403776 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.835051, "process_in_blocks": "0", "process_kernel_time": 1.31, "process_mem_max_rss": "433796", "process_out_blocks": "0", "process_user_time": 6.2}
[0m16:31:29.404509 [debug] [Dummy-1   ]: Command `cli run` failed at 16:31:29.404237 after 13.84 seconds
[0m16:31:29.405114 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:35:03.161476 | 306dfbeb-b32e-4211-aef7-32c903dfe3d5 ==============================
[0m16:35:03.161476 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:35:03.162612 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:35:03.542654 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:35:04.289496 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:35:04.694355 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:35:04.695638 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m16:35:05.350940 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:35:05.353788 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:35:05.401234 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:35:05.405594 [info ] [Dummy-1   ]: 
[0m16:35:05.406256 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:35:05.406723 [info ] [Dummy-1   ]: 
[0m16:35:05.428922 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:35:05.437502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:35:05.567977 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:35:05.568846 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:35:05.569374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:06.394774 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.825 seconds
[0m16:35:06.400777 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:35:06.401433 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:35:06.553901 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.152 seconds
[0m16:35:06.557437 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:35:06.558114 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:35:06.676286 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.117 seconds
[0m16:35:06.679101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:35:06.691441 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:35:06.692097 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:35:06.692602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:07.483077 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.790 seconds
[0m16:35:07.485593 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:35:07.486226 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:35:07.606836 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.120 seconds
[0m16:35:07.609313 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:35:07.609932 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:35:07.756381 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.146 seconds
[0m16:35:07.783295 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:35:07.784159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m16:35:07.784916 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:35:07.804923 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:35:07.806029 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:35:07.807142 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:35:07.808457 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:35:07.809380 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:35:07.810091 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:35:07.822111 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:35:07.823213 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:35:07.824336 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:35:07.825517 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:35:07.826608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:35:07.827265 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:35:07.840810 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:35:07.841827 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:35:07.842912 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:35:07.844103 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:35:07.845225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:35:07.845962 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:35:07.870960 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:35:07.872153 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:35:07.873343 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:35:07.874552 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:35:07.875455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:35:07.876207 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:35:07.889424 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:35:07.890404 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:35:07.891448 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:35:07.892616 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:35:07.893452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:35:07.894131 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:35:07.908571 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:35:07.909493 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:35:07.910536 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:35:07.911610 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:35:07.912449 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:35:07.913126 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:35:07.925834 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:35:07.926875 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:35:07.927894 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:35:07.929046 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:35:07.929918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:35:07.930503 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:35:07.944364 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:35:07.945456 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:35:07.946515 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:35:07.947574 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:35:07.948430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:35:07.949094 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:35:07.961606 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:35:07.962505 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:35:07.963507 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:35:07.964543 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:35:07.965324 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:35:07.965970 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:35:07.980307 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:35:07.981347 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:35:07.982460 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:35:07.983590 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:35:07.984443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:35:07.985069 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:35:08.134322 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:35:08.135264 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:35:08.136296 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:35:08.137359 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:35:08.138252 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:35:08.139004 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:35:08.151602 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:35:08.152559 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:35:08.153584 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:35:08.154907 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:35:08.155686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:35:08.156256 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:35:08.170570 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:35:08.171530 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:35:08.172556 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:35:08.173634 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:35:08.174462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:35:08.175075 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:35:08.190607 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:35:08.191525 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:35:08.192518 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:35:08.193612 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:35:08.194465 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:35:08.195096 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:35:08.209145 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:35:08.210199 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:35:08.211260 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:35:08.212377 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:35:08.213277 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:35:08.213942 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:35:08.251380 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:35:08.252342 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:35:08.253347 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:35:08.254513 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:35:08.255265 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:35:08.255828 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:35:08.270199 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:35:08.271150 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:35:08.272168 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:35:08.274061 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:35:08.274907 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:35:08.275513 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:35:08.287405 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:35:08.288317 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:35:08.289470 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:35:08.290832 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:35:08.291619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:35:08.292217 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:35:08.303448 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:35:08.304298 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:35:08.305260 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:35:08.306389 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:35:08.307478 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:35:08.308048 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:35:08.322586 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:35:08.323529 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:35:08.324548 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:35:08.325634 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:35:08.326417 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:35:08.326971 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:35:08.339353 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:35:08.340269 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:35:08.341256 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:35:08.342384 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:35:08.343159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:35:08.343739 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:35:08.357124 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:35:08.358106 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:35:08.359177 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:35:08.360302 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:35:08.361183 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:35:08.361892 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:35:08.374246 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:35:08.375204 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:35:08.376211 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:35:08.377331 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:35:08.378198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:35:08.378937 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:35:08.397985 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:35:08.399331 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:35:08.400744 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:35:08.402327 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:35:08.403165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:35:08.404119 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:35:08.427133 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:35:08.428065 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:35:08.429194 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:35:08.430346 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:35:08.431144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:35:08.431739 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:35:08.445937 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:35:08.446852 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:35:08.447857 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:35:08.449099 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:35:08.449976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:35:08.450622 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:35:08.465113 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:35:08.466031 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:35:08.467040 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:35:08.468127 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:35:08.468950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:35:08.469607 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:35:08.482170 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:35:08.483042 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:35:08.484031 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:35:08.485146 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:35:08.485929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:35:08.486498 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:35:08.500429 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:35:08.501307 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:35:08.502320 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:35:08.503421 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:35:08.504176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:35:08.504734 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:35:08.517065 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:35:08.517957 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:35:08.519026 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:35:08.520116 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:35:08.520881 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:35:08.521448 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:35:08.535271 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:35:08.536158 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:35:08.537149 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:35:08.538288 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:35:08.539114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:35:08.539683 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:35:08.551942 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:35:08.552825 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:35:08.553946 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:35:08.556381 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:35:08.556913 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:35:08.562694 [debug] [Dummy-1   ]: Command end result
[0m16:35:08.605884 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:35:08.608601 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:35:08.619418 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:35:08.621517 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.5589714, "process_in_blocks": "0", "process_kernel_time": 1.52, "process_mem_max_rss": "439332", "process_out_blocks": "0", "process_user_time": 6.41}
[0m16:35:08.622253 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:35:08.621968 after 5.56 seconds
[0m16:35:08.622809 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:37:54.206667 | 9f732453-44e6-4ef8-895c-8d3beb9df4b4 ==============================
[0m16:37:54.206667 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:37:54.207756 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m16:37:54.580265 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:37:55.398486 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:37:55.803908 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:55.804591 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:56.010141 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:37:56.012781 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:37:56.069968 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:37:56.073346 [info ] [Dummy-1   ]: 
[0m16:37:56.073948 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:37:56.074432 [info ] [Dummy-1   ]: 
[0m16:37:56.075266 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:37:56.082292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:37:56.234806 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:37:56.235521 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:37:56.236082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:57.033019 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.797 seconds
[0m16:37:57.038323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:37:57.061596 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:37:57.062260 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:37:57.062747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:57.742140 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.679 seconds
[0m16:37:57.747934 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:37:57.748655 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:37:57.898068 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.149 seconds
[0m16:37:57.900833 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:37:57.901409 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:37:57.969329 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.067 seconds
[0m16:37:57.971903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:37:57.984081 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:37:57.984670 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:37:57.985150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:58.809681 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.824 seconds
[0m16:37:58.812183 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:37:58.812761 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:37:58.911616 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.098 seconds
[0m16:37:58.914111 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:37:58.914764 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:37:59.081574 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.166 seconds
[0m16:37:59.088687 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:37:59.089615 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:37:59.090819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:37:59.091447 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:37:59.110337 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:37:59.111255 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:37:59.168747 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:37:59.170644 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:37:59.171378 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:37:59.172005 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:38:00.111022 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.939 seconds
[0m16:38:00.145180 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.05s]
[0m16:38:00.146195 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:38:00.148147 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:38:00.149276 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:38:00.150051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:38:00.150633 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:38:00.188925 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:38:00.189919 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:38:00.231664 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:38:00.234609 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:38:00.235732 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset_path")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:38:00.236670 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:38:04.319154 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d46-0206-cee1-0032-318704d76882
[0m16:38:04.319938 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:38:04.325537 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/{relative_path}.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:38:04.326994 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.18s]
[0m16:38:04.327964 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:38:04.329473 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/{relative_path}.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:38:04.332394 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:38:04.332926 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m16:38:04.333404 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:38:04.333941 [info ] [Dummy-1   ]: 
[0m16:38:04.334467 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m16:38:04.335615 [debug] [Dummy-1   ]: Command end result
[0m16:38:04.378931 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:38:04.381506 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:38:04.389557 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:38:04.390140 [info ] [Dummy-1   ]: 
[0m16:38:04.390812 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:38:04.391321 [info ] [Dummy-1   ]: 
[0m16:38:04.392107 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/{relative_path}.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:38:04.392662 [info ] [Dummy-1   ]: 
[0m16:38:04.393188 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:38:04.395029 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.284812, "process_in_blocks": "0", "process_kernel_time": 1.26, "process_mem_max_rss": "440532", "process_out_blocks": "0", "process_user_time": 5.83}
[0m16:38:04.395709 [debug] [Dummy-1   ]: Command `cli run` failed at 16:38:04.395437 after 10.29 seconds
[0m16:38:04.396268 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:38:32.967290 | 08147b36-340d-4bb4-a233-72426d5001f0 ==============================
[0m16:38:32.967290 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:38:32.968459 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:38:33.341622 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:38:34.173223 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:38:34.571357 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:34.572491 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m16:38:35.213945 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:38:35.216870 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:38:35.263166 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:38:35.267458 [info ] [Dummy-1   ]: 
[0m16:38:35.268140 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:38:35.268774 [info ] [Dummy-1   ]: 
[0m16:38:35.298888 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:38:35.307611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:38:35.480826 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:38:35.481723 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:38:35.482382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:36.257303 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.775 seconds
[0m16:38:36.263299 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:38:36.263994 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:38:36.368447 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.104 seconds
[0m16:38:36.371937 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:38:36.372508 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:38:36.501837 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.129 seconds
[0m16:38:36.504502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:38:36.516717 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:38:36.517324 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:38:36.517826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:37.189188 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.671 seconds
[0m16:38:37.191679 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:38:37.192294 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:38:37.264345 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.071 seconds
[0m16:38:37.266716 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:38:37.267328 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:38:37.381516 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m16:38:37.389370 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:38:37.390814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m16:38:37.391391 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:38:37.411132 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:38:37.412147 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:38:37.413242 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:38:37.414460 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:38:37.415329 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:38:37.415935 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:38:37.428067 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:38:37.429235 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:38:37.430367 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:38:37.431763 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:38:37.432936 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:38:37.433557 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:38:37.447106 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:38:37.448020 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:38:37.449216 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:38:37.450465 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:38:37.451587 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:38:37.452231 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:38:37.476701 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:38:37.477794 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:38:37.479039 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:38:37.480296 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:38:37.481170 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:38:37.481863 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:38:37.494987 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:38:37.495931 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:38:37.496969 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:38:37.498144 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:38:37.499091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:38:37.499699 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:38:37.513908 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:38:37.514906 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:38:37.515956 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:38:37.517050 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:38:37.517863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:38:37.518600 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:38:37.531402 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:38:37.532404 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:38:37.533528 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:38:37.534620 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:38:37.535434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:38:37.536026 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:38:37.550411 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:38:37.551370 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:38:37.552412 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:38:37.553466 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:38:37.554301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:38:37.554948 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:38:37.567733 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:38:37.568758 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:38:37.569840 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:38:37.570934 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:38:37.571733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:38:37.572357 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:38:37.586483 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:38:37.587547 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:38:37.588652 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:38:37.589710 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:38:37.590509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:38:37.591119 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:38:37.740387 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:38:37.741313 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:38:37.742363 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:38:37.743417 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:38:37.744201 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:38:37.744784 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:38:37.757186 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:38:37.758248 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:38:37.759380 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:38:37.760671 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:38:37.761447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:38:37.762059 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:38:37.776048 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:38:37.776977 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:38:37.778004 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:38:37.779132 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:38:37.779924 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:38:37.780546 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:38:37.795413 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:38:37.796337 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:38:37.797367 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:38:37.798552 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:38:37.799339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:38:37.799929 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:38:37.813383 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:38:37.814271 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:38:37.815272 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:38:37.816490 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:38:37.817310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:38:37.817908 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:38:37.854975 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:38:37.855993 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:38:37.856984 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:38:37.858118 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:38:37.859003 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:38:37.859637 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:38:37.874155 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:38:37.875075 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:38:37.876056 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:38:37.877985 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:38:37.878951 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:38:37.879553 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:38:37.891462 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:38:37.892297 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:38:37.893275 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:38:37.894634 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:38:37.895451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:38:37.896025 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:38:37.907378 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:38:37.908237 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:38:37.909323 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:38:37.910490 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:38:37.911624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:38:37.912226 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:38:37.926562 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:38:37.927425 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:38:37.928523 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:38:37.929664 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:38:37.930455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:38:37.931019 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:38:37.943297 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:38:37.944146 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:38:37.945108 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:38:37.946194 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:38:37.946923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:38:37.947478 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:38:37.960674 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:38:37.961551 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:38:37.962563 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:38:37.963685 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:38:37.964460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:38:37.965019 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:38:37.976913 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:38:37.977734 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:38:37.978800 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:38:37.979898 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:38:37.980651 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:38:37.981206 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:38:37.993974 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:38:37.994806 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:38:37.995763 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:38:37.996806 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:38:37.997566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:38:37.998162 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:38:38.017950 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:38:38.018856 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:38:38.019838 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:38:38.020891 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:38:38.021631 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:38:38.022222 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:38:38.035677 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:38:38.036516 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:38:38.037478 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:38:38.038596 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:38:38.039353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:38:38.039909 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:38:38.053657 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:38:38.054496 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:38:38.055445 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:38:38.056475 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:38:38.057222 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:38:38.057798 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:38:38.069693 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:38:38.070640 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:38:38.071661 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:38:38.072719 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:38:38.073447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:38:38.074055 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:38:38.087952 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:38:38.088862 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:38:38.089856 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:38:38.090928 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:38:38.091646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:38:38.092199 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:38:38.104067 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:38:38.104878 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:38:38.105848 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:38:38.106891 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:38:38.107652 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:38:38.108210 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:38:38.121665 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:38:38.122589 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:38:38.123560 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:38:38.124618 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:38:38.125364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:38:38.125948 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:38:38.137945 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:38:38.138866 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:38:38.139820 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:38:38.142276 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:38:38.142796 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:38:38.148551 [debug] [Dummy-1   ]: Command end result
[0m16:38:38.191670 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:38:38.194376 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:38:38.205211 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:38:38.207224 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.336615, "process_in_blocks": "0", "process_kernel_time": 1.26, "process_mem_max_rss": "437376", "process_out_blocks": "0", "process_user_time": 6.72}
[0m16:38:38.207934 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:38:38.207655 after 5.34 seconds
[0m16:38:38.208568 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:39:42.845902 | ba611349-42e0-4e19-8aa9-2940e1b975be ==============================
[0m16:39:42.845902 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:39:42.847006 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:39:43.227298 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:39:44.040980 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:39:44.451296 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:44.451961 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:44.658275 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:39:44.661258 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:39:44.719291 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:39:44.722713 [info ] [Dummy-1   ]: 
[0m16:39:44.723317 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:39:44.723798 [info ] [Dummy-1   ]: 
[0m16:39:44.724636 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:39:44.731842 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:39:44.904395 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:39:44.905105 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:39:44.905707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:45.711875 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.806 seconds
[0m16:39:45.717062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:39:45.740777 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:39:45.741495 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:39:45.742047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:46.571881 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.830 seconds
[0m16:39:46.577744 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:39:46.578433 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:39:46.704699 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.126 seconds
[0m16:39:46.707532 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:39:46.708140 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:39:46.837811 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.129 seconds
[0m16:39:46.840450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:39:46.852892 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:39:46.853516 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:39:46.854069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:47.817152 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.963 seconds
[0m16:39:47.819892 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:39:47.820503 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:39:47.935852 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.115 seconds
[0m16:39:47.938406 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:39:47.939065 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:39:48.025510 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.086 seconds
[0m16:39:48.032698 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:39:48.033699 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:39:48.035016 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:39:48.035677 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:39:48.054877 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:39:48.055854 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:39:48.116770 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:39:48.118796 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:39:48.119538 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:39:48.120146 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:39:49.041294 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.921 seconds
[0m16:39:49.076401 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.04s]
[0m16:39:49.077432 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:39:49.079450 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:39:49.080582 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:39:49.081416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:39:49.082042 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:39:49.121615 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:39:49.122639 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:39:49.165509 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:39:49.168588 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:39:49.169787 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset-paths")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset-paths': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:39:49.170723 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:39:52.519272 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d47-0206-cee1-0032-318704d76972
[0m16:39:52.520100 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:39:52.525736 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/{relative_path}.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:39:52.527257 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.45s]
[0m16:39:52.528252 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:39:52.529784 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/{relative_path}.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:39:52.532680 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:39:52.533218 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m16:39:52.533674 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:39:52.534226 [info ] [Dummy-1   ]: 
[0m16:39:52.534751 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.81 seconds (7.81s).
[0m16:39:52.535922 [debug] [Dummy-1   ]: Command end result
[0m16:39:52.580468 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:39:52.583244 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:39:52.591424 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:39:52.591996 [info ] [Dummy-1   ]: 
[0m16:39:52.592646 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:39:52.593156 [info ] [Dummy-1   ]: 
[0m16:39:52.593974 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/{relative_path}.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:39:52.594543 [info ] [Dummy-1   ]: 
[0m16:39:52.595069 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:39:52.596914 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.848986, "process_in_blocks": "0", "process_kernel_time": 1.5, "process_mem_max_rss": "439540", "process_out_blocks": "0", "process_user_time": 5.62}
[0m16:39:52.597603 [debug] [Dummy-1   ]: Command `cli run` failed at 16:39:52.597335 after 9.85 seconds
[0m16:39:52.598183 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:40:49.415437 | a6cabb14-f975-4a8a-bd2f-79fedf4e4b4f ==============================
[0m16:40:49.415437 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:40:49.416696 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:40:49.798954 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:40:50.590894 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:40:51.008029 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:40:51.009226 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m16:40:51.661458 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:40:51.664273 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:40:51.711295 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:40:51.715654 [info ] [Dummy-1   ]: 
[0m16:40:51.716305 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:40:51.716831 [info ] [Dummy-1   ]: 
[0m16:40:51.717796 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:40:51.726526 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m16:40:51.883675 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:40:51.884392 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:40:51.884925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:52.799775 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.915 seconds
[0m16:40:52.805655 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:40:52.806267 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:40:52.895935 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.089 seconds
[0m16:40:52.899417 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:40:52.900128 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:40:52.999098 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m16:40:53.001557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:40:53.012263 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:40:53.013030 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:40:53.013591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:53.719608 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.706 seconds
[0m16:40:53.722126 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:40:53.722714 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:40:53.852334 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.129 seconds
[0m16:40:53.855082 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:40:53.855737 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:40:53.953677 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.097 seconds
[0m16:40:53.994245 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:40:53.995102 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m16:40:53.995708 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:40:54.019484 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:40:54.020732 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:40:54.021982 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:40:54.023302 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:40:54.024247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:40:54.024905 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:40:54.037214 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:40:54.038223 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:40:54.039407 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:40:54.040667 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:40:54.041817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:40:54.042437 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:40:54.056550 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:40:54.057591 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:40:54.058928 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:40:54.060218 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:40:54.061397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:40:54.062050 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:40:54.087607 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:40:54.088712 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:40:54.089836 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:40:54.091062 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:40:54.091929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:40:54.092521 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:40:54.105679 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:40:54.106761 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:40:54.107901 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:40:54.109246 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:40:54.110122 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:40:54.110746 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:40:54.125157 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:40:54.126095 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:40:54.127143 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:40:54.128314 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:40:54.129355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:40:54.129982 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:40:54.142797 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:40:54.143756 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:40:54.144803 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:40:54.145864 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:40:54.146696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:40:54.147276 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:40:54.161434 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:40:54.163398 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:40:54.164524 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:40:54.165588 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:40:54.166361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:40:54.166929 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:40:54.180025 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:40:54.181059 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:40:54.182121 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:40:54.183229 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:40:54.184188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:40:54.184920 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:40:54.199223 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:40:54.200399 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:40:54.201418 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:40:54.202482 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:40:54.203308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:40:54.203911 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:40:54.354258 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:40:54.355186 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:40:54.356239 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:40:54.357316 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:40:54.358103 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:40:54.358764 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:40:54.371899 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:40:54.372832 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:40:54.373882 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:40:54.374964 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:40:54.375823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:40:54.376440 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:40:54.391060 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:40:54.392113 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:40:54.393160 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:40:54.394267 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:40:54.395081 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:40:54.395720 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:40:54.411696 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:40:54.412687 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:40:54.413740 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:40:54.414856 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:40:54.415673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:40:54.416245 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:40:54.430257 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:40:54.431212 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:40:54.432284 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:40:54.433480 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:40:54.434353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:40:54.434967 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:40:54.472965 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:40:54.473994 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:40:54.475049 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:40:54.476209 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:40:54.476996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:40:54.477618 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:40:54.492350 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:40:54.493297 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:40:54.494296 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:40:54.496101 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:40:54.497068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:40:54.497686 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:40:54.509977 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:40:54.510920 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:40:54.511960 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:40:54.513158 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:40:54.513948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:40:54.514518 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:40:54.526100 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:40:54.526988 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:40:54.528006 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:40:54.529217 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:40:54.530347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:40:54.530957 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:40:54.545972 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:40:54.546861 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:40:54.547888 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:40:54.549129 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:40:54.549991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:40:54.550611 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:40:54.563309 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:40:54.564254 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:40:54.565260 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:40:54.566412 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:40:54.567174 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:40:54.567844 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:40:54.581370 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:40:54.582381 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:40:54.583422 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:40:54.584561 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:40:54.585401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:40:54.586005 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:40:54.598451 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:40:54.599439 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:40:54.600492 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:40:54.601881 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:40:54.602700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:40:54.603273 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:40:54.616648 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:40:54.617519 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:40:54.618586 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:40:54.619761 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:40:54.620586 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:40:54.621178 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:40:54.641674 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:40:54.642600 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:40:54.643632 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:40:54.644772 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:40:54.645563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:40:54.646141 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:40:54.660452 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:40:54.661379 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:40:54.662382 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:40:54.663509 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:40:54.664282 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:40:54.667168 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:40:54.679848 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:40:54.680734 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:40:54.681723 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:40:54.682847 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:40:54.683677 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:40:54.684295 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:40:54.696976 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:40:54.697886 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:40:54.698955 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:40:54.700109 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:40:54.700904 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:40:54.701471 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:40:54.715994 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:40:54.716907 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:40:54.717908 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:40:54.719108 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:40:54.719920 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:40:54.720484 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:40:54.733107 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:40:54.733977 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:40:54.734949 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:40:54.736089 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:40:54.736840 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:40:54.737406 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:40:54.751862 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:40:54.752774 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:40:54.753772 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:40:54.754902 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:40:54.755705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:40:54.756278 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:40:54.768940 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:40:54.769841 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:40:54.770846 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:40:54.773349 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:40:54.773903 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:40:54.779786 [debug] [Dummy-1   ]: Command end result
[0m16:40:54.823710 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:40:54.826467 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:40:54.837401 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:40:54.839563 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.5233455, "process_in_blocks": "0", "process_kernel_time": 1.29, "process_mem_max_rss": "443724", "process_out_blocks": "0", "process_user_time": 6.74}
[0m16:40:54.840313 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:40:54.840029 after 5.52 seconds
[0m16:40:54.840883 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:41:32.572273 | 4cdd5100-1837-4c0c-b05d-2a2943f1a691 ==============================
[0m16:41:32.572273 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:41:32.573331 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:41:32.942414 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:41:33.680726 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:41:34.070076 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:34.070745 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:34.269826 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:41:34.272253 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:41:34.326813 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:41:34.330122 [info ] [Dummy-1   ]: 
[0m16:41:34.330800 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:41:34.331311 [info ] [Dummy-1   ]: 
[0m16:41:34.332197 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:41:34.339025 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:41:34.482429 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:41:34.483108 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:41:34.483646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:35.253046 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.769 seconds
[0m16:41:35.257941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m16:41:35.280691 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:41:35.281272 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:41:35.281775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:36.062740 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.781 seconds
[0m16:41:36.068602 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:41:36.069243 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:41:36.172904 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.103 seconds
[0m16:41:36.175354 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:41:36.175989 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:41:36.277578 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m16:41:36.280052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:41:36.290741 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:41:36.291397 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:41:36.291900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:37.108890 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.817 seconds
[0m16:41:37.111459 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:41:37.112106 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:41:37.228425 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.116 seconds
[0m16:41:37.231088 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:41:37.231666 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:41:37.421274 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.189 seconds
[0m16:41:37.430197 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:41:37.431104 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:41:37.431845 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m16:41:37.432858 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:41:37.451614 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:41:37.452524 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:41:37.510042 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:41:37.511912 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:41:37.512604 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:41:37.513225 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:41:38.532341 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.019 seconds
[0m16:41:38.566252 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.13s]
[0m16:41:38.567263 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:41:38.569214 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:41:38.570271 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:41:38.571039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:41:38.571639 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:41:38.609573 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:41:38.610551 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:41:38.651744 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:41:38.654658 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:41:38.655771 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'{asset_path}/global_inm_policy_schema.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset-paths")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset-paths': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:41:38.656694 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:41:41.892456 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d49-0206-cee1-0032-318704d76aea
[0m16:41:41.893231 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'{asset_path}/global_inm_policy_schema.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'None/global_inm_policy_schema.json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:41:41.898757 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:41:41.900196 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.33s]
[0m16:41:41.901175 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:41:41.902628 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:41:41.905438 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:41:41.905999 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:41:41.906521 [info ] [Dummy-1   ]: 
[0m16:41:41.907041 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m16:41:41.908218 [debug] [Dummy-1   ]: Command end result
[0m16:41:41.950244 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:41:41.952484 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:41:41.960194 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:41:41.960697 [info ] [Dummy-1   ]: 
[0m16:41:41.961331 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:41:41.961846 [info ] [Dummy-1   ]: 
[0m16:41:41.962646 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:41:41.963191 [info ] [Dummy-1   ]: 
[0m16:41:41.963707 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:41:41.965417 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.488312, "process_in_blocks": "0", "process_kernel_time": 1.36, "process_mem_max_rss": "445764", "process_out_blocks": "0", "process_user_time": 5.49}
[0m16:41:41.966114 [debug] [Dummy-1   ]: Command `cli run` failed at 16:41:41.965840 after 9.49 seconds
[0m16:41:41.966670 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:44:35.362108 | 68705cfa-344f-413a-ab4e-86ba07f5159b ==============================
[0m16:44:35.362108 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:44:35.363156 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m16:44:35.730385 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:44:36.514417 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:44:36.904045 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:44:36.905098 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m16:44:37.533666 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:44:37.536201 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:44:37.580112 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:44:37.584219 [info ] [Dummy-1   ]: 
[0m16:44:37.584890 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:44:37.585435 [info ] [Dummy-1   ]: 
[0m16:44:37.586391 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:44:37.594623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m16:44:37.740395 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:44:37.741040 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:44:37.741543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:38.627844 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.886 seconds
[0m16:44:38.633668 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:44:38.634307 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:44:38.752300 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.117 seconds
[0m16:44:38.755379 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:44:38.756015 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:44:38.857686 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m16:44:38.860002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:44:38.870146 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:44:38.870728 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:44:38.871259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:39.702144 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.831 seconds
[0m16:44:39.704667 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:44:39.705244 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:44:39.855417 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.150 seconds
[0m16:44:39.858089 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:44:39.858758 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:44:39.970959 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m16:44:39.993488 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:44:39.994270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m16:44:39.994881 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:44:40.014188 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:44:40.015040 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:44:40.016077 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:44:40.017186 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:44:40.017991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:44:40.018661 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:44:40.029664 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:44:40.030532 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:44:40.031496 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:44:40.032510 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:44:40.033476 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:44:40.034126 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:44:40.046751 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:44:40.047678 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:44:40.048767 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:44:40.049839 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:44:40.050883 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:44:40.051563 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:44:40.074747 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:44:40.075594 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:44:40.076569 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:44:40.077584 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:44:40.078425 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:44:40.079033 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:44:40.090713 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:44:40.091680 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:44:40.092675 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:44:40.093699 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:44:40.094529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:44:40.095158 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:44:40.108270 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:44:40.109204 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:44:40.110208 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:44:40.111183 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:44:40.111903 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:44:40.112469 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:44:40.124323 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:44:40.125129 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:44:40.126109 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:44:40.127070 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:44:40.127861 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:44:40.128501 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:44:40.141348 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:44:40.142127 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:44:40.143067 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:44:40.143999 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:44:40.144737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:44:40.145302 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:44:40.156955 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:44:40.157781 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:44:40.158802 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:44:40.159744 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:44:40.160441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:44:40.161006 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:44:40.173838 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:44:40.174625 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:44:40.175547 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:44:40.176452 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:44:40.177147 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:44:40.177705 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:44:40.307069 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:44:40.307986 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:44:40.309025 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:44:40.310034 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:44:40.310788 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:44:40.311354 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:44:40.323005 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:44:40.323784 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:44:40.324703 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:44:40.325617 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:44:40.326338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:44:40.326910 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:44:40.339673 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:44:40.340448 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:44:40.341376 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:44:40.342319 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:44:40.343017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:44:40.343682 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:44:40.358016 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:44:40.358876 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:44:40.359828 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:44:40.360783 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:44:40.361495 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:44:40.362079 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:44:40.374374 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:44:40.375159 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:44:40.376083 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:44:40.377050 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:44:40.377766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:44:40.378446 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:44:40.413674 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:44:40.414523 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:44:40.415487 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:44:40.416488 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:44:40.417216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:44:40.417791 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:44:40.431128 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:44:40.431918 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:44:40.432851 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:44:40.434527 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:44:40.435328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:44:40.435894 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:44:40.446986 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:44:40.447771 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:44:40.448773 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:44:40.449796 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:44:40.450554 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:44:40.451110 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:44:40.461789 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:44:40.462563 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:44:40.463479 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:44:40.464433 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:44:40.465409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:44:40.465988 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:44:40.479395 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:44:40.480188 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:44:40.481119 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:44:40.482129 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:44:40.482908 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:44:40.483497 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:44:40.494941 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:44:40.495720 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:44:40.496639 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:44:40.497590 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:44:40.498313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:44:40.498964 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:44:40.510944 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:44:40.511701 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:44:40.512619 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:44:40.513568 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:44:40.514293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:44:40.514850 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:44:40.526000 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:44:40.526763 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:44:40.527674 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:44:40.528818 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:44:40.529593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:44:40.530224 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:44:40.542289 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:44:40.543089 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:44:40.544028 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:44:40.545032 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:44:40.545762 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:44:40.546356 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:44:40.565484 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:44:40.566298 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:44:40.567260 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:44:40.568237 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:44:40.569040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:44:40.569626 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:44:40.582724 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:44:40.583523 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:44:40.584478 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:44:40.585448 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:44:40.586224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:44:40.588808 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:44:40.600461 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:44:40.601251 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:44:40.602209 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:44:40.603182 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:44:40.603920 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:44:40.604486 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:44:40.615850 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:44:40.616647 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:44:40.617579 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:44:40.618613 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:44:40.619401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:44:40.619986 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:44:40.632986 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:44:40.633768 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:44:40.634709 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:44:40.635648 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:44:40.636344 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:44:40.636905 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:44:40.648143 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:44:40.648993 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:44:40.649926 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:44:40.650875 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:44:40.651583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:44:40.652149 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:44:40.664944 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:44:40.665713 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:44:40.666681 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:44:40.667628 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:44:40.668331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:44:40.668982 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:44:40.680243 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:44:40.681031 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:44:40.681979 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:44:40.684017 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:44:40.684566 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:44:40.690266 [debug] [Dummy-1   ]: Command end result
[0m16:44:40.731097 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:44:40.733378 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:44:40.743655 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:44:40.745512 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.47893, "process_in_blocks": "0", "process_kernel_time": 1.27, "process_mem_max_rss": "439932", "process_out_blocks": "0", "process_user_time": 6.49}
[0m16:44:40.746229 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:44:40.745945 after 5.48 seconds
[0m16:44:40.746780 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:44:55.707135 | c8d29c98-8247-41e1-9f48-9abc13cb0237 ==============================
[0m16:44:55.707135 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:44:55.708346 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:44:56.101957 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:44:56.892340 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:44:57.319907 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:57.320600 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:57.532922 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:44:57.536068 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:44:57.596759 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:44:57.600499 [info ] [Dummy-1   ]: 
[0m16:44:57.601159 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:44:57.601653 [info ] [Dummy-1   ]: 
[0m16:44:57.602640 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:44:57.610055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:44:57.763000 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:44:57.763732 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:44:57.764306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:58.890313 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.126 seconds
[0m16:44:58.895477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m16:44:58.919887 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:44:58.920590 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:44:58.921149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:00.144870 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.224 seconds
[0m16:45:00.150828 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:45:00.151587 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:45:00.288221 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.136 seconds
[0m16:45:00.291013 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:45:00.291651 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:45:00.435733 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.143 seconds
[0m16:45:00.438172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:45:00.449156 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:45:00.449845 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:45:00.450358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:01.766595 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.316 seconds
[0m16:45:01.769454 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:45:01.770105 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:45:02.019824 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.249 seconds
[0m16:45:02.022636 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:45:02.023264 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:45:02.205702 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.182 seconds
[0m16:45:02.215151 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:45:02.216185 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:45:02.217007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m16:45:02.218073 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:45:02.237504 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:45:02.238609 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:45:02.300005 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:45:02.302036 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:45:02.302793 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:45:02.303441 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:45:03.863057 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.559 seconds
[0m16:45:03.899581 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.68s]
[0m16:45:03.900669 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:45:03.902738 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:45:03.903898 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:45:03.904716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:45:03.905317 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:45:03.946251 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:45:03.947314 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:45:03.991021 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:45:03.994089 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:45:03.995286 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'../../assets/global_inm_policy_schema.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset-paths")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset-paths': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:45:03.996286 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:45:07.833475 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d4d-0206-df66-0032-318704d7b586
[0m16:45:07.834335 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'../../assets/global_inm_policy_schema.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: '../../assets/global_inm_policy_schema.json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:45:07.840251 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'../../assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: '../../assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:45:07.841935 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.94s]
[0m16:45:07.842988 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:45:07.844542 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'../../assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: '../../assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:45:07.847642 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:45:07.848276 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m16:45:07.848884 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:45:07.849429 [info ] [Dummy-1   ]: 
[0m16:45:07.849973 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.25 seconds (10.25s).
[0m16:45:07.851196 [debug] [Dummy-1   ]: Command end result
[0m16:45:07.897320 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:45:07.900369 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:45:07.908864 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:45:07.909464 [info ] [Dummy-1   ]: 
[0m16:45:07.910144 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:45:07.910662 [info ] [Dummy-1   ]: 
[0m16:45:07.911473 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'../../assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: '../../assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:45:07.912066 [info ] [Dummy-1   ]: 
[0m16:45:07.912599 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:45:07.914489 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.307465, "process_in_blocks": "0", "process_kernel_time": 1.35, "process_mem_max_rss": "428044", "process_out_blocks": "0", "process_user_time": 5.98}
[0m16:45:07.915194 [debug] [Dummy-1   ]: Command `cli run` failed at 16:45:07.914917 after 12.31 seconds
[0m16:45:07.915805 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:47:00.576414 | 59bfdf90-f6b6-4e0f-9554-2c8ced823c66 ==============================
[0m16:47:00.576414 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:47:00.577640 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:47:00.974653 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:47:01.705636 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:47:02.132425 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:47:02.133573 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m16:47:02.818152 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:47:02.821190 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:47:02.872572 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:47:02.877110 [info ] [Dummy-1   ]: 
[0m16:47:02.877846 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:47:02.878500 [info ] [Dummy-1   ]: 
[0m16:47:02.879567 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:47:02.888338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:47:03.022569 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:47:03.023281 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:47:03.023969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:03.810910 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.787 seconds
[0m16:47:03.817001 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:47:03.817717 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:47:03.898318 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.080 seconds
[0m16:47:03.902214 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:47:03.902858 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:47:03.975091 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.072 seconds
[0m16:47:03.977792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:47:03.990568 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:47:03.991215 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:47:03.991743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:04.722128 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.730 seconds
[0m16:47:04.724736 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:47:04.725398 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:47:04.830933 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.105 seconds
[0m16:47:04.833419 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:47:04.834028 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:47:04.914195 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.079 seconds
[0m16:47:04.922319 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:47:04.923192 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m16:47:04.923854 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:47:04.944141 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:47:04.945185 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:47:04.946311 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:47:04.947646 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:47:04.948631 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:47:04.949302 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:47:04.961681 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:47:04.962649 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:47:04.963764 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:47:04.965006 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:47:04.966165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:47:04.966776 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:47:04.980573 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:47:04.981506 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:47:04.982579 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:47:04.983841 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:47:04.984962 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:47:04.985617 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:47:05.011821 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:47:05.012838 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:47:05.013970 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:47:05.015249 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:47:05.016166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:47:05.016762 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:47:05.030445 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:47:05.031445 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:47:05.032539 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:47:05.033818 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:47:05.034680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:47:05.035266 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:47:05.050290 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:47:05.051288 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:47:05.052395 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:47:05.053548 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:47:05.054421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:47:05.055020 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:47:05.068166 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:47:05.069229 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:47:05.070313 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:47:05.071485 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:47:05.072439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:47:05.073038 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:47:05.087589 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:47:05.088678 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:47:05.089778 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:47:05.090915 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:47:05.091803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:47:05.092524 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:47:05.105840 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:47:05.106809 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:47:05.107857 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:47:05.109146 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:47:05.110021 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:47:05.110647 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:47:05.125642 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:47:05.126778 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:47:05.127893 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:47:05.129169 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:47:05.130070 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:47:05.130700 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:47:05.293221 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:47:05.294230 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:47:05.295296 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:47:05.296457 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:47:05.297277 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:47:05.297867 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:47:05.310995 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:47:05.312063 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:47:05.313236 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:47:05.314658 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:47:05.315602 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:47:05.316345 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:47:05.331497 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:47:05.332604 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:47:05.333639 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:47:05.334813 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:47:05.335909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:47:05.336598 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:47:05.353072 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:47:05.354065 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:47:05.355130 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:47:05.356371 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:47:05.357224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:47:05.357851 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:47:05.372510 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:47:05.373440 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:47:05.374481 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:47:05.375704 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:47:05.376531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:47:05.377177 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:47:05.416549 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:47:05.417529 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:47:05.418669 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:47:05.419924 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:47:05.420878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:47:05.421502 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:47:05.436526 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:47:05.437452 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:47:05.438579 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:47:05.440577 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:47:05.441628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:47:05.442272 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:47:05.454707 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:47:05.455747 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:47:05.456775 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:47:05.458153 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:47:05.459173 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:47:05.459854 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:47:05.471613 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:47:05.472545 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:47:05.473584 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:47:05.474852 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:47:05.475935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:47:05.476573 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:47:05.492368 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:47:05.493379 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:47:05.494434 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:47:05.495626 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:47:05.496444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:47:05.497018 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:47:05.510183 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:47:05.511227 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:47:05.512296 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:47:05.513490 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:47:05.514310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:47:05.514883 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:47:05.528822 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:47:05.529783 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:47:05.530863 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:47:05.532137 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:47:05.532983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:47:05.533559 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:47:05.546202 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:47:05.547168 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:47:05.548251 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:47:05.549553 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:47:05.550385 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:47:05.550954 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:47:05.564583 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:47:05.565501 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:47:05.566548 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:47:05.567824 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:47:05.568794 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:47:05.569460 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:47:05.590831 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:47:05.591907 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:47:05.593012 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:47:05.594219 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:47:05.595122 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:47:05.595793 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:47:05.610453 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:47:05.611378 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:47:05.612455 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:47:05.613645 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:47:05.614474 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:47:05.615117 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:47:05.630183 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:47:05.631111 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:47:05.632244 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:47:05.633439 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:47:05.634297 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:47:05.634929 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:47:05.648074 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:47:05.649130 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:47:05.650192 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:47:05.651378 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:47:05.652224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:47:05.652827 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:47:05.667353 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:47:05.668425 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:47:05.669600 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:47:05.670815 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:47:05.671657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:47:05.672287 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:47:05.685185 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:47:05.686138 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:47:05.687144 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:47:05.688343 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:47:05.689327 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:47:05.689976 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:47:05.704393 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:47:05.705328 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:47:05.706360 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:47:05.707566 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:47:05.708519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:47:05.709214 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:47:05.722096 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:47:05.723025 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:47:05.724102 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:47:05.726686 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:47:05.727237 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:47:05.733212 [debug] [Dummy-1   ]: Command end result
[0m16:47:05.778463 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:47:05.781313 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:47:05.792690 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:47:05.795168 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.3214273, "process_in_blocks": "0", "process_kernel_time": 1.27, "process_mem_max_rss": "443772", "process_out_blocks": "0", "process_user_time": 7.02}
[0m16:47:05.796027 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:47:05.795702 after 5.32 seconds
[0m16:47:05.796685 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:49:28.219965 | c70e6c25-e69b-4c69-b177-5c72bb77e133 ==============================
[0m16:49:28.219965 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:49:28.221144 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:49:28.615664 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:49:29.405235 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:49:29.818467 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:29.819253 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:30.033782 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:49:30.036681 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:49:30.099363 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:49:30.103066 [info ] [Dummy-1   ]: 
[0m16:49:30.103787 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:49:30.104317 [info ] [Dummy-1   ]: 
[0m16:49:30.105286 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:49:30.112872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:49:30.265012 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:49:30.265849 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:49:30.266465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:30.991970 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.725 seconds
[0m16:49:31.010473 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:49:31.035707 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:49:31.036393 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:49:31.036911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:31.742991 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.706 seconds
[0m16:49:31.749053 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:49:31.749791 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:49:31.861370 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.111 seconds
[0m16:49:31.864226 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:49:31.864847 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:49:31.993689 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m16:49:31.996383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:49:32.009045 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:49:32.009687 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:49:32.010244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:33.297843 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.287 seconds
[0m16:49:33.300507 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:49:33.301136 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:49:33.410496 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.109 seconds
[0m16:49:33.412965 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:49:33.413601 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:49:33.511787 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.097 seconds
[0m16:49:33.519251 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:49:33.520276 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:49:33.521604 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:49:33.522320 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:49:33.541634 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:49:33.542634 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:49:33.603224 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:49:33.605247 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:49:33.606032 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:49:33.606702 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:49:34.698640 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.092 seconds
[0m16:49:34.735406 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.21s]
[0m16:49:34.736475 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:49:34.738538 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:49:34.739628 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:49:34.740435 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:49:34.741047 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:49:34.781527 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:49:34.782570 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:49:34.825895 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:49:34.828994 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:49:34.830201 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'../assets/global_inm_policy_schema.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset-paths")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset-paths': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:49:34.831164 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:49:38.411454 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d51-0206-d87f-0032-318704d777aa
[0m16:49:38.412289 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'../assets/global_inm_policy_schema.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: '../assets/global_inm_policy_schema.json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:49:38.418079 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'../assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: '../assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:49:38.419787 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.68s]
[0m16:49:38.420831 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:49:38.422396 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'../assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: '../assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:49:38.425535 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:49:38.426151 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m16:49:38.426614 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:49:38.427148 [info ] [Dummy-1   ]: 
[0m16:49:38.427681 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 8.32 seconds (8.32s).
[0m16:49:38.429035 [debug] [Dummy-1   ]: Command end result
[0m16:49:38.474799 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:49:38.477718 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:49:38.486243 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:49:38.486866 [info ] [Dummy-1   ]: 
[0m16:49:38.487590 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:49:38.488133 [info ] [Dummy-1   ]: 
[0m16:49:38.489103 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'../assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: '../assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:49:38.489709 [info ] [Dummy-1   ]: 
[0m16:49:38.490277 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:49:38.492208 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.37511, "process_in_blocks": "0", "process_kernel_time": 1.53, "process_mem_max_rss": "435328", "process_out_blocks": "0", "process_user_time": 5.93}
[0m16:49:38.492912 [debug] [Dummy-1   ]: Command `cli run` failed at 16:49:38.492637 after 10.38 seconds
[0m16:49:38.493487 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:54:45.592339 | 745f5dc4-e067-4881-8e31-7c2875256317 ==============================
[0m16:54:45.592339 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:54:45.593474 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:54:45.977194 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:54:46.771737 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:54:47.179025 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:54:47.180201 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m16:54:47.841916 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:54:47.844824 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:54:47.894143 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:54:47.898568 [info ] [Dummy-1   ]: 
[0m16:54:47.899221 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:54:47.899780 [info ] [Dummy-1   ]: 
[0m16:54:47.900719 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:54:47.909458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m16:54:48.081148 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:54:48.081847 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:54:48.082397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:49.205056 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.122 seconds
[0m16:54:49.211055 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:54:49.211713 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:54:49.316060 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.104 seconds
[0m16:54:49.319436 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:54:49.320115 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:54:49.439538 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.119 seconds
[0m16:54:49.441959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:54:49.452583 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:54:49.453239 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:54:49.453759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:50.235704 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.782 seconds
[0m16:54:50.238269 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:54:50.239017 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:54:50.345997 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.106 seconds
[0m16:54:50.348840 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:54:50.349445 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:54:50.461882 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m16:54:50.472444 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:54:50.473337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m16:54:50.473940 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:54:50.494104 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:54:50.495093 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:54:50.496300 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:54:50.497529 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:54:50.498479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:54:50.499144 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:54:50.511061 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:54:50.512024 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:54:50.513153 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:54:50.514366 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:54:50.515585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:54:50.516274 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:54:50.529890 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:54:50.530855 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:54:50.531960 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:54:50.533140 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:54:50.534151 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:54:50.534789 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:54:50.560054 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:54:50.561037 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:54:50.562093 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:54:50.563299 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:54:50.564205 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:54:50.564797 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:54:50.577725 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:54:50.578736 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:54:50.579838 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:54:50.581207 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:54:50.582218 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:54:50.582838 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:54:50.597207 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:54:50.598261 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:54:50.599418 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:54:50.600553 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:54:50.601390 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:54:50.602017 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:54:50.614901 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:54:50.615907 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:54:50.616965 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:54:50.618056 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:54:50.618961 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:54:50.619571 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:54:50.633727 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:54:50.634640 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:54:50.635669 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:54:50.636730 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:54:50.637531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:54:50.638114 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:54:50.651299 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:54:50.652229 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:54:50.653237 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:54:50.654290 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:54:50.655077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:54:50.655684 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:54:50.670164 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:54:50.671094 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:54:50.672135 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:54:50.673201 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:54:50.673983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:54:50.674565 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:54:50.827715 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:54:50.828772 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:54:50.829831 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:54:50.830906 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:54:50.831710 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:54:50.832302 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:54:50.845434 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:54:50.846372 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:54:50.847396 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:54:50.848545 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:54:50.849330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:54:50.849911 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:54:50.864618 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:54:50.865510 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:54:50.866613 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:54:50.867764 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:54:50.868601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:54:50.869185 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:54:50.884903 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:54:50.885838 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:54:50.886862 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:54:50.887974 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:54:50.888824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:54:50.889408 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:54:50.903317 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:54:50.904258 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:54:50.905275 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:54:50.906446 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:54:50.907224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:54:50.907816 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:54:50.945943 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:54:50.946926 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:54:50.947979 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:54:50.949237 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:54:50.950052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:54:50.950636 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:54:50.965381 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:54:50.966264 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:54:50.967275 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:54:50.969276 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:54:50.970190 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:54:50.970765 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:54:50.982916 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:54:50.983832 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:54:50.984850 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:54:50.986025 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:54:50.986785 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:54:50.987339 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:54:50.999042 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:54:50.999960 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:54:51.000990 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:54:51.002120 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:54:51.003178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:54:51.003775 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:54:51.018646 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:54:51.019544 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:54:51.020567 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:54:51.021707 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:54:51.022569 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:54:51.023189 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:54:51.035964 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:54:51.036856 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:54:51.037875 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:54:51.039078 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:54:51.039871 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:54:51.040443 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:54:51.053967 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:54:51.054829 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:54:51.055879 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:54:51.057059 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:54:51.057811 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:54:51.058446 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:54:51.070843 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:54:51.071769 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:54:51.072830 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:54:51.074204 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:54:51.075079 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:54:51.075703 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:54:51.088928 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:54:51.089803 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:54:51.090811 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:54:51.091992 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:54:51.092778 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:54:51.093382 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:54:51.113919 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:54:51.114839 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:54:51.115874 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:54:51.117090 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:54:51.117933 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:54:51.118632 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:54:51.132994 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:54:51.133921 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:54:51.134922 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:54:51.136073 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:54:51.136891 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:54:51.140015 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:54:51.152952 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:54:51.153885 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:54:51.154899 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:54:51.156073 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:54:51.156874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:54:51.157445 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:54:51.170199 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:54:51.171093 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:54:51.172112 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:54:51.173258 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:54:51.174018 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:54:51.174586 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:54:51.189394 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:54:51.190321 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:54:51.191319 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:54:51.192459 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:54:51.193216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:54:51.193785 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:54:51.206674 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:54:51.207612 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:54:51.208759 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:54:51.209919 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:54:51.210709 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:54:51.211287 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:54:51.225884 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:54:51.226827 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:54:51.227846 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:54:51.229070 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:54:51.229853 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:54:51.230419 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:54:51.243026 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:54:51.244003 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:54:51.245011 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:54:51.247479 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:54:51.248047 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:54:51.253835 [debug] [Dummy-1   ]: Command end result
[0m16:54:51.298109 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:54:51.301078 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:54:51.312206 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:54:51.314344 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.819895, "process_in_blocks": "0", "process_kernel_time": 1.28, "process_mem_max_rss": "441548", "process_out_blocks": "0", "process_user_time": 6.71}
[0m16:54:51.315080 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:54:51.314802 after 5.82 seconds
[0m16:54:51.315674 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:56:57.608662 | 78e87634-b1a1-4ea2-bd70-e3a3f53032a7 ==============================
[0m16:56:57.608662 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:56:57.609918 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:56:57.996625 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:56:58.808083 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:56:59.228276 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:56:59.229486 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:56:59.442212 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:56:59.445306 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:56:59.507015 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:56:59.510807 [info ] [Dummy-1   ]: 
[0m16:56:59.511542 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:56:59.512130 [info ] [Dummy-1   ]: 
[0m16:56:59.513093 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:56:59.520631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:56:59.675571 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:56:59.676273 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:56:59.676822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:00.468301 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.791 seconds
[0m16:57:00.473748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m16:57:00.497698 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:57:00.498471 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:57:00.499088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:01.249711 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.750 seconds
[0m16:57:01.255651 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:57:01.256342 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:57:01.352229 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.095 seconds
[0m16:57:01.354714 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:57:01.355360 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:57:01.496832 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.141 seconds
[0m16:57:01.499446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:57:01.510338 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:57:01.511015 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:57:01.511551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:02.353924 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.842 seconds
[0m16:57:02.356589 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:57:02.357260 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:57:02.468239 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.110 seconds
[0m16:57:02.471116 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:57:02.471822 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:57:02.590043 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.117 seconds
[0m16:57:02.601657 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:57:02.602683 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:57:02.603489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m16:57:02.604582 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:57:02.623795 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:57:02.624795 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:57:02.695219 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:57:02.697254 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:57:02.697998 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:57:02.698724 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:57:03.941234 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.242 seconds
[0m16:57:03.976847 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.37s]
[0m16:57:03.977904 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:57:03.979875 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:57:03.981095 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:57:03.981902 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:57:03.982478 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:57:04.022380 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:57:04.023376 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:57:04.066249 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:57:04.069346 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:57:04.070541 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'assets/global_inm_policy_schema.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset-paths")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset-paths': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:57:04.071513 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:57:07.202224 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d59-0206-e114-0032-318704d7f36e
[0m16:57:07.203013 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'assets/global_inm_policy_schema.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'assets/global_inm_policy_schema.json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:57:07.208638 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:57:07.210081 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.23s]
[0m16:57:07.211051 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:57:07.212486 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:57:07.215249 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:57:07.215812 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m16:57:07.216265 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:57:07.216830 [info ] [Dummy-1   ]: 
[0m16:57:07.217358 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.70 seconds (7.70s).
[0m16:57:07.218619 [debug] [Dummy-1   ]: Command end result
[0m16:57:07.262058 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:57:07.264729 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:57:07.272551 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:57:07.273076 [info ] [Dummy-1   ]: 
[0m16:57:07.273764 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:57:07.274268 [info ] [Dummy-1   ]: 
[0m16:57:07.275051 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:57:07.275614 [info ] [Dummy-1   ]: 
[0m16:57:07.276146 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:57:07.277913 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.771845, "process_in_blocks": "0", "process_kernel_time": 1.27, "process_mem_max_rss": "435108", "process_out_blocks": "0", "process_user_time": 6.05}
[0m16:57:07.278671 [debug] [Dummy-1   ]: Command `cli run` failed at 16:57:07.278322 after 9.77 seconds
[0m16:57:07.279246 [debug] [Dummy-1   ]: Flushing usage events


============================== 17:00:32.523035 | d31d0332-6f45-4848-8fec-ded00541087a ==============================
[0m17:00:32.523035 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m17:00:32.524201 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m17:00:32.908858 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m17:00:33.710816 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:00:34.126865 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:00:34.128029 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m17:00:34.795137 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:00:34.798157 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:00:34.847489 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m17:00:34.852039 [info ] [Dummy-1   ]: 
[0m17:00:34.852686 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m17:00:34.853159 [info ] [Dummy-1   ]: 
[0m17:00:34.853993 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m17:00:34.862593 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m17:00:35.054919 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:00:35.055692 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:00:35.056270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:36.510935 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.454 seconds
[0m17:00:36.516971 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:00:36.517615 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m17:00:36.641737 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.123 seconds
[0m17:00:36.645431 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:00:36.646066 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:00:36.790285 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.144 seconds
[0m17:00:36.793008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m17:00:36.805312 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:00:36.806030 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:00:36.806575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:37.552440 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.746 seconds
[0m17:00:37.555014 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:00:37.555659 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m17:00:37.640338 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.084 seconds
[0m17:00:37.642803 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:00:37.643404 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:00:37.754162 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m17:00:37.762398 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m17:00:37.763251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m17:00:37.763870 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m17:00:37.783775 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m17:00:37.784718 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m17:00:37.785786 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m17:00:37.787023 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m17:00:37.787954 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m17:00:37.788627 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m17:00:37.800838 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m17:00:37.801789 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m17:00:37.802852 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m17:00:37.804073 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m17:00:37.805226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m17:00:37.805844 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m17:00:37.819476 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m17:00:37.820429 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m17:00:37.821484 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m17:00:37.822683 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m17:00:37.823847 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m17:00:37.824479 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m17:00:37.849729 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m17:00:37.850788 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m17:00:37.851909 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m17:00:37.853123 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m17:00:37.853983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m17:00:37.854574 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m17:00:37.867809 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m17:00:37.868813 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m17:00:37.869868 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m17:00:37.871090 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m17:00:37.871947 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m17:00:37.872525 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m17:00:37.886915 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m17:00:37.887848 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m17:00:37.888958 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m17:00:37.890063 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m17:00:37.890866 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m17:00:37.891450 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m17:00:37.904350 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m17:00:37.905248 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m17:00:37.906310 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m17:00:37.907461 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m17:00:37.908418 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m17:00:37.909055 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m17:00:37.923202 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m17:00:37.924167 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m17:00:37.925223 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m17:00:37.926309 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m17:00:37.927121 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m17:00:37.927715 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m17:00:37.940766 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m17:00:37.941699 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m17:00:37.942742 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m17:00:37.943823 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m17:00:37.944619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m17:00:37.945183 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m17:00:37.959924 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m17:00:37.960821 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m17:00:37.961811 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m17:00:37.962864 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m17:00:37.963650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m17:00:37.964222 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m17:00:38.118324 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m17:00:38.119373 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m17:00:38.120411 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m17:00:38.121469 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m17:00:38.122248 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m17:00:38.122812 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m17:00:38.135657 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m17:00:38.136570 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m17:00:38.137553 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m17:00:38.138924 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m17:00:38.139754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m17:00:38.140329 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m17:00:38.154888 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m17:00:38.155819 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m17:00:38.156821 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m17:00:38.157883 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m17:00:38.158744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m17:00:38.159323 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m17:00:38.175178 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m17:00:38.176167 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m17:00:38.177193 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m17:00:38.178316 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m17:00:38.179243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m17:00:38.179834 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m17:00:38.193912 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m17:00:38.194841 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m17:00:38.195872 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m17:00:38.197045 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m17:00:38.197844 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m17:00:38.198474 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m17:00:38.236963 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m17:00:38.237870 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m17:00:38.238953 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m17:00:38.240143 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m17:00:38.240935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m17:00:38.241490 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m17:00:38.256173 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m17:00:38.257071 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m17:00:38.258070 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m17:00:38.260218 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m17:00:38.261187 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m17:00:38.261784 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m17:00:38.274245 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m17:00:38.275176 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m17:00:38.276194 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m17:00:38.277552 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m17:00:38.278326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m17:00:38.278999 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m17:00:38.290595 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m17:00:38.291529 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m17:00:38.292569 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m17:00:38.293724 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m17:00:38.294945 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m17:00:38.295553 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m17:00:38.310578 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m17:00:38.311453 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m17:00:38.312499 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m17:00:38.313659 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m17:00:38.314434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m17:00:38.315001 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m17:00:38.327712 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m17:00:38.328685 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m17:00:38.329718 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m17:00:38.330878 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m17:00:38.331653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m17:00:38.332241 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m17:00:38.345676 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m17:00:38.346543 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m17:00:38.347549 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m17:00:38.348785 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m17:00:38.349626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m17:00:38.350207 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m17:00:38.362466 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m17:00:38.363341 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m17:00:38.364372 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m17:00:38.365504 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m17:00:38.366261 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m17:00:38.366821 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m17:00:38.380163 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m17:00:38.381056 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m17:00:38.382086 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m17:00:38.383229 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m17:00:38.384052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m17:00:38.384635 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m17:00:38.405423 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m17:00:38.406327 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m17:00:38.407333 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m17:00:38.408531 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m17:00:38.409339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m17:00:38.409914 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m17:00:38.424097 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m17:00:38.425034 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m17:00:38.426019 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m17:00:38.427129 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m17:00:38.427896 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m17:00:38.428538 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m17:00:38.443124 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m17:00:38.444094 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m17:00:38.445108 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m17:00:38.446216 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m17:00:38.446993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m17:00:38.447570 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m17:00:38.460490 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m17:00:38.461383 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m17:00:38.462367 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m17:00:38.463499 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m17:00:38.464388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m17:00:38.465014 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m17:00:38.479388 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m17:00:38.480331 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m17:00:38.481326 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m17:00:38.482454 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m17:00:38.483222 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m17:00:38.483824 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m17:00:38.496550 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m17:00:38.497468 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m17:00:38.498516 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m17:00:38.499712 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m17:00:38.500531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m17:00:38.501117 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m17:00:38.515219 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m17:00:38.516159 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m17:00:38.517167 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m17:00:38.518303 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m17:00:38.519170 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m17:00:38.519782 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m17:00:38.532501 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m17:00:38.533420 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m17:00:38.534427 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m17:00:38.536958 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m17:00:38.537509 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m17:00:38.543321 [debug] [Dummy-1   ]: Command end result
[0m17:00:38.587772 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:00:38.590677 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:00:38.601722 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m17:00:38.603830 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.1794243, "process_in_blocks": "0", "process_kernel_time": 1.36, "process_mem_max_rss": "442892", "process_out_blocks": "0", "process_user_time": 6.87}
[0m17:00:38.604575 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 17:00:38.604293 after 6.18 seconds
[0m17:00:38.605162 [debug] [Dummy-1   ]: Flushing usage events


============================== 17:01:01.624913 | 7e83ba00-13a6-4bbe-8444-6c0af9989498 ==============================
[0m17:01:01.624913 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m17:01:01.626191 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m17:01:02.028143 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m17:01:02.794662 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:01:03.266944 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:03.267705 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:03.484026 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:01:03.487212 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:01:03.549688 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m17:01:03.553454 [info ] [Dummy-1   ]: 
[0m17:01:03.554210 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m17:01:03.554826 [info ] [Dummy-1   ]: 
[0m17:01:03.555860 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m17:01:03.563673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m17:01:03.719597 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m17:01:03.720277 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m17:01:03.720808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:04.854285 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.133 seconds
[0m17:01:04.859754 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m17:01:04.884097 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:01:04.884768 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:01:04.885276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:06.407458 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.522 seconds
[0m17:01:06.413614 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:01:06.414341 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m17:01:06.644336 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.229 seconds
[0m17:01:06.647283 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:01:06.647991 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:01:06.815436 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.167 seconds
[0m17:01:06.818169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m17:01:06.831002 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:01:06.831691 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:01:06.832243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:08.260920 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.428 seconds
[0m17:01:08.263575 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:01:08.264215 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m17:01:08.480472 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.216 seconds
[0m17:01:08.483084 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:01:08.483714 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:01:08.751810 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.267 seconds
[0m17:01:08.759830 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m17:01:08.760863 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m17:01:08.761665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m17:01:08.762334 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m17:01:08.781919 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m17:01:08.782941 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m17:01:08.844689 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m17:01:08.846711 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m17:01:08.847471 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m17:01:08.848150 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:01:11.086353 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.238 seconds
[0m17:01:11.122278 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 2.36s]
[0m17:01:11.123334 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m17:01:11.125354 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m17:01:11.126492 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m17:01:11.127300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m17:01:11.127910 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m17:01:11.167926 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m17:01:11.169019 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m17:01:11.212788 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m17:01:11.215885 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m17:01:11.217104 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'global_inm_policy_schema.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset-paths")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset-paths': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m17:01:11.218099 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:01:15.622811 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d5d-0206-e0d0-0032-318704d788ae
[0m17:01:15.623670 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'global_inm_policy_schema.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'global_inm_policy_schema.json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m17:01:15.629512 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m17:01:15.631187 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.50s]
[0m17:01:15.632250 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m17:01:15.633838 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m17:01:15.637231 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m17:01:15.637841 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m17:01:15.638399 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m17:01:15.639009 [info ] [Dummy-1   ]: 
[0m17:01:15.639563 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.08 seconds (12.08s).
[0m17:01:15.640821 [debug] [Dummy-1   ]: Command end result
[0m17:01:15.686982 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:01:15.690082 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:01:15.698635 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m17:01:15.699279 [info ] [Dummy-1   ]: 
[0m17:01:15.699987 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:01:15.700586 [info ] [Dummy-1   ]: 
[0m17:01:15.701454 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m17:01:15.702085 [info ] [Dummy-1   ]: 
[0m17:01:15.702641 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:01:15.704682 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.183983, "process_in_blocks": "0", "process_kernel_time": 1.4, "process_mem_max_rss": "430584", "process_out_blocks": "0", "process_user_time": 6.13}
[0m17:01:15.705417 [debug] [Dummy-1   ]: Command `cli run` failed at 17:01:15.705133 after 14.19 seconds
[0m17:01:15.706067 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:09:00.595578 | 0662e76c-53df-4eee-ae45-439b4e95870b ==============================
[0m11:09:00.595578 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:09:00.596867 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:09:01.005799 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:09:01.713267 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:09:02.049354 [info ] [Dummy-1   ]: Unable to do partial parsing because a project config has changed
[0m11:09:05.081004 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:09:05.084274 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:09:05.133426 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m11:09:05.138137 [info ] [Dummy-1   ]: 
[0m11:09:05.138889 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:09:05.139382 [info ] [Dummy-1   ]: 
[0m11:09:05.140216 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:09:05.148986 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m11:09:05.299508 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:09:05.300231 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:09:05.300804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:06.108889 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.808 seconds
[0m11:09:06.115063 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:09:06.115706 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:09:06.203621 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.087 seconds
[0m11:09:06.207133 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:09:06.207800 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:09:06.295440 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.087 seconds
[0m11:09:06.297963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m11:09:06.310526 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:09:06.311172 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:09:06.311662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:07.051342 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.739 seconds
[0m11:09:07.053971 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:09:07.054624 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:09:07.207466 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.152 seconds
[0m11:09:07.210375 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:09:07.210989 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:09:07.334500 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.123 seconds
[0m11:09:07.345598 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m11:09:07.346509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m11:09:07.347120 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m11:09:07.365745 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m11:09:07.366734 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m11:09:07.367832 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m11:09:07.369229 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:09:07.370173 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m11:09:07.370773 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:09:07.384595 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:09:07.385563 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:09:07.386657 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:09:07.387883 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m11:09:07.389162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m11:09:07.389799 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m11:09:07.403464 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m11:09:07.404371 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m11:09:07.405455 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m11:09:07.406656 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:09:07.407693 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m11:09:07.408286 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:09:07.429101 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m11:09:07.430091 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:09:07.431161 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:09:07.432353 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:09:07.433210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m11:09:07.433822 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:09:07.447123 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m11:09:07.448018 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:09:07.449132 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:09:07.450366 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:09:07.451178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m11:09:07.451760 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:09:07.464857 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m11:09:07.465757 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:09:07.466779 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:09:07.467833 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:09:07.468702 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m11:09:07.469317 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:09:07.484158 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m11:09:07.485064 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:09:07.486186 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:09:07.487250 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:09:07.488107 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m11:09:07.488772 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:09:07.501752 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m11:09:07.502681 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:09:07.503707 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:09:07.504763 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:09:07.505607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m11:09:07.506189 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:09:07.520781 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m11:09:07.521687 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:09:07.522704 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:09:07.523773 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:09:07.524564 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m11:09:07.525154 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:09:07.538168 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m11:09:07.539141 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:09:07.540179 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:09:07.541256 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:09:07.542070 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m11:09:07.542649 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:09:07.557069 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m11:09:07.557960 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:09:07.559054 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:09:07.560151 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:09:07.560944 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m11:09:07.561539 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:09:07.574498 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m11:09:07.575391 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:09:07.576406 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:09:07.577487 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:09:07.578278 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m11:09:07.578969 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:09:07.593998 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m11:09:07.594889 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:09:07.595924 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:09:07.596993 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:09:07.597839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m11:09:07.598487 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:09:07.614337 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m11:09:07.615212 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:09:07.616234 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:09:07.617362 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m11:09:07.618140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m11:09:07.618836 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m11:09:07.630966 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m11:09:07.631875 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m11:09:07.632903 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m11:09:07.635533 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m11:09:07.636553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m11:09:07.638522 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m11:09:07.675449 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m11:09:07.677903 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m11:09:07.680490 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m11:09:07.681851 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m11:09:07.682971 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m11:09:07.683550 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m11:09:07.696374 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m11:09:07.697346 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m11:09:07.698462 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m11:09:07.699677 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:09:07.700773 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m11:09:07.701390 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:09:07.716205 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m11:09:07.717134 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:09:07.718181 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:09:07.719431 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:09:07.720226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m11:09:07.720794 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:09:07.733839 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m11:09:07.734713 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:09:07.735726 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:09:07.736908 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m11:09:07.737718 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m11:09:07.738275 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m11:09:07.752215 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m11:09:07.753096 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m11:09:07.754136 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m11:09:07.755296 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m11:09:07.756095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m11:09:07.756649 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m11:09:07.768295 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m11:09:07.769300 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m11:09:07.770343 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m11:09:07.771521 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m11:09:07.772750 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m11:09:07.773393 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m11:09:07.786190 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m11:09:07.787063 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m11:09:07.788094 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m11:09:07.789338 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m11:09:07.790114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m11:09:07.790680 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m11:09:07.805102 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m11:09:07.806019 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m11:09:07.807046 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m11:09:07.808183 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m11:09:07.809052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m11:09:07.809648 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m11:09:07.821443 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m11:09:07.822325 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m11:09:07.823339 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m11:09:07.824678 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m11:09:07.825501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m11:09:07.826071 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m11:09:07.839976 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m11:09:07.840880 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m11:09:07.841933 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m11:09:07.843084 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m11:09:07.843839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m11:09:07.844436 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m11:09:07.856120 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m11:09:07.857014 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m11:09:07.858077 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m11:09:07.859326 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:09:07.860114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m11:09:07.860685 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:09:08.027276 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m11:09:08.028268 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:09:08.029432 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:09:08.030606 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:09:08.031403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m11:09:08.031986 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:09:08.044693 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m11:09:08.045575 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:09:08.046591 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:09:08.047743 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:09:08.048580 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m11:09:08.049170 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:09:08.062142 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m11:09:08.063017 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:09:08.064019 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:09:08.065158 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:09:08.065938 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m11:09:08.066508 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:09:08.081605 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m11:09:08.082486 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:09:08.083529 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:09:08.084693 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:09:08.085546 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m11:09:08.086129 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:09:08.098980 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m11:09:08.099868 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:09:08.100888 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:09:08.102052 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:09:08.102840 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m11:09:08.103405 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:09:08.117954 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m11:09:08.118906 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:09:08.119915 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:09:08.121059 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:09:08.121952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m11:09:08.122558 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:09:08.135724 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m11:09:08.136572 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:09:08.137612 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:09:08.138819 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:09:08.139582 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m11:09:08.140167 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:09:08.155057 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m11:09:08.155900 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:09:08.156900 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:09:08.159748 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:09:08.160364 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m11:09:08.166442 [debug] [Dummy-1   ]: Command end result
[0m11:09:08.214953 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:09:08.217979 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:09:08.228915 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:09:08.231055 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 7.740861, "process_in_blocks": "0", "process_kernel_time": 1.28, "process_mem_max_rss": "480752", "process_out_blocks": "0", "process_user_time": 9.25}
[0m11:09:08.231797 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 11:09:08.231516 after 7.74 seconds
[0m11:09:08.232367 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:12:30.054799 | 08ab6943-5d67-4b0b-8b21-86e6d3821623 ==============================
[0m11:12:30.054799 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:12:30.056041 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:12:30.448269 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:12:31.189748 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:12:31.640579 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:12:31.641286 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m11:12:31.860283 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:12:31.863430 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:12:31.925483 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m11:12:31.929213 [info ] [Dummy-1   ]: 
[0m11:12:31.929906 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:12:31.930453 [info ] [Dummy-1   ]: 
[0m11:12:31.931405 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:12:31.938976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m11:12:32.085699 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m11:12:32.086457 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m11:12:32.087011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:33.069269 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.982 seconds
[0m11:12:33.074997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m11:12:33.098748 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:12:33.099435 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:12:33.099942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:33.938119 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.838 seconds
[0m11:12:33.944365 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:12:33.945071 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:12:34.043127 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.097 seconds
[0m11:12:34.045715 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:12:34.046360 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:12:34.156038 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m11:12:34.158543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m11:12:34.171486 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:12:34.172149 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:12:34.172711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:35.051134 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.878 seconds
[0m11:12:35.053721 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:12:35.054356 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:12:35.198093 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.143 seconds
[0m11:12:35.202046 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:12:35.202678 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:12:35.298116 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m11:12:35.307592 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:12:35.308705 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m11:12:35.309556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m11:12:35.310194 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:12:35.328389 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:12:35.329450 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:12:35.391918 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m11:12:35.393937 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m11:12:35.394699 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m11:12:35.395332 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:12:36.922017 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.526 seconds
[0m11:12:36.958367 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.65s]
[0m11:12:36.959474 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:12:36.962812 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m11:12:36.965469 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m11:12:36.966492 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m11:12:36.968437 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m11:12:37.008948 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m11:12:37.011372 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m11:12:37.058090 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m11:12:37.062573 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m11:12:37.065219 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json


def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    docs_stage = dbt.config.get("docs_stage_path")
    global_inm_policy_schema = dbt.config.get("global_inm_policy_schema") 

    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}'), F.col('relative_path')),
            json.dumps(global_inm_policy_schema)
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'docs_stage_path': None, 'global_inm_policy_schema': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m11:12:37.067629 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:12:42.022697 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c031a0-0206-e1f0-0032-318704e2430e
[0m11:12:42.025655 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 115, in main
    materialize(session, df, dbt.this)
  File "_udf_code.py", line 110, in materialize
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
    result = func(*args, **kwargs)
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 509, in save_as_table
    snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 903, in resolve
    result = self.do_resolve(logical_plan)
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 956, in do_resolve
    res = self.do_resolve_with_resolved_children(
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1176, in do_resolve_with_resolved_children
    child_attributes=resolved_child.attributes,
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 608, in attributes
    attributes = self._analyze_attributes()
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 426, in wrap
    raise ne.with_traceback(tb) from None
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 597, in _analyze_attributes
    return analyze_attributes(
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 108, in analyze_attributes
    attributes = session._get_result_attributes(sql, query_params)
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/session.py", line 3048, in _get_result_attributes
    return self._conn.get_result_attributes(query, query_params)
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 277, in get_result_attributes
    self._run_new_describe(self._cursor, query, query_params=query_params),
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 288, in _run_new_describe
    result_metadata = run_new_describe(cursor, query, query_params)
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 177, in run_new_describe
    return cursor._describe_internal(query, params=query_params)  # pyright: ignore
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1137, in _describe_internal
    self.execute(*args, **kwargs)
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
    Error.errorhandler_wrapper(
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
    raise error_class(
snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c031a0-0206-e1f0-0032-318704e2431e: 001044 (42P13): SQL compilation error: error line 12 at position 4
Invalid argument types for function 'AI_EXTRACT$V3': (FILE, VARCHAR(4))
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m11:12:42.034579 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 115, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 110, in materialize
      df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 509, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 903, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 956, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1176, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 608, in attributes
      attributes = self._analyze_attributes()
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 426, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 597, in _analyze_attributes
      return analyze_attributes(
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 108, in analyze_attributes
      attributes = session._get_result_attributes(sql, query_params)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/session.py", line 3048, in _get_result_attributes
      return self._conn.get_result_attributes(query, query_params)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 277, in get_result_attributes
      self._run_new_describe(self._cursor, query, query_params=query_params),
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 288, in _run_new_describe
      result_metadata = run_new_describe(cursor, query, query_params)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 177, in run_new_describe
      return cursor._describe_internal(query, params=query_params)  # pyright: ignore
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1137, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c031a0-0206-e1f0-0032-318704e2431e: 001044 (42P13): SQL compilation error: error line 12 at position 4
  Invalid argument types for function 'AI_EXTRACT$V3': (FILE, VARCHAR(4))
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m11:12:42.038050 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 5.07s]
[0m11:12:42.040880 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m11:12:42.043234 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 115, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 110, in materialize
      df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 509, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 903, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 956, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1176, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 608, in attributes
      attributes = self._analyze_attributes()
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 426, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 597, in _analyze_attributes
      return analyze_attributes(
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 108, in analyze_attributes
      attributes = session._get_result_attributes(sql, query_params)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/session.py", line 3048, in _get_result_attributes
      return self._conn.get_result_attributes(query, query_params)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 277, in get_result_attributes
      self._run_new_describe(self._cursor, query, query_params=query_params),
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 288, in _run_new_describe
      result_metadata = run_new_describe(cursor, query, query_params)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 177, in run_new_describe
      return cursor._describe_internal(query, params=query_params)  # pyright: ignore
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1137, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c031a0-0206-e1f0-0032-318704e2431e: 001044 (42P13): SQL compilation error: error line 12 at position 4
  Invalid argument types for function 'AI_EXTRACT$V3': (FILE, VARCHAR(4))
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m11:12:42.046741 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:12:42.047371 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m11:12:42.047880 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m11:12:42.048517 [info ] [Dummy-1   ]: 
[0m11:12:42.049079 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.12 seconds (10.12s).
[0m11:12:42.050608 [debug] [Dummy-1   ]: Command end result
[0m11:12:42.101134 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:12:42.103969 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:12:42.112509 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:12:42.113094 [info ] [Dummy-1   ]: 
[0m11:12:42.113770 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:12:42.114301 [info ] [Dummy-1   ]: 
[0m11:12:42.117082 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 115, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 110, in materialize
      df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 509, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 903, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 956, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1176, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 608, in attributes
      attributes = self._analyze_attributes()
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 426, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 597, in _analyze_attributes
      return analyze_attributes(
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 108, in analyze_attributes
      attributes = session._get_result_attributes(sql, query_params)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/session.py", line 3048, in _get_result_attributes
      return self._conn.get_result_attributes(query, query_params)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 277, in get_result_attributes
      self._run_new_describe(self._cursor, query, query_params=query_params),
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 288, in _run_new_describe
      result_metadata = run_new_describe(cursor, query, query_params)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 177, in run_new_describe
      return cursor._describe_internal(query, params=query_params)  # pyright: ignore
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1137, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/1d7fc844796e20aef40a9153125a618d11a425cd1406655e586ac1c5bc3568a2/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c031a0-0206-e1f0-0032-318704e2431e: 001044 (42P13): SQL compilation error: error line 12 at position 4
  Invalid argument types for function 'AI_EXTRACT$V3': (FILE, VARCHAR(4))
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m11:12:42.118219 [info ] [Dummy-1   ]: 
[0m11:12:42.118890 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:12:42.120833 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.167701, "process_in_blocks": "0", "process_kernel_time": 1.39, "process_mem_max_rss": "431040", "process_out_blocks": "0", "process_user_time": 6.15}
[0m11:12:42.121556 [debug] [Dummy-1   ]: Command `cli run` failed at 11:12:42.121267 after 12.17 seconds
[0m11:12:42.122137 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:45:44.837342 | 984e3a8f-bb78-45ac-9981-dc1e51797f95 ==============================
[0m11:45:44.837342 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:45:44.838496 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:45:45.211418 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:45:45.965333 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:45:46.384621 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:46.385331 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:46.594994 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:45:46.597747 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:45:46.645268 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m11:45:46.649680 [info ] [Dummy-1   ]: 
[0m11:45:46.650290 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:45:46.650753 [info ] [Dummy-1   ]: 
[0m11:45:46.651596 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:45:46.660210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m11:45:46.813934 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:45:46.814618 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:45:46.815160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:47.670476 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.855 seconds
[0m11:45:47.676335 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:45:47.677045 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:45:47.808339 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.131 seconds
[0m11:45:47.812020 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:45:47.812615 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:45:47.912762 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m11:45:47.915413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m11:45:47.927964 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:45:47.928745 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:45:47.929349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:48.746645 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.817 seconds
[0m11:45:48.749243 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:45:48.749846 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:45:48.868727 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.118 seconds
[0m11:45:48.871095 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:45:48.871737 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:45:48.965589 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m11:45:48.974054 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m11:45:48.974910 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m11:45:48.975540 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m11:45:48.995669 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m11:45:48.996598 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m11:45:48.998366 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m11:45:48.999706 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:45:49.000573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m11:45:49.001192 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:45:49.013152 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:45:49.014052 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:45:49.015134 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:45:49.016308 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m11:45:49.017399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m11:45:49.018009 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m11:45:49.031352 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m11:45:49.032298 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m11:45:49.033377 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m11:45:49.034611 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:45:49.035823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m11:45:49.036488 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:45:49.061872 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m11:45:49.062974 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:45:49.064029 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:45:49.065183 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:45:49.066031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m11:45:49.066670 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:45:49.079490 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m11:45:49.080384 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:45:49.081408 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:45:49.082590 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:45:49.083482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m11:45:49.084146 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:45:49.098341 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m11:45:49.099389 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:45:49.100402 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:45:49.101496 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:45:49.102339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m11:45:49.102985 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:45:49.115692 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m11:45:49.116778 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:45:49.117863 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:45:49.119149 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:45:49.119943 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m11:45:49.120529 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:45:49.134824 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m11:45:49.135855 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:45:49.136918 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:45:49.138028 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:45:49.138960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m11:45:49.139605 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:45:49.152454 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m11:45:49.153413 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:45:49.154427 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:45:49.155501 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:45:49.156328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m11:45:49.157008 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:45:49.171250 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m11:45:49.172232 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:45:49.173279 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:45:49.174612 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:45:49.175425 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m11:45:49.176044 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:45:49.188750 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m11:45:49.189713 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:45:49.190727 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:45:49.191800 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:45:49.192749 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m11:45:49.193445 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:45:49.206156 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m11:45:49.207187 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:45:49.208181 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:45:49.209323 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:45:49.210127 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m11:45:49.210751 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:45:49.224858 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m11:45:49.225819 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:45:49.226802 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:45:49.227887 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:45:49.228840 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m11:45:49.229517 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:45:49.244879 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m11:45:49.245864 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:45:49.246891 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:45:49.247964 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m11:45:49.248800 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m11:45:49.249397 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m11:45:49.262670 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m11:45:49.263735 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m11:45:49.264851 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m11:45:49.267373 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m11:45:49.268297 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m11:45:49.270383 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m11:45:49.308619 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m11:45:49.310960 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m11:45:49.313287 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m11:45:49.314544 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m11:45:49.315651 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m11:45:49.316269 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m11:45:49.330370 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m11:45:49.331278 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m11:45:49.332314 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m11:45:49.333471 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:45:49.334489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m11:45:49.335069 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:45:49.353457 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m11:45:49.354494 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:45:49.355471 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:45:49.356689 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:45:49.357627 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m11:45:49.358257 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:45:49.372263 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m11:45:49.373236 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:45:49.374239 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:45:49.375323 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m11:45:49.376124 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m11:45:49.376714 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m11:45:49.388668 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m11:45:49.389534 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m11:45:49.390514 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m11:45:49.391667 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m11:45:49.392489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m11:45:49.393128 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m11:45:49.404595 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m11:45:49.405470 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m11:45:49.406477 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m11:45:49.407584 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m11:45:49.408786 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m11:45:49.409403 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m11:45:49.423430 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m11:45:49.424391 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m11:45:49.425416 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m11:45:49.426514 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m11:45:49.427289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m11:45:49.427889 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m11:45:49.440335 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m11:45:49.441262 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m11:45:49.442263 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m11:45:49.443575 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m11:45:49.444351 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m11:45:49.444926 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m11:45:49.588112 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m11:45:49.589202 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m11:45:49.590300 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m11:45:49.591451 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m11:45:49.592244 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m11:45:49.592919 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m11:45:49.604955 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m11:45:49.605801 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m11:45:49.606768 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m11:45:49.607853 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m11:45:49.608691 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m11:45:49.609281 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m11:45:49.620779 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m11:45:49.621704 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m11:45:49.622724 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m11:45:49.623851 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:45:49.624667 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m11:45:49.625335 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:45:49.642937 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m11:45:49.643877 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:45:49.644893 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:45:49.646243 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:45:49.647024 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m11:45:49.647602 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:45:49.661479 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m11:45:49.662339 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:45:49.663306 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:45:49.664405 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:45:49.665214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m11:45:49.665839 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:45:49.679708 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m11:45:49.680565 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:45:49.681583 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:45:49.682642 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:45:49.683469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m11:45:49.684111 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:45:49.696606 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m11:45:49.697474 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:45:49.698500 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:45:49.699562 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:45:49.700313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m11:45:49.700922 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:45:49.715135 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m11:45:49.716080 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:45:49.717073 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:45:49.718159 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:45:49.719031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m11:45:49.719633 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:45:49.732743 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m11:45:49.734071 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:45:49.735721 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:45:49.738196 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:45:49.739747 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m11:45:49.740542 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:45:49.758816 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m11:45:49.759676 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:45:49.760841 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:45:49.762226 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:45:49.763211 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m11:45:49.763910 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:45:49.776433 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m11:45:49.777326 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:45:49.778282 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:45:49.780760 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:45:49.781385 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m11:45:49.787391 [debug] [Dummy-1   ]: Command end result
[0m11:45:49.835917 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:45:49.838609 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:45:49.849475 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:45:49.851469 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.112097, "process_in_blocks": "0", "process_kernel_time": 1.26, "process_mem_max_rss": "432324", "process_out_blocks": "0", "process_user_time": 6.46}
[0m11:45:49.852177 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 11:45:49.851902 after 5.11 seconds
[0m11:45:49.852784 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:46:08.122799 | d5c07462-4f8b-49e9-8179-7ef1975aba4e ==============================
[0m11:46:08.122799 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:46:08.123911 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:46:08.501536 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:46:09.259992 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:46:09.685140 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:09.685864 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:09.899306 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:46:09.902367 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:46:09.962655 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m11:46:09.966301 [info ] [Dummy-1   ]: 
[0m11:46:09.967011 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:46:09.967555 [info ] [Dummy-1   ]: 
[0m11:46:09.968522 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:46:09.975767 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m11:46:10.127484 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m11:46:10.128195 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m11:46:10.128797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:11.323881 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.195 seconds
[0m11:46:11.328941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m11:46:11.351987 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:46:11.352683 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:46:11.353282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:12.658303 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.305 seconds
[0m11:46:12.664089 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:46:12.664699 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:46:12.971259 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.306 seconds
[0m11:46:12.973697 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:46:12.974271 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:46:13.218725 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.244 seconds
[0m11:46:13.221121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m11:46:13.233696 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:46:13.234327 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:46:13.234821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:14.645820 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.411 seconds
[0m11:46:14.648298 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:46:14.648940 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:46:14.889172 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.240 seconds
[0m11:46:14.891787 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:46:14.892368 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:46:15.036462 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.143 seconds
[0m11:46:15.046216 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:46:15.047163 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m11:46:15.047931 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m11:46:15.048590 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:46:15.066449 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:46:15.067393 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:46:15.127111 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m11:46:15.129047 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m11:46:15.129779 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m11:46:15.130405 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:46:16.790946 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.660 seconds
[0m11:46:16.825779 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.78s]
[0m11:46:16.826792 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:46:16.829960 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m11:46:16.832371 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m11:46:16.833321 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m11:46:16.835128 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m11:46:16.874166 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m11:46:16.876507 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m11:46:16.922234 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m11:46:16.926530 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m11:46:16.929056 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json


def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    docs_stage = dbt.config.get("docs_stage_path")
    global_inm_policy_schema = dbt.config.get("global_inm_policy_schema") 

    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}'), F.col('relative_path')),
            json.dumps(global_inm_policy_schema)
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'docs_stage_path': None, 'global_inm_policy_schema': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m11:46:16.931317 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:46:21.945174 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c03d02-0206-e94a-0032-318704fd6072
[0m11:46:21.948052 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 115, in main
    materialize(session, df, dbt.this)
  File "_udf_code.py", line 110, in materialize
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
    result = func(*args, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 509, in save_as_table
    snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 903, in resolve
    result = self.do_resolve(logical_plan)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 956, in do_resolve
    res = self.do_resolve_with_resolved_children(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1176, in do_resolve_with_resolved_children
    child_attributes=resolved_child.attributes,
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 608, in attributes
    attributes = self._analyze_attributes()
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 426, in wrap
    raise ne.with_traceback(tb) from None
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 597, in _analyze_attributes
    return analyze_attributes(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 108, in analyze_attributes
    attributes = session._get_result_attributes(sql, query_params)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/session.py", line 3048, in _get_result_attributes
    return self._conn.get_result_attributes(query, query_params)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 277, in get_result_attributes
    self._run_new_describe(self._cursor, query, query_params=query_params),
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 288, in _run_new_describe
    result_metadata = run_new_describe(cursor, query, query_params)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 177, in run_new_describe
    return cursor._describe_internal(query, params=query_params)  # pyright: ignore
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1137, in _describe_internal
    self.execute(*args, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
    Error.errorhandler_wrapper(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
    raise error_class(
snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c03d02-0206-e94a-0032-318704fd608a: 001044 (42P13): SQL compilation error: error line 12 at position 4
Invalid argument types for function 'AI_EXTRACT$V3': (FILE, VARCHAR(4))
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m11:46:21.956907 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 115, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 110, in materialize
      df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 509, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 903, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 956, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1176, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 608, in attributes
      attributes = self._analyze_attributes()
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 426, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 597, in _analyze_attributes
      return analyze_attributes(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 108, in analyze_attributes
      attributes = session._get_result_attributes(sql, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/session.py", line 3048, in _get_result_attributes
      return self._conn.get_result_attributes(query, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 277, in get_result_attributes
      self._run_new_describe(self._cursor, query, query_params=query_params),
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 288, in _run_new_describe
      result_metadata = run_new_describe(cursor, query, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 177, in run_new_describe
      return cursor._describe_internal(query, params=query_params)  # pyright: ignore
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1137, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c03d02-0206-e94a-0032-318704fd608a: 001044 (42P13): SQL compilation error: error line 12 at position 4
  Invalid argument types for function 'AI_EXTRACT$V3': (FILE, VARCHAR(4))
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m11:46:21.960319 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 5.13s]
[0m11:46:21.963005 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m11:46:21.965296 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 115, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 110, in materialize
      df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 509, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 903, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 956, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1176, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 608, in attributes
      attributes = self._analyze_attributes()
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 426, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 597, in _analyze_attributes
      return analyze_attributes(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 108, in analyze_attributes
      attributes = session._get_result_attributes(sql, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/session.py", line 3048, in _get_result_attributes
      return self._conn.get_result_attributes(query, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 277, in get_result_attributes
      self._run_new_describe(self._cursor, query, query_params=query_params),
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 288, in _run_new_describe
      result_metadata = run_new_describe(cursor, query, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 177, in run_new_describe
      return cursor._describe_internal(query, params=query_params)  # pyright: ignore
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1137, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c03d02-0206-e94a-0032-318704fd608a: 001044 (42P13): SQL compilation error: error line 12 at position 4
  Invalid argument types for function 'AI_EXTRACT$V3': (FILE, VARCHAR(4))
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m11:46:21.969418 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:46:21.970085 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m11:46:21.970616 [info ] [Dummy-1   ]: 
[0m11:46:21.971156 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.00 seconds (12.00s).
[0m11:46:21.972680 [debug] [Dummy-1   ]: Command end result
[0m11:46:22.021575 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:46:22.024293 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:46:22.032651 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:46:22.033270 [info ] [Dummy-1   ]: 
[0m11:46:22.033946 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:46:22.034467 [info ] [Dummy-1   ]: 
[0m11:46:22.037218 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 115, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 110, in materialize
      df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 509, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 903, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 956, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1176, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 608, in attributes
      attributes = self._analyze_attributes()
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 426, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 597, in _analyze_attributes
      return analyze_attributes(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 108, in analyze_attributes
      attributes = session._get_result_attributes(sql, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/session.py", line 3048, in _get_result_attributes
      return self._conn.get_result_attributes(query, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 277, in get_result_attributes
      self._run_new_describe(self._cursor, query, query_params=query_params),
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 288, in _run_new_describe
      result_metadata = run_new_describe(cursor, query, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 177, in run_new_describe
      return cursor._describe_internal(query, params=query_params)  # pyright: ignore
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1137, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c03d02-0206-e94a-0032-318704fd608a: 001044 (42P13): SQL compilation error: error line 12 at position 4
  Invalid argument types for function 'AI_EXTRACT$V3': (FILE, VARCHAR(4))
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m11:46:22.038317 [info ] [Dummy-1   ]: 
[0m11:46:22.038905 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:46:22.040749 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.015165, "process_in_blocks": "0", "process_kernel_time": 1.12, "process_mem_max_rss": "435544", "process_out_blocks": "0", "process_user_time": 5.96}
[0m11:46:22.041481 [debug] [Dummy-1   ]: Command `cli run` failed at 11:46:22.041191 after 14.02 seconds
[0m11:46:22.042066 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:48:11.281275 | d3e4cb26-e941-4283-8d08-4ad844a21e98 ==============================
[0m11:48:11.281275 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:48:11.282512 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m11:48:11.683571 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:48:12.410451 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:48:12.849773 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:48:12.851135 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m11:48:13.956795 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:48:13.960208 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:48:14.172579 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m11:48:14.177346 [info ] [Dummy-1   ]: 
[0m11:48:14.178001 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:48:14.178574 [info ] [Dummy-1   ]: 
[0m11:48:14.179471 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:48:14.188228 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m11:48:14.312754 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:48:14.313472 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:48:14.314058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:15.219005 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.905 seconds
[0m11:48:15.226986 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:48:15.227666 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:48:15.358545 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.130 seconds
[0m11:48:15.361523 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:48:15.362204 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:48:15.513819 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.151 seconds
[0m11:48:15.516542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m11:48:15.529268 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:48:15.529920 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:48:15.530447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:16.416434 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.886 seconds
[0m11:48:16.419061 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:48:16.419725 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:48:16.526945 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.106 seconds
[0m11:48:16.529553 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:48:16.530174 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:48:16.661874 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.131 seconds
[0m11:48:16.670037 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m11:48:16.670894 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m11:48:16.671518 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m11:48:16.691574 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m11:48:16.692566 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m11:48:16.693680 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m11:48:16.694926 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:48:16.695808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m11:48:16.696434 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:48:16.708680 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:48:16.709622 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:48:16.710723 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:48:16.712020 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m11:48:16.713210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m11:48:16.713845 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m11:48:16.727633 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m11:48:16.728695 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m11:48:16.729825 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m11:48:16.731080 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:48:16.732262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m11:48:16.732934 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:48:16.754401 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m11:48:16.755348 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:48:16.756471 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:48:16.757650 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:48:16.758583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m11:48:16.759195 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:48:16.772741 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m11:48:16.773645 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:48:16.774687 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:48:16.775860 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:48:16.776732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m11:48:16.777325 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:48:16.792226 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m11:48:16.793110 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:48:16.794158 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:48:16.795321 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:48:16.796235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m11:48:16.796845 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:48:16.810253 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m11:48:16.811175 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:48:16.812252 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:48:16.813402 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:48:16.814320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m11:48:16.814916 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:48:16.830013 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m11:48:16.830964 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:48:16.832078 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:48:16.833239 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:48:16.834126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m11:48:16.834733 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:48:16.848126 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m11:48:16.849174 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:48:16.850251 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:48:16.851625 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:48:16.852477 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m11:48:16.853075 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:48:16.866230 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m11:48:16.867120 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:48:16.868200 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:48:16.869344 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:48:16.870144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m11:48:16.870718 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:48:16.885611 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m11:48:16.886521 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:48:16.887565 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:48:16.888794 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:48:16.889652 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m11:48:16.890250 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:48:16.903279 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m11:48:16.904211 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:48:16.905247 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:48:16.906340 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:48:16.907133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m11:48:16.907714 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:48:16.922468 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m11:48:16.923395 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:48:16.924449 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:48:16.925537 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:48:16.926332 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m11:48:16.926927 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:48:16.943330 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m11:48:16.944307 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:48:16.945385 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:48:16.946557 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m11:48:16.947379 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m11:48:16.948029 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m11:48:16.961985 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m11:48:16.962932 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m11:48:16.964005 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m11:48:16.966680 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m11:48:16.967798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m11:48:16.969785 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m11:48:17.010684 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m11:48:17.013186 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m11:48:17.015694 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m11:48:17.017149 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m11:48:17.018356 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m11:48:17.019101 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m11:48:17.033771 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m11:48:17.034670 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m11:48:17.035724 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m11:48:17.036965 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:48:17.038084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m11:48:17.038818 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:48:17.052619 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m11:48:17.053537 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:48:17.054585 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:48:17.055795 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:48:17.056680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m11:48:17.057304 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:48:17.070553 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m11:48:17.071472 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:48:17.072564 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:48:17.073784 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m11:48:17.074627 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m11:48:17.075208 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m11:48:17.089717 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m11:48:17.090639 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m11:48:17.091680 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m11:48:17.092930 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m11:48:17.093782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m11:48:17.094366 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m11:48:17.106110 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m11:48:17.107005 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m11:48:17.108071 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m11:48:17.109348 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m11:48:17.110576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m11:48:17.111176 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m11:48:17.125514 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m11:48:17.126397 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m11:48:17.127437 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m11:48:17.128714 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m11:48:17.129542 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m11:48:17.130129 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m11:48:17.143008 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m11:48:17.143908 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m11:48:17.144933 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m11:48:17.146082 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m11:48:17.146857 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m11:48:17.147423 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m11:48:17.161020 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m11:48:17.161957 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m11:48:17.163028 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m11:48:17.164235 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m11:48:17.165039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m11:48:17.165616 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m11:48:17.178428 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m11:48:17.179355 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m11:48:17.180421 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m11:48:17.181613 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m11:48:17.182445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m11:48:17.183047 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m11:48:17.194983 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m11:48:17.195886 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m11:48:17.196966 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m11:48:17.198135 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:48:17.199016 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m11:48:17.199628 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:48:17.218189 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m11:48:17.219253 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:48:17.220353 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:48:17.221551 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:48:17.222379 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m11:48:17.222970 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:48:17.237582 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m11:48:17.238556 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:48:17.239660 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:48:17.240881 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:48:17.241734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m11:48:17.242334 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:48:17.257125 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m11:48:17.258030 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:48:17.259156 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:48:17.260366 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:48:17.261207 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m11:48:17.261793 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:48:17.274914 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m11:48:17.275889 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:48:17.276971 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:48:17.278195 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:48:17.279107 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m11:48:17.279712 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:48:17.294370 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m11:48:17.295296 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:48:17.296372 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:48:17.297586 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:48:17.298486 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m11:48:17.299123 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:48:17.312209 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m11:48:17.313092 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:48:17.314102 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:48:17.315255 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:48:17.316083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m11:48:17.316667 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:48:17.331621 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m11:48:17.332564 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:48:17.333604 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:48:17.334777 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:48:17.335581 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m11:48:17.336210 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:48:17.517832 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m11:48:17.518887 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:48:17.519987 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:48:17.522634 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:48:17.523279 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m11:48:17.529428 [debug] [Dummy-1   ]: Command end result
[0m11:48:17.579316 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:48:17.582385 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:48:17.593718 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:48:17.595940 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.4176316, "process_in_blocks": "0", "process_kernel_time": 1.4, "process_mem_max_rss": "446224", "process_out_blocks": "0", "process_user_time": 7.39}
[0m11:48:17.596756 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 11:48:17.596450 after 6.42 seconds
[0m11:48:17.597369 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:48:33.427109 | 8b62f9fb-8eb8-4322-8bb0-eda921a8dff0 ==============================
[0m11:48:33.427109 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:48:33.428294 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:48:33.825155 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:48:34.591133 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:48:35.031503 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:35.032304 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:35.252776 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:48:35.255989 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:48:35.319044 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m11:48:35.322782 [info ] [Dummy-1   ]: 
[0m11:48:35.323487 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:48:35.324009 [info ] [Dummy-1   ]: 
[0m11:48:35.324952 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:48:35.332585 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m11:48:35.484858 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m11:48:35.485653 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m11:48:35.486247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:36.350275 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.864 seconds
[0m11:48:36.355690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m11:48:36.379772 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:48:36.380460 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:48:36.380993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:37.319767 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.939 seconds
[0m11:48:37.325906 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:48:37.326590 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:48:37.525789 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.198 seconds
[0m11:48:37.528316 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:48:37.529108 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:48:37.634881 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m11:48:37.637620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m11:48:37.650864 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:48:37.651640 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:48:37.652295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:38.614809 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.962 seconds
[0m11:48:38.617429 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:48:38.618071 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:48:38.718351 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.100 seconds
[0m11:48:38.721290 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:48:38.721915 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:48:38.823706 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m11:48:38.833542 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:48:38.834587 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m11:48:38.835411 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m11:48:38.836053 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:48:38.854471 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:48:38.855494 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:48:38.919368 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m11:48:38.921404 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m11:48:38.922183 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m11:48:38.922831 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:48:40.404590 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.482 seconds
[0m11:48:40.441980 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.60s]
[0m11:48:40.443035 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:48:40.446380 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m11:48:40.449184 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m11:48:40.450252 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m11:48:40.452134 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m11:48:40.493228 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m11:48:40.495671 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m11:48:40.542826 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m11:48:40.547254 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m11:48:40.549935 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json


def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    docs_stage = dbt.config.get("docs_stage_path")
    global_inm_policy_schema = dbt.config.get("global_inm_policy_schema") 

    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}'), F.col('relative_path')),
            F.parse_json(json.dumps(global_inm_policy_schema))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'docs_stage_path': None, 'global_inm_policy_schema': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m11:48:40.552287 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:48:45.179389 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c03d04-0206-e946-0032-318704fd420e
[0m11:48:45.182403 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 115, in main
    materialize(session, df, dbt.this)
  File "_udf_code.py", line 110, in materialize
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
    result = func(*args, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 509, in save_as_table
    snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 903, in resolve
    result = self.do_resolve(logical_plan)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 956, in do_resolve
    res = self.do_resolve_with_resolved_children(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1176, in do_resolve_with_resolved_children
    child_attributes=resolved_child.attributes,
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 608, in attributes
    attributes = self._analyze_attributes()
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 379, in wrap
    raise ne.with_traceback(tb) from None
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 597, in _analyze_attributes
    return analyze_attributes(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 108, in analyze_attributes
    attributes = session._get_result_attributes(sql, query_params)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/session.py", line 3048, in _get_result_attributes
    return self._conn.get_result_attributes(query, query_params)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 277, in get_result_attributes
    self._run_new_describe(self._cursor, query, query_params=query_params),
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 288, in _run_new_describe
    result_metadata = run_new_describe(cursor, query, query_params)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 177, in run_new_describe
    return cursor._describe_internal(query, params=query_params)  # pyright: ignore
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1137, in _describe_internal
    self.execute(*args, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
    Error.errorhandler_wrapper(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
    raise error_class(
snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c03d04-0206-e946-0032-318704fd421e: 000904 (42000): SQL compilation error: error line 12 at position 60
invalid identifier 'NULL'
There are existing quoted column identifiers: ['"RELATIVE_PATH"', '"SIZE"', '"LAST_MODIFIED"', '"MD5"', '"ETAG"', '"FILE_URL"', '"METADATA$ACTION"', '"METADATA$ISUPDATE"', '"METADATA$ROW_ID"', '"ANALYSIS_TYPE"', ...]. Please use one of them to reference the column. See more details on Snowflake identifier requirements https://docs.snowflake.com/en/sql-reference/identifiers-syntax
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m11:48:45.191492 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 115, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 110, in materialize
      df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 509, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 903, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 956, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1176, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 608, in attributes
      attributes = self._analyze_attributes()
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 379, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 597, in _analyze_attributes
      return analyze_attributes(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 108, in analyze_attributes
      attributes = session._get_result_attributes(sql, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/session.py", line 3048, in _get_result_attributes
      return self._conn.get_result_attributes(query, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 277, in get_result_attributes
      self._run_new_describe(self._cursor, query, query_params=query_params),
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 288, in _run_new_describe
      result_metadata = run_new_describe(cursor, query, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 177, in run_new_describe
      return cursor._describe_internal(query, params=query_params)  # pyright: ignore
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1137, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c03d04-0206-e946-0032-318704fd421e: 000904 (42000): SQL compilation error: error line 12 at position 60
  invalid identifier 'NULL'
  There are existing quoted column identifiers: ['"RELATIVE_PATH"', '"SIZE"', '"LAST_MODIFIED"', '"MD5"', '"ETAG"', '"FILE_URL"', '"METADATA$ACTION"', '"METADATA$ISUPDATE"', '"METADATA$ROW_ID"', '"ANALYSIS_TYPE"', ...]. Please use one of them to reference the column. See more details on Snowflake identifier requirements https://docs.snowflake.com/en/sql-reference/identifiers-syntax
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m11:48:45.194947 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.74s]
[0m11:48:45.197751 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m11:48:45.200188 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 115, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 110, in materialize
      df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 509, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 903, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 956, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1176, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 608, in attributes
      attributes = self._analyze_attributes()
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 379, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 597, in _analyze_attributes
      return analyze_attributes(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 108, in analyze_attributes
      attributes = session._get_result_attributes(sql, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/session.py", line 3048, in _get_result_attributes
      return self._conn.get_result_attributes(query, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 277, in get_result_attributes
      self._run_new_describe(self._cursor, query, query_params=query_params),
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 288, in _run_new_describe
      result_metadata = run_new_describe(cursor, query, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 177, in run_new_describe
      return cursor._describe_internal(query, params=query_params)  # pyright: ignore
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1137, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c03d04-0206-e946-0032-318704fd421e: 000904 (42000): SQL compilation error: error line 12 at position 60
  invalid identifier 'NULL'
  There are existing quoted column identifiers: ['"RELATIVE_PATH"', '"SIZE"', '"LAST_MODIFIED"', '"MD5"', '"ETAG"', '"FILE_URL"', '"METADATA$ACTION"', '"METADATA$ISUPDATE"', '"METADATA$ROW_ID"', '"ANALYSIS_TYPE"', ...]. Please use one of them to reference the column. See more details on Snowflake identifier requirements https://docs.snowflake.com/en/sql-reference/identifiers-syntax
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m11:48:45.203797 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:48:45.204417 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m11:48:45.204985 [info ] [Dummy-1   ]: 
[0m11:48:45.205540 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.88 seconds (9.88s).
[0m11:48:45.207107 [debug] [Dummy-1   ]: Command end result
[0m11:48:45.256730 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:48:45.259645 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:48:45.268212 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:48:45.268976 [info ] [Dummy-1   ]: 
[0m11:48:45.269690 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:48:45.270214 [info ] [Dummy-1   ]: 
[0m11:48:45.272983 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 115, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 110, in materialize
      df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 509, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 903, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 956, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1176, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 608, in attributes
      attributes = self._analyze_attributes()
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 379, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 597, in _analyze_attributes
      return analyze_attributes(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 108, in analyze_attributes
      attributes = session._get_result_attributes(sql, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/session.py", line 3048, in _get_result_attributes
      return self._conn.get_result_attributes(query, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 277, in get_result_attributes
      self._run_new_describe(self._cursor, query, query_params=query_params),
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 288, in _run_new_describe
      result_metadata = run_new_describe(cursor, query, query_params)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 177, in run_new_describe
      return cursor._describe_internal(query, params=query_params)  # pyright: ignore
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1137, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c03d04-0206-e946-0032-318704fd421e: 000904 (42000): SQL compilation error: error line 12 at position 60
  invalid identifier 'NULL'
  There are existing quoted column identifiers: ['"RELATIVE_PATH"', '"SIZE"', '"LAST_MODIFIED"', '"MD5"', '"ETAG"', '"FILE_URL"', '"METADATA$ACTION"', '"METADATA$ISUPDATE"', '"METADATA$ROW_ID"', '"ANALYSIS_TYPE"', ...]. Please use one of them to reference the column. See more details on Snowflake identifier requirements https://docs.snowflake.com/en/sql-reference/identifiers-syntax
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m11:48:45.274101 [info ] [Dummy-1   ]: 
[0m11:48:45.274651 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:48:45.276542 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.953106, "process_in_blocks": "0", "process_kernel_time": 1.3, "process_mem_max_rss": "441896", "process_out_blocks": "0", "process_user_time": 6.29}
[0m11:48:45.277290 [debug] [Dummy-1   ]: Command `cli run` failed at 11:48:45.277003 after 11.95 seconds
[0m11:48:45.277881 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:53:16.307257 | 6982a0d7-7711-42bf-a68a-c4338ffcb630 ==============================
[0m11:53:16.307257 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:53:16.308545 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:53:16.703733 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:53:17.505572 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:53:17.944718 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:53:17.946037 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m11:53:19.043276 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:53:19.046267 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:53:19.256370 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m11:53:19.261131 [info ] [Dummy-1   ]: 
[0m11:53:19.261847 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:53:19.262388 [info ] [Dummy-1   ]: 
[0m11:53:19.263303 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:53:19.272006 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m11:53:19.421269 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:53:19.421953 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:53:19.422487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:20.100938 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.678 seconds
[0m11:53:20.109162 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:53:20.109890 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:53:20.272608 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.162 seconds
[0m11:53:20.275575 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:53:20.276242 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:53:20.378506 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m11:53:20.381197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m11:53:20.393619 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:53:20.394272 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:53:20.394790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:21.178892 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.784 seconds
[0m11:53:21.181504 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:53:21.182138 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:53:21.275169 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.092 seconds
[0m11:53:21.277754 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:53:21.278495 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:53:21.360040 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.081 seconds
[0m11:53:21.373600 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m11:53:21.374496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m11:53:21.375138 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m11:53:21.395320 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m11:53:21.396317 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m11:53:21.397449 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m11:53:21.398828 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:53:21.399769 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m11:53:21.400397 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:53:21.412478 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:53:21.413423 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:53:21.414487 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:53:21.415705 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m11:53:21.416938 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m11:53:21.417570 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m11:53:21.431286 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m11:53:21.432252 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m11:53:21.433414 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m11:53:21.434653 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:53:21.435752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m11:53:21.436413 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:53:21.458073 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m11:53:21.459096 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:53:21.460194 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:53:21.461371 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:53:21.462231 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m11:53:21.462817 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:53:21.476198 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m11:53:21.477119 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:53:21.478162 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:53:21.479448 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:53:21.480311 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m11:53:21.480897 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:53:21.495617 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m11:53:21.496560 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:53:21.497624 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:53:21.498859 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:53:21.499733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m11:53:21.500348 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:53:21.513442 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m11:53:21.514359 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:53:21.515442 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:53:21.516604 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:53:21.517474 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m11:53:21.518067 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:53:21.532765 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m11:53:21.533698 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:53:21.534746 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:53:21.535881 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:53:21.536747 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m11:53:21.537342 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:53:21.550567 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m11:53:21.551477 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:53:21.552547 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:53:21.553886 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:53:21.554729 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m11:53:21.555323 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:53:21.568421 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m11:53:21.569371 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:53:21.570403 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:53:21.571507 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:53:21.572326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m11:53:21.572907 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:53:21.587667 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m11:53:21.588677 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:53:21.589764 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:53:21.590867 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:53:21.591697 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m11:53:21.592327 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:53:21.605321 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m11:53:21.606243 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:53:21.607270 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:53:21.608485 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:53:21.609347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m11:53:21.609932 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:53:21.624731 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m11:53:21.625655 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:53:21.626692 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:53:21.627791 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:53:21.628718 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m11:53:21.629322 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:53:21.645533 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m11:53:21.646484 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:53:21.647520 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:53:21.648753 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m11:53:21.649583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m11:53:21.650159 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m11:53:21.663885 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m11:53:21.664795 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m11:53:21.665817 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m11:53:21.668525 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m11:53:21.669662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m11:53:21.671539 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m11:53:21.711906 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m11:53:21.714383 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m11:53:21.716886 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m11:53:21.718286 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m11:53:21.719533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m11:53:21.720205 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m11:53:21.734680 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m11:53:21.735565 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m11:53:21.736607 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m11:53:21.737767 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:53:21.738913 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m11:53:21.739516 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:53:21.752964 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m11:53:21.753867 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:53:21.754913 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:53:21.756087 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:53:21.756874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m11:53:21.757448 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:53:21.770595 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m11:53:21.771522 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:53:21.772589 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:53:21.773788 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m11:53:21.774597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m11:53:21.775165 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m11:53:21.789557 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m11:53:21.790480 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m11:53:21.791500 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m11:53:21.792721 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m11:53:21.793536 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m11:53:21.794101 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m11:53:21.805874 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m11:53:21.806780 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m11:53:21.807825 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m11:53:21.809122 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m11:53:21.810386 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m11:53:21.811026 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m11:53:21.825488 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m11:53:21.826408 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m11:53:21.827472 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m11:53:21.828770 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m11:53:21.829629 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m11:53:21.830213 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m11:53:21.843229 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m11:53:21.844184 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m11:53:21.845250 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m11:53:21.846447 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m11:53:21.847303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m11:53:21.847906 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m11:53:21.861448 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m11:53:21.862362 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m11:53:21.863419 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m11:53:21.864643 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m11:53:21.865452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m11:53:21.866030 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m11:53:21.878920 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m11:53:21.879812 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m11:53:21.880900 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m11:53:21.882112 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m11:53:21.882948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m11:53:21.883553 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m11:53:21.895417 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m11:53:21.896344 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m11:53:21.897373 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m11:53:21.898661 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:53:21.899512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m11:53:21.900123 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:53:21.918800 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m11:53:21.919725 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:53:21.920807 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:53:21.921992 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:53:21.922927 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m11:53:21.923542 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:53:21.938186 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m11:53:21.939194 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:53:21.940254 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:53:21.941394 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:53:21.942194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m11:53:21.942783 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:53:21.957543 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m11:53:21.958544 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:53:21.959598 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:53:21.960819 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:53:21.961655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m11:53:21.962239 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:53:21.975262 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m11:53:21.976253 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:53:21.977320 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:53:21.978531 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:53:21.979371 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m11:53:21.979983 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:53:21.994354 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m11:53:21.995256 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:53:21.996281 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:53:21.997415 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:53:21.998211 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m11:53:21.998879 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:53:22.011757 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m11:53:22.012690 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:53:22.013725 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:53:22.014893 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:53:22.015679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m11:53:22.016287 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:53:22.031133 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m11:53:22.032060 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:53:22.033104 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:53:22.034241 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:53:22.035046 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m11:53:22.035628 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:53:22.214186 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m11:53:22.215185 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:53:22.216274 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:53:22.219013 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:53:22.219737 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m11:53:22.225895 [debug] [Dummy-1   ]: Command end result
[0m11:53:22.274750 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:53:22.277743 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:53:22.288874 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:53:22.290994 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.0874524, "process_in_blocks": "0", "process_kernel_time": 1.37, "process_mem_max_rss": "444432", "process_out_blocks": "0", "process_user_time": 7.44}
[0m11:53:22.291758 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 11:53:22.291464 after 6.09 seconds
[0m11:53:22.292396 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:53:37.501449 | 6d381526-85ba-4d38-a960-db0da65ce65b ==============================
[0m11:53:37.501449 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:53:37.502580 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:53:37.881274 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:53:38.599437 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:53:39.015634 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:39.016346 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:39.232100 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:53:39.235155 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:53:39.295761 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m11:53:39.299387 [info ] [Dummy-1   ]: 
[0m11:53:39.300062 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:53:39.300591 [info ] [Dummy-1   ]: 
[0m11:53:39.301521 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:53:39.329531 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m11:53:39.482433 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m11:53:39.483076 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m11:53:39.483574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:40.274380 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.791 seconds
[0m11:53:40.279401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m11:53:40.302184 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:53:40.302891 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:53:40.303425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:41.058833 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.755 seconds
[0m11:53:41.064691 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:53:41.065350 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:53:41.191121 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.125 seconds
[0m11:53:41.193905 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:53:41.194494 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:53:41.314568 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.119 seconds
[0m11:53:41.317127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m11:53:41.331123 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:53:41.331808 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:53:41.332345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:42.125440 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.793 seconds
[0m11:53:42.127865 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:53:42.128496 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:53:42.188780 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.059 seconds
[0m11:53:42.191101 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:53:42.191656 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:53:42.287178 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m11:53:42.295215 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:53:42.296154 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m11:53:42.296964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m11:53:42.297699 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:53:42.315450 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:53:42.316383 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:53:42.406039 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m11:53:42.407958 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m11:53:42.408846 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m11:53:42.409556 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:53:43.385620 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.976 seconds
[0m11:53:43.419919 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.12s]
[0m11:53:43.420935 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:53:43.424059 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m11:53:43.426449 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m11:53:43.427368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m11:53:43.429224 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m11:53:43.467726 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m11:53:43.470173 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m11:53:43.515659 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m11:53:43.519928 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m11:53:43.522356 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json


def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    docs_stage = dbt.config.get("docs_stage_path")
    global_inm_policy_schema = dbt.config.get("global_inm_policy_schema") 

    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    # document_all_pages = document_all_pages.with_column(
    #     'question_extracts_json',
    #     F.call_builtin(
    #         'AI_EXTRACT',
    #         F.call_builtin('TO_FILE', F.lit(f'{docs_stage}'), F.col('relative_path')),
    #         F.parse_json(json.dumps(global_inm_policy_schema))
    #     )
    # )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'docs_stage_path': None, 'global_inm_policy_schema': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m11:53:43.524522 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:53:48.311073 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.786 seconds
[0m11:53:48.316482 [info ] [Thread-2 (]: 2 of 2 OK created python table model bronze_zone.document_question_extracts .... [[32mSUCCESS 1[0m in 4.89s]
[0m11:53:48.318825 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m11:53:48.321910 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:53:48.322416 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m11:53:48.322921 [info ] [Dummy-1   ]: 
[0m11:53:48.323432 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.02 seconds (9.02s).
[0m11:53:48.324549 [debug] [Dummy-1   ]: Command end result
[0m11:53:48.373217 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:53:48.375870 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:53:48.383931 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:53:48.384498 [info ] [Dummy-1   ]: 
[0m11:53:48.385228 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m11:53:48.385734 [info ] [Dummy-1   ]: 
[0m11:53:48.386268 [info ] [Dummy-1   ]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:53:48.388117 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.985574, "process_in_blocks": "0", "process_kernel_time": 1.18, "process_mem_max_rss": "434340", "process_out_blocks": "0", "process_user_time": 5.96}
[0m11:53:48.388984 [debug] [Dummy-1   ]: Command `cli run` succeeded at 11:53:48.388673 after 10.99 seconds
[0m11:53:48.389548 [debug] [Dummy-1   ]: Flushing usage events


============================== 13:06:33.501472 | dd9f340f-753c-4fd2-8dcc-35190d5666c9 ==============================
[0m13:06:33.501472 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m13:06:33.502697 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m13:06:33.907646 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m13:06:34.720381 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:06:35.166011 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:06:35.167567 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/document_question_extracts.yml
[0m13:06:35.168550 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m13:06:36.222870 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m13:06:36.226163 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m13:06:36.277313 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m13:06:36.282165 [info ] [Dummy-1   ]: 
[0m13:06:36.282909 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m13:06:36.283436 [info ] [Dummy-1   ]: 
[0m13:06:36.284403 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m13:06:36.293391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m13:06:36.602117 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:06:36.602875 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:06:36.603495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:37.499087 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.895 seconds
[0m13:06:37.506263 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:06:37.506925 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m13:06:37.604251 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.097 seconds
[0m13:06:37.606915 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:06:37.607561 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:06:37.718987 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m13:06:37.721610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m13:06:37.732505 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:06:37.733168 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:06:37.733693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:38.532353 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.798 seconds
[0m13:06:38.535095 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:06:38.535835 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m13:06:38.659173 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.122 seconds
[0m13:06:38.662090 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:06:38.662810 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:06:38.759038 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m13:06:38.770614 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m13:06:38.771525 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m13:06:38.772244 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m13:06:38.794016 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m13:06:38.795068 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m13:06:38.796271 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m13:06:38.797699 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m13:06:38.798887 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m13:06:38.799556 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m13:06:38.811873 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m13:06:38.812913 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m13:06:38.814083 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m13:06:38.815344 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m13:06:38.816603 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m13:06:38.817290 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m13:06:38.836094 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m13:06:38.837394 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m13:06:38.838893 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m13:06:38.840471 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m13:06:38.842143 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m13:06:38.843140 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m13:06:38.867422 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m13:06:38.868554 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m13:06:38.869746 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m13:06:38.871011 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m13:06:38.871925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m13:06:38.872555 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m13:06:38.886270 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m13:06:38.887226 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m13:06:38.888353 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m13:06:38.889739 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m13:06:38.890633 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m13:06:38.891248 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m13:06:38.906380 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m13:06:38.907341 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m13:06:38.908584 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m13:06:38.909870 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m13:06:38.910772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m13:06:38.911395 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m13:06:38.924813 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m13:06:38.925811 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m13:06:38.926948 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m13:06:38.928246 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m13:06:38.929311 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m13:06:38.929975 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m13:06:38.944990 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m13:06:38.945965 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m13:06:38.947067 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m13:06:38.948288 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m13:06:38.949279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m13:06:38.949910 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m13:06:38.963447 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m13:06:38.964457 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m13:06:38.965546 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m13:06:38.966705 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m13:06:38.967594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m13:06:38.968268 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m13:06:38.983202 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m13:06:38.984208 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m13:06:38.985320 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m13:06:38.986475 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m13:06:38.987317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m13:06:38.987962 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m13:06:39.001403 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m13:06:39.002371 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m13:06:39.003468 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m13:06:39.004703 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m13:06:39.005569 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m13:06:39.006207 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m13:06:39.019563 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m13:06:39.020548 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m13:06:39.021663 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m13:06:39.022863 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m13:06:39.023752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m13:06:39.024443 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m13:06:39.039698 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m13:06:39.040678 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m13:06:39.041800 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m13:06:39.043246 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m13:06:39.044153 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m13:06:39.044781 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m13:06:39.061313 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m13:06:39.062276 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m13:06:39.063381 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m13:06:39.064674 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m13:06:39.065551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m13:06:39.066185 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m13:06:39.080326 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m13:06:39.081314 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m13:06:39.082416 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m13:06:39.083904 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m13:06:39.084831 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m13:06:39.085603 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m13:06:39.125903 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m13:06:39.127041 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m13:06:39.128320 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m13:06:39.129786 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m13:06:39.130900 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m13:06:39.131551 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m13:06:39.146573 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m13:06:39.147558 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m13:06:39.148798 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m13:06:39.150164 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m13:06:39.151341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m13:06:39.152019 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m13:06:39.165848 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m13:06:39.166817 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m13:06:39.167933 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m13:06:39.169320 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m13:06:39.170263 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m13:06:39.170917 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m13:06:39.185809 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m13:06:39.186780 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m13:06:39.187889 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m13:06:39.189276 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m13:06:39.190186 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m13:06:39.190828 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m13:06:39.203260 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m13:06:39.204276 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m13:06:39.205398 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m13:06:39.206751 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m13:06:39.207652 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m13:06:39.208292 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m13:06:39.220474 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m13:06:39.221399 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m13:06:39.222488 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m13:06:39.223784 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m13:06:39.225032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m13:06:39.225684 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m13:06:39.240646 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m13:06:39.241626 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m13:06:39.242731 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m13:06:39.244008 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m13:06:39.244899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m13:06:39.245504 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m13:06:39.258540 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m13:06:39.259569 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m13:06:39.260704 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m13:06:39.261941 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m13:06:39.262792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m13:06:39.263402 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m13:06:39.277324 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m13:06:39.278444 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m13:06:39.279668 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m13:06:39.280972 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m13:06:39.281858 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m13:06:39.282497 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m13:06:39.295322 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m13:06:39.296360 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m13:06:39.297458 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m13:06:39.298796 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m13:06:39.299714 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m13:06:39.300396 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m13:06:39.313992 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m13:06:39.314953 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m13:06:39.316061 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m13:06:39.317373 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m13:06:39.318267 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m13:06:39.319006 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m13:06:39.335980 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m13:06:39.336985 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m13:06:39.338101 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m13:06:39.339439 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m13:06:39.340381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m13:06:39.341010 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m13:06:39.355981 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m13:06:39.356984 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m13:06:39.358093 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m13:06:39.359440 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m13:06:39.360384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m13:06:39.361026 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m13:06:39.375998 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m13:06:39.376959 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m13:06:39.378053 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m13:06:39.379635 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m13:06:39.380539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m13:06:39.381174 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m13:06:39.394267 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m13:06:39.395243 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m13:06:39.396335 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m13:06:39.397573 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m13:06:39.398461 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m13:06:39.399108 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m13:06:39.413922 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m13:06:39.414893 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m13:06:39.416018 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m13:06:39.417271 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m13:06:39.418117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m13:06:39.418815 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m13:06:39.432034 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m13:06:39.432989 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m13:06:39.434061 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m13:06:39.435311 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m13:06:39.436200 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m13:06:39.436824 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m13:06:39.451544 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m13:06:39.452527 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m13:06:39.453637 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m13:06:39.454883 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m13:06:39.455779 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m13:06:39.456427 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m13:06:39.469833 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m13:06:39.470796 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m13:06:39.471889 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m13:06:39.474748 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m13:06:39.475373 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m13:06:39.481779 [debug] [Dummy-1   ]: Command end result
[0m13:06:39.528774 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m13:06:39.531798 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m13:06:39.543300 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m13:06:39.545588 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.1486, "process_in_blocks": "0", "process_kernel_time": 1.16, "process_mem_max_rss": "438880", "process_out_blocks": "0", "process_user_time": 7.69}
[0m13:06:39.546380 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 13:06:39.546075 after 6.15 seconds
[0m13:06:39.546980 [debug] [Dummy-1   ]: Flushing usage events


============================== 13:06:59.268982 | 788a0494-864a-4d64-a295-22891483b26a ==============================
[0m13:06:59.268982 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m13:06:59.270178 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m13:06:59.671175 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m13:07:00.503425 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:07:00.932747 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:07:00.933500 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m13:07:01.151626 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m13:07:01.154775 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m13:07:01.217116 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m13:07:01.220930 [info ] [Dummy-1   ]: 
[0m13:07:01.221583 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m13:07:01.222089 [info ] [Dummy-1   ]: 
[0m13:07:01.223002 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m13:07:01.230607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m13:07:01.368141 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m13:07:01.368955 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m13:07:01.369652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:02.536016 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.166 seconds
[0m13:07:02.541641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m13:07:02.566760 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:07:02.567461 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:07:02.567984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:03.466707 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.898 seconds
[0m13:07:03.472963 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:07:03.473624 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m13:07:03.549560 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.075 seconds
[0m13:07:03.552175 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:07:03.552819 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:07:03.739363 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.186 seconds
[0m13:07:03.741965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m13:07:03.753040 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:07:03.753746 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:07:03.754315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:04.655873 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.901 seconds
[0m13:07:04.658629 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:07:04.659310 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m13:07:04.810971 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.151 seconds
[0m13:07:04.813968 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:07:04.814638 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:07:04.940960 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.126 seconds
[0m13:07:04.951247 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m13:07:04.952741 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m13:07:04.953590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m13:07:04.954267 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m13:07:04.973900 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m13:07:04.974914 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m13:07:05.036098 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m13:07:05.038226 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m13:07:05.039067 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m13:07:05.039771 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:07:06.329962 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.290 seconds
[0m13:07:06.367459 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.41s]
[0m13:07:06.368588 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m13:07:06.370759 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m13:07:06.372276 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m13:07:06.373160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m13:07:06.373939 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m13:07:06.416059 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m13:07:06.417230 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m13:07:06.461633 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m13:07:06.464883 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m13:07:06.466231 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_model_meta_config(yaml_config, model_name):
    for model in yaml_config['models']:
        if model['name'] == model_name:
            return model['config']['meta']
            
    return None
    
def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    docs_stage = dbt.config.get("docs_stage_path")
    global_inm_policy_schema = dbt.config.get("global_inm_policy_schema") 

    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = df.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS'), F.col('relative_path')),
            get_model_meta_config(global_inm_policy_schema, 'document_question_extracts')['global_inm_policy_schema']
        )
    )    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'docs_stage_path': None, 'global_inm_policy_schema': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m13:07:06.467304 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:07:10.530790 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c03d53-0206-e95a-0032-318704fe0356
[0m13:07:10.531743 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 119, in main
    df = model(dbt, session)
  File "_udf_code.py", line 38, in model
    document_all_pages = df.with_column(
NameError: name 'df' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m13:07:10.537586 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 119, in main
      df = model(dbt, session)
    File "_udf_code.py", line 38, in model
      document_all_pages = df.with_column(
  NameError: name 'df' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m13:07:10.539396 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.17s]
[0m13:07:10.540579 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m13:07:10.542103 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 119, in main
      df = model(dbt, session)
    File "_udf_code.py", line 38, in model
      document_all_pages = df.with_column(
  NameError: name 'df' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m13:07:10.545251 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m13:07:10.545852 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m13:07:10.546443 [info ] [Dummy-1   ]: 
[0m13:07:10.546993 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.32 seconds (9.32s).
[0m13:07:10.548211 [debug] [Dummy-1   ]: Command end result
[0m13:07:10.594764 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m13:07:10.597789 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m13:07:10.606381 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m13:07:10.607002 [info ] [Dummy-1   ]: 
[0m13:07:10.607684 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:07:10.608217 [info ] [Dummy-1   ]: 
[0m13:07:10.609248 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 119, in main
      df = model(dbt, session)
    File "_udf_code.py", line 38, in model
      document_all_pages = df.with_column(
  NameError: name 'df' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m13:07:10.609833 [info ] [Dummy-1   ]: 
[0m13:07:10.610398 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:07:10.612345 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.44669, "process_in_blocks": "0", "process_kernel_time": 1.4, "process_mem_max_rss": "434660", "process_out_blocks": "0", "process_user_time": 6.04}
[0m13:07:10.613065 [debug] [Dummy-1   ]: Command `cli run` failed at 13:07:10.612785 after 11.45 seconds
[0m13:07:10.613642 [debug] [Dummy-1   ]: Flushing usage events


============================== 13:07:45.522473 | 81a98d5f-f704-486f-967a-53046c7fd57e ==============================
[0m13:07:45.522473 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m13:07:45.523766 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:07:45.935522 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m13:07:46.728635 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:07:47.162080 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:07:47.163400 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m13:07:48.218316 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m13:07:48.221700 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m13:07:48.274946 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m13:07:48.279716 [info ] [Dummy-1   ]: 
[0m13:07:48.280429 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m13:07:48.280929 [info ] [Dummy-1   ]: 
[0m13:07:48.281776 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m13:07:48.290582 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m13:07:48.596744 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:07:48.597460 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:07:48.598062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:49.496066 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.898 seconds
[0m13:07:49.503374 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:07:49.504099 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m13:07:49.645728 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.141 seconds
[0m13:07:49.648910 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:07:49.649581 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:07:49.771180 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m13:07:49.773998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m13:07:49.786904 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:07:49.787565 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:07:49.788134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:50.810119 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.022 seconds
[0m13:07:50.812799 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:07:50.813521 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m13:07:50.920942 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.107 seconds
[0m13:07:50.923559 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:07:50.924252 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:07:51.010932 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.086 seconds
[0m13:07:51.019499 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m13:07:51.020473 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m13:07:51.021167 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m13:07:51.042995 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m13:07:51.044064 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m13:07:51.045287 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m13:07:51.046736 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m13:07:51.047757 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m13:07:51.048547 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m13:07:51.061022 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m13:07:51.062044 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m13:07:51.063222 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m13:07:51.064642 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m13:07:51.065866 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m13:07:51.066531 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m13:07:51.080838 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m13:07:51.081868 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m13:07:51.083013 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m13:07:51.084384 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m13:07:51.085610 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m13:07:51.086291 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m13:07:51.108839 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m13:07:51.109899 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m13:07:51.111082 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m13:07:51.112434 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m13:07:51.113412 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m13:07:51.114085 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m13:07:51.127964 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m13:07:51.129089 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m13:07:51.130263 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m13:07:51.131582 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m13:07:51.132562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m13:07:51.133200 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m13:07:51.148626 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m13:07:51.149607 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m13:07:51.150721 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m13:07:51.151986 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m13:07:51.152912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m13:07:51.153558 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m13:07:51.167049 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m13:07:51.168111 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m13:07:51.169373 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m13:07:51.170642 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m13:07:51.171597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m13:07:51.172274 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m13:07:51.187261 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m13:07:51.188308 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m13:07:51.189612 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m13:07:51.190830 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m13:07:51.191741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m13:07:51.192427 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m13:07:51.206011 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m13:07:51.207006 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m13:07:51.208146 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m13:07:51.209449 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m13:07:51.210329 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m13:07:51.210945 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m13:07:51.225808 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m13:07:51.226861 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m13:07:51.227986 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m13:07:51.229253 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m13:07:51.230164 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m13:07:51.230798 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m13:07:51.244215 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m13:07:51.245181 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m13:07:51.246296 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m13:07:51.247467 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m13:07:51.248375 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m13:07:51.249120 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m13:07:51.262558 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m13:07:51.263537 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m13:07:51.264647 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m13:07:51.265859 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m13:07:51.266736 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m13:07:51.267351 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m13:07:51.282572 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m13:07:51.283591 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m13:07:51.284742 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m13:07:51.286229 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m13:07:51.287158 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m13:07:51.287800 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m13:07:51.304532 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m13:07:51.305508 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m13:07:51.306633 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m13:07:51.307935 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m13:07:51.308935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m13:07:51.309580 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m13:07:51.323645 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m13:07:51.324642 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m13:07:51.325757 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m13:07:51.327208 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m13:07:51.328149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m13:07:51.328990 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m13:07:51.369350 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m13:07:51.370523 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m13:07:51.371804 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m13:07:51.373166 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m13:07:51.374358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m13:07:51.375024 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m13:07:51.390056 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m13:07:51.391028 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m13:07:51.392134 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m13:07:51.393410 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m13:07:51.394568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m13:07:51.395208 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m13:07:51.409108 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m13:07:51.410100 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m13:07:51.411227 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m13:07:51.412491 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m13:07:51.413369 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m13:07:51.413988 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m13:07:51.428810 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m13:07:51.429757 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m13:07:51.430802 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m13:07:51.432065 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m13:07:51.432912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m13:07:51.433498 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m13:07:51.445975 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m13:07:51.446908 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m13:07:51.448011 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m13:07:51.449394 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m13:07:51.450273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m13:07:51.450900 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m13:07:51.462952 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m13:07:51.463879 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m13:07:51.465004 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m13:07:51.466297 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m13:07:51.467515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m13:07:51.468191 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m13:07:51.483179 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m13:07:51.484139 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m13:07:51.485256 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m13:07:51.486510 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m13:07:51.487363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m13:07:51.487990 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m13:07:51.501074 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m13:07:51.502025 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m13:07:51.503136 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m13:07:51.504427 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m13:07:51.505303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m13:07:51.505932 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m13:07:51.519737 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m13:07:51.520730 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m13:07:51.521829 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m13:07:51.523101 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m13:07:51.524009 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m13:07:51.524639 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m13:07:51.537464 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m13:07:51.538510 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m13:07:51.539671 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m13:07:51.540968 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m13:07:51.541848 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m13:07:51.542467 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m13:07:51.556272 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m13:07:51.557235 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m13:07:51.558321 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m13:07:51.559754 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m13:07:51.560679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m13:07:51.561306 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m13:07:51.578522 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m13:07:51.579533 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m13:07:51.580714 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m13:07:51.582012 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m13:07:51.582938 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m13:07:51.583620 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m13:07:51.598793 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m13:07:51.599808 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m13:07:51.600973 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m13:07:51.602228 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m13:07:51.603079 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m13:07:51.603725 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m13:07:51.619025 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m13:07:51.620044 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m13:07:51.621155 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m13:07:51.622629 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m13:07:51.623519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m13:07:51.624168 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m13:07:51.637167 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m13:07:51.638126 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m13:07:51.639326 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m13:07:51.640628 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m13:07:51.641519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m13:07:51.642129 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m13:07:51.657059 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m13:07:51.658043 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m13:07:51.659241 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m13:07:51.660545 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m13:07:51.661425 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m13:07:51.662040 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m13:07:51.675283 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m13:07:51.676264 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m13:07:51.677390 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m13:07:51.678745 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m13:07:51.679665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m13:07:51.680321 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m13:07:51.695128 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m13:07:51.696127 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m13:07:51.697254 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m13:07:51.698594 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m13:07:51.699532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m13:07:51.700203 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m13:07:51.713570 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m13:07:51.714543 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m13:07:51.715668 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m13:07:51.718689 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m13:07:51.719304 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m13:07:51.725578 [debug] [Dummy-1   ]: Command end result
[0m13:07:51.772905 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m13:07:51.775916 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m13:07:51.787418 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m13:07:51.789784 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.3718696, "process_in_blocks": "0", "process_kernel_time": 1.39, "process_mem_max_rss": "438812", "process_out_blocks": "0", "process_user_time": 7.42}
[0m13:07:51.790590 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 13:07:51.790279 after 6.37 seconds
[0m13:07:51.791197 [debug] [Dummy-1   ]: Flushing usage events


============================== 13:09:47.700045 | b773a8cb-a48d-4648-8a41-71e5dff69fb5 ==============================
[0m13:09:47.700045 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m13:09:47.701306 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:09:48.101407 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m13:09:48.917875 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:09:49.342120 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:09:49.342841 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m13:09:49.561411 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m13:09:49.564733 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m13:09:49.627946 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m13:09:49.631977 [info ] [Dummy-1   ]: 
[0m13:09:49.632637 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m13:09:49.633120 [info ] [Dummy-1   ]: 
[0m13:09:49.634015 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m13:09:49.641688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m13:09:49.792453 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m13:09:49.793242 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m13:09:49.793810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:50.785105 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.991 seconds
[0m13:09:50.790510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m13:09:50.815037 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:09:50.815756 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:09:50.816330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:51.785716 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.969 seconds
[0m13:09:51.791880 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:09:51.792561 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m13:09:51.937072 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.144 seconds
[0m13:09:51.940233 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:09:51.940911 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:09:52.069665 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m13:09:52.072526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m13:09:52.085488 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:09:52.086170 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:09:52.086680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:53.230591 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.144 seconds
[0m13:09:53.233273 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:09:53.233921 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m13:09:53.344895 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.110 seconds
[0m13:09:53.347422 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:09:53.348104 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:09:53.556684 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.208 seconds
[0m13:09:53.564834 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m13:09:53.565853 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m13:09:53.566711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m13:09:53.567353 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m13:09:53.587092 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m13:09:53.588140 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m13:09:53.649513 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m13:09:53.651562 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m13:09:53.652372 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m13:09:53.653042 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:09:55.184786 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.531 seconds
[0m13:09:55.222256 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.65s]
[0m13:09:55.223378 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m13:09:55.225612 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m13:09:55.227162 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m13:09:55.228098 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m13:09:55.229030 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m13:09:55.270852 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m13:09:55.272086 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m13:09:55.316661 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m13:09:55.319973 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m13:09:55.321354 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_model_meta_config(yaml_config, model_name):
    for model in yaml_config['models']:
        if model['name'] == model_name:
            return model['config']['meta']
            
    return None
    
def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    docs_stage = dbt.config.get("docs_stage_path")
    global_inm_policy_schema = dbt.config.get("global_inm_policy_schema") 

    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS'), F.col('relative_path')),
            get_model_meta_config(global_inm_policy_schema, 'document_question_extracts')['global_inm_policy_schema']
        )
    )    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'docs_stage_path': None, 'global_inm_policy_schema': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m13:09:55.322505 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:09:59.650584 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c03d55-0206-e963-0032-318704fc8f1a
[0m13:09:59.651631 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 119, in main
    df = model(dbt, session)
  File "_udf_code.py", line 43, in model
    get_model_meta_config(global_inm_policy_schema, 'document_question_extracts')['global_inm_policy_schema']
  File "_udf_code.py", line 13, in get_model_meta_config
    for model in yaml_config['models']:
TypeError: 'NoneType' object is not subscriptable
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m13:09:59.657788 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 119, in main
      df = model(dbt, session)
    File "_udf_code.py", line 43, in model
      get_model_meta_config(global_inm_policy_schema, 'document_question_extracts')['global_inm_policy_schema']
    File "_udf_code.py", line 13, in get_model_meta_config
      for model in yaml_config['models']:
  TypeError: 'NoneType' object is not subscriptable
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m13:09:59.659740 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.43s]
[0m13:09:59.661052 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m13:09:59.662682 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 119, in main
      df = model(dbt, session)
    File "_udf_code.py", line 43, in model
      get_model_meta_config(global_inm_policy_schema, 'document_question_extracts')['global_inm_policy_schema']
    File "_udf_code.py", line 13, in get_model_meta_config
      for model in yaml_config['models']:
  TypeError: 'NoneType' object is not subscriptable
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m13:09:59.665856 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m13:09:59.666457 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m13:09:59.667025 [info ] [Dummy-1   ]: 
[0m13:09:59.667590 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.03 seconds (10.03s).
[0m13:09:59.668970 [debug] [Dummy-1   ]: Command end result
[0m13:09:59.715981 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m13:09:59.719143 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m13:09:59.727759 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m13:09:59.728486 [info ] [Dummy-1   ]: 
[0m13:09:59.729254 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:09:59.729793 [info ] [Dummy-1   ]: 
[0m13:09:59.730738 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 119, in main
      df = model(dbt, session)
    File "_udf_code.py", line 43, in model
      get_model_meta_config(global_inm_policy_schema, 'document_question_extracts')['global_inm_policy_schema']
    File "_udf_code.py", line 13, in get_model_meta_config
      for model in yaml_config['models']:
  TypeError: 'NoneType' object is not subscriptable
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m13:09:59.731347 [info ] [Dummy-1   ]: 
[0m13:09:59.731907 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:09:59.733903 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.138621, "process_in_blocks": "0", "process_kernel_time": 1.49, "process_mem_max_rss": "436876", "process_out_blocks": "0", "process_user_time": 6.05}
[0m13:09:59.734626 [debug] [Dummy-1   ]: Command `cli run` failed at 13:09:59.734349 after 12.14 seconds
[0m13:09:59.735206 [debug] [Dummy-1   ]: Flushing usage events


============================== 13:15:50.777062 | 1b495269-d4ef-4def-8458-365797d67a2d ==============================
[0m13:15:50.777062 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m13:15:50.778215 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m13:15:51.166239 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m13:15:51.951011 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:15:52.365630 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:52.366896 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m13:15:53.391312 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m13:15:53.394525 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m13:15:53.445496 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m13:15:53.450235 [info ] [Dummy-1   ]: 
[0m13:15:53.450934 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m13:15:53.451420 [info ] [Dummy-1   ]: 
[0m13:15:53.452299 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m13:15:53.460914 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m13:15:53.768502 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:15:53.769350 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:15:53.769883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:55.180258 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.410 seconds
[0m13:15:55.187301 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:15:55.188027 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m13:15:55.440830 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.252 seconds
[0m13:15:55.443884 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:15:55.444584 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:15:55.798606 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.353 seconds
[0m13:15:55.801393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m13:15:55.814273 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:15:55.815033 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:15:55.815654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:57.604110 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.788 seconds
[0m13:15:57.606739 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:15:57.607406 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m13:15:57.713959 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.106 seconds
[0m13:15:57.716467 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:15:57.717092 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:15:57.824371 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.107 seconds
[0m13:15:57.832526 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m13:15:57.833409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m13:15:57.834046 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m13:15:57.855052 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m13:15:57.856049 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m13:15:57.857188 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m13:15:57.858490 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m13:15:57.859388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m13:15:57.860004 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m13:15:57.872132 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m13:15:57.873080 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m13:15:57.874184 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m13:15:57.875415 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m13:15:57.876510 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m13:15:57.877119 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m13:15:57.890815 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m13:15:57.891764 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m13:15:57.892888 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m13:15:57.894127 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m13:15:57.895191 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m13:15:57.895845 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m13:15:57.917260 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m13:15:57.918256 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m13:15:57.919446 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m13:15:57.920661 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m13:15:57.921523 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m13:15:57.922124 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m13:15:57.935395 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m13:15:57.936380 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m13:15:57.937452 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m13:15:57.938705 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m13:15:57.939549 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m13:15:57.940187 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m13:15:57.954892 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m13:15:57.955852 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m13:15:57.956959 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m13:15:57.958149 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m13:15:57.959066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m13:15:57.959687 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m13:15:57.972935 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m13:15:57.973893 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m13:15:57.974957 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m13:15:57.976068 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m13:15:57.976946 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m13:15:57.977544 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m13:15:57.992182 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m13:15:57.993128 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m13:15:57.994225 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m13:15:57.995318 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m13:15:57.996174 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m13:15:57.996774 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m13:15:58.010102 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m13:15:58.011054 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m13:15:58.012141 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m13:15:58.013261 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m13:15:58.014065 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m13:15:58.014652 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m13:15:58.029277 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m13:15:58.030204 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m13:15:58.031257 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m13:15:58.032424 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m13:15:58.033246 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m13:15:58.033845 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m13:15:58.046904 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m13:15:58.047866 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m13:15:58.049028 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m13:15:58.050164 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m13:15:58.051003 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m13:15:58.051601 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m13:15:58.064843 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m13:15:58.065767 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m13:15:58.066820 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m13:15:58.067948 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m13:15:58.068869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m13:15:58.069501 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m13:15:58.084237 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m13:15:58.085170 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m13:15:58.086225 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m13:15:58.087592 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m13:15:58.088532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m13:15:58.089189 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m13:15:58.105407 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m13:15:58.106346 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m13:15:58.107436 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m13:15:58.108761 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m13:15:58.109639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m13:15:58.110251 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m13:15:58.123948 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m13:15:58.124893 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m13:15:58.125965 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m13:15:58.127348 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m13:15:58.128252 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m13:15:58.129081 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m13:15:58.168522 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m13:15:58.169726 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m13:15:58.170978 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m13:15:58.172234 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m13:15:58.173359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m13:15:58.174017 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m13:15:58.188620 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m13:15:58.189570 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m13:15:58.190642 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m13:15:58.191869 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m13:15:58.193077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m13:15:58.193708 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m13:15:58.207324 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m13:15:58.208271 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m13:15:58.209417 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m13:15:58.210622 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m13:15:58.211459 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m13:15:58.212087 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m13:15:58.226556 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m13:15:58.227452 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m13:15:58.228567 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m13:15:58.229737 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m13:15:58.230510 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m13:15:58.231100 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m13:15:58.243458 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m13:15:58.244410 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m13:15:58.245441 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m13:15:58.246624 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m13:15:58.247439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m13:15:58.248054 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m13:15:58.260061 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m13:15:58.260972 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m13:15:58.262001 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m13:15:58.263197 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m13:15:58.264422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m13:15:58.265037 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m13:15:58.279638 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m13:15:58.280569 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m13:15:58.281617 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m13:15:58.282772 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m13:15:58.283571 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m13:15:58.284179 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m13:15:58.297020 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m13:15:58.297933 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m13:15:58.299075 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m13:15:58.300267 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m13:15:58.301066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m13:15:58.301648 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m13:15:58.315142 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m13:15:58.316084 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m13:15:58.317132 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m13:15:58.318292 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m13:15:58.319174 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m13:15:58.319753 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m13:15:58.332432 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m13:15:58.333360 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m13:15:58.334412 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m13:15:58.335597 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m13:15:58.336443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m13:15:58.337029 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m13:15:58.350422 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m13:15:58.351312 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m13:15:58.352353 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m13:15:58.353542 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m13:15:58.354357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m13:15:58.354954 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m13:15:58.371351 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m13:15:58.372332 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m13:15:58.373381 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m13:15:58.374537 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m13:15:58.375339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m13:15:58.375944 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m13:15:58.390569 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m13:15:58.391491 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m13:15:58.392563 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m13:15:58.393724 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m13:15:58.394513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m13:15:58.395096 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m13:15:58.409880 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m13:15:58.410778 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m13:15:58.411792 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m13:15:58.413179 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m13:15:58.414006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m13:15:58.414595 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m13:15:58.427337 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m13:15:58.428285 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m13:15:58.429425 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m13:15:58.430605 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m13:15:58.431411 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m13:15:58.432015 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m13:15:58.446544 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m13:15:58.447485 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m13:15:58.448634 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m13:15:58.449812 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m13:15:58.450602 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m13:15:58.451182 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m13:15:58.464058 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m13:15:58.464956 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m13:15:58.465976 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m13:15:58.467127 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m13:15:58.467953 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m13:15:58.468631 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m13:15:58.482923 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m13:15:58.483833 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m13:15:58.484882 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m13:15:58.486020 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m13:15:58.486834 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m13:15:58.487434 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m13:15:58.500572 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m13:15:58.501503 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m13:15:58.502541 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m13:15:58.505177 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m13:15:58.505729 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m13:15:58.511905 [debug] [Dummy-1   ]: Command end result
[0m13:15:58.558034 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m13:15:58.560947 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m13:15:58.572028 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m13:15:58.574132 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 7.8970575, "process_in_blocks": "0", "process_kernel_time": 1.42, "process_mem_max_rss": "436684", "process_out_blocks": "0", "process_user_time": 7.1}
[0m13:15:58.574882 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 13:15:58.574591 after 7.90 seconds
[0m13:15:58.575462 [debug] [Dummy-1   ]: Flushing usage events


============================== 13:16:46.161722 | 264ee1d1-1bf6-40a6-9699-f18700c15104 ==============================
[0m13:16:46.161722 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m13:16:46.162972 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:16:46.563238 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m13:16:47.333884 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:16:47.758496 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:16:47.759224 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m13:16:47.976160 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m13:16:47.979204 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m13:16:48.040965 [info ] [Dummy-1   ]: Found 13 models, 21 data tests, 6 sources, 483 macros
[0m13:16:48.044742 [info ] [Dummy-1   ]: 
[0m13:16:48.045436 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m13:16:48.045978 [info ] [Dummy-1   ]: 
[0m13:16:48.046981 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m13:16:48.054617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m13:16:48.212539 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m13:16:48.213225 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m13:16:48.213839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:49.037627 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.824 seconds
[0m13:16:49.048332 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m13:16:49.073047 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:16:49.073810 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:16:49.074376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:50.062337 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.988 seconds
[0m13:16:50.068777 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:16:50.069513 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m13:16:50.236456 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.166 seconds
[0m13:16:50.239414 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m13:16:50.240035 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:16:50.332586 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.092 seconds
[0m13:16:50.335312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m13:16:50.348212 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:16:50.348980 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:16:50.349501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:51.253257 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.904 seconds
[0m13:16:51.255892 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:16:51.256561 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m13:16:51.379546 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.122 seconds
[0m13:16:51.382076 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m13:16:51.382709 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:16:51.513450 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.130 seconds
[0m13:16:51.521682 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m13:16:51.522716 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m13:16:51.523555 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m13:16:51.524197 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m13:16:51.543822 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m13:16:51.544825 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m13:16:51.605912 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m13:16:51.607920 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m13:16:51.608744 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m13:16:51.609418 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:16:52.785312 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.176 seconds
[0m13:16:52.822162 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.30s]
[0m13:16:52.823203 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m13:16:52.825363 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m13:16:52.826598 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m13:16:52.827417 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m13:16:52.828159 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m13:16:52.869296 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m13:16:52.870497 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m13:16:52.914578 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m13:16:52.918217 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m13:16:52.919775 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

    
def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    docs_stage = dbt.config.get("docs_stage_path")
    global_inm_policy_schema = dbt.config.get("meta")['global_inm_policy_schema']

    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS'), F.col('relative_path')),
            global_inm_policy_schema
        )
    )    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'docs_stage_path': None, 'meta': {'global_inm_policy_schema': {'schema': {'type': 'object', 'properties': {'purpose': {'description': 'Purpose of this policy', 'type': 'string'}, 'objectives': {'description': 'Objectives achieved by this policy', 'type': 'string'}, 'policy_statement': {'description': 'Primary policy statement', 'type': 'string'}, 'in_scope_services': {'description': 'Services explicitly in scope', 'type': 'array'}, 'out_of_scope_services': {'description': 'Services explicitly out of scope', 'type': 'array'}, 'geographical_coverage': {'description': 'Countries/regions covered', 'type': 'array'}, 'business_units_in_scope': {'description': 'Business units covered by the policy', 'type': 'array'}, 'applicability_conditions': {'description': 'Conditions determining when policy applies', 'type': 'array'}, 'exclusions': {'description': 'Explicit exceptions to scope', 'type': 'array'}, 'definitions_and_glossary': {'description': 'Terms, acronyms, and reference standards', 'type': 'object', 'properties': {'defined_terms': {'description': 'Key defined terms', 'type': 'array'}, 'acronyms': {'description': 'Acronyms used within the document', 'type': 'array'}, 'reference_standards': {'description': 'Referenced standards and frameworks', 'type': 'array'}}}}}}}}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m13:16:52.920882 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:18:15.868704 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 82.947 seconds
[0m13:18:15.873052 [info ] [Thread-2 (]: 2 of 2 OK created python table model bronze_zone.document_question_extracts .... [[32mSUCCESS 1[0m in 83.05s]
[0m13:18:15.874200 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m13:18:15.877092 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m13:18:15.877643 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m13:18:15.878102 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m13:18:15.879131 [info ] [Dummy-1   ]: 
[0m13:18:15.879679 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 1 minutes and 27.83 seconds (87.83s).
[0m13:18:15.880853 [debug] [Dummy-1   ]: Command end result
[0m13:18:15.928046 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m13:18:15.931031 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m13:18:15.939337 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m13:18:15.939916 [info ] [Dummy-1   ]: 
[0m13:18:15.940642 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m13:18:15.941130 [info ] [Dummy-1   ]: 
[0m13:18:15.941652 [info ] [Dummy-1   ]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:18:15.943540 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 89.885124, "process_in_blocks": "0", "process_kernel_time": 1.45, "process_mem_max_rss": "434988", "process_out_blocks": "0", "process_user_time": 6.38}
[0m13:18:15.944236 [debug] [Dummy-1   ]: Command `cli run` succeeded at 13:18:15.943968 after 89.89 seconds
[0m13:18:15.944792 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:37:56.094865 | 190dba6c-0172-4beb-bff8-176fc8c89314 ==============================
[0m11:37:56.094865 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:37:56.095914 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:37:56.463682 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:37:57.251512 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:37:57.544566 [info ] [Dummy-1   ]: Unable to do partial parsing because a project config has changed
[0m11:38:00.267315 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:38:00.270360 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:38:00.317592 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m11:38:00.321982 [info ] [Dummy-1   ]: 
[0m11:38:00.322686 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:38:00.323245 [info ] [Dummy-1   ]: 
[0m11:38:00.324054 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:38:00.332111 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m11:38:00.472098 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:38:00.472794 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:38:00.473331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:01.650572 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.177 seconds
[0m11:38:01.656401 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:38:01.657006 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:38:01.760830 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.103 seconds
[0m11:38:01.764088 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:38:01.764670 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:38:01.851680 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.086 seconds
[0m11:38:01.854121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m11:38:01.864620 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:38:01.865284 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:38:01.865780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:03.052220 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.186 seconds
[0m11:38:03.054690 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:38:03.055303 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:38:03.298289 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.242 seconds
[0m11:38:03.301108 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:38:03.301699 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:38:03.449038 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.147 seconds
[0m11:38:03.459955 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m11:38:03.460793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m11:38:03.461402 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m11:38:03.481692 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m11:38:03.482646 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m11:38:03.483736 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m11:38:03.484964 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:38:03.485815 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m11:38:03.486394 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:38:03.498109 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:38:03.499046 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:38:03.500079 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:38:03.501229 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m11:38:03.502333 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m11:38:03.502967 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m11:38:03.517799 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m11:38:03.518729 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m11:38:03.519836 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m11:38:03.521005 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:38:03.522051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m11:38:03.522702 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:38:03.541487 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m11:38:03.542417 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:38:03.543476 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:38:03.544616 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:38:03.545424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m11:38:03.546014 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:38:03.560155 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m11:38:03.561015 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:38:03.562011 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:38:03.563134 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:38:03.563927 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m11:38:03.564722 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:38:03.577257 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m11:38:03.578112 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:38:03.579165 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:38:03.580215 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:38:03.580992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m11:38:03.581565 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:38:03.594130 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m11:38:03.595014 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:38:03.596012 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:38:03.597044 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:38:03.597820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m11:38:03.598421 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:38:03.612685 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m11:38:03.613570 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:38:03.614571 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:38:03.615615 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:38:03.616410 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m11:38:03.616990 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:38:03.629631 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m11:38:03.630482 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:38:03.631482 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:38:03.632531 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:38:03.633267 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m11:38:03.633831 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:38:03.647818 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m11:38:03.648727 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:38:03.649715 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:38:03.650757 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:38:03.651527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m11:38:03.652102 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:38:03.664633 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m11:38:03.665515 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:38:03.666484 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:38:03.667528 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:38:03.668250 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m11:38:03.668849 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:38:03.682474 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m11:38:03.683309 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:38:03.684271 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:38:03.685264 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:38:03.685973 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m11:38:03.686528 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:38:03.698906 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m11:38:03.699715 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:38:03.700663 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:38:03.701654 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:38:03.702401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m11:38:03.702980 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:38:03.719313 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m11:38:03.720131 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:38:03.721096 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:38:03.722173 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m11:38:03.722925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m11:38:03.723533 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m11:38:03.740236 [debug] [Thread-2 (]: Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }
[0m11:38:03.741218 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m11:38:03.742492 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m11:38:03.743318 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_full_extracts' to be skipped because of status 'error'.  Reason: Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }.
[0m11:38:03.744052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m11:38:03.745502 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:38:03.746282 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m11:38:03.746818 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m11:38:03.780401 [error] [Dummy-1   ]: Encountered an error:
Runtime Error
  Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
    Required var 'parse_mode' not found in config:
    Vars supplied to document_full_extracts = {
        "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
        "supported_doc_formats": [
            "pdf",
            "docx",
            "doc",
            "txt",
            "text",
            "html",
            "md",
            "pptx",
            "ppt",
            "png",
            "eml",
            "jpg",
            "jpeg",
            "gif",
            "bmp",
            "tiff",
            "tif",
            "webp",
            "htm"
        ]
    }
[0m11:38:03.781175 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m11:38:03.783439 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m11:38:03.784336 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 7.7847238, "process_in_blocks": "0", "process_kernel_time": 1.27, "process_mem_max_rss": "486812", "process_out_blocks": "0", "process_user_time": 7.83}
[0m11:38:03.785493 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m11:38:03.786202 [debug] [Dummy-1   ]: Command `cli compile` failed at 11:38:03.785926 after 7.79 seconds
[0m11:38:03.787308 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m11:38:03.788023 [debug] [Dummy-1   ]: Flushing usage events
[0m11:38:03.788840 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.incident_management.incidents'
[0m11:38:03.790580 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m11:38:03.805362 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m11:38:03.806545 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m11:38:03.807710 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents


============================== 11:38:31.614621 | f0f42373-48cd-45c8-85c2-6c6ac3c6a01c ==============================
[0m11:38:31.614621 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:38:31.615757 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m11:38:31.997458 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:38:32.798337 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:38:33.202256 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:33.203032 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:33.415144 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:38:33.418243 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:38:33.478597 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m11:38:33.482373 [info ] [Dummy-1   ]: 
[0m11:38:33.483064 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:38:33.483591 [info ] [Dummy-1   ]: 
[0m11:38:33.484517 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:38:33.491809 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m11:38:33.644852 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m11:38:33.645594 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m11:38:33.646144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:34.546084 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.900 seconds
[0m11:38:34.569995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m11:38:34.593934 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:38:34.594578 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:38:34.595074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:35.386263 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.791 seconds
[0m11:38:35.392287 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:38:35.392979 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:38:35.496508 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.103 seconds
[0m11:38:35.499134 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:38:35.499763 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:38:35.622320 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.122 seconds
[0m11:38:35.624773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m11:38:35.635651 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:38:35.636291 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:38:35.636832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:36.693135 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.056 seconds
[0m11:38:36.695780 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:38:36.696436 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:38:36.807123 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.110 seconds
[0m11:38:36.809989 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:38:36.810603 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:38:36.896202 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.085 seconds
[0m11:38:36.906487 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:38:36.907948 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m11:38:36.908869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m11:38:36.909507 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:38:36.928564 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:38:36.929595 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:38:36.990208 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m11:38:36.992224 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m11:38:36.992996 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m11:38:36.993657 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:38:38.005256 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.011 seconds
[0m11:38:38.041430 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.13s]
[0m11:38:38.042477 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:38:38.044488 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m11:38:38.045630 [info ] [Thread-2 (]: 2 of 2 START sql table model bronze_zone.document_full_extracts ................ [RUN]
[0m11:38:38.046437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_full_extracts)
[0m11:38:38.047074 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m11:38:38.066118 [debug] [Thread-2 (]: Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }
[0m11:38:38.067704 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model bronze_zone.document_full_extracts ....... [[31mERROR[0m in 0.02s]
[0m11:38:38.068720 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m11:38:38.070193 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_full_extracts' to be skipped because of status 'error'.  Reason: Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }.
[0m11:38:38.073294 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:38:38.073910 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m11:38:38.074382 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_full_extracts' was properly closed.
[0m11:38:38.074915 [info ] [Dummy-1   ]: 
[0m11:38:38.075449 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m11:38:38.076593 [debug] [Dummy-1   ]: Command end result
[0m11:38:38.123042 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:38:38.125852 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:38:38.134169 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:38:38.134773 [info ] [Dummy-1   ]: 
[0m11:38:38.135440 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:38:38.135960 [info ] [Dummy-1   ]: 
[0m11:38:38.136806 [error] [Dummy-1   ]:   Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }
[0m11:38:38.137438 [info ] [Dummy-1   ]: 
[0m11:38:38.137989 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:38:38.139858 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.624098, "process_in_blocks": "0", "process_kernel_time": 1.31, "process_mem_max_rss": "433568", "process_out_blocks": "0", "process_user_time": 5.9}
[0m11:38:38.140556 [debug] [Dummy-1   ]: Command `cli run` failed at 11:38:38.140285 after 6.63 seconds
[0m11:38:38.141178 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:39:43.042032 | 47d78cba-5375-4341-85cb-415550199b08 ==============================
[0m11:39:43.042032 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:39:43.043116 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:39:43.416400 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:39:44.215085 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:39:44.623473 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:39:44.624864 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/document_full_extracts.yml
[0m11:39:45.658841 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:39:45.661692 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:39:45.719927 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m11:39:45.723475 [info ] [Dummy-1   ]: 
[0m11:39:45.724094 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:39:45.724567 [info ] [Dummy-1   ]: 
[0m11:39:45.725507 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:39:45.732892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m11:39:46.019327 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m11:39:46.020068 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m11:39:46.020635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:47.404866 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.384 seconds
[0m11:39:47.429879 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m11:39:47.453553 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:39:47.454323 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:39:47.454878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:48.913961 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.459 seconds
[0m11:39:48.919956 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:39:48.920585 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:39:49.138273 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.217 seconds
[0m11:39:49.140865 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:39:49.141476 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:39:49.432602 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.290 seconds
[0m11:39:49.435061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m11:39:49.445797 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:39:49.446415 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:39:49.446921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:50.978296 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.531 seconds
[0m11:39:50.980978 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:39:50.981589 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:39:51.197392 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.215 seconds
[0m11:39:51.200271 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:39:51.200932 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:39:51.410337 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.209 seconds
[0m11:39:51.419980 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:39:51.421449 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m11:39:51.422264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m11:39:51.422880 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:39:51.442044 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:39:51.443174 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:39:51.503243 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m11:39:51.505198 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m11:39:51.505907 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m11:39:51.506539 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:39:53.315408 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.809 seconds
[0m11:39:53.350785 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.93s]
[0m11:39:53.351819 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:39:53.353878 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m11:39:53.354943 [info ] [Thread-2 (]: 2 of 2 START sql table model bronze_zone.document_full_extracts ................ [RUN]
[0m11:39:53.355732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_full_extracts)
[0m11:39:53.356303 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m11:39:53.374760 [debug] [Thread-2 (]: Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }
[0m11:39:53.376199 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model bronze_zone.document_full_extracts ....... [[31mERROR[0m in 0.02s]
[0m11:39:53.377142 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m11:39:53.378582 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_full_extracts' to be skipped because of status 'error'.  Reason: Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }.
[0m11:39:53.381541 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:39:53.382077 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m11:39:53.382526 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_full_extracts' was properly closed.
[0m11:39:53.383039 [info ] [Dummy-1   ]: 
[0m11:39:53.383555 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.66 seconds (7.66s).
[0m11:39:53.384677 [debug] [Dummy-1   ]: Command end result
[0m11:39:53.430740 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:39:53.433426 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:39:53.441231 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:39:53.441798 [info ] [Dummy-1   ]: 
[0m11:39:53.442453 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:39:53.442959 [info ] [Dummy-1   ]: 
[0m11:39:53.443736 [error] [Dummy-1   ]:   Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }
[0m11:39:53.444292 [info ] [Dummy-1   ]: 
[0m11:39:53.444837 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:39:53.446710 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.501802, "process_in_blocks": "0", "process_kernel_time": 1.57, "process_mem_max_rss": "496844", "process_out_blocks": "0", "process_user_time": 6.66}
[0m11:39:53.447386 [debug] [Dummy-1   ]: Command `cli run` failed at 11:39:53.447120 after 10.50 seconds
[0m11:39:53.447945 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:40:33.136123 | 48dda390-5be4-41ea-8ba8-866b5cd2fa7f ==============================
[0m11:40:33.136123 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:40:33.137332 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m11:40:33.517025 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:40:34.328649 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:40:34.737239 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:40:34.737988 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m11:40:34.952879 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:40:34.955975 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:40:35.005037 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m11:40:35.009711 [info ] [Dummy-1   ]: 
[0m11:40:35.010345 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:40:35.010861 [info ] [Dummy-1   ]: 
[0m11:40:35.011830 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:40:35.021113 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m11:40:35.163628 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:40:35.164322 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:40:35.164940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:36.041076 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.876 seconds
[0m11:40:36.047018 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:40:36.047712 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:40:36.173040 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.125 seconds
[0m11:40:36.175883 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:40:36.176478 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:40:36.270112 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m11:40:36.272785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m11:40:36.286779 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:40:36.287502 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:40:36.288063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:37.089150 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.801 seconds
[0m11:40:37.091637 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:40:37.092250 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:40:37.170597 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.078 seconds
[0m11:40:37.173035 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:40:37.173641 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:40:37.256532 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.082 seconds
[0m11:40:37.264414 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m11:40:37.265288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m11:40:37.265905 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m11:40:37.284271 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m11:40:37.285304 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m11:40:37.286415 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m11:40:37.287652 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:40:37.288554 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m11:40:37.289187 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:40:37.302587 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:40:37.303537 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:40:37.304629 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:40:37.305996 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m11:40:37.307049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m11:40:37.307652 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m11:40:37.321278 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m11:40:37.322217 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m11:40:37.323310 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m11:40:37.324518 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:40:37.325658 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m11:40:37.326296 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:40:37.351721 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m11:40:37.352683 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:40:37.353799 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:40:37.354992 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:40:37.355846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m11:40:37.356441 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:40:37.369756 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m11:40:37.370687 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:40:37.371751 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:40:37.372974 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:40:37.373798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m11:40:37.374395 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:40:37.388732 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m11:40:37.389769 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:40:37.390888 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:40:37.391997 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:40:37.392891 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m11:40:37.393562 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:40:37.406527 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m11:40:37.407602 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:40:37.408762 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:40:37.409881 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:40:37.410751 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m11:40:37.411388 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:40:37.424421 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m11:40:37.425459 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:40:37.426507 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:40:37.427636 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:40:37.428523 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m11:40:37.429214 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:40:37.443630 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m11:40:37.444560 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:40:37.445614 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:40:37.446689 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:40:37.447556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m11:40:37.448227 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:40:37.461063 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m11:40:37.462112 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:40:37.463152 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:40:37.464277 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:40:37.465101 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m11:40:37.465797 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:40:37.480200 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m11:40:37.481267 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:40:37.482316 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:40:37.483423 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:40:37.484323 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m11:40:37.484953 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:40:37.498244 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m11:40:37.499324 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:40:37.500406 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:40:37.501536 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:40:37.502342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m11:40:37.502928 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:40:37.516975 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m11:40:37.517875 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:40:37.518957 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:40:37.520137 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:40:37.521007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m11:40:37.521608 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:40:37.537462 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m11:40:37.538560 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:40:37.539640 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:40:37.540804 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m11:40:37.541667 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m11:40:37.542261 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m11:40:37.560075 [debug] [Thread-2 (]: Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }
[0m11:40:37.561220 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m11:40:37.565083 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m11:40:37.565993 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_full_extracts' to be skipped because of status 'error'.  Reason: Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }.
[0m11:40:37.566861 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m11:40:37.568600 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:40:37.569460 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m11:40:37.570045 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m11:40:37.604131 [error] [Dummy-1   ]: Encountered an error:
Runtime Error
  Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
    Required var 'parse_mode' not found in config:
    Vars supplied to document_full_extracts = {
        "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
        "supported_doc_formats": [
            "pdf",
            "docx",
            "doc",
            "txt",
            "text",
            "html",
            "md",
            "pptx",
            "ppt",
            "png",
            "eml",
            "jpg",
            "jpeg",
            "gif",
            "bmp",
            "tiff",
            "tif",
            "webp",
            "htm"
        ]
    }
[0m11:40:37.612316 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m11:40:37.615125 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 4.577916, "process_in_blocks": "0", "process_kernel_time": 1.44, "process_mem_max_rss": "439912", "process_out_blocks": "0", "process_user_time": 5.63}
[0m11:40:37.615936 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m11:40:37.616797 [debug] [Dummy-1   ]: Command `cli compile` failed at 11:40:37.616494 after 4.58 seconds
[0m11:40:37.619130 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m11:40:37.619910 [debug] [Dummy-1   ]: Flushing usage events
[0m11:40:37.621244 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m11:40:37.623604 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.incident_management.incidents'
[0m11:40:37.624539 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m11:40:37.638530 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m11:40:37.639846 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m11:40:37.641001 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents


============================== 11:40:50.195828 | 51f96a04-94ba-47ae-a5c5-0fa197417301 ==============================
[0m11:40:50.195828 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:40:50.196941 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:40:50.576221 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:40:51.304356 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:40:51.718750 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:40:51.719466 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m11:40:51.929253 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:40:51.932458 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:40:51.991680 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m11:40:51.995283 [info ] [Dummy-1   ]: 
[0m11:40:51.995986 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:40:51.996566 [info ] [Dummy-1   ]: 
[0m11:40:51.997456 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:40:52.004615 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m11:40:52.154856 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m11:40:52.155588 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m11:40:52.156125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:52.970424 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.814 seconds
[0m11:40:52.975595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m11:40:52.999813 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:40:53.000500 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:40:53.001063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:53.916830 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.916 seconds
[0m11:40:53.922721 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:40:53.923359 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:40:54.012098 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.088 seconds
[0m11:40:54.014483 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:40:54.015081 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:40:54.114690 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m11:40:54.117036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m11:40:54.127683 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:40:54.128292 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:40:54.128873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:54.919911 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.791 seconds
[0m11:40:54.922425 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:40:54.923098 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:40:55.033960 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.110 seconds
[0m11:40:55.036727 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:40:55.037318 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:40:55.136288 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m11:40:55.158678 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:40:55.160169 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m11:40:55.160994 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m11:40:55.161614 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:40:55.180504 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:40:55.181434 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:40:55.239150 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m11:40:55.241047 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m11:40:55.241781 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m11:40:55.242408 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:40:56.256836 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.014 seconds
[0m11:40:56.292593 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.13s]
[0m11:40:56.293587 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:40:56.295404 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m11:40:56.296345 [info ] [Thread-2 (]: 2 of 2 START sql table model bronze_zone.document_full_extracts ................ [RUN]
[0m11:40:56.297106 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_full_extracts)
[0m11:40:56.297691 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m11:40:56.314270 [debug] [Thread-2 (]: Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }
[0m11:40:56.315663 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model bronze_zone.document_full_extracts ....... [[31mERROR[0m in 0.02s]
[0m11:40:56.316568 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m11:40:56.317872 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_full_extracts' to be skipped because of status 'error'.  Reason: Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }.
[0m11:40:56.320654 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:40:56.321162 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_full_extracts' was properly closed.
[0m11:40:56.321673 [info ] [Dummy-1   ]: 
[0m11:40:56.322194 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m11:40:56.323289 [debug] [Dummy-1   ]: Command end result
[0m11:40:56.368318 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:40:56.370968 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:40:56.378826 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:40:56.379400 [info ] [Dummy-1   ]: 
[0m11:40:56.380050 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:40:56.380557 [info ] [Dummy-1   ]: 
[0m11:40:56.381325 [error] [Dummy-1   ]:   Compilation Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  Required var 'parse_mode' not found in config:
  Vars supplied to document_full_extracts = {
      "docs_stage_path": "@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS",
      "supported_doc_formats": [
          "pdf",
          "docx",
          "doc",
          "txt",
          "text",
          "html",
          "md",
          "pptx",
          "ppt",
          "png",
          "eml",
          "jpg",
          "jpeg",
          "gif",
          "bmp",
          "tiff",
          "tif",
          "webp",
          "htm"
      ]
  }
[0m11:40:56.381861 [info ] [Dummy-1   ]: 
[0m11:40:56.382445 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:40:56.384323 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.2870107, "process_in_blocks": "0", "process_kernel_time": 1.36, "process_mem_max_rss": "435420", "process_out_blocks": "0", "process_user_time": 5.63}
[0m11:40:56.385008 [debug] [Dummy-1   ]: Command `cli run` failed at 11:40:56.384732 after 6.29 seconds
[0m11:40:56.385565 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:49:23.464099 | 2c6913f1-0158-41dd-a426-19a05e956ef6 ==============================
[0m11:49:23.464099 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:49:23.465276 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:49:23.847365 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:49:24.642276 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:49:24.972898 [info ] [Dummy-1   ]: Unable to do partial parsing because a project config has changed
[0m11:49:27.826447 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:49:27.829755 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:49:27.881511 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m11:49:27.886214 [info ] [Dummy-1   ]: 
[0m11:49:27.886958 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:49:27.887495 [info ] [Dummy-1   ]: 
[0m11:49:27.888518 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:49:27.897099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m11:49:28.048889 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:49:28.049644 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:49:28.050200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:29.102250 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.052 seconds
[0m11:49:29.108193 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:49:29.108960 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:49:29.273261 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.164 seconds
[0m11:49:29.277053 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:49:29.277672 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:49:29.460673 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.182 seconds
[0m11:49:29.463418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m11:49:29.476196 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:49:29.476862 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:49:29.477378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:30.712067 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.234 seconds
[0m11:49:30.714628 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:49:30.715250 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:49:30.868326 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.152 seconds
[0m11:49:30.870905 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:49:30.871499 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:49:31.020648 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.148 seconds
[0m11:49:31.028630 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m11:49:31.029491 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m11:49:31.030098 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m11:49:31.050536 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m11:49:31.051505 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m11:49:31.052576 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m11:49:31.053814 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:49:31.054665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m11:49:31.055232 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:49:31.067188 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:49:31.068090 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:49:31.069225 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:49:31.070415 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m11:49:31.071508 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m11:49:31.072134 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m11:49:31.085688 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m11:49:31.086603 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m11:49:31.087639 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m11:49:31.088874 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:49:31.090000 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m11:49:31.090628 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:49:31.111236 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m11:49:31.112199 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:49:31.113278 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m11:49:31.114454 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:49:31.115292 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m11:49:31.115885 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:49:31.129109 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m11:49:31.130033 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:49:31.131034 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m11:49:31.132182 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:49:31.132998 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m11:49:31.133587 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:49:31.147841 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m11:49:31.148832 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:49:31.149886 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m11:49:31.150935 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:49:31.151723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m11:49:31.152291 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:49:31.165121 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m11:49:31.166023 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:49:31.167050 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m11:49:31.168081 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:49:31.168986 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m11:49:31.169587 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:49:31.183721 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m11:49:31.184628 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:49:31.185688 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m11:49:31.186742 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:49:31.187535 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m11:49:31.188120 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:49:31.201083 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m11:49:31.201983 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:49:31.202990 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m11:49:31.204306 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:49:31.205178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m11:49:31.205762 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:49:31.220054 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m11:49:31.220977 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:49:31.221974 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m11:49:31.223017 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:49:31.223761 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m11:49:31.224322 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:49:31.237087 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m11:49:31.238002 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:49:31.239093 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m11:49:31.240148 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:49:31.240945 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m11:49:31.241518 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:49:31.254309 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m11:49:31.255231 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:49:31.256216 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m11:49:31.257320 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:49:31.258092 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m11:49:31.258762 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:49:31.273050 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m11:49:31.273936 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:49:31.274919 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m11:49:31.275966 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:49:31.276717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m11:49:31.277559 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:49:31.293320 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m11:49:31.294206 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:49:31.295223 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m11:49:31.296323 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m11:49:31.297132 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m11:49:31.297701 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m11:49:31.312084 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m11:49:31.312997 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m11:49:31.314014 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m11:49:31.315319 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m11:49:31.316315 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m11:49:31.317034 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m11:49:31.350923 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m11:49:31.351974 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m11:49:31.353140 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m11:49:31.354345 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m11:49:31.355355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m11:49:31.355949 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m11:49:31.370337 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m11:49:31.371259 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m11:49:31.372272 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m11:49:31.373460 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m11:49:31.374619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6)
[0m11:49:31.375235 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m11:49:31.388080 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6"
[0m11:49:31.389092 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m11:49:31.390180 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m11:49:31.391313 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m11:49:31.392100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6, now test.incident_management.not_null_document_full_extracts_chunk.facaf6c655)
[0m11:49:31.392686 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m11:49:31.407236 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_chunk.facaf6c655"
[0m11:49:31.408077 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m11:49:31.409157 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m11:49:31.410307 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m11:49:31.411071 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_chunk.facaf6c655, now test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424)
[0m11:49:31.411636 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m11:49:31.424313 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424"
[0m11:49:31.425209 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m11:49:31.426213 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m11:49:31.427353 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:49:31.428113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m11:49:31.428801 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:49:31.441855 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m11:49:31.442764 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:49:31.443760 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m11:49:31.444905 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:49:31.445696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m11:49:31.446291 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:49:31.460886 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m11:49:31.461763 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:49:31.462756 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m11:49:31.463899 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m11:49:31.464668 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m11:49:31.465297 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m11:49:31.477395 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m11:49:31.478257 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m11:49:31.479366 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m11:49:31.480522 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m11:49:31.481348 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m11:49:31.481910 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m11:49:31.495038 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m11:49:31.495927 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m11:49:31.496940 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m11:49:31.498265 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m11:49:31.499403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m11:49:31.499974 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m11:49:31.512675 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m11:49:31.513582 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m11:49:31.514573 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m11:49:31.515697 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m11:49:31.516457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m11:49:31.517055 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m11:49:31.531199 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m11:49:31.532081 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m11:49:31.533093 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m11:49:31.534218 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m11:49:31.534973 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m11:49:31.535535 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m11:49:31.694850 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m11:49:31.695818 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m11:49:31.696847 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m11:49:31.698005 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m11:49:31.698901 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m11:49:31.699479 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m11:49:31.711876 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m11:49:31.712848 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m11:49:31.713883 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m11:49:31.715037 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m11:49:31.715893 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m11:49:31.716488 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m11:49:31.729945 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m11:49:31.730844 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m11:49:31.731860 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m11:49:31.733014 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:49:31.733782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m11:49:31.734352 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:49:31.747713 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m11:49:31.748708 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:49:31.749760 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m11:49:31.750876 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:49:31.751636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m11:49:31.752210 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:49:31.766869 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m11:49:31.767798 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:49:31.768897 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m11:49:31.770040 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:49:31.770900 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m11:49:31.771522 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:49:31.784240 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m11:49:31.785178 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:49:31.786188 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m11:49:31.787303 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:49:31.788061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m11:49:31.788713 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:49:31.801585 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m11:49:31.802506 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:49:31.803504 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m11:49:31.804655 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:49:31.805482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m11:49:31.806049 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:49:31.821541 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m11:49:31.822451 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:49:31.823452 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m11:49:31.824591 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:49:31.825382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m11:49:31.825946 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:49:31.838672 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m11:49:31.839566 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:49:31.840560 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m11:49:31.841730 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:49:31.842501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m11:49:31.843068 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:49:31.857653 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m11:49:31.858657 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:49:31.859690 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m11:49:31.860852 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:49:31.861655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m11:49:31.862238 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:49:31.874889 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m11:49:31.875819 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:49:31.876843 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m11:49:31.879483 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:49:31.880106 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m11:49:31.886606 [debug] [Dummy-1   ]: Command end result
[0m11:49:31.932934 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:49:31.935808 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:49:31.946756 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:49:31.948977 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 8.583788, "process_in_blocks": "0", "process_kernel_time": 1.33, "process_mem_max_rss": "483476", "process_out_blocks": "0", "process_user_time": 8.71}
[0m11:49:31.949738 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 11:49:31.949451 after 8.59 seconds
[0m11:49:31.950305 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:49:48.804857 | b9b0320f-5fee-431e-9564-eb624204f3eb ==============================
[0m11:49:48.804857 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:49:48.805993 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:49:49.186528 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m11:49:49.919383 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m11:49:50.339049 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:49:50.339784 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m11:49:50.552607 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:49:50.555577 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:49:50.617057 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m11:49:50.620775 [info ] [Dummy-1   ]: 
[0m11:49:50.621450 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m11:49:50.621980 [info ] [Dummy-1   ]: 
[0m11:49:50.622895 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m11:49:50.630662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m11:49:50.782618 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m11:49:50.783344 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m11:49:50.783911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:51.570689 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.787 seconds
[0m11:49:51.575909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m11:49:51.600173 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:49:51.600855 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:49:51.601365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:52.907246 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.306 seconds
[0m11:49:52.913224 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:49:52.913869 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m11:49:53.021585 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.107 seconds
[0m11:49:53.024145 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m11:49:53.024776 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:49:53.105392 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.080 seconds
[0m11:49:53.107817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m11:49:53.118648 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:49:53.119365 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:49:53.119937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:53.878687 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.758 seconds
[0m11:49:53.881211 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:49:53.881814 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m11:49:53.999542 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.117 seconds
[0m11:49:54.002336 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m11:49:54.002958 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:49:54.103121 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m11:49:54.112930 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m11:49:54.114377 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m11:49:54.115213 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m11:49:54.115825 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m11:49:54.135073 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m11:49:54.136041 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m11:49:54.195237 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m11:49:54.197200 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m11:49:54.197933 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m11:49:54.198663 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:49:55.242136 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.043 seconds
[0m11:49:55.277499 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.16s]
[0m11:49:55.279031 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m11:49:55.281203 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m11:49:55.282338 [info ] [Thread-2 (]: 2 of 2 START sql table model bronze_zone.document_full_extracts ................ [RUN]
[0m11:49:55.283169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_full_extracts)
[0m11:49:55.283764 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m11:49:55.298684 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m11:49:55.299652 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m11:49:55.339482 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.document_full_extracts"
[0m11:49:55.341985 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_full_extracts"
[0m11:49:55.342759 [debug] [Thread-2 (]: On model.incident_management.document_full_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_full_extracts"} */
create or replace transient table incident_management.bronze_zone.document_full_extracts
         as
        (

with 
documents_raw_extracts as(
    select
        *,
        AI_PARSE_DOCUMENT (
            TO_FILE('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS/full',relative_path),
            parse_mode => LAYOUT, 
            page_split => True
        ) as raw_extracts
        FROM incident_management.bronze_zone.v_qualify_new_documents
        WHERE doc_type = 'full'
),
documents_chunked_extracts as
(
    select 
    og1.* exclude (raw_extracts),
    SPLIT_TEXT_MARKDOWN_HEADER(
        lf1.value:content::STRING,
        OBJECT_CONSTRUCT('#', 'header_1', '##', 'header_2'),
        50,
        5
    ) as page_chunks,
    lf1.index::int as page_num
    from documents_raw_extracts og1,
    LATERAL FLATTEN(input => raw_extracts:pages) lf1
)

select 
    og2.* exclude (page_chunks),
    lf2.value['chunk']::varchar as chunk,
    lf2.value['headers']::object as headers
from documents_chunked_extracts og2
lateral flatten(input => page_chunks) lf2;
[0m11:49:55.343442 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:49:56.097903 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c04845-0106-f145-0032-3187053f12ee
[0m11:49:56.098732 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 37 at position 0 unexpected 'lateral'.
syntax error line 37 at position 38 unexpected 'lf2'.
[0m11:49:56.104265 [debug] [Thread-2 (]: Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 0 unexpected 'lateral'.
  syntax error line 37 at position 38 unexpected 'lf2'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql
[0m11:49:56.105735 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model bronze_zone.document_full_extracts ....... [[31mERROR[0m in 0.82s]
[0m11:49:56.106714 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m11:49:56.108181 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_full_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 0 unexpected 'lateral'.
  syntax error line 37 at position 38 unexpected 'lf2'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql.
[0m11:49:56.111223 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m11:49:56.111804 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m11:49:56.112269 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_full_extracts' was properly closed.
[0m11:49:56.112788 [info ] [Dummy-1   ]: 
[0m11:49:56.113312 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m11:49:56.114483 [debug] [Dummy-1   ]: Command end result
[0m11:49:56.160217 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m11:49:56.163063 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m11:49:56.171239 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m11:49:56.171809 [info ] [Dummy-1   ]: 
[0m11:49:56.172480 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:49:56.172991 [info ] [Dummy-1   ]: 
[0m11:49:56.173741 [error] [Dummy-1   ]:   Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 0 unexpected 'lateral'.
  syntax error line 37 at position 38 unexpected 'lf2'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql
[0m11:49:56.174284 [info ] [Dummy-1   ]: 
[0m11:49:56.174811 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:49:56.176695 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.4714203, "process_in_blocks": "0", "process_kernel_time": 1.35, "process_mem_max_rss": "432168", "process_out_blocks": "0", "process_user_time": 5.77}
[0m11:49:56.177391 [debug] [Dummy-1   ]: Command `cli run` failed at 11:49:56.177119 after 7.47 seconds
[0m11:49:56.177964 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:03:57.620119 | 59e3c941-6686-4b33-a949-621c21a94418 ==============================
[0m12:03:57.620119 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:03:57.621255 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m12:03:57.997682 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:03:58.825638 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:03:59.140983 [info ] [Dummy-1   ]: Unable to do partial parsing because a project config has changed
[0m12:04:02.064422 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:04:02.067678 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:04:02.119067 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m12:04:02.123854 [info ] [Dummy-1   ]: 
[0m12:04:02.124570 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:04:02.125097 [info ] [Dummy-1   ]: 
[0m12:04:02.126006 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:04:02.134872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m12:04:02.271324 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:04:02.272067 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:04:02.272605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:04.372535 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.100 seconds
[0m12:04:04.378643 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:04:04.379316 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m12:04:04.654141 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.274 seconds
[0m12:04:04.657822 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:04:04.658550 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:04:04.991737 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.332 seconds
[0m12:04:04.994336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m12:04:05.005071 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:04:05.005735 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:04:05.006272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:06.494208 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.488 seconds
[0m12:04:06.496868 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:04:06.497488 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m12:04:06.771262 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.273 seconds
[0m12:04:06.774179 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:04:06.774820 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:04:06.979109 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.204 seconds
[0m12:04:06.989882 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m12:04:06.990802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m12:04:06.991489 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m12:04:07.012560 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m12:04:07.013555 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m12:04:07.014670 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m12:04:07.016001 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m12:04:07.016928 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m12:04:07.017540 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m12:04:07.029742 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m12:04:07.030707 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m12:04:07.031802 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m12:04:07.033055 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m12:04:07.034214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m12:04:07.034847 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m12:04:07.048660 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m12:04:07.049644 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m12:04:07.050763 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m12:04:07.052092 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:04:07.053162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m12:04:07.053775 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:04:07.075261 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m12:04:07.076299 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:04:07.077419 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:04:07.078740 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:04:07.079685 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m12:04:07.080307 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:04:07.093677 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m12:04:07.094633 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:04:07.095734 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:04:07.097021 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:04:07.097887 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m12:04:07.098566 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:04:07.113486 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m12:04:07.114439 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:04:07.115573 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:04:07.116720 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:04:07.117572 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m12:04:07.118191 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:04:07.131421 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m12:04:07.132393 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:04:07.133463 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:04:07.134572 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:04:07.135488 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m12:04:07.136129 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:04:07.150606 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m12:04:07.151551 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:04:07.152622 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:04:07.153730 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:04:07.154557 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m12:04:07.155135 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:04:07.168176 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m12:04:07.169242 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:04:07.170309 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:04:07.171709 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:04:07.172558 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m12:04:07.173149 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:04:07.187807 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m12:04:07.188849 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:04:07.189925 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:04:07.191029 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:04:07.191883 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m12:04:07.192519 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:04:07.205473 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m12:04:07.206395 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:04:07.207452 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:04:07.208627 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:04:07.209432 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m12:04:07.210013 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:04:07.222995 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m12:04:07.223981 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:04:07.225051 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:04:07.226171 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:04:07.226997 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m12:04:07.227600 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:04:07.242416 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m12:04:07.243362 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:04:07.244469 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:04:07.245603 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:04:07.246457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m12:04:07.247336 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:04:07.263583 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m12:04:07.264543 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:04:07.265606 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:04:07.266772 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m12:04:07.267648 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m12:04:07.268239 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m12:04:07.283053 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m12:04:07.284048 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m12:04:07.285131 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m12:04:07.286522 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m12:04:07.287639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m12:04:07.288437 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m12:04:07.323166 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m12:04:07.324375 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m12:04:07.325621 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m12:04:07.326860 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m12:04:07.328007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m12:04:07.328711 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m12:04:07.343484 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m12:04:07.344488 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m12:04:07.345584 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m12:04:07.346822 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:04:07.347961 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6)
[0m12:04:07.348647 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:04:07.361805 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6"
[0m12:04:07.362760 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:04:07.363874 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:04:07.365117 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:04:07.365949 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6, now test.incident_management.not_null_document_full_extracts_chunk.facaf6c655)
[0m12:04:07.366550 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:04:07.381494 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_chunk.facaf6c655"
[0m12:04:07.382436 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:04:07.383494 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:04:07.384699 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:04:07.385508 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_chunk.facaf6c655, now test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424)
[0m12:04:07.386105 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:04:07.399138 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424"
[0m12:04:07.400113 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:04:07.401226 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:04:07.402455 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:04:07.403277 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m12:04:07.403901 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:04:07.417176 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m12:04:07.418149 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:04:07.419325 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:04:07.420571 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:04:07.421416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m12:04:07.422013 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:04:07.436886 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m12:04:07.437836 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:04:07.438970 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:04:07.440245 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m12:04:07.441072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m12:04:07.441651 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m12:04:07.453892 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m12:04:07.454824 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m12:04:07.455892 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m12:04:07.457103 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m12:04:07.457945 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m12:04:07.458593 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m12:04:07.471914 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m12:04:07.472853 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m12:04:07.473900 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m12:04:07.475304 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m12:04:07.476534 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m12:04:07.477176 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m12:04:07.489967 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m12:04:07.490884 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m12:04:07.491937 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m12:04:07.493114 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m12:04:07.493918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m12:04:07.494497 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m12:04:07.508766 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m12:04:07.509690 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m12:04:07.510722 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m12:04:07.511898 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m12:04:07.512684 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m12:04:07.513262 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m12:04:07.525059 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m12:04:07.525970 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m12:04:07.527004 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m12:04:07.528218 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m12:04:07.529127 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m12:04:07.529715 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m12:04:07.542156 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m12:04:07.543078 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m12:04:07.544133 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m12:04:07.545314 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m12:04:07.546104 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m12:04:07.546668 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m12:04:07.560363 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m12:04:07.561272 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m12:04:07.562305 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m12:04:07.563527 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:04:07.564430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m12:04:07.565045 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:04:07.578166 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m12:04:07.579188 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:04:07.580307 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:04:07.581488 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:04:07.582304 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m12:04:07.583070 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:04:07.597740 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m12:04:07.598762 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:04:07.599865 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:04:07.601090 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:04:07.601925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m12:04:07.602534 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:04:07.615395 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m12:04:07.616346 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:04:07.617423 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:04:07.618690 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:04:07.619568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m12:04:07.620162 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:04:07.634478 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m12:04:07.635479 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:04:07.636565 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:04:07.637779 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:04:07.638696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m12:04:07.639305 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:04:07.817551 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m12:04:07.818631 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:04:07.819747 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:04:07.820963 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:04:07.821787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m12:04:07.822369 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:04:07.835048 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m12:04:07.836010 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:04:07.837078 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:04:07.838248 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:04:07.839133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m12:04:07.839744 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:04:07.854155 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m12:04:07.855091 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:04:07.856163 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:04:07.857335 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:04:07.858143 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m12:04:07.858819 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:04:07.871550 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m12:04:07.872481 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:04:07.873525 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:04:07.876123 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:04:07.876798 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m12:04:07.883370 [debug] [Dummy-1   ]: Command end result
[0m12:04:07.929985 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:04:07.932997 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:04:07.944132 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:04:07.946262 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 10.42524, "process_in_blocks": "0", "process_kernel_time": 1.39, "process_mem_max_rss": "486448", "process_out_blocks": "0", "process_user_time": 9.01}
[0m12:04:07.947014 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 12:04:07.946723 after 10.43 seconds
[0m12:04:07.947638 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:04:27.936544 | 59754025-8278-45a3-9a15-6ea34260437b ==============================
[0m12:04:27.936544 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:04:27.937703 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m12:04:28.324619 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:04:29.101577 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:04:29.521360 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:04:29.522730 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_full_extracts.sql
[0m12:04:30.549214 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:04:30.552339 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:04:30.601130 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m12:04:30.605698 [info ] [Dummy-1   ]: 
[0m12:04:30.606393 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:04:30.606935 [info ] [Dummy-1   ]: 
[0m12:04:30.607819 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:04:30.616326 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m12:04:30.912624 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:04:30.913353 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:04:30.913928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:31.785928 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.872 seconds
[0m12:04:31.792883 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:04:31.793598 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m12:04:31.917170 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.123 seconds
[0m12:04:31.920189 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:04:31.920812 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:04:32.032956 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m12:04:32.035704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m12:04:32.048372 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:04:32.049050 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:04:32.049551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:32.868345 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.819 seconds
[0m12:04:32.870890 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:04:32.871517 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m12:04:32.966190 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.094 seconds
[0m12:04:32.968819 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:04:32.969457 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:04:33.076754 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.107 seconds
[0m12:04:33.084930 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m12:04:33.085834 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m12:04:33.086469 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m12:04:33.107835 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m12:04:33.108834 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m12:04:33.109985 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m12:04:33.111274 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m12:04:33.112193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m12:04:33.112792 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m12:04:33.124873 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m12:04:33.125801 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m12:04:33.126915 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m12:04:33.128199 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m12:04:33.129347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m12:04:33.129981 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m12:04:33.145185 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m12:04:33.146135 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m12:04:33.147221 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m12:04:33.148510 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:04:33.149569 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m12:04:33.150170 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:04:33.169691 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m12:04:33.170651 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:04:33.171755 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:04:33.172985 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:04:33.173868 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m12:04:33.174474 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:04:33.187908 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m12:04:33.188902 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:04:33.190004 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:04:33.191244 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:04:33.192101 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m12:04:33.192691 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:04:33.207793 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m12:04:33.208776 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:04:33.209870 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:04:33.210989 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:04:33.211851 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m12:04:33.212441 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:04:33.225479 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m12:04:33.226398 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:04:33.227451 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:04:33.228625 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:04:33.229494 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m12:04:33.230087 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:04:33.245026 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m12:04:33.245999 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:04:33.247103 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:04:33.248270 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:04:33.249185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m12:04:33.249805 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:04:33.263033 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m12:04:33.263981 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:04:33.265050 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:04:33.266409 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:04:33.267241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m12:04:33.267860 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:04:33.282371 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m12:04:33.283286 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:04:33.284358 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:04:33.285442 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:04:33.286245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m12:04:33.286825 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:04:33.299928 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m12:04:33.300855 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:04:33.301909 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:04:33.303015 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:04:33.303850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m12:04:33.304477 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:04:33.317492 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m12:04:33.318407 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:04:33.319471 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:04:33.320542 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:04:33.321337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m12:04:33.321905 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:04:33.336645 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m12:04:33.337547 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:04:33.338627 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:04:33.339738 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:04:33.340526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m12:04:33.341116 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:04:33.356868 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m12:04:33.357788 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:04:33.358854 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:04:33.360048 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m12:04:33.360888 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m12:04:33.361483 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m12:04:33.376120 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m12:04:33.377072 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m12:04:33.378147 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m12:04:33.379565 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m12:04:33.380726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m12:04:33.381495 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m12:04:33.420848 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m12:04:33.421999 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m12:04:33.423210 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m12:04:33.424507 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m12:04:33.425608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m12:04:33.426242 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m12:04:33.440812 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m12:04:33.441761 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m12:04:33.442825 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m12:04:33.444063 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:04:33.445279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6)
[0m12:04:33.445911 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:04:33.459160 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6"
[0m12:04:33.460109 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:04:33.461170 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:04:33.462351 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:04:33.463166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6, now test.incident_management.not_null_document_full_extracts_chunk.facaf6c655)
[0m12:04:33.463782 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:04:33.478236 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_chunk.facaf6c655"
[0m12:04:33.479156 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:04:33.480224 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:04:33.481427 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:04:33.482275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_chunk.facaf6c655, now test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424)
[0m12:04:33.482886 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:04:33.495870 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424"
[0m12:04:33.496792 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:04:33.497822 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:04:33.499034 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:04:33.499863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m12:04:33.500455 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:04:33.514667 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m12:04:33.515619 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:04:33.516673 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:04:33.517867 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:04:33.518704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m12:04:33.519295 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:04:33.534009 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m12:04:33.534925 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:04:33.535981 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:04:33.537185 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m12:04:33.538012 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m12:04:33.538629 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m12:04:33.550801 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m12:04:33.551758 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m12:04:33.552806 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m12:04:33.553996 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m12:04:33.554794 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m12:04:33.555392 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m12:04:33.568786 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m12:04:33.569706 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m12:04:33.570763 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m12:04:33.571969 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m12:04:33.573076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m12:04:33.573667 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m12:04:33.586587 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m12:04:33.587517 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m12:04:33.588632 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m12:04:33.589821 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m12:04:33.590650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m12:04:33.591232 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m12:04:33.605491 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m12:04:33.606429 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m12:04:33.607500 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m12:04:33.608710 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m12:04:33.609558 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m12:04:33.610156 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m12:04:33.622060 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m12:04:33.622995 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m12:04:33.624061 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m12:04:33.625233 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m12:04:33.626043 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m12:04:33.626623 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m12:04:33.639246 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m12:04:33.640184 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m12:04:33.643251 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m12:04:33.644507 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m12:04:33.645339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m12:04:33.645926 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m12:04:33.657620 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m12:04:33.658551 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m12:04:33.659617 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m12:04:33.660790 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:04:33.661637 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m12:04:33.662224 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:04:33.678323 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m12:04:33.679293 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:04:33.680373 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:04:33.681529 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:04:33.682341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m12:04:33.682929 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:04:33.698899 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m12:04:33.699875 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:04:33.700927 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:04:33.702084 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:04:33.702857 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m12:04:33.703441 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:04:33.716264 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m12:04:33.717164 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:04:33.718174 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:04:33.719629 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:04:33.720450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m12:04:33.721028 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:04:33.735260 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m12:04:33.736196 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:04:33.737233 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:04:33.738404 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:04:33.739227 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m12:04:33.739824 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:04:33.752634 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m12:04:33.753521 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:04:33.754544 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:04:33.755714 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:04:33.756509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m12:04:33.757103 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:04:33.771355 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m12:04:33.772277 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:04:33.773281 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:04:33.774435 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:04:33.775240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m12:04:33.775836 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:04:33.788839 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m12:04:33.789759 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:04:33.790777 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:04:33.791955 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:04:33.792757 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m12:04:33.793334 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:04:33.806207 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m12:04:33.807106 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:04:33.808159 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:04:33.811531 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:04:33.812105 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m12:04:33.818702 [debug] [Dummy-1   ]: Command end result
[0m12:04:33.866339 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:04:33.869407 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:04:33.880523 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:04:33.882596 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.046219, "process_in_blocks": "0", "process_kernel_time": 1.34, "process_mem_max_rss": "482632", "process_out_blocks": "0", "process_user_time": 7.23}
[0m12:04:33.883356 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 12:04:33.883058 after 6.05 seconds
[0m12:04:33.883975 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:04:59.374829 | 7c8201bb-dc85-49f7-8b20-c9ca13a00129 ==============================
[0m12:04:59.374829 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:04:59.375991 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m12:04:59.765299 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:05:00.541091 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:05:00.955406 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:05:00.956655 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m12:05:01.990367 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:05:01.993629 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:05:02.041761 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m12:05:02.046490 [info ] [Dummy-1   ]: 
[0m12:05:02.047171 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:05:02.047658 [info ] [Dummy-1   ]: 
[0m12:05:02.048597 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:05:02.057198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m12:05:02.342034 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:05:02.342811 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:05:02.343391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:03.749453 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.406 seconds
[0m12:05:03.756266 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:05:03.756989 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m12:05:03.858059 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.100 seconds
[0m12:05:03.860782 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:05:03.861462 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:05:04.029470 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.167 seconds
[0m12:05:04.032002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m12:05:04.042626 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:05:04.043361 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:05:04.043956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:05.957725 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.914 seconds
[0m12:05:05.960463 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:05:05.961104 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m12:05:06.227788 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.266 seconds
[0m12:05:06.230671 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:05:06.231275 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:05:06.479323 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.247 seconds
[0m12:05:06.490401 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m12:05:06.491315 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m12:05:06.491926 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m12:05:06.512911 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m12:05:06.513918 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m12:05:06.515052 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m12:05:06.516334 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m12:05:06.517238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m12:05:06.517822 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m12:05:06.529883 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m12:05:06.530878 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m12:05:06.531978 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m12:05:06.533184 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m12:05:06.534236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m12:05:06.534865 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m12:05:06.550102 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m12:05:06.551090 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m12:05:06.552196 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m12:05:06.553416 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:05:06.554551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m12:05:06.555230 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:05:06.574879 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m12:05:06.575893 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:05:06.576973 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:05:06.578195 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:05:06.579157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m12:05:06.579769 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:05:06.593290 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m12:05:06.594275 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:05:06.595364 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:05:06.596554 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:05:06.597379 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m12:05:06.597975 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:05:06.613029 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m12:05:06.614033 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:05:06.615150 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:05:06.616263 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:05:06.617092 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m12:05:06.617682 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:05:06.630789 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m12:05:06.631742 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:05:06.632813 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:05:06.633915 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:05:06.634776 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m12:05:06.635387 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:05:06.650224 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m12:05:06.651182 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:05:06.652274 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:05:06.653378 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:05:06.654231 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m12:05:06.654859 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:05:06.667939 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m12:05:06.668974 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:05:06.670035 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:05:06.671394 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:05:06.672224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m12:05:06.672819 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:05:06.687150 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m12:05:06.688101 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:05:06.689212 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:05:06.690293 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:05:06.691125 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m12:05:06.691714 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:05:06.704754 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m12:05:06.705727 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:05:06.706841 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:05:06.707936 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:05:06.708831 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m12:05:06.709436 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:05:06.722591 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m12:05:06.723529 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:05:06.724561 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:05:06.725646 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:05:06.726444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m12:05:06.727054 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:05:06.742004 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m12:05:06.742982 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:05:06.744023 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:05:06.745099 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:05:06.745938 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m12:05:06.746542 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:05:06.762619 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m12:05:06.763588 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:05:06.764615 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:05:06.765797 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m12:05:06.766649 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m12:05:06.767239 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m12:05:06.781836 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m12:05:06.782825 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m12:05:06.783890 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m12:05:06.785255 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m12:05:06.786351 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m12:05:06.787128 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m12:05:06.826041 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m12:05:06.827178 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m12:05:06.828373 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m12:05:06.829701 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m12:05:06.830893 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m12:05:06.831569 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m12:05:06.845990 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m12:05:06.846919 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m12:05:06.847955 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m12:05:06.849209 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:05:06.850305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6)
[0m12:05:06.850935 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:05:06.864980 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6"
[0m12:05:06.865906 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:05:06.866943 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:05:06.868113 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:05:06.868979 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6, now test.incident_management.not_null_document_full_extracts_chunk.facaf6c655)
[0m12:05:06.869585 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:05:06.883951 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_chunk.facaf6c655"
[0m12:05:06.884919 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:05:06.885948 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:05:06.887132 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:05:06.887910 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_chunk.facaf6c655, now test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424)
[0m12:05:06.888558 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:05:06.901416 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424"
[0m12:05:06.902325 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:05:06.903366 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:05:06.904541 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:05:06.905344 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m12:05:06.905946 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:05:06.919272 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m12:05:06.920192 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:05:06.921214 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:05:06.922360 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:05:06.923204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m12:05:06.923791 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:05:06.938454 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m12:05:06.939392 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:05:06.940400 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:05:06.941576 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m12:05:06.942367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m12:05:06.942983 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m12:05:06.955051 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m12:05:06.955963 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m12:05:06.956999 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m12:05:06.958151 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m12:05:06.959038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m12:05:06.959620 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m12:05:06.972824 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m12:05:06.973739 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m12:05:06.974788 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m12:05:06.975930 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m12:05:06.977022 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m12:05:06.977635 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m12:05:06.990386 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m12:05:06.991340 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m12:05:06.992371 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m12:05:06.993510 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m12:05:06.994309 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m12:05:06.994921 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m12:05:07.009122 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m12:05:07.010037 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m12:05:07.011086 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m12:05:07.012266 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m12:05:07.013083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m12:05:07.013663 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m12:05:07.025432 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m12:05:07.026335 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m12:05:07.027403 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m12:05:07.028621 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m12:05:07.029440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m12:05:07.030051 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m12:05:07.042443 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m12:05:07.043370 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m12:05:07.044387 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m12:05:07.045545 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m12:05:07.046337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m12:05:07.046928 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m12:05:07.060376 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m12:05:07.061278 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m12:05:07.062506 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m12:05:07.063699 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:05:07.064525 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m12:05:07.065126 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:05:07.081397 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m12:05:07.082355 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:05:07.083408 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:05:07.084550 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:05:07.085368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m12:05:07.085991 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:05:07.101722 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m12:05:07.102700 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:05:07.103737 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:05:07.104880 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:05:07.105695 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m12:05:07.106280 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:05:07.119318 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m12:05:07.120245 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:05:07.121266 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:05:07.122433 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:05:07.123286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m12:05:07.123877 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:05:07.138171 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m12:05:07.139275 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:05:07.140329 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:05:07.141496 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:05:07.142321 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m12:05:07.142945 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:05:07.155716 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m12:05:07.156646 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:05:07.157655 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:05:07.158883 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:05:07.159670 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m12:05:07.160257 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:05:07.174687 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m12:05:07.175610 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:05:07.176612 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:05:07.177770 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:05:07.178672 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m12:05:07.179275 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:05:07.192134 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m12:05:07.193079 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:05:07.194108 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:05:07.195285 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:05:07.196074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m12:05:07.196669 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:05:07.209784 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m12:05:07.210739 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:05:07.211856 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:05:07.214561 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:05:07.215159 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m12:05:07.221853 [debug] [Dummy-1   ]: Command end result
[0m12:05:07.434492 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:05:07.437566 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:05:07.448698 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:05:07.450876 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 8.175785, "process_in_blocks": "0", "process_kernel_time": 1.47, "process_mem_max_rss": "446604", "process_out_blocks": "0", "process_user_time": 7.25}
[0m12:05:07.451632 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 12:05:07.451340 after 8.18 seconds
[0m12:05:07.452211 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:05:41.428134 | d9083cb4-8397-4d02-a9f9-5a0be2abb780 ==============================
[0m12:05:41.428134 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:05:41.429421 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m12:05:41.818153 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:05:42.653859 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:05:43.076651 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:05:43.077939 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_full_extracts.sql
[0m12:05:44.101662 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:05:44.104817 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:05:44.154522 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m12:05:44.159223 [info ] [Dummy-1   ]: 
[0m12:05:44.159860 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:05:44.160333 [info ] [Dummy-1   ]: 
[0m12:05:44.161162 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:05:44.169732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m12:05:44.465964 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:05:44.466663 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:05:44.467196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:45.255540 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.788 seconds
[0m12:05:45.262610 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:05:45.263385 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m12:05:45.398596 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.134 seconds
[0m12:05:45.401539 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:05:45.402181 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:05:45.496842 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m12:05:45.499606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m12:05:45.512198 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:05:45.512832 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:05:45.513322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:46.330914 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.817 seconds
[0m12:05:46.333451 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:05:46.334061 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m12:05:46.440268 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.105 seconds
[0m12:05:46.442813 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:05:46.443513 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:05:46.552864 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m12:05:46.561154 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m12:05:46.562004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m12:05:46.562626 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m12:05:46.583517 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m12:05:46.584483 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m12:05:46.585545 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m12:05:46.586787 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m12:05:46.587625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m12:05:46.588197 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m12:05:46.600198 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m12:05:46.601106 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m12:05:46.602183 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m12:05:46.603388 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m12:05:46.604399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m12:05:46.604982 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m12:05:46.620017 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m12:05:46.620952 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m12:05:46.622010 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m12:05:46.623218 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:05:46.624415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m12:05:46.625048 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:05:46.644511 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m12:05:46.645452 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:05:46.646557 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:05:46.647770 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:05:46.648711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m12:05:46.649334 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:05:46.662735 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m12:05:46.663679 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:05:46.664741 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:05:46.665959 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:05:46.666859 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m12:05:46.667456 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:05:46.682521 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m12:05:46.683465 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:05:46.684507 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:05:46.685601 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:05:46.686423 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m12:05:46.687052 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:05:46.699959 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m12:05:46.700879 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:05:46.701912 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:05:46.703024 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:05:46.703881 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m12:05:46.704470 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:05:46.719066 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m12:05:46.719993 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:05:46.721043 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:05:46.722142 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:05:46.723018 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m12:05:46.723607 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:05:46.736569 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m12:05:46.737506 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:05:46.738602 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:05:46.739949 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:05:46.740796 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m12:05:46.741402 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:05:46.755861 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m12:05:46.756807 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:05:46.757824 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:05:46.759036 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:05:46.759853 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m12:05:46.760434 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:05:46.773435 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m12:05:46.774374 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:05:46.775425 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:05:46.776520 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:05:46.777342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m12:05:46.777944 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:05:46.791128 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m12:05:46.792038 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:05:46.793053 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:05:46.794111 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:05:46.794900 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m12:05:46.795470 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:05:46.810324 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m12:05:46.811279 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:05:46.812317 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:05:46.813412 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:05:46.814240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m12:05:46.814850 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:05:46.830580 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m12:05:46.831520 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:05:46.832553 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:05:46.833704 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m12:05:46.834629 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m12:05:46.835244 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m12:05:46.849788 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m12:05:46.850795 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m12:05:46.851868 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m12:05:46.853249 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m12:05:46.854408 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m12:05:46.855185 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m12:05:46.894643 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m12:05:46.895848 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m12:05:46.897111 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m12:05:46.898481 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m12:05:46.899666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m12:05:46.900289 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m12:05:46.914825 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m12:05:46.915753 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m12:05:46.916795 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m12:05:46.918001 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:05:46.919266 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6)
[0m12:05:46.919894 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:05:46.933141 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6"
[0m12:05:46.934109 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:05:46.935163 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:05:46.936341 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:05:46.937132 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6, now test.incident_management.not_null_document_full_extracts_chunk.facaf6c655)
[0m12:05:46.937707 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:05:46.952061 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_chunk.facaf6c655"
[0m12:05:46.953027 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:05:46.954042 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:05:46.955241 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:05:46.956053 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_chunk.facaf6c655, now test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424)
[0m12:05:46.956635 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:05:46.969411 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424"
[0m12:05:46.970317 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:05:46.971340 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:05:46.972492 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:05:46.973283 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m12:05:46.973856 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:05:46.987822 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m12:05:46.988859 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:05:46.989910 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:05:46.991092 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:05:46.991924 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m12:05:46.992520 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:05:47.007109 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m12:05:47.008008 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:05:47.009117 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:05:47.010330 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m12:05:47.011137 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m12:05:47.011705 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m12:05:47.023762 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m12:05:47.024642 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m12:05:47.025673 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m12:05:47.026872 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m12:05:47.027671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m12:05:47.028238 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m12:05:47.041596 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m12:05:47.042504 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m12:05:47.043569 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m12:05:47.044740 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m12:05:47.045846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m12:05:47.046435 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m12:05:47.059300 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m12:05:47.060219 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m12:05:47.061255 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m12:05:47.062411 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m12:05:47.063239 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m12:05:47.063814 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m12:05:47.077939 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m12:05:47.078930 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m12:05:47.079963 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m12:05:47.081109 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m12:05:47.081895 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m12:05:47.082488 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m12:05:47.094295 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m12:05:47.095245 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m12:05:47.096272 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m12:05:47.097431 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m12:05:47.098245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m12:05:47.098923 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m12:05:47.111407 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m12:05:47.112322 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m12:05:47.115475 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m12:05:47.116712 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m12:05:47.117518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m12:05:47.118098 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m12:05:47.129826 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m12:05:47.130745 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m12:05:47.131760 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m12:05:47.132915 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:05:47.133716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m12:05:47.134297 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:05:47.150608 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m12:05:47.151556 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:05:47.152590 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:05:47.153771 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:05:47.154602 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m12:05:47.155199 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:05:47.171362 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m12:05:47.172279 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:05:47.173306 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:05:47.174483 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:05:47.175295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m12:05:47.176006 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:05:47.188787 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m12:05:47.189710 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:05:47.190740 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:05:47.192123 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:05:47.192943 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m12:05:47.193517 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:05:47.207657 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m12:05:47.208668 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:05:47.209712 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:05:47.210874 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:05:47.211671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m12:05:47.212243 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:05:47.224935 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m12:05:47.225836 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:05:47.226899 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:05:47.228030 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:05:47.228880 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m12:05:47.229459 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:05:47.243651 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m12:05:47.244548 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:05:47.245552 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:05:47.246748 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:05:47.247569 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m12:05:47.248159 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:05:47.261267 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m12:05:47.262214 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:05:47.263279 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:05:47.264461 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:05:47.265242 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m12:05:47.265818 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:05:47.278715 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m12:05:47.279627 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:05:47.280639 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:05:47.283218 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:05:47.283776 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m12:05:47.290546 [debug] [Dummy-1   ]: Command end result
[0m12:05:47.338674 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:05:47.341607 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:05:47.352649 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:05:47.354782 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.027203, "process_in_blocks": "0", "process_kernel_time": 1.43, "process_mem_max_rss": "497936", "process_out_blocks": "0", "process_user_time": 7.16}
[0m12:05:47.355554 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 12:05:47.355268 after 6.03 seconds
[0m12:05:47.356125 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:06:04.365892 | f649d49f-56d6-48d6-b671-d2296186fbc2 ==============================
[0m12:06:04.365892 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:06:04.367112 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m12:06:04.755368 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:06:05.522451 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:06:05.952007 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:06:05.952765 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m12:06:06.167474 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:06:06.170652 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:06:06.232031 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m12:06:06.235638 [info ] [Dummy-1   ]: 
[0m12:06:06.236314 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:06:06.236854 [info ] [Dummy-1   ]: 
[0m12:06:06.237761 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:06:06.245127 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m12:06:06.390983 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m12:06:06.391644 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m12:06:06.392166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:07.179353 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.787 seconds
[0m12:06:07.184607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m12:06:07.208825 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:06:07.209517 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:06:07.210033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:08.068446 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.858 seconds
[0m12:06:08.074514 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:06:08.075181 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m12:06:08.178759 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.103 seconds
[0m12:06:08.181170 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:06:08.181777 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:06:08.289128 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.107 seconds
[0m12:06:08.291610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m12:06:08.302426 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:06:08.303121 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:06:08.303620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:09.133730 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.830 seconds
[0m12:06:09.136332 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:06:09.136981 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m12:06:09.322174 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.184 seconds
[0m12:06:09.325007 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:06:09.325669 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:06:09.442048 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.116 seconds
[0m12:06:09.453789 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m12:06:09.455279 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m12:06:09.456107 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m12:06:09.456717 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m12:06:09.475995 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m12:06:09.477072 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m12:06:09.546434 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m12:06:09.548513 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m12:06:09.549284 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m12:06:09.549929 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:06:11.211438 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.661 seconds
[0m12:06:11.247724 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.79s]
[0m12:06:11.248881 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m12:06:11.250834 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m12:06:11.251984 [info ] [Thread-2 (]: 2 of 2 START sql table model bronze_zone.document_full_extracts ................ [RUN]
[0m12:06:11.252803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_full_extracts)
[0m12:06:11.253513 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m12:06:11.268547 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m12:06:11.269495 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m12:06:11.309443 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.document_full_extracts"
[0m12:06:11.312041 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_full_extracts"
[0m12:06:11.312839 [debug] [Thread-2 (]: On model.incident_management.document_full_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_full_extracts"} */
create or replace transient table incident_management.bronze_zone.document_full_extracts
         as
        (

with 
documents_raw_extracts as(
    select
        *,
        AI_PARSE_DOCUMENT (
            TO_FILE('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS',relative_path),
             {
                'mode': 'LAYOUT'
                ,'page_split': True
             }
        ) as raw_extracts
        FROM incident_management.bronze_zone.v_qualify_new_documents
        WHERE lower(doc_type) = 'full'
),
documents_chunked_extracts as
(
    select 
    og1.* exclude (raw_extracts),
    SPLIT_TEXT_MARKDOWN_HEADER(
        lf1.value:content::STRING,
        OBJECT_CONSTRUCT('#', 'header_1', '##', 'header_2'),
        500,
        5
    ) as page_chunks,
    lf1.index::int as page_num
    from documents_raw_extracts og1,
    LATERAL FLATTEN(input => raw_extracts:pages) lf1
)

select 
    og2.* exclude (page_chunks),
    lf2.value['chunk']::varchar as chunk,
    lf2.value['headers']::object as headers
from documents_chunked_extracts og2,
lateral flatten(input => page_chunks) lf2;
[0m12:06:11.313492 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:06:12.142235 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c04856-0106-f145-0032-3187053fe0c2
[0m12:06:12.143026 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 39 at position 41 unexpected ';'.
[0m12:06:12.148627 [debug] [Thread-2 (]: Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 39 at position 41 unexpected ';'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql
[0m12:06:12.150166 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model bronze_zone.document_full_extracts ....... [[31mERROR[0m in 0.90s]
[0m12:06:12.151224 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m12:06:12.152670 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_full_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 39 at position 41 unexpected ';'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql.
[0m12:06:12.155773 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:06:12.156361 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_full_extracts' was properly closed.
[0m12:06:12.156898 [info ] [Dummy-1   ]: 
[0m12:06:12.157435 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m12:06:12.158737 [debug] [Dummy-1   ]: Command end result
[0m12:06:12.205456 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:06:12.208376 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:06:12.216726 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:06:12.217309 [info ] [Dummy-1   ]: 
[0m12:06:12.217982 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:06:12.218687 [info ] [Dummy-1   ]: 
[0m12:06:12.219477 [error] [Dummy-1   ]:   Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 39 at position 41 unexpected ';'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql
[0m12:06:12.220009 [info ] [Dummy-1   ]: 
[0m12:06:12.220539 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:06:12.222441 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.957047, "process_in_blocks": "0", "process_kernel_time": 1.33, "process_mem_max_rss": "431184", "process_out_blocks": "0", "process_user_time": 6.0}
[0m12:06:12.223184 [debug] [Dummy-1   ]: Command `cli run` failed at 12:06:12.222894 after 7.96 seconds
[0m12:06:12.223777 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:08:08.363863 | 462e337c-e406-4c0c-9763-c639a2e22675 ==============================
[0m12:08:08.363863 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:08:08.365017 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m12:08:08.751625 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:08:09.557442 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:08:09.979542 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:08:09.980806 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_full_extracts.sql
[0m12:08:11.041000 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:08:11.044005 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:08:11.094275 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m12:08:11.099244 [info ] [Dummy-1   ]: 
[0m12:08:11.099940 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:08:11.100455 [info ] [Dummy-1   ]: 
[0m12:08:11.101320 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:08:11.110868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m12:08:11.418888 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:08:11.419650 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:08:11.420202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:12.441907 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.021 seconds
[0m12:08:12.448794 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:08:12.449440 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m12:08:12.587191 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.137 seconds
[0m12:08:12.590351 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:08:12.591086 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:08:12.732878 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.141 seconds
[0m12:08:12.735708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m12:08:12.748527 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:08:12.749313 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:08:12.749868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:13.636443 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.886 seconds
[0m12:08:13.639156 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:08:13.639796 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m12:08:13.732689 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.092 seconds
[0m12:08:13.735266 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:08:13.735893 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:08:13.854180 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m12:08:13.862558 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m12:08:13.863460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m12:08:13.864093 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m12:08:13.885595 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m12:08:13.886678 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m12:08:13.887862 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m12:08:13.889321 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m12:08:13.890257 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m12:08:13.890904 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m12:08:13.903159 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m12:08:13.904155 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m12:08:13.905280 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m12:08:13.906591 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m12:08:13.907766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m12:08:13.908448 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m12:08:13.923971 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m12:08:13.924931 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m12:08:13.926057 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m12:08:13.927338 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:08:13.928364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m12:08:13.929084 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:08:13.948888 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m12:08:13.949884 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:08:13.951020 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:08:13.952288 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:08:13.953170 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m12:08:13.953774 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:08:13.967357 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m12:08:13.968312 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:08:13.969501 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:08:13.970746 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:08:13.971585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m12:08:13.972183 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:08:13.987409 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m12:08:13.988369 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:08:13.989563 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:08:13.990726 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:08:13.991595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m12:08:13.992212 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:08:14.005305 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m12:08:14.006241 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:08:14.007305 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:08:14.008376 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:08:14.009276 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m12:08:14.009865 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:08:14.024600 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m12:08:14.025589 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:08:14.026705 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:08:14.027833 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:08:14.028776 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m12:08:14.029398 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:08:14.042592 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m12:08:14.043542 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:08:14.044596 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:08:14.045949 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:08:14.046813 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m12:08:14.047467 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:08:14.062065 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m12:08:14.063048 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:08:14.064090 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:08:14.065195 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:08:14.065998 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m12:08:14.066596 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:08:14.079763 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m12:08:14.080683 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:08:14.081706 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:08:14.082824 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:08:14.083627 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m12:08:14.084208 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:08:14.097243 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m12:08:14.098167 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:08:14.099315 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:08:14.100395 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:08:14.101160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m12:08:14.101730 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:08:14.116581 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m12:08:14.117526 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:08:14.118649 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:08:14.119757 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:08:14.120529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m12:08:14.121112 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:08:14.137215 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m12:08:14.138180 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:08:14.139346 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:08:14.140517 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m12:08:14.141347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m12:08:14.141936 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m12:08:14.156826 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m12:08:14.157787 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m12:08:14.158969 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m12:08:14.160401 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m12:08:14.161513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m12:08:14.162262 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m12:08:14.202293 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m12:08:14.203562 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m12:08:14.204835 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m12:08:14.206122 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m12:08:14.207208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m12:08:14.207823 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m12:08:14.222499 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m12:08:14.223482 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m12:08:14.224538 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m12:08:14.225747 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:08:14.226987 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6)
[0m12:08:14.227626 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:08:14.241102 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6"
[0m12:08:14.242065 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:08:14.243175 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:08:14.244389 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:08:14.245180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6, now test.incident_management.not_null_document_full_extracts_chunk.facaf6c655)
[0m12:08:14.245780 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:08:14.260347 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_chunk.facaf6c655"
[0m12:08:14.261283 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:08:14.262304 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:08:14.263501 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:08:14.264330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_chunk.facaf6c655, now test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424)
[0m12:08:14.264911 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:08:14.277777 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424"
[0m12:08:14.278803 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:08:14.279851 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:08:14.281028 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:08:14.281912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m12:08:14.282559 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:08:14.296820 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m12:08:14.297766 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:08:14.298914 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:08:14.300094 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:08:14.300930 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m12:08:14.301527 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:08:14.316177 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m12:08:14.317112 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:08:14.318122 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:08:14.319376 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m12:08:14.320236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m12:08:14.320870 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m12:08:14.333091 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m12:08:14.334003 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m12:08:14.335046 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m12:08:14.336192 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m12:08:14.336974 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m12:08:14.337549 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m12:08:14.350831 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m12:08:14.351731 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m12:08:14.352766 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m12:08:14.353903 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m12:08:14.355112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m12:08:14.355747 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m12:08:14.368832 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m12:08:14.369766 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m12:08:14.370886 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m12:08:14.372103 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m12:08:14.372957 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m12:08:14.373557 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m12:08:14.387954 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m12:08:14.388954 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m12:08:14.390001 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m12:08:14.391194 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m12:08:14.391994 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m12:08:14.392567 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m12:08:14.404572 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m12:08:14.405512 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m12:08:14.406613 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m12:08:14.407834 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m12:08:14.408731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m12:08:14.409340 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m12:08:14.422068 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m12:08:14.423036 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m12:08:14.426276 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m12:08:14.427576 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m12:08:14.428534 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m12:08:14.429164 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m12:08:14.440974 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m12:08:14.441858 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m12:08:14.442905 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m12:08:14.444040 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:08:14.444828 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m12:08:14.445414 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:08:14.461696 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m12:08:14.462634 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:08:14.463671 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:08:14.464829 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:08:14.465641 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m12:08:14.466228 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:08:14.482800 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m12:08:14.483748 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:08:14.484791 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:08:14.485981 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:08:14.486819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m12:08:14.487418 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:08:14.500401 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m12:08:14.501358 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:08:14.502384 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:08:14.503854 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:08:14.504717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m12:08:14.505299 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:08:14.520053 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m12:08:14.521005 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:08:14.522051 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:08:14.523279 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:08:14.524118 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m12:08:14.524709 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:08:14.537860 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m12:08:14.538904 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:08:14.539992 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:08:14.541220 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:08:14.542031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m12:08:14.542658 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:08:14.557184 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m12:08:14.558102 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:08:14.559244 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:08:14.560454 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:08:14.561266 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m12:08:14.561848 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:08:14.575046 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m12:08:14.575989 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:08:14.577061 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:08:14.578262 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:08:14.579164 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m12:08:14.579768 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:08:14.592822 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m12:08:14.593767 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:08:14.594842 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:08:14.597508 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:08:14.598090 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m12:08:14.604893 [debug] [Dummy-1   ]: Command end result
[0m12:08:14.652847 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:08:14.655837 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:08:14.667126 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:08:14.669459 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.4052114, "process_in_blocks": "0", "process_kernel_time": 1.61, "process_mem_max_rss": "492040", "process_out_blocks": "0", "process_user_time": 7.3}
[0m12:08:14.670246 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 12:08:14.669951 after 6.41 seconds
[0m12:08:14.670869 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:08:33.957523 | 25632d52-e0eb-4d55-b3fa-348732139c6f ==============================
[0m12:08:33.957523 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:08:33.958837 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m12:08:34.350981 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:08:35.137982 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:08:35.560911 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:08:35.561669 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m12:08:35.777087 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:08:35.780382 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:08:35.841829 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m12:08:35.845538 [info ] [Dummy-1   ]: 
[0m12:08:35.846242 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:08:35.846753 [info ] [Dummy-1   ]: 
[0m12:08:35.847723 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:08:35.855319 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m12:08:36.007286 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m12:08:36.008055 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m12:08:36.008766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:37.456800 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.448 seconds
[0m12:08:37.462073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m12:08:37.486463 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:08:37.487184 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:08:37.487825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:38.578750 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.091 seconds
[0m12:08:38.584794 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:08:38.585437 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m12:08:38.746921 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.161 seconds
[0m12:08:38.749992 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:08:38.750632 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:08:38.888867 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.138 seconds
[0m12:08:38.891641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m12:08:38.904509 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:08:38.905214 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:08:38.905763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:39.966452 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.060 seconds
[0m12:08:39.969158 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:08:39.969873 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m12:08:40.112097 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.141 seconds
[0m12:08:40.114560 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:08:40.115159 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:08:40.248650 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.133 seconds
[0m12:08:40.256536 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m12:08:40.257528 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m12:08:40.258337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m12:08:40.259063 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m12:08:40.278423 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m12:08:40.279464 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m12:08:40.339923 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m12:08:40.341898 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m12:08:40.342630 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m12:08:40.343268 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:08:41.782264 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.439 seconds
[0m12:08:41.819334 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.56s]
[0m12:08:41.820466 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m12:08:41.822563 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m12:08:41.823771 [info ] [Thread-2 (]: 2 of 2 START sql table model bronze_zone.document_full_extracts ................ [RUN]
[0m12:08:41.824601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_full_extracts)
[0m12:08:41.825235 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m12:08:41.840503 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m12:08:41.841467 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m12:08:41.882104 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.document_full_extracts"
[0m12:08:41.884696 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_full_extracts"
[0m12:08:41.885501 [debug] [Thread-2 (]: On model.incident_management.document_full_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_full_extracts"} */
create or replace transient table incident_management.bronze_zone.document_full_extracts
         as
        (

with 
documents_raw_extracts as(
    select
        *,
        AI_PARSE_DOCUMENT (
            TO_FILE('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS',relative_path),
             {
                'mode': 'LAYOUT'
                ,'page_split': True
             }
        ) as raw_extracts
        FROM incident_management.bronze_zone.v_qualify_new_documents
        WHERE lower(doc_type) = 'full'
),
documents_chunked_extracts as
(
    select 
    og1.* exclude (raw_extracts),
    SPLIT_TEXT_MARKDOWN_HEADER(
        lf1.value:content::STRING,
        OBJECT_CONSTRUCT('#', 'header_1', '##', 'header_2'),
        500,
        5
    ) as page_chunks,
    lf1.index::int as page_num
    from documents_raw_extracts og1,
    LATERAL FLATTEN(input => raw_extracts:pages) lf1
)

select 
    og2.* exclude (page_chunks),
    lf2.value['chunk']::varchar as chunk,
    lf2.value['headers']::object as headers
from documents_chunked_extracts og2,
lateral flatten(input => page_chunks) lf2
        );
[0m12:08:41.886160 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:08:43.220523 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c04858-0106-f481-0032-3187053f4d82
[0m12:08:43.221318 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function SPLIT_TEXT_MARKDOWN_HEADER
[0m12:08:43.226704 [debug] [Thread-2 (]: Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  002140 (42601): SQL compilation error:
  Unknown function SPLIT_TEXT_MARKDOWN_HEADER
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql
[0m12:08:43.228297 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model bronze_zone.document_full_extracts ....... [[31mERROR[0m in 1.40s]
[0m12:08:43.229423 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m12:08:43.230859 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_full_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  002140 (42601): SQL compilation error:
  Unknown function SPLIT_TEXT_MARKDOWN_HEADER
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql.
[0m12:08:43.233777 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:08:43.234349 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_full_extracts' was properly closed.
[0m12:08:43.234882 [info ] [Dummy-1   ]: 
[0m12:08:43.235429 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.39 seconds (7.39s).
[0m12:08:43.236683 [debug] [Dummy-1   ]: Command end result
[0m12:08:43.284607 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:08:43.287588 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:08:43.296034 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:08:43.296610 [info ] [Dummy-1   ]: 
[0m12:08:43.297273 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:08:43.297791 [info ] [Dummy-1   ]: 
[0m12:08:43.298618 [error] [Dummy-1   ]:   Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  002140 (42601): SQL compilation error:
  Unknown function SPLIT_TEXT_MARKDOWN_HEADER
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql
[0m12:08:43.299198 [info ] [Dummy-1   ]: 
[0m12:08:43.299763 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:08:43.301648 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.444881, "process_in_blocks": "0", "process_kernel_time": 1.35, "process_mem_max_rss": "438260", "process_out_blocks": "0", "process_user_time": 6.07}
[0m12:08:43.302341 [debug] [Dummy-1   ]: Command `cli run` failed at 12:08:43.302070 after 9.45 seconds
[0m12:08:43.302908 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:09:11.402897 | 12c59e8d-13ac-4b1e-83f3-c312a1c91261 ==============================
[0m12:09:11.402897 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:09:11.404062 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m12:09:11.794807 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:09:12.615110 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:09:13.065975 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:09:13.067240 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_full_extracts.sql
[0m12:09:14.142191 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:09:14.145250 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:09:14.208291 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m12:09:14.212253 [info ] [Dummy-1   ]: 
[0m12:09:14.212976 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:09:14.213525 [info ] [Dummy-1   ]: 
[0m12:09:14.214451 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:09:14.222180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m12:09:14.540426 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m12:09:14.541120 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m12:09:14.541646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:15.424770 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.883 seconds
[0m12:09:15.430011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m12:09:15.452908 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:09:15.453578 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:09:15.454085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:16.282627 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.828 seconds
[0m12:09:16.288776 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:09:16.289515 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m12:09:16.406049 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.116 seconds
[0m12:09:16.408984 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:09:16.409653 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:09:16.519558 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m12:09:16.522240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m12:09:16.538356 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:09:16.539148 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:09:16.539687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:17.339426 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.800 seconds
[0m12:09:17.341992 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:09:17.342641 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m12:09:17.418943 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.076 seconds
[0m12:09:17.421471 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:09:17.422099 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:09:17.538158 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.115 seconds
[0m12:09:17.545998 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m12:09:17.547032 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m12:09:17.547858 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m12:09:17.548556 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m12:09:17.567266 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m12:09:17.568366 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m12:09:17.631526 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m12:09:17.633499 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m12:09:17.634253 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m12:09:17.634935 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:09:18.764247 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.129 seconds
[0m12:09:18.801131 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.25s]
[0m12:09:18.802247 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m12:09:18.804312 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m12:09:18.805507 [info ] [Thread-2 (]: 2 of 2 START sql table model bronze_zone.document_full_extracts ................ [RUN]
[0m12:09:18.806330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_full_extracts)
[0m12:09:18.806973 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m12:09:18.820900 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m12:09:18.821923 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m12:09:18.865860 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.document_full_extracts"
[0m12:09:18.868640 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_full_extracts"
[0m12:09:18.869515 [debug] [Thread-2 (]: On model.incident_management.document_full_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_full_extracts"} */
create or replace transient table incident_management.bronze_zone.document_full_extracts
         as
        (

with 
documents_raw_extracts as(
    select
        *,
        AI_PARSE_DOCUMENT (
            TO_FILE('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS',relative_path),
             {
                'mode': 'LAYOUT'
                ,'page_split': True
             }
        ) as raw_extracts
        FROM incident_management.bronze_zone.v_qualify_new_documents
        WHERE lower(doc_type) = 'full'
),
documents_chunked_extracts as
(
    select 
    og1.* exclude (raw_extracts),
    SNOWFLAKE.CORTEX.SPLIT_TEXT_MARKDOWN_HEADER(
        lf1.value:content::STRING,
        OBJECT_CONSTRUCT('#', 'header_1', '##', 'header_2'),
        500,
        5
    ) as page_chunks,
    lf1.index::int as page_num
    from documents_raw_extracts og1,
    LATERAL FLATTEN(input => raw_extracts:pages) lf1
)

select 
    og2.* exclude (page_chunks),
    lf2.value['chunk']::varchar as chunk,
    lf2.value['headers']::object as headers
from documents_chunked_extracts og2,
lateral flatten(input => page_chunks) lf2
        );
[0m12:09:18.870191 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:09:33.775585 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 14.905 seconds
[0m12:09:33.779350 [info ] [Thread-2 (]: 2 of 2 OK created sql table model bronze_zone.document_full_extracts ........... [[32mSUCCESS 1[0m in 14.97s]
[0m12:09:33.780382 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m12:09:33.783577 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:09:33.784164 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_full_extracts' was properly closed.
[0m12:09:33.784697 [info ] [Dummy-1   ]: 
[0m12:09:33.785241 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 19.57 seconds (19.57s).
[0m12:09:33.786440 [debug] [Dummy-1   ]: Command end result
[0m12:09:33.833197 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:09:33.836093 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:09:33.844233 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:09:33.844811 [info ] [Dummy-1   ]: 
[0m12:09:33.845523 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m12:09:33.846022 [info ] [Dummy-1   ]: 
[0m12:09:33.846579 [info ] [Dummy-1   ]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:09:33.848530 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.548153, "process_in_blocks": "0", "process_kernel_time": 1.38, "process_mem_max_rss": "480588", "process_out_blocks": "0", "process_user_time": 7.3}
[0m12:09:33.849280 [debug] [Dummy-1   ]: Command `cli run` succeeded at 12:09:33.848998 after 22.55 seconds
[0m12:09:33.849866 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:25:16.915092 | 7f6530ca-4084-48ad-9947-3f873950b4f7 ==============================
[0m12:25:16.915092 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:25:16.916226 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m12:25:17.308678 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:25:18.071884 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:25:18.514724 [debug] [Dummy-1   ]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m12:25:18.515821 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://macros/create_document_search_sevice.sql
[0m12:25:18.516423 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://macros/get_response_format.sql
[0m12:25:18.517104 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://macros/clean_stale_documents.sql
[0m12:25:18.841614 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:25:18.844672 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:25:18.894667 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m12:25:18.899350 [info ] [Dummy-1   ]: 
[0m12:25:18.900020 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:25:18.900551 [info ] [Dummy-1   ]: 
[0m12:25:18.901525 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:25:18.910232 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m12:25:19.061506 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:25:19.062183 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:25:19.062703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:19.872451 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.810 seconds
[0m12:25:19.878507 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:25:19.879213 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m12:25:19.984126 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.104 seconds
[0m12:25:19.986641 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:25:19.987283 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:25:20.081301 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m12:25:20.083817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m12:25:20.094865 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:25:20.095531 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:25:20.096031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:20.902623 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.806 seconds
[0m12:25:20.905114 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:25:20.905721 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m12:25:20.996012 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.090 seconds
[0m12:25:20.998918 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:25:20.999563 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:25:21.090152 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m12:25:21.101089 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m12:25:21.101978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m12:25:21.102595 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m12:25:21.123373 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m12:25:21.124376 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m12:25:21.125489 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m12:25:21.126775 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m12:25:21.127728 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m12:25:21.128420 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m12:25:21.140690 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m12:25:21.141747 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m12:25:21.142929 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m12:25:21.144171 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m12:25:21.145420 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m12:25:21.146083 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m12:25:21.161373 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m12:25:21.162345 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m12:25:21.163496 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m12:25:21.164708 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:25:21.165868 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m12:25:21.166530 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:25:21.190682 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m12:25:21.191737 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:25:21.192857 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m12:25:21.194086 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:25:21.194992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m12:25:21.195664 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:25:21.210513 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m12:25:21.211544 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:25:21.212635 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m12:25:21.213805 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:25:21.214705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m12:25:21.215394 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:25:21.228590 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m12:25:21.229682 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:25:21.230765 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m12:25:21.231874 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:25:21.232770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m12:25:21.233389 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:25:21.246446 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m12:25:21.247529 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:25:21.248695 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m12:25:21.249819 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:25:21.250732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m12:25:21.251398 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:25:21.266103 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m12:25:21.267202 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:25:21.268299 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m12:25:21.269469 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:25:21.270314 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m12:25:21.271011 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:25:21.283784 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m12:25:21.284744 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:25:21.285766 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m12:25:21.286858 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:25:21.287705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m12:25:21.288394 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:25:21.302601 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m12:25:21.303638 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:25:21.304674 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m12:25:21.305725 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:25:21.306582 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m12:25:21.307216 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:25:21.320247 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m12:25:21.321248 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:25:21.322298 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m12:25:21.323382 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:25:21.324310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m12:25:21.324983 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:25:21.339428 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m12:25:21.340359 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:25:21.341390 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m12:25:21.342502 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:25:21.343399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m12:25:21.344246 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:25:21.357115 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m12:25:21.358084 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:25:21.359200 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m12:25:21.360345 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:25:21.361303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m12:25:21.361945 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:25:21.379166 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m12:25:21.380103 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:25:21.381188 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m12:25:21.382339 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m12:25:21.383186 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m12:25:21.383815 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m12:25:21.397058 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m12:25:21.398022 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m12:25:21.399206 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m12:25:21.400556 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m12:25:21.401663 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m12:25:21.402406 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m12:25:21.443019 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m12:25:21.444119 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m12:25:21.445282 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m12:25:21.446479 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m12:25:21.447597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m12:25:21.448286 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m12:25:21.594288 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m12:25:21.595247 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m12:25:21.596308 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m12:25:21.597499 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:25:21.598720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6)
[0m12:25:21.599388 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:25:21.618287 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6"
[0m12:25:21.619371 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:25:21.620455 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6
[0m12:25:21.621627 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:25:21.622474 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_full_extracts_analysis_type__full.4bab5fcab6, now test.incident_management.not_null_document_full_extracts_chunk.facaf6c655)
[0m12:25:21.623144 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:25:21.637902 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_chunk.facaf6c655"
[0m12:25:21.638941 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:25:21.640014 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_chunk.facaf6c655
[0m12:25:21.641128 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:25:21.641948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_chunk.facaf6c655, now test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424)
[0m12:25:21.642604 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:25:21.655501 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424"
[0m12:25:21.656438 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:25:21.657492 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424
[0m12:25:21.658718 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:25:21.659601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_relative_path.79ec1ee424, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m12:25:21.660251 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:25:21.676157 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m12:25:21.677111 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:25:21.678147 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m12:25:21.679459 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:25:21.680335 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m12:25:21.680963 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:25:21.693995 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m12:25:21.694975 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:25:21.696031 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m12:25:21.697152 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m12:25:21.697975 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m12:25:21.698673 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m12:25:21.712928 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m12:25:21.713925 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m12:25:21.714973 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m12:25:21.716123 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m12:25:21.716917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m12:25:21.717482 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m12:25:21.729287 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m12:25:21.730199 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m12:25:21.731254 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m12:25:21.732398 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m12:25:21.733506 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m12:25:21.734098 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m12:25:21.746749 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m12:25:21.747791 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m12:25:21.748913 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m12:25:21.750060 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m12:25:21.750846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m12:25:21.751442 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m12:25:21.766336 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m12:25:21.767284 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m12:25:21.768406 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m12:25:21.769568 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m12:25:21.770422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m12:25:21.771072 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m12:25:21.783050 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m12:25:21.783920 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m12:25:21.784919 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m12:25:21.786007 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m12:25:21.786865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m12:25:21.787501 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m12:25:21.801665 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m12:25:21.802572 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m12:25:21.803630 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m12:25:21.804791 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m12:25:21.805617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m12:25:21.806230 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m12:25:21.818151 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m12:25:21.819205 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m12:25:21.820270 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m12:25:21.821476 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:25:21.822341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m12:25:21.823011 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:25:21.841570 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m12:25:21.842562 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:25:21.843654 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m12:25:21.844834 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:25:21.845722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m12:25:21.846397 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:25:21.861079 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m12:25:21.862070 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:25:21.863139 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m12:25:21.864279 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:25:21.865069 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m12:25:21.865646 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:25:21.878544 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m12:25:21.879458 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:25:21.880480 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m12:25:21.881602 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:25:21.882570 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m12:25:21.883301 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:25:21.897911 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m12:25:21.898891 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:25:21.899938 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m12:25:21.901010 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:25:21.901795 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m12:25:21.902362 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:25:21.915280 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m12:25:21.916156 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:25:21.917138 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m12:25:21.918185 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:25:21.919063 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m12:25:21.919642 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:25:21.934002 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m12:25:21.934930 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:25:21.935933 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m12:25:21.937043 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:25:21.937836 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m12:25:21.938475 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:25:21.951447 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m12:25:21.952390 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:25:21.953394 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m12:25:21.954505 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:25:21.955323 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m12:25:21.955892 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:25:21.970468 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m12:25:21.971399 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:25:21.972417 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m12:25:21.975048 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:25:21.975589 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m12:25:21.982333 [debug] [Dummy-1   ]: Command end result
[0m12:25:22.027934 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:25:22.030920 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:25:22.042394 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:25:22.044526 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.2311277, "process_in_blocks": "0", "process_kernel_time": 1.39, "process_mem_max_rss": "437296", "process_out_blocks": "0", "process_user_time": 6.49}
[0m12:25:22.045296 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 12:25:22.045005 after 5.23 seconds
[0m12:25:22.045882 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:30:16.838915 | fdd2de75-0ee2-4fc8-88a1-d4d0b77361dd ==============================
[0m12:30:16.838915 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:30:16.840088 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m12:30:17.229257 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:30:18.005570 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:30:18.411692 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:30:18.412823 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://macros/clean_stale_documents.sql
[0m12:30:18.413524 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://macros/create_document_search_sevice.sql
[0m12:30:18.736849 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:30:18.739995 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:30:18.777384 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m12:30:18.778684 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'macro_create_document_search_service'
[0m12:30:18.927828 [debug] [Dummy-1   ]: Using snowflake connection "macro_create_document_search_service"
[0m12:30:18.928731 [debug] [Dummy-1   ]: On macro_create_document_search_service: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "macro_create_document_search_service"} */
CREATE OR REPLACE CORTEX SEARCH SERVICE INCIDENT_MANAGEMENT.BRONZE_ZONE.incm_doc_search
      ON chunk
      ATTRIBUTES RELATIVE_PATH, EXTENSION
      WAREHOUSE = compute_wh
      TARGET_LAG = '1 hour'
      EMBEDDING_MODEL = 'snowflake-arctic-embed-l-v2.0'
    AS (
      SELECT
        CHUNK,
        RELATIVE_PATH,
        EXTENSION
      FROM INCIDENT_MANAGEMENT.BRONZE_ZONE.DOCUMENT_FULL_EXTRACTS
    );
[0m12:30:18.929381 [debug] [Dummy-1   ]: Opening a new connection, currently in state init
[0m12:30:21.671245 [debug] [Dummy-1   ]: Snowflake adapter: Snowflake query id: 01c0486e-0106-f21a-0032-31870541238e
[0m12:30:21.671999 [debug] [Dummy-1   ]: Snowflake adapter: Snowflake error: 002742 (01000): SQL compilation error: Failed to refresh dynamic table with refresh_trigger INITIAL at data_timestamp 1762720221112 because of the error: SQL compilation error: Target table failed to refresh: Dynamic Table 'INCIDENT_MANAGEMENT.BRONZE_ZONE._CORTEX_SEARCH_SOURCE_INCM_DOC_SEARCH_5AF39AEC_3633_4041_947D_7D4EB2CD0CE2' could not be refreshed because warehouse 'COMPUTE_WH' is missing.
[0m12:30:21.672821 [debug] [Dummy-1   ]: Snowflake adapter: Error running SQL: macro create_document_search_service
[0m12:30:21.673369 [debug] [Dummy-1   ]: Snowflake adapter: Rolling back transaction.
[0m12:30:21.674441 [error] [Dummy-1   ]: Encountered an error while running operation: Database Error
  002742 (01000): SQL compilation error: Failed to refresh dynamic table with refresh_trigger INITIAL at data_timestamp 1762720221112 because of the error: SQL compilation error: Target table failed to refresh: Dynamic Table 'INCIDENT_MANAGEMENT.BRONZE_ZONE._CORTEX_SEARCH_SOURCE_INCM_DOC_SEARCH_5AF39AEC_3633_4041_947D_7D4EB2CD0CE2' could not be refreshed because warehouse 'COMPUTE_WH' is missing.
[0m12:30:21.680451 [debug] [Dummy-1   ]: Traceback (most recent call last):
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 341, in exception_handler
    yield
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 147, in add_query
    _execute_query_with_retry(
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 97, in _execute_query_with_retry
    cursor.execute(sql, bindings)
  File "_udf_code.py", line 343, in wrapper
    return original_execute(self, sql, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/snowflake/connector/cursor.py", line 1092, in execute
    Error.errorhandler_wrapper(
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002742 (01000): SQL compilation error: Failed to refresh dynamic table with refresh_trigger INITIAL at data_timestamp 1762720221112 because of the error: SQL compilation error: Target table failed to refresh: Dynamic Table 'INCIDENT_MANAGEMENT.BRONZE_ZONE._CORTEX_SEARCH_SOURCE_INCM_DOC_SEARCH_5AF39AEC_3633_4041_947D_7D4EB2CD0CE2' could not be refreshed because warehouse 'COMPUTE_WH' is missing.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1276, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 421, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 45, in macro
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/clients/jinja.py", line 91, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/clients/jinja.py", line 91, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt_common/record.py", line 507, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 438, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 538, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 575, in add_query
    connection, cursor = self._add_standard_queries(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 631, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 549, in add_standard_query
    return super().add_query(self._add_query_comment(sql), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 130, in add_query
    with self.exception_handler(sql):
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/usr/lib/python_udf/7572a8db11e712fed6beb756e6c14cdfd320d48237f422b7a5b1ae764f1db134/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 367, in exception_handler
    raise DbtDatabaseError(msg)
dbt_common.exceptions.base.DbtDatabaseError: Database Error
  002742 (01000): SQL compilation error: Failed to refresh dynamic table with refresh_trigger INITIAL at data_timestamp 1762720221112 because of the error: SQL compilation error: Target table failed to refresh: Dynamic Table 'INCIDENT_MANAGEMENT.BRONZE_ZONE._CORTEX_SEARCH_SOURCE_INCM_DOC_SEARCH_5AF39AEC_3633_4041_947D_7D4EB2CD0CE2' could not be refreshed because warehouse 'COMPUTE_WH' is missing.

[0m12:30:21.691689 [debug] [Dummy-1   ]: Wrote artifact RunResultsArtifact to /tmp/dbt/target/run_results.json
[0m12:30:21.693904 [debug] [Dummy-1   ]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 4.955063, "process_in_blocks": "0", "process_kernel_time": 1.25, "process_mem_max_rss": "409264", "process_out_blocks": "0", "process_user_time": 5.52}
[0m12:30:21.694692 [debug] [Dummy-1   ]: Command `cli run-operation` failed at 12:30:21.694393 after 4.96 seconds
[0m12:30:21.695375 [debug] [Dummy-1   ]: Connection 'macro_create_document_search_service' was properly closed.
[0m12:30:21.695945 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:32:14.268050 | 5c48b1b3-4249-4851-8867-51f4e4ffb68d ==============================
[0m12:32:14.268050 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:32:14.269369 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m12:32:14.670450 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:32:15.398732 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:32:15.825201 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:32:15.825921 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m12:32:16.042888 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:32:16.045948 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:32:16.084605 [info ] [Dummy-1   ]: Found 13 models, 24 data tests, 6 sources, 483 macros
[0m12:32:16.085866 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'macro_create_document_search_service'
[0m12:32:16.237656 [debug] [Dummy-1   ]: Using snowflake connection "macro_create_document_search_service"
[0m12:32:16.238507 [debug] [Dummy-1   ]: On macro_create_document_search_service: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "macro_create_document_search_service"} */
CREATE OR REPLACE CORTEX SEARCH SERVICE INCIDENT_MANAGEMENT.BRONZE_ZONE.incm_doc_search
      ON chunk
      ATTRIBUTES RELATIVE_PATH, EXTENSION
      WAREHOUSE = compute_wh
      TARGET_LAG = '1 hour'
      EMBEDDING_MODEL = 'snowflake-arctic-embed-l-v2.0'
    AS (
      SELECT
        CHUNK,
        RELATIVE_PATH,
        EXTENSION
      FROM INCIDENT_MANAGEMENT.BRONZE_ZONE.DOCUMENT_FULL_EXTRACTS
    );
[0m12:32:16.239137 [debug] [Dummy-1   ]: Opening a new connection, currently in state init
[0m12:32:26.202445 [debug] [Dummy-1   ]: SQL status: SUCCESS 1 in 9.963 seconds
[0m12:32:26.214636 [debug] [Dummy-1   ]: Wrote artifact RunResultsArtifact to /tmp/dbt/target/run_results.json
[0m12:32:26.216749 [debug] [Dummy-1   ]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 12.0503435, "process_in_blocks": "0", "process_kernel_time": 1.34, "process_mem_max_rss": "412744", "process_out_blocks": "0", "process_user_time": 5.49}
[0m12:32:26.217515 [debug] [Dummy-1   ]: Command `cli run-operation` succeeded at 12:32:26.217224 after 12.05 seconds
[0m12:32:26.218072 [debug] [Dummy-1   ]: Connection 'macro_create_document_search_service' was properly closed.
[0m12:32:26.218661 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:39:02.488775 | e9f622fc-65dc-4a16-a2fd-3750ad8db627 ==============================
[0m12:39:02.488775 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:39:02.489983 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m12:39:02.884307 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:39:03.630581 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:39:04.043485 [debug] [Dummy-1   ]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m12:39:04.044554 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/semantic_views/incm_semantic_view_1.sql
[0m12:39:04.045156 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/semantic_views/build_semantic_view.sql
[0m12:39:04.045878 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://macros/create_document_search_sevice.sql
[0m12:39:04.722587 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:39:04.725882 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:39:04.785757 [info ] [Dummy-1   ]: Found 14 models, 24 data tests, 6 sources, 483 macros
[0m12:39:04.789655 [info ] [Dummy-1   ]: 
[0m12:39:04.790393 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:39:04.790988 [info ] [Dummy-1   ]: 
[0m12:39:04.791962 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:39:04.799605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m12:39:04.932407 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m12:39:04.933145 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m12:39:04.933674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:05.768690 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.835 seconds
[0m12:39:05.783008 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m12:39:05.783707 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m12:39:05.784225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:06.702004 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.918 seconds
[0m12:39:06.704949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now create_incident_management_semantic_views)
[0m12:39:06.705826 [debug] [ThreadPool]: Creating schema "database: "incident_management"
schema: "semantic_views"
"
[0m12:39:06.719743 [debug] [ThreadPool]: Using snowflake connection "create_incident_management_semantic_views"
[0m12:39:06.720385 [debug] [ThreadPool]: On create_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "create_incident_management_semantic_views"} */
create schema if not exists incident_management.semantic_views
[0m12:39:06.720888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:07.530657 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.810 seconds
[0m12:39:07.535039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_incident_management_semantic_views, now list_incident_management_gold_zone)
[0m12:39:07.559064 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:39:07.559789 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:39:07.560321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:08.310560 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.750 seconds
[0m12:39:08.316538 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:39:08.317174 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m12:39:08.428774 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.111 seconds
[0m12:39:08.431331 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:39:08.431957 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:39:08.557347 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.125 seconds
[0m12:39:08.559902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_semantic_views)
[0m12:39:08.570708 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m12:39:08.571373 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:39:08.571878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:09.348086 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.776 seconds
[0m12:39:09.350827 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m12:39:09.351487 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m12:39:09.442789 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.091 seconds
[0m12:39:09.445250 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m12:39:09.445854 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:39:09.536216 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m12:39:09.538655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_bronze_zone)
[0m12:39:09.551076 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:39:09.551727 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:39:09.552285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:10.492149 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.940 seconds
[0m12:39:10.494608 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:39:10.495234 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m12:39:10.630939 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.135 seconds
[0m12:39:10.633809 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:39:10.634438 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:39:10.713104 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.078 seconds
[0m12:39:10.723355 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m12:39:10.724296 [info ] [Thread-2 (]: 1 of 2 START sql incremental model bronze_zone.users ........................... [RUN]
[0m12:39:10.725583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m12:39:10.726229 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m12:39:10.744215 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m12:39:10.745184 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m12:39:10.968490 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m12:39:10.969331 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
create or replace  temporary view incident_management.bronze_zone.users__dbt_tmp
  
   as (
    

select 
    sm.MEMBERIDS[0] as id,
    sm.memberemails[0] as email,
    split(sm.memberemails[0], '@')[0] as first_name,
    split(sm.memberemails[0], '@')[1] as last_name,
    'reporter' as role,
    '' as department,
    '' as team,
    true as is_active,
    current_timestamp() as created_at,
    current_timestamp() as updated_at
from incident_management.bronze_zone.slack_members sm
  );
[0m12:39:10.969930 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:39:12.174529 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c04877-0106-e9ca-0032-31870541791e
[0m12:39:12.175284 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MEMBERS' does not exist or not authorized.
[0m12:39:12.180856 [debug] [Thread-2 (]: Database Error in model users (models/bronze_zone/users.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MEMBERS' does not exist or not authorized.
[0m12:39:12.184429 [error] [Thread-2 (]: 1 of 2 ERROR creating sql incremental model bronze_zone.users .................. [[31mERROR[0m in 1.46s]
[0m12:39:12.185431 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m12:39:12.186721 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.users' to be skipped because of status 'error'.  Reason: Database Error in model users (models/bronze_zone/users.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MEMBERS' does not exist or not authorized..
[0m12:39:12.188753 [debug] [Thread-2 (]: Began running node model.incident_management.incm_semantic_view_1
[0m12:39:12.189636 [info ] [Thread-2 (]: 2 of 2 SKIP relation semantic_views.incm_semantic_view_1 ....................... [[33mSKIP[0m]
[0m12:39:12.190327 [debug] [Thread-2 (]: Finished running node model.incident_management.incm_semantic_view_1
[0m12:39:12.192929 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:39:12.193509 [debug] [Dummy-1   ]: Connection 'model.incident_management.users' was properly closed.
[0m12:39:12.194049 [info ] [Dummy-1   ]: 
[0m12:39:12.194589 [info ] [Dummy-1   ]: Finished running 1 incremental model, 1 semantic view model in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m12:39:12.195668 [debug] [Dummy-1   ]: Command end result
[0m12:39:12.242950 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:39:12.246004 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:39:12.254437 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:39:12.255049 [info ] [Dummy-1   ]: 
[0m12:39:12.255754 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:39:12.256283 [info ] [Dummy-1   ]: 
[0m12:39:12.257032 [error] [Dummy-1   ]:   Database Error in model users (models/bronze_zone/users.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MEMBERS' does not exist or not authorized.
[0m12:39:12.257568 [info ] [Dummy-1   ]: 
[0m12:39:12.258093 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m12:39:12.260120 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.872699, "process_in_blocks": "0", "process_kernel_time": 1.54, "process_mem_max_rss": "487108", "process_out_blocks": "0", "process_user_time": 6.44}
[0m12:39:12.260836 [debug] [Dummy-1   ]: Command `cli run` failed at 12:39:12.260558 after 9.87 seconds
[0m12:39:12.261414 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:39:46.414098 | 3c4974be-ed8f-4e14-8c54-dcbe203cb8ec ==============================
[0m12:39:46.414098 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:39:46.415329 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m12:39:46.812079 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:39:47.621023 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:39:48.068683 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:39:48.069892 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/semantic_views/incm_semantic_view_1.sql
[0m12:39:48.770497 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:39:48.773808 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:39:48.839848 [info ] [Dummy-1   ]: Found 14 models, 24 data tests, 6 sources, 483 macros
[0m12:39:48.854262 [info ] [Dummy-1   ]: 
[0m12:39:48.855033 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:39:48.855607 [info ] [Dummy-1   ]: 
[0m12:39:48.856604 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:39:48.864587 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m12:39:49.002408 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m12:39:49.003271 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m12:39:49.003896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:49.826526 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.822 seconds
[0m12:39:49.842256 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m12:39:49.843002 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m12:39:49.843576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:50.554756 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.711 seconds
[0m12:39:50.560000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m12:39:50.583459 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:39:50.584139 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:39:50.584646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:51.291875 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.707 seconds
[0m12:39:51.297847 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:39:51.298649 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m12:39:51.377889 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.078 seconds
[0m12:39:51.380629 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m12:39:51.381266 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:39:51.462243 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.080 seconds
[0m12:39:51.464742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m12:39:51.477582 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:39:51.478241 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:39:51.478865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:52.221463 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.742 seconds
[0m12:39:52.224032 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:39:52.224630 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m12:39:52.326227 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.101 seconds
[0m12:39:52.329500 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m12:39:52.330118 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:39:52.437395 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.107 seconds
[0m12:39:52.440186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_semantic_views)
[0m12:39:52.453512 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m12:39:52.454180 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:39:52.454690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:53.470891 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.016 seconds
[0m12:39:53.473462 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m12:39:53.474083 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m12:39:53.560063 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.085 seconds
[0m12:39:53.562552 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m12:39:53.563208 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:39:53.650441 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.086 seconds
[0m12:39:53.657981 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m12:39:53.659066 [info ] [Thread-2 (]: 1 of 3 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m12:39:53.659885 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now model.incident_management.v_qualify_new_documents)
[0m12:39:53.660524 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m12:39:53.681146 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m12:39:53.682165 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m12:39:53.742703 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m12:39:53.744678 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m12:39:53.745433 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m12:39:53.746073 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:39:54.806789 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.060 seconds
[0m12:39:54.845667 [info ] [Thread-2 (]: 1 of 3 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.18s]
[0m12:39:54.846734 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m12:39:54.848861 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m12:39:54.849973 [info ] [Thread-2 (]: 2 of 3 START sql table model bronze_zone.document_full_extracts ................ [RUN]
[0m12:39:54.850792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_full_extracts)
[0m12:39:54.851433 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m12:39:55.031255 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m12:39:55.032296 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m12:39:55.073403 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.document_full_extracts"
[0m12:39:55.075988 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_full_extracts"
[0m12:39:55.076800 [debug] [Thread-2 (]: On model.incident_management.document_full_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_full_extracts"} */
create or replace transient table incident_management.bronze_zone.document_full_extracts
         as
        (

with 
documents_raw_extracts as(
    select
        *,
        AI_PARSE_DOCUMENT (
            TO_FILE('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS',relative_path),
             {
                'mode': 'LAYOUT'
                ,'page_split': True
             }
        ) as raw_extracts
        FROM incident_management.bronze_zone.v_qualify_new_documents
        WHERE lower(doc_type) = 'full'
),
documents_chunked_extracts as
(
    select 
    og1.* exclude (raw_extracts),
    SNOWFLAKE.CORTEX.SPLIT_TEXT_MARKDOWN_HEADER(
        lf1.value:content::STRING,
        OBJECT_CONSTRUCT('#', 'header_1', '##', 'header_2'),
        500,
        5
    ) as page_chunks,
    lf1.index::int as page_num
    from documents_raw_extracts og1,
    LATERAL FLATTEN(input => raw_extracts:pages) lf1
)

select 
    og2.* exclude (page_chunks),
    lf2.value['chunk']::varchar as chunk,
    lf2.value['headers']::object as headers
from documents_chunked_extracts og2,
lateral flatten(input => page_chunks) lf2
        );
[0m12:39:55.077460 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:39:56.799660 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.722 seconds
[0m12:39:56.803469 [info ] [Thread-2 (]: 2 of 3 OK created sql table model bronze_zone.document_full_extracts ........... [[32mSUCCESS 1[0m in 1.95s]
[0m12:39:56.804514 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m12:39:56.806365 [debug] [Thread-2 (]: Began running node model.incident_management.incm_semantic_view_1
[0m12:39:56.807478 [info ] [Thread-2 (]: 3 of 3 START sql semantic_view model semantic_views.incm_semantic_view_1 ....... [RUN]
[0m12:39:56.808261 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.incm_semantic_view_1)
[0m12:39:56.808999 [debug] [Thread-2 (]: Began compiling node model.incident_management.incm_semantic_view_1
[0m12:39:56.821199 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incm_semantic_view_1"
[0m12:39:56.822220 [debug] [Thread-2 (]: Began executing node model.incident_management.incm_semantic_view_1
[0m12:39:56.843367 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.incm_semantic_view_1"
[0m12:39:56.844783 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incm_semantic_view_1"
[0m12:39:56.845435 [debug] [Thread-2 (]: On model.incident_management.incm_semantic_view_1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incm_semantic_view_1"} */
create or replace semantic view incident_management.semantic_views.incm_semantic_view_1
  

TABLES(
  incident_management.bronze_zone.document_full_extracts
)
[0m12:39:56.846007 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:39:57.507061 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c04877-0106-f4e2-0032-318705415f0e
[0m12:39:57.507806 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 010226 (42601): SQL compilation error:
No queryable expression is defined in the semantic view.
[0m12:39:57.513704 [debug] [Thread-2 (]: Database Error in model incm_semantic_view_1 (models/semantic_views/incm_semantic_view_1.sql)
  010226 (42601): SQL compilation error:
  No queryable expression is defined in the semantic view.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/incm_semantic_view_1.sql
[0m12:39:57.515302 [error] [Thread-2 (]: 3 of 3 ERROR creating sql semantic_view model semantic_views.incm_semantic_view_1  [[31mERROR[0m in 0.71s]
[0m12:39:57.516298 [debug] [Thread-2 (]: Finished running node model.incident_management.incm_semantic_view_1
[0m12:39:57.517624 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.incm_semantic_view_1' to be skipped because of status 'error'.  Reason: Database Error in model incm_semantic_view_1 (models/semantic_views/incm_semantic_view_1.sql)
  010226 (42601): SQL compilation error:
  No queryable expression is defined in the semantic view.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/incm_semantic_view_1.sql.
[0m12:39:57.520746 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:39:57.521320 [debug] [Dummy-1   ]: Connection 'model.incident_management.incm_semantic_view_1' was properly closed.
[0m12:39:57.521866 [info ] [Dummy-1   ]: 
[0m12:39:57.522404 [info ] [Dummy-1   ]: Finished running 1 semantic view model, 1 table model, 1 view model in 0 hours 0 minutes and 8.67 seconds (8.67s).
[0m12:39:57.523802 [debug] [Dummy-1   ]: Command end result
[0m12:39:57.573894 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:39:57.577097 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:39:57.585825 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:39:57.586417 [info ] [Dummy-1   ]: 
[0m12:39:57.587119 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:39:57.587657 [info ] [Dummy-1   ]: 
[0m12:39:57.588470 [error] [Dummy-1   ]:   Database Error in model incm_semantic_view_1 (models/semantic_views/incm_semantic_view_1.sql)
  010226 (42601): SQL compilation error:
  No queryable expression is defined in the semantic view.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/incm_semantic_view_1.sql
[0m12:39:57.589044 [info ] [Dummy-1   ]: 
[0m12:39:57.589573 [info ] [Dummy-1   ]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m12:39:57.591484 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.28053, "process_in_blocks": "0", "process_kernel_time": 1.55, "process_mem_max_rss": "479536", "process_out_blocks": "0", "process_user_time": 6.83}
[0m12:39:57.592189 [debug] [Dummy-1   ]: Command `cli run` failed at 12:39:57.591914 after 11.28 seconds
[0m12:39:57.592764 [debug] [Dummy-1   ]: Flushing usage events


============================== 14:48:43.453224 | 83ef0674-034d-4a44-aa4e-4d732c65b1af ==============================
[0m14:48:43.453224 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m14:48:43.454302 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m14:48:43.823670 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m14:48:44.633040 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m14:48:45.033577 [debug] [Dummy-1   ]: Partial parsing enabled: 7 files deleted, 13 files added, 5 files changed.
[0m14:48:45.034781 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/users.yml
[0m14:48:45.035521 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/document_full_extracts.yml
[0m14:48:45.036278 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/incident_attachments.yml
[0m14:48:45.037029 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/weekly_incident_trends.yml
[0m14:48:45.037728 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/closed_incidents.yml
[0m14:48:45.038578 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/v_qualify_slack_messages.yml
[0m14:48:45.039262 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/incident_comment_history.yml
[0m14:48:45.039982 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/document_question_extracts.yml
[0m14:48:45.040649 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/v_slack_msg_incident_number.yml
[0m14:48:45.041240 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/v_qualify_new_documents.yml
[0m14:48:45.041861 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/incidents.yml
[0m14:48:45.042456 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/semantic_views/alpha.sql
[0m14:48:45.043109 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/active_incidents.yml
[0m14:48:45.044242 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/gold_zone/monthly_incident_trends.sql
[0m14:48:45.044778 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/semantic_views/incm_semantic_view_1.sql
[0m14:48:45.045300 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/bronze_zone/v_stg_servicenow_incidents.sql
[0m14:48:45.045788 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/gold_zone/fact_incident.sql
[0m14:48:45.046420 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/users.sql
[0m14:48:45.046932 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_full_extracts.sql
[0m14:48:45.047544 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_new_documents.sql
[0m14:48:45.048163 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_slack_msg_incident_number.sql
[0m14:48:45.048865 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_slack_messages.sql
[0m14:48:45.945323 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.alpha' (models/semantic_views/alpha.sql) depends on a node named 'v_slack_msg_incident_number' which is disabled
[0m14:48:45.947591 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.589995, "process_in_blocks": "0", "process_kernel_time": 1.46, "process_mem_max_rss": "460436", "process_out_blocks": "0", "process_user_time": 5.61}
[0m14:48:45.948327 [debug] [Dummy-1   ]: Command `cli compile` failed at 14:48:45.948046 after 2.59 seconds
[0m14:48:45.949076 [debug] [Dummy-1   ]: Flushing usage events


============================== 14:49:30.289392 | dadc65f6-0ce8-4381-b443-16710c8e8f07 ==============================
[0m14:49:30.289392 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m14:49:30.290603 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m14:49:30.674557 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m14:49:31.453583 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m14:49:31.875588 [debug] [Dummy-1   ]: Partial parsing enabled: 7 files deleted, 13 files added, 5 files changed.
[0m14:49:31.876770 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/active_incidents.yml
[0m14:49:31.877515 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/v_qualify_slack_messages.yml
[0m14:49:31.878311 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/weekly_incident_trends.yml
[0m14:49:31.878973 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/v_qualify_new_documents.yml
[0m14:49:31.879591 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/document_full_extracts.yml
[0m14:49:31.880136 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/semantic_views/alpha.sql
[0m14:49:31.880732 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/incidents.yml
[0m14:49:31.881345 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/v_slack_msg_incident_number.yml
[0m14:49:31.881931 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/users.yml
[0m14:49:31.882515 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/incident_attachments.yml
[0m14:49:31.883170 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/document_question_extracts.yml
[0m14:49:31.883727 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/incident_comment_history.yml
[0m14:49:31.884345 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/closed_incidents.yml
[0m14:49:31.885457 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/semantic_views/incm_semantic_view_1.sql
[0m14:49:31.886087 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/bronze_zone/v_stg_servicenow_incidents.sql
[0m14:49:31.886632 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/gold_zone/monthly_incident_trends.sql
[0m14:49:31.887219 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/gold_zone/fact_incident.sql
[0m14:49:31.887811 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_full_extracts.sql
[0m14:49:31.888482 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_slack_msg_incident_number.sql
[0m14:49:31.889141 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/users.sql
[0m14:49:31.889773 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_slack_messages.sql
[0m14:49:31.890437 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_new_documents.sql
[0m14:49:32.842484 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.alpha' (models/semantic_views/alpha.sql) depends on a node named 'v_slack_msg_incident_number' which is disabled
[0m14:49:32.844810 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6541326, "process_in_blocks": "0", "process_kernel_time": 1.25, "process_mem_max_rss": "463180", "process_out_blocks": "0", "process_user_time": 6.03}
[0m14:49:32.845661 [debug] [Dummy-1   ]: Command `cli run` failed at 14:49:32.845376 after 2.66 seconds
[0m14:49:32.846373 [debug] [Dummy-1   ]: Flushing usage events


============================== 14:50:43.515176 | 7a349bfb-a5a0-4b10-958d-3fcb19530a7c ==============================
[0m14:50:43.515176 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m14:50:43.516281 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m14:50:43.897695 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m14:50:44.722793 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m14:50:45.146673 [debug] [Dummy-1   ]: Partial parsing enabled: 7 files deleted, 13 files added, 5 files changed.
[0m14:50:45.147837 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/incident_attachments.yml
[0m14:50:45.148703 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/weekly_incident_trends.yml
[0m14:50:45.149548 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/v_slack_msg_incident_number.yml
[0m14:50:45.150271 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/v_qualify_slack_messages.yml
[0m14:50:45.150942 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/active_incidents.yml
[0m14:50:45.151550 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/incident_comment_history.yml
[0m14:50:45.152242 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/closed_incidents.yml
[0m14:50:45.152965 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/incidents.yml
[0m14:50:45.153596 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/users.yml
[0m14:50:45.154202 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/semantic_views/alpha.sql
[0m14:50:45.154853 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/document_full_extracts.yml
[0m14:50:45.155467 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/v_qualify_new_documents.yml
[0m14:50:45.156151 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/document_question_extracts.yml
[0m14:50:45.157277 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/gold_zone/fact_incident.sql
[0m14:50:45.157827 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/gold_zone/monthly_incident_trends.sql
[0m14:50:45.158489 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/bronze_zone/v_stg_servicenow_incidents.sql
[0m14:50:45.159055 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/semantic_views/incm_semantic_view_1.sql
[0m14:50:45.159715 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/users.sql
[0m14:50:45.160338 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_new_documents.sql
[0m14:50:45.160919 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_full_extracts.sql
[0m14:50:45.161532 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_slack_msg_incident_number.sql
[0m14:50:45.162193 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_slack_messages.sql
[0m14:50:46.122402 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.alpha' (models/semantic_views/alpha.sql) depends on a node named 'v_slack_msg_incident_number' which is disabled
[0m14:50:46.124553 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7071528, "process_in_blocks": "0", "process_kernel_time": 1.23, "process_mem_max_rss": "460824", "process_out_blocks": "0", "process_user_time": 5.9}
[0m14:50:46.125361 [debug] [Dummy-1   ]: Command `cli run` failed at 14:50:46.125065 after 2.71 seconds
[0m14:50:46.126106 [debug] [Dummy-1   ]: Flushing usage events


============================== 14:52:43.258107 | f2a128df-e009-458e-bdbe-1bcf34e62c19 ==============================
[0m14:52:43.258107 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m14:52:43.259259 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m14:52:43.635541 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m14:52:44.398384 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m14:52:44.804360 [debug] [Dummy-1   ]: Partial parsing enabled: 7 files deleted, 13 files added, 5 files changed.
[0m14:52:44.805462 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/incident_attachments.yml
[0m14:52:44.806148 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/users.yml
[0m14:52:44.806891 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/v_qualify_slack_messages.yml
[0m14:52:44.807533 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/v_slack_msg_incident_number.yml
[0m14:52:44.808072 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/semantic_views/alpha.sql
[0m14:52:44.809042 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/incident_comment_history.yml
[0m14:52:44.809705 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/incidents.yml
[0m14:52:44.810389 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/closed_incidents.yml
[0m14:52:44.811004 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/document_full_extracts.yml
[0m14:52:44.811578 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/v_qualify_new_documents.yml
[0m14:52:44.812248 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/bronze_zone/document_question_extracts.yml
[0m14:52:44.812852 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/active_incidents.yml
[0m14:52:44.813447 [debug] [Dummy-1   ]: Partial parsing: added file: incident_management://models/gold_zone/weekly_incident_trends.yml
[0m14:52:44.814547 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/gold_zone/fact_incident.sql
[0m14:52:44.815079 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/bronze_zone/v_stg_servicenow_incidents.sql
[0m14:52:44.815554 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/gold_zone/monthly_incident_trends.sql
[0m14:52:44.816025 [debug] [Dummy-1   ]: Partial parsing: deleted file: incident_management://models/semantic_views/incm_semantic_view_1.sql
[0m14:52:44.816620 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_slack_messages.sql
[0m14:52:44.817203 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/users.sql
[0m14:52:44.817783 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_new_documents.sql
[0m14:52:44.818343 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_full_extracts.sql
[0m14:52:44.819023 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_slack_msg_incident_number.sql
[0m14:52:46.133274 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m14:52:46.136189 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m14:52:46.195206 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m14:52:46.198336 [info ] [Dummy-1   ]: 
[0m14:52:46.199051 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m14:52:46.199574 [info ] [Dummy-1   ]: 
[0m14:52:46.200483 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m14:52:46.207829 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m14:52:46.328546 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m14:52:46.329291 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m14:52:46.329816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:47.655426 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.325 seconds
[0m14:52:47.660946 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_semantic_views'
[0m14:52:47.683200 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m14:52:47.683810 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:52:47.684312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:48.782130 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.098 seconds
[0m14:52:48.787933 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m14:52:48.788590 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m14:52:48.951117 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.162 seconds
[0m14:52:48.953514 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m14:52:48.954099 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:52:49.105511 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.151 seconds
[0m14:52:49.107903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_bronze_zone)
[0m14:52:49.120597 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m14:52:49.121185 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:52:49.121680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:50.436899 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.315 seconds
[0m14:52:50.439415 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m14:52:50.439965 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m14:52:50.550212 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.110 seconds
[0m14:52:50.552904 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m14:52:50.553461 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:52:50.649207 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m14:52:50.651800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m14:52:50.664496 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m14:52:50.665077 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:52:50.665566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:51.513221 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.847 seconds
[0m14:52:51.515646 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m14:52:51.516199 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m14:52:51.602716 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.086 seconds
[0m14:52:51.604954 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m14:52:51.605498 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:52:51.696717 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m14:52:51.704275 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m14:52:51.705156 [info ] [Thread-2 (]: 1 of 5 START sql incremental model bronze_zone.users ........................... [RUN]
[0m14:52:51.705879 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m14:52:51.706488 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m14:52:51.725374 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m14:52:51.726269 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m14:52:51.802839 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m14:52:51.803584 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
create or replace  temporary view incident_management.bronze_zone.users__dbt_tmp
  
   as (
    

select 
    sm.MEMBERIDS[0] as id,
    sm.memberemails[0] as email,
    split(sm.memberemails[0], '@')[0] as first_name,
    split(sm.memberemails[0], '@')[1] as last_name,
    'reporter' as role,
    '' as department,
    '' as team,
    true as is_active,
    current_timestamp() as created_at,
    current_timestamp() as updated_at
from incident_management.bronze_zone.slack_members sm
  );
[0m14:52:51.804178 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:53.025126 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.221 seconds
[0m14:52:53.046411 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m14:52:53.047116 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
describe table incident_management.bronze_zone.users__dbt_tmp
[0m14:52:53.145900 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.098 seconds
[0m14:52:53.158598 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m14:52:53.159288 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
describe table incident_management.bronze_zone.users
[0m14:52:53.252700 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.093 seconds
[0m14:52:53.272214 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m14:52:53.272901 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
describe table "INCIDENT_MANAGEMENT"."BRONZE_ZONE"."USERS"
[0m14:52:53.371238 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.098 seconds
[0m14:52:53.471776 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.users"
[0m14:52:53.473997 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m14:52:53.474633 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
-- back compat for old kwarg name
  
  begin;
[0m14:52:53.648272 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m14:52:53.649126 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m14:52:53.649827 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
merge into incident_management.bronze_zone.users as DBT_INTERNAL_DEST
        using incident_management.bronze_zone.users__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.email = DBT_INTERNAL_DEST.email))

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","EMAIL" = DBT_INTERNAL_SOURCE."EMAIL","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","ROLE" = DBT_INTERNAL_SOURCE."ROLE","DEPARTMENT" = DBT_INTERNAL_SOURCE."DEPARTMENT","TEAM" = DBT_INTERNAL_SOURCE."TEAM","IS_ACTIVE" = DBT_INTERNAL_SOURCE."IS_ACTIVE","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("ID", "EMAIL", "FIRST_NAME", "LAST_NAME", "ROLE", "DEPARTMENT", "TEAM", "IS_ACTIVE", "CREATED_AT", "UPDATED_AT")
    values
        ("ID", "EMAIL", "FIRST_NAME", "LAST_NAME", "ROLE", "DEPARTMENT", "TEAM", "IS_ACTIVE", "CREATED_AT", "UPDATED_AT")

;
[0m14:52:54.393075 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.742 seconds
[0m14:52:54.393929 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m14:52:54.394567 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
COMMIT
[0m14:52:54.734361 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.339 seconds
[0m14:52:54.754391 [debug] [Thread-2 (]: Applying DROP to: incident_management.bronze_zone.users__dbt_tmp
[0m14:52:54.775766 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m14:52:54.776471 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
drop view if exists incident_management.bronze_zone.users__dbt_tmp cascade
[0m14:52:54.900037 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m14:52:54.929519 [info ] [Thread-2 (]: 1 of 5 OK created sql incremental model bronze_zone.users ...................... [[32mSUCCESS 0[0m in 3.22s]
[0m14:52:54.930547 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m14:52:54.931759 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m14:52:54.932674 [info ] [Thread-2 (]: 2 of 5 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m14:52:54.933400 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m14:52:54.933996 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m14:52:54.947073 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m14:52:54.947917 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m14:52:54.975334 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m14:52:54.977076 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m14:52:54.977759 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m14:52:54.978456 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:56.046679 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.068 seconds
[0m14:52:56.050178 [info ] [Thread-2 (]: 2 of 5 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.12s]
[0m14:52:56.051186 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m14:52:56.052276 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m14:52:56.053353 [info ] [Thread-2 (]: 3 of 5 START sql view model bronze_zone.v_qualify_slack_messages ............... [RUN]
[0m14:52:56.054064 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m14:52:56.054655 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m14:52:56.069323 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m14:52:56.070205 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m14:52:56.080899 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_slack_messages"
[0m14:52:56.084944 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_slack_messages"
[0m14:52:56.085983 [debug] [Thread-2 (]: On model.incident_management.v_qualify_slack_messages: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_slack_messages"} */
create or replace   view incident_management.bronze_zone.v_qualify_slack_messages
  
   as (
    

-- Only propagate messages from known reporters (users in channel)
with slack_messages_from_known_reporters as (
    select sm.*, r.id as reporter_id
    from incident_management.bronze_zone.slack_messages sm
    inner join incident_management.bronze_zone.users r on sm.username = split(r.email, '@')[0]
    where sm.clientmsgid is not null
    and to_date(sm.ingestts) >= to_date(current_timestamp())
)

-- Messages with attachments (with join to doc_metadata)
select 
    true as hasfiles,
    sm.type,
    sm.subtype,
    sm.team,
    sm.channel,
    sm.user,
    sm.username,
    sm.reporter_id,
    sm.text,
    sm.ts,
    sm.clientmsgid as slack_message_id,
    
    -- Attachment metadata from doc_metadata
    dm.file_id,
    dm.file_name, 
    dm.file_mimetype, 
    dm.file_size, 
    dm.staged_file_path,
    to_file('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', dm.staged_file_path) as attachment_file,
    case 
        -- When there is an attachment file and it is an image, use the image to extract the incident code
        when dm.staged_file_path is not null and fl_is_image(to_file('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', dm.staged_file_path)) then 
        ai_complete('claude-3-5-sonnet',
            prompt(
            $$
            Find the incident number that may be present either in the image {0} or in the text {1}. 
            Use the one in the image if found.Look for alphanumeric codes preceded by the keyword 'incident' (case-insensitive). 
            Examples: INC-12345, incident_001, INC-2025-001.
            Respond only in JSON format with a single key called 'incident_code'.
            Do not add any explanation in the response.
            $$, 
            attachment_file,
            text
            )
        )
        else null
    end as incident_number

from slack_messages_from_known_reporters sm
inner join incident_management.bronze_zone.doc_metadata dm 
on (sm.hasfiles and (sm.channel = dm.channel_id) and (sm.ts = dm.event_ts))

UNION ALL

-- Messages without attachments (no join to doc_metadata)
select 
    false as hasfiles,
    sm.type,
    sm.subtype,
    sm.team,
    sm.channel,
    sm.user,
    sm.username,
    sm.reporter_id,
    sm.text,
    sm.ts,
    sm.clientmsgid as slack_message_id,
    
    -- No attachment metadata for messages without files
    null as file_id,
    null as file_name, 
    null as file_mimetype, 
    null as file_size, 
    null as staged_file_path,
    null as attachment_file,
    case 
        -- Only use text to extract the incident code since there are no attachments
        when sm.text is not null then ai_complete('claude-3-5-sonnet',
                prompt(
                $$
                Extract incident codes from Slack text {0}. 
                Look for alphanumeric codes preceded by the keyword 'incident' (case-insensitive). 
                Examples: INC-12345, incident_001, INC-2025-001.
                Respond only in JSON format with a single key called 'incident_code'.
                Do not add any explanation in the response.
                $$, 
                text
            )
        )
        else null
    end as incident_number

from slack_messages_from_known_reporters sm
where not sm.hasfiles or sm.hasfiles is null
  );
[0m14:52:56.086833 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:57.556248 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.469 seconds
[0m14:52:57.559744 [info ] [Thread-2 (]: 3 of 5 OK created sql view model bronze_zone.v_qualify_slack_messages .......... [[32mSUCCESS 1[0m in 1.51s]
[0m14:52:57.560679 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m14:52:57.561737 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m14:52:57.562633 [info ] [Thread-2 (]: 4 of 5 START sql table model bronze_zone.document_full_extracts ................ [RUN]
[0m14:52:57.563320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now model.incident_management.document_full_extracts)
[0m14:52:57.563881 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m14:52:57.577920 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m14:52:57.578816 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m14:52:57.617158 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.document_full_extracts"
[0m14:52:57.619697 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_full_extracts"
[0m14:52:57.620469 [debug] [Thread-2 (]: On model.incident_management.document_full_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_full_extracts"} */
create or replace transient table incident_management.bronze_zone.document_full_extracts
         as
        (

with 
documents_raw_extracts as(
    select
        * exclude (METADATA$ACTION, METADATA$ISUPDATE, METADATA$ROW_ID) ,
        AI_PARSE_DOCUMENT (
            TO_FILE('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS',relative_path),
             {
                'mode': 'LAYOUT'
                ,'page_split': True
             }
        ) as raw_extracts
        FROM incident_management.bronze_zone.v_qualify_new_documents
        WHERE lower(doc_type) = 'full'
),
documents_chunked_extracts as
(
    select 
    og1.* exclude (raw_extracts),
    SNOWFLAKE.CORTEX.SPLIT_TEXT_MARKDOWN_HEADER(
        lf1.value:content::STRING,
        OBJECT_CONSTRUCT('#', 'header_1', '##', 'header_2'),
        500,
        5
    ) as page_chunks,
    lf1.index::int as page_num
    from documents_raw_extracts og1,
    LATERAL FLATTEN(input => raw_extracts:pages) lf1
)

select 
    og2.* exclude (page_chunks), 
    lf2.value['chunk']::varchar as chunk,
    lf2.value['headers']::object as headers
from documents_chunked_extracts og2,
lateral flatten(input => page_chunks) lf2
        );
[0m14:52:57.621110 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:59.498706 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.877 seconds
[0m14:52:59.502061 [info ] [Thread-2 (]: 4 of 5 OK created sql table model bronze_zone.document_full_extracts ........... [[32mSUCCESS 1[0m in 1.94s]
[0m14:52:59.503024 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m14:52:59.504308 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m14:52:59.505342 [info ] [Thread-2 (]: 5 of 5 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m14:52:59.506118 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m14:52:59.506817 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m14:52:59.544853 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m14:52:59.545879 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m14:52:59.559997 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m14:52:59.563307 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m14:52:59.564639 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session

    
def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    docs_stage = dbt.config.get("docs_stage_path")
    global_inm_policy_schema = dbt.config.get("meta")['global_inm_policy_schema']

    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.lower(F.col('doc_type')) == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}'), F.col('relative_path')),
            global_inm_policy_schema
        )
    )    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'docs_stage_path': None, 'meta': {'global_inm_policy_schema': {'schema': {'type': 'object', 'properties': {'purpose': {'description': 'Purpose of this policy', 'type': 'string'}, 'objectives': {'description': 'Objectives achieved by this policy', 'type': 'string'}, 'policy_statement': {'description': 'Primary policy statement', 'type': 'string'}, 'in_scope_services': {'description': 'Services explicitly in scope', 'type': 'array'}, 'out_of_scope_services': {'description': 'Services explicitly out of scope', 'type': 'array'}, 'geographical_coverage': {'description': 'Countries/regions covered', 'type': 'array'}, 'business_units_in_scope': {'description': 'Business units covered by the policy', 'type': 'array'}, 'applicability_conditions': {'description': 'Conditions determining when policy applies', 'type': 'array'}, 'exclusions': {'description': 'Explicit exceptions to scope', 'type': 'array'}, 'definitions_and_glossary': {'description': 'Terms, acronyms, and reference standards', 'type': 'object', 'properties': {'defined_terms': {'description': 'Key defined terms', 'type': 'array'}, 'acronyms': {'description': 'Acronyms used within the document', 'type': 'array'}, 'reference_standards': {'description': 'Referenced standards and frameworks', 'type': 'array'}}}}}}}}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m14:52:59.565732 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:53:04.947471 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 5.382 seconds
[0m14:53:04.951536 [info ] [Thread-2 (]: 5 of 5 OK created python table model bronze_zone.document_question_extracts .... [[32mSUCCESS 1[0m in 5.44s]
[0m14:53:04.952624 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m14:53:04.955780 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m14:53:04.956311 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m14:53:04.956783 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m14:53:04.957414 [info ] [Dummy-1   ]: 
[0m14:53:04.957963 [info ] [Dummy-1   ]: Finished running 1 incremental model, 2 table models, 2 view models in 0 hours 0 minutes and 18.76 seconds (18.76s).
[0m14:53:04.959702 [debug] [Dummy-1   ]: Command end result
[0m14:53:05.008224 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m14:53:05.011122 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m14:53:05.018900 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m14:53:05.019429 [info ] [Dummy-1   ]: 
[0m14:53:05.020143 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m14:53:05.020671 [info ] [Dummy-1   ]: 
[0m14:53:05.021194 [info ] [Dummy-1   ]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:53:05.022995 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.86224, "process_in_blocks": "0", "process_kernel_time": 1.42, "process_mem_max_rss": "489092", "process_out_blocks": "0", "process_user_time": 7.22}
[0m14:53:05.023676 [debug] [Dummy-1   ]: Command `cli run` succeeded at 14:53:05.023404 after 21.86 seconds
[0m14:53:05.024215 [debug] [Dummy-1   ]: Flushing usage events


============================== 14:53:26.441946 | 205f5850-7632-4252-a907-4f4acb92bc8f ==============================
[0m14:53:26.441946 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m14:53:26.443118 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m14:53:26.826758 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m14:53:27.601465 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m14:53:28.058950 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:28.059701 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:28.276505 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m14:53:28.279727 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m14:53:28.342252 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m14:53:28.345694 [info ] [Dummy-1   ]: 
[0m14:53:28.346346 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m14:53:28.346823 [info ] [Dummy-1   ]: 
[0m14:53:28.347689 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m14:53:28.355523 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m14:53:28.506658 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m14:53:28.507313 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m14:53:28.507820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:29.389628 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.882 seconds
[0m14:53:29.394513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m14:53:29.418478 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m14:53:29.419190 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:53:29.419719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:30.252300 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.832 seconds
[0m14:53:30.258224 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m14:53:30.259175 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m14:53:30.386433 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.127 seconds
[0m14:53:30.388951 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m14:53:30.389538 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:53:30.538711 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.148 seconds
[0m14:53:30.541115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m14:53:30.553820 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m14:53:30.554491 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:53:30.555005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:31.355467 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.800 seconds
[0m14:53:31.357963 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m14:53:31.358725 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m14:53:31.497176 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.138 seconds
[0m14:53:31.500140 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m14:53:31.500746 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:53:31.590507 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m14:53:31.593219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_semantic_views)
[0m14:53:31.607007 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m14:53:31.607672 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:53:31.608205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:32.505846 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.897 seconds
[0m14:53:32.508306 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m14:53:32.508981 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m14:53:32.626952 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.117 seconds
[0m14:53:32.629424 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m14:53:32.630033 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:53:32.741721 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m14:53:32.749113 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m14:53:32.750084 [info ] [Thread-2 (]: 1 of 6 START sql incremental model gold_zone.incidents ......................... [RUN]
[0m14:53:32.750867 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now model.incident_management.incidents)
[0m14:53:32.751467 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m14:53:32.772228 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m14:53:32.773214 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m14:53:32.863640 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.incidents"
[0m14:53:32.868968 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m14:53:32.870155 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
create or replace transient table incident_management.gold_zone.incidents
         as
        (-- Create only new incidents in this incremental mode; new incidents are detected by absence of an incident number from previous step in the pipeline or,
-- they are not related to any existing incident by title and text.


-- Get recent open incidents for lookback when incident_code is null
with 

recent_open_incidents as (
    select * from incident_management.gold_zone.incidents
    where lower(status) = 'open' 
    and reportee_id is not null
    and created_at > dateadd('day', -7, current_timestamp())
)

, new_slack_messages as (
    select lh.*
    from incident_management.bronze_zone.v_qualify_slack_messages lh 
    left join recent_open_incidents rh 
    on lh.slack_message_id = rh.slack_message_id
    where rh.slack_message_id is null
)

-- Split messages based on whether they have valid incident codes
, messages_with_incident_code as (
    select *
    from new_slack_messages
    where not IS_NULL_VALUE(parse_json(incident_number):incident_code)
)

, messages_without_incident_code as (
    select *
    from new_slack_messages
    where IS_NULL_VALUE(parse_json(incident_number):incident_code)
)

-- For messages without incident codes, try to find existing incidents
, messages_with_matching_incidents as (
    select 
        sm.*,
        ai_classify(sm.text, ['payment gateway error', 'login error', 'other']):labels[0] as text_category,
        roi.incident_number as existing_incident_number
    from messages_without_incident_code sm
    left join recent_open_incidents roi 
    on sm.channel = roi.external_source_id 
    and sm.username = roi.reportee_id 
    and ai_filter(
     prompt('The text category {0} is logically relatable to this record\'s category {1}', text_category, roi.category)
    )
)

-- Combine all messages with their appropriate incident numbers
, all_processed_messages as (
    -- Messages that already have incident codes
    select *, incident_number as final_incident_number
    from messages_with_incident_code
    
    union
    
    -- Messages without incident codes, use existing if found, otherwise generate new
    select 
        * exclude (existing_incident_number, text_category),
        coalesce(existing_incident_number, concat_ws('-', 'INC', '2025', randstr(3, random()))) as final_incident_number
    from messages_with_matching_incidents
)

, enriched_incidents as (
    select
        -- Core incident fields matching DDL schema
        case 
            when not IS_NULL_VALUE(parse_json(sri.incident_number):incident_code) then 
                parse_json(sri.incident_number):incident_code::string
            else sri.final_incident_number
        end as incident_number,        
        
        -- Image or Text Classification
        case 
            when sri.attachment_file is not null then 
                ai_classify(sri.attachment_file, ['payment gateway error', 'login error', 'other']):labels[0]
            else ai_classify(sri.text, ['payment gateway error', 'login error', 'other']):labels[0]
        end as category,
        ai_classify(sri.text, ['payment gateway error', 'login error', 'other']):labels[0] as title, 
        case 
            when category = 'payment gateway error' then 'critical'
            when category = 'login error' then 'high'
            else 'low'
        end as priority,
        
        -- Status tracking
        'open' as status,
        
        -- People involved
        '' as assignee_id,
        sri.reporter_id as reportee_id,
        
        -- Timestamps
        sri.ts as created_at,
        null as closed_at,
        sri.ts as updated_at,
        
        -- System fields
        'Slack' as source_system,
        sri.channel as external_source_id,
        sri.hasfiles as has_attachments,
        sri.slack_message_id,
        
        -- Latest comment
        sri.text as last_comment

        
    from all_processed_messages sri
)

select * 
from enriched_incidents
        );
[0m14:53:32.871130 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:53:33.670821 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c048fd-0106-f145-0032-3187054674d6
[0m14:53:33.671584 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'INCIDENT_MANAGEMENT.GOLD_ZONE.INCIDENTS' does not exist or not authorized.
[0m14:53:33.676852 [debug] [Thread-2 (]: Database Error in model incidents (models/gold_zone/incidents.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.GOLD_ZONE.INCIDENTS' does not exist or not authorized.
  compiled code at /tmp/dbt/target/run/incident_management/models/gold_zone/incidents.sql
[0m14:53:33.680476 [error] [Thread-2 (]: 1 of 6 ERROR creating sql incremental model gold_zone.incidents ................ [[31mERROR[0m in 0.93s]
[0m14:53:33.681487 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m14:53:33.682842 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.incidents' to be skipped because of status 'error'.  Reason: Database Error in model incidents (models/gold_zone/incidents.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.GOLD_ZONE.INCIDENTS' does not exist or not authorized.
  compiled code at /tmp/dbt/target/run/incident_management/models/gold_zone/incidents.sql.
[0m14:53:33.685296 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m14:53:33.686198 [info ] [Thread-2 (]: 2 of 6 SKIP relation gold_zone.active_incidents ................................ [[33mSKIP[0m]
[0m14:53:33.686874 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m14:53:33.688008 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m14:53:33.688866 [info ] [Thread-2 (]: 3 of 6 SKIP relation gold_zone.closed_incidents ................................ [[33mSKIP[0m]
[0m14:53:33.689546 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m14:53:33.690632 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m14:53:33.691401 [info ] [Thread-2 (]: 4 of 6 SKIP relation gold_zone.incident_attachments ............................ [[33mSKIP[0m]
[0m14:53:33.692056 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m14:53:33.693034 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m14:53:33.693746 [info ] [Thread-2 (]: 5 of 6 SKIP relation gold_zone.incident_comment_history ........................ [[33mSKIP[0m]
[0m14:53:33.694418 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m14:53:33.695374 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m14:53:33.696090 [info ] [Thread-2 (]: 6 of 6 SKIP relation gold_zone.weekly_incident_trends .......................... [[33mSKIP[0m]
[0m14:53:33.696716 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m14:53:33.699525 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m14:53:33.700068 [debug] [Dummy-1   ]: Connection 'model.incident_management.incidents' was properly closed.
[0m14:53:33.700713 [info ] [Dummy-1   ]: 
[0m14:53:33.701247 [info ] [Dummy-1   ]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m14:53:33.702446 [debug] [Dummy-1   ]: Command end result
[0m14:53:33.754168 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m14:53:33.756963 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m14:53:33.765244 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m14:53:33.765819 [info ] [Dummy-1   ]: 
[0m14:53:33.766488 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:53:33.767013 [info ] [Dummy-1   ]: 
[0m14:53:33.767751 [error] [Dummy-1   ]:   Database Error in model incidents (models/gold_zone/incidents.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.GOLD_ZONE.INCIDENTS' does not exist or not authorized.
  compiled code at /tmp/dbt/target/run/incident_management/models/gold_zone/incidents.sql
[0m14:53:33.768292 [info ] [Dummy-1   ]: 
[0m14:53:33.768926 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 TOTAL=6
[0m14:53:33.770818 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.4289474, "process_in_blocks": "0", "process_kernel_time": 1.24, "process_mem_max_rss": "434664", "process_out_blocks": "0", "process_user_time": 5.94}
[0m14:53:33.771519 [debug] [Dummy-1   ]: Command `cli run` failed at 14:53:33.771247 after 7.43 seconds
[0m14:53:33.772079 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:52:25.877689 | 709d6090-997e-4eb9-bfa4-9c89190538fd ==============================
[0m16:52:25.877689 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:52:25.878885 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m16:52:26.256462 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:52:27.063294 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:52:27.479057 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:27.479749 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:27.692148 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:52:27.695062 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:52:27.754583 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m16:52:27.757781 [info ] [Dummy-1   ]: 
[0m16:52:27.758433 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:52:27.758978 [info ] [Dummy-1   ]: 
[0m16:52:27.759893 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:52:27.767422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:52:27.910901 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:52:27.911597 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:52:27.912177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:28.990299 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.078 seconds
[0m16:52:28.995209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m16:52:29.018037 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:52:29.018745 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:52:29.019282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:29.921875 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.902 seconds
[0m16:52:29.927582 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:52:29.928169 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:52:30.099290 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.170 seconds
[0m16:52:30.101753 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:52:30.102443 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:52:30.219232 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.116 seconds
[0m16:52:30.221654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:52:30.234459 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:52:30.235107 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:52:30.235653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:31.138561 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.903 seconds
[0m16:52:31.141056 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:52:31.141659 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:52:31.292977 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.151 seconds
[0m16:52:31.295761 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:52:31.296314 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:52:31.407881 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m16:52:31.410573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_semantic_views)
[0m16:52:31.424196 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m16:52:31.424805 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:52:31.425318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:32.317507 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.892 seconds
[0m16:52:32.320006 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m16:52:32.320589 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m16:52:32.942570 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.621 seconds
[0m16:52:32.944885 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m16:52:32.945445 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:52:33.080741 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.135 seconds
[0m16:52:33.087907 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:52:33.088895 [info ] [Thread-2 (]: 1 of 6 START sql incremental model gold_zone.incidents ......................... [RUN]
[0m16:52:33.089671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now model.incident_management.incidents)
[0m16:52:33.090263 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:52:33.110691 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:52:33.111612 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:52:33.199484 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.incidents"
[0m16:52:33.204638 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m16:52:33.205806 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
create or replace transient table incident_management.gold_zone.incidents
         as
        (-- Create only new incidents in this incremental mode; new incidents are detected by absence of an incident number from previous step in the pipeline or,
-- they are not related to any existing incident by title and text.


-- Get recent open incidents for lookback when incident_code is null
with 

recent_open_incidents as (
    select * from incident_management.gold_zone.incidents
    where lower(status) = 'open' 
    and reportee_id is not null
    and created_at > dateadd('day', -7, current_timestamp())
)

, new_slack_messages as (
    select lh.*
    from incident_management.bronze_zone.v_qualify_slack_messages lh 
    left join recent_open_incidents rh 
    on lh.slack_message_id = rh.slack_message_id
    where rh.slack_message_id is null
)

-- Split messages based on whether they have valid incident codes
, messages_with_incident_code as (
    select *
    from new_slack_messages
    where not IS_NULL_VALUE(parse_json(incident_number):incident_code)
)

, messages_without_incident_code as (
    select *
    from new_slack_messages
    where IS_NULL_VALUE(parse_json(incident_number):incident_code)
)

-- For messages without incident codes, try to find existing incidents
, messages_with_matching_incidents as (
    select 
        sm.*,
        ai_classify(sm.text, ['payment gateway error', 'login error', 'other']):labels[0] as text_category,
        roi.incident_number as existing_incident_number
    from messages_without_incident_code sm
    left join recent_open_incidents roi 
    on sm.channel = roi.external_source_id 
    and sm.username = roi.reportee_id 
    and ai_filter(
     prompt('The text category {0} is logically relatable to this record\'s category {1}', text_category, roi.category)
    )
)

-- Combine all messages with their appropriate incident numbers
, all_processed_messages as (
    -- Messages that already have incident codes
    select *, incident_number as final_incident_number
    from messages_with_incident_code
    
    union
    
    -- Messages without incident codes, use existing if found, otherwise generate new
    select 
        * exclude (existing_incident_number, text_category),
        coalesce(existing_incident_number, concat_ws('-', 'INC', '2025', randstr(3, random()))) as final_incident_number
    from messages_with_matching_incidents
)

, enriched_incidents as (
    select
        -- Core incident fields matching DDL schema
        case 
            when not IS_NULL_VALUE(parse_json(sri.incident_number):incident_code) then 
                parse_json(sri.incident_number):incident_code::string
            else sri.final_incident_number
        end as incident_number,        
        
        -- Image or Text Classification
        case 
            when sri.attachment_file is not null then 
                ai_classify(sri.attachment_file, ['payment gateway error', 'login error', 'other']):labels[0]
            else ai_classify(sri.text, ['payment gateway error', 'login error', 'other']):labels[0]
        end as category,
        ai_classify(sri.text, ['payment gateway error', 'login error', 'other']):labels[0] as title, 
        case 
            when category = 'payment gateway error' then 'critical'
            when category = 'login error' then 'high'
            else 'low'
        end as priority,
        
        -- Status tracking
        'open' as status,
        
        -- People involved
        '' as assignee_id,
        sri.reporter_id as reportee_id,
        
        -- Timestamps
        sri.ts as created_at,
        null as closed_at,
        sri.ts as updated_at,
        
        -- System fields
        'Slack' as source_system,
        sri.channel as external_source_id,
        sri.hasfiles as has_attachments,
        sri.slack_message_id,
        
        -- Latest comment
        sri.text as last_comment

        
    from all_processed_messages sri
)

select * 
from enriched_incidents
        );
[0m16:52:33.206676 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:52:34.161689 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c04974-0106-e9ca-0032-318705469b3e
[0m16:52:34.162416 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'INCIDENT_MANAGEMENT.GOLD_ZONE.INCIDENTS' does not exist or not authorized.
[0m16:52:34.167587 [debug] [Thread-2 (]: Database Error in model incidents (models/gold_zone/incidents.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.GOLD_ZONE.INCIDENTS' does not exist or not authorized.
  compiled code at /tmp/dbt/target/run/incident_management/models/gold_zone/incidents.sql
[0m16:52:34.171028 [error] [Thread-2 (]: 1 of 6 ERROR creating sql incremental model gold_zone.incidents ................ [[31mERROR[0m in 1.08s]
[0m16:52:34.172014 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:52:34.173290 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.incidents' to be skipped because of status 'error'.  Reason: Database Error in model incidents (models/gold_zone/incidents.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.GOLD_ZONE.INCIDENTS' does not exist or not authorized.
  compiled code at /tmp/dbt/target/run/incident_management/models/gold_zone/incidents.sql.
[0m16:52:34.175646 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:52:34.176482 [info ] [Thread-2 (]: 2 of 6 SKIP relation gold_zone.active_incidents ................................ [[33mSKIP[0m]
[0m16:52:34.177130 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:52:34.178222 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:52:34.179013 [info ] [Thread-2 (]: 3 of 6 SKIP relation gold_zone.closed_incidents ................................ [[33mSKIP[0m]
[0m16:52:34.179661 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:52:34.180602 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:52:34.181292 [info ] [Thread-2 (]: 4 of 6 SKIP relation gold_zone.incident_attachments ............................ [[33mSKIP[0m]
[0m16:52:34.181950 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:52:34.182867 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:52:34.183549 [info ] [Thread-2 (]: 5 of 6 SKIP relation gold_zone.incident_comment_history ........................ [[33mSKIP[0m]
[0m16:52:34.184160 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:52:34.185036 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:52:34.185728 [info ] [Thread-2 (]: 6 of 6 SKIP relation gold_zone.weekly_incident_trends .......................... [[33mSKIP[0m]
[0m16:52:34.186347 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:52:34.188984 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:52:34.189502 [debug] [Dummy-1   ]: Connection 'model.incident_management.incidents' was properly closed.
[0m16:52:34.190169 [info ] [Dummy-1   ]: 
[0m16:52:34.190696 [info ] [Dummy-1   ]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 6.43 seconds (6.43s).
[0m16:52:34.191826 [debug] [Dummy-1   ]: Command end result
[0m16:52:34.242258 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:52:34.245023 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:52:34.253039 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:52:34.253613 [info ] [Dummy-1   ]: 
[0m16:52:34.254245 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:52:34.254755 [info ] [Dummy-1   ]: 
[0m16:52:34.255479 [error] [Dummy-1   ]:   Database Error in model incidents (models/gold_zone/incidents.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.GOLD_ZONE.INCIDENTS' does not exist or not authorized.
  compiled code at /tmp/dbt/target/run/incident_management/models/gold_zone/incidents.sql
[0m16:52:34.256015 [info ] [Dummy-1   ]: 
[0m16:52:34.256540 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 TOTAL=6
[0m16:52:34.258449 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.477793, "process_in_blocks": "0", "process_kernel_time": 1.42, "process_mem_max_rss": "435544", "process_out_blocks": "0", "process_user_time": 5.78}
[0m16:52:34.259154 [debug] [Dummy-1   ]: Command `cli run` failed at 16:52:34.258882 after 8.48 seconds
[0m16:52:34.259711 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:57:57.621316 | 72a21581-6f27-4a18-99ad-01761cd27ae0 ==============================
[0m16:57:57.621316 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:57:57.622419 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:57:57.995046 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:57:58.772103 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:57:59.192780 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:57:59.193489 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:57:59.408991 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:57:59.411762 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:57:59.470997 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m16:57:59.474224 [info ] [Dummy-1   ]: 
[0m16:57:59.474822 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:57:59.475283 [info ] [Dummy-1   ]: 
[0m16:57:59.476151 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:57:59.485386 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:57:59.637779 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:57:59.638571 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:57:59.639207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:00.369529 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.730 seconds
[0m16:58:00.374423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m16:58:00.397787 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:58:00.398553 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:58:00.399159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:01.175410 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.776 seconds
[0m16:58:01.181766 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:58:01.182423 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:58:01.275553 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.092 seconds
[0m16:58:01.278214 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:58:01.279169 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:58:01.436693 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.157 seconds
[0m16:58:01.439359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_semantic_views)
[0m16:58:01.453580 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m16:58:01.454224 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:58:01.454722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:02.432764 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.978 seconds
[0m16:58:02.435212 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m16:58:02.435805 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m16:58:02.537545 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.101 seconds
[0m16:58:02.540036 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m16:58:02.540635 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:58:02.661701 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.120 seconds
[0m16:58:02.664116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_bronze_zone)
[0m16:58:02.674627 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:58:02.675247 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:58:02.675747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:03.499214 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.823 seconds
[0m16:58:03.501675 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:58:03.502259 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:58:03.632407 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.129 seconds
[0m16:58:03.635225 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:58:03.635801 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:58:03.736630 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m16:58:03.747559 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:58:03.748613 [info ] [Thread-2 (]: 1 of 6 START sql incremental model gold_zone.incidents ......................... [RUN]
[0m16:58:03.749413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.incidents)
[0m16:58:03.750059 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:58:03.770689 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:58:03.771658 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:58:03.852052 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m16:58:03.853297 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
create or replace  temporary view incident_management.gold_zone.incidents__dbt_tmp
  
   as (
    -- Create only new incidents in this incremental mode; new incidents are detected by absence of an incident number from previous step in the pipeline or,
-- they are not related to any existing incident by title and text.


-- Get recent open incidents for lookback when incident_code is null
with 

recent_open_incidents as (
    select * from incident_management.gold_zone.incidents
    where lower(status) = 'open' 
    and reportee_id is not null
    and created_at > dateadd('day', -7, current_timestamp())
)

, new_slack_messages as (
    select lh.*
    from incident_management.bronze_zone.v_qualify_slack_messages lh 
    left join recent_open_incidents rh 
    on lh.slack_message_id = rh.slack_message_id
    where rh.slack_message_id is null
)

-- Split messages based on whether they have valid incident codes
, messages_with_incident_code as (
    select *
    from new_slack_messages
    where not IS_NULL_VALUE(parse_json(incident_number):incident_code)
)

, messages_without_incident_code as (
    select *
    from new_slack_messages
    where IS_NULL_VALUE(parse_json(incident_number):incident_code)
)

-- For messages without incident codes, try to find existing incidents
, messages_with_matching_incidents as (
    select 
        sm.*,
        ai_classify(sm.text, ['payment gateway error', 'login error', 'other']):labels[0] as text_category,
        roi.incident_number as existing_incident_number
    from messages_without_incident_code sm
    left join recent_open_incidents roi 
    on sm.channel = roi.external_source_id 
    and sm.username = roi.reportee_id 
    and ai_filter(
     prompt('The text category {0} is logically relatable to this record\'s category {1}', text_category, roi.category)
    )
)

-- Combine all messages with their appropriate incident numbers
, all_processed_messages as (
    -- Messages that already have incident codes
    select *, incident_number as final_incident_number
    from messages_with_incident_code
    
    union
    
    -- Messages without incident codes, use existing if found, otherwise generate new
    select 
        * exclude (existing_incident_number, text_category),
        coalesce(existing_incident_number, concat_ws('-', 'INC', '2025', randstr(3, random()))) as final_incident_number
    from messages_with_matching_incidents
)

, enriched_incidents as (
    select
        -- Core incident fields matching DDL schema
        case 
            when not IS_NULL_VALUE(parse_json(sri.incident_number):incident_code) then 
                parse_json(sri.incident_number):incident_code::string
            else sri.final_incident_number
        end as incident_number,        
        
        -- Image or Text Classification
        case 
            when sri.attachment_file is not null then 
                ai_classify(sri.attachment_file, ['payment gateway error', 'login error', 'other']):labels[0]
            else ai_classify(sri.text, ['payment gateway error', 'login error', 'other']):labels[0]
        end as category,
        ai_classify(sri.text, ['payment gateway error', 'login error', 'other']):labels[0] as title, 
        case 
            when category = 'payment gateway error' then 'critical'
            when category = 'login error' then 'high'
            else 'low'
        end as priority,
        
        -- Status tracking
        'open' as status,
        
        -- People involved
        '' as assignee_id,
        sri.reporter_id as reportee_id,
        
        -- Timestamps
        sri.ts as created_at,
        null as closed_at,
        sri.ts as updated_at,
        
        -- System fields
        'Slack' as source_system,
        sri.channel as external_source_id,
        sri.hasfiles as has_attachments,
        sri.slack_message_id,
        
        -- Latest comment
        sri.text as last_comment

        
    from all_processed_messages sri
)

select * 
from enriched_incidents
  );
[0m16:58:03.854262 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:58:06.452825 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.598 seconds
[0m16:58:06.474131 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m16:58:06.474853 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
describe table incident_management.gold_zone.incidents__dbt_tmp
[0m16:58:06.561364 [debug] [Thread-2 (]: SQL status: SUCCESS 15 in 0.086 seconds
[0m16:58:06.574218 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m16:58:06.574930 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
describe table incident_management.gold_zone.incidents
[0m16:58:06.663208 [debug] [Thread-2 (]: SQL status: SUCCESS 15 in 0.088 seconds
[0m16:58:06.666197 [debug] [Thread-2 (]: Changing col type from character varying(50) to character varying(16777216) in table database: "incident_management"
schema: "gold_zone"
identifier: "incidents"

[0m16:58:06.682293 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m16:58:06.683006 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
alter  table incident_management.gold_zone.incidents alter "INCIDENT_NUMBER" set data type character varying(16777216);
[0m16:58:06.812811 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m16:58:06.814379 [debug] [Thread-2 (]: Changing col type from character varying(100) to character varying(16777216) in table database: "incident_management"
schema: "gold_zone"
identifier: "incidents"

[0m16:58:06.824583 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m16:58:06.825238 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
alter  table incident_management.gold_zone.incidents alter "EXTERNAL_SOURCE_ID" set data type character varying(16777216);
[0m16:58:06.937276 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m16:58:06.938925 [debug] [Thread-2 (]: Changing col type from character varying(100) to character varying(16777216) in table database: "incident_management"
schema: "gold_zone"
identifier: "incidents"

[0m16:58:06.950743 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m16:58:06.951405 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
alter  table incident_management.gold_zone.incidents alter "SLACK_MESSAGE_ID" set data type character varying(16777216);
[0m16:58:07.070915 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m16:58:07.088027 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m16:58:07.088870 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
describe table "INCIDENT_MANAGEMENT"."GOLD_ZONE"."INCIDENTS"
[0m16:58:07.212677 [debug] [Thread-2 (]: SQL status: SUCCESS 15 in 0.123 seconds
[0m16:58:07.317512 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.incidents"
[0m16:58:07.319721 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m16:58:07.320389 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
-- back compat for old kwarg name
  
  begin;
[0m16:58:07.469125 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m16:58:07.469880 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m16:58:07.470566 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
merge into incident_management.gold_zone.incidents as DBT_INTERNAL_DEST
        using incident_management.gold_zone.incidents__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.incident_number = DBT_INTERNAL_DEST.incident_number))

    
    when matched then update set
        updated_at = DBT_INTERNAL_SOURCE.updated_at,slack_message_id = DBT_INTERNAL_SOURCE.slack_message_id,last_comment = DBT_INTERNAL_SOURCE.last_comment
    

    when not matched then insert
        ("INCIDENT_NUMBER", "TITLE", "CATEGORY", "PRIORITY", "STATUS", "ASSIGNEE_ID", "REPORTEE_ID", "CREATED_AT", "CLOSED_AT", "UPDATED_AT", "SOURCE_SYSTEM", "EXTERNAL_SOURCE_ID", "HAS_ATTACHMENTS", "SLACK_MESSAGE_ID", "LAST_COMMENT")
    values
        ("INCIDENT_NUMBER", "TITLE", "CATEGORY", "PRIORITY", "STATUS", "ASSIGNEE_ID", "REPORTEE_ID", "CREATED_AT", "CLOSED_AT", "UPDATED_AT", "SOURCE_SYSTEM", "EXTERNAL_SOURCE_ID", "HAS_ATTACHMENTS", "SLACK_MESSAGE_ID", "LAST_COMMENT")

;
[0m16:58:10.944197 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 3.473 seconds
[0m16:58:10.945063 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m16:58:10.945698 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
COMMIT
[0m16:58:11.088061 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m16:58:11.109786 [debug] [Thread-2 (]: Applying DROP to: incident_management.gold_zone.incidents__dbt_tmp
[0m16:58:11.131439 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m16:58:11.132163 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
drop view if exists incident_management.gold_zone.incidents__dbt_tmp cascade
[0m16:58:11.334038 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m16:58:11.363361 [info ] [Thread-2 (]: 1 of 6 OK created sql incremental model gold_zone.incidents .................... [[32mSUCCESS 0[0m in 7.61s]
[0m16:58:11.364368 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:58:11.366312 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:58:11.367354 [info ] [Thread-2 (]: 2 of 6 START sql table model gold_zone.active_incidents ........................ [RUN]
[0m16:58:11.368150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:58:11.368828 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:58:11.380928 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:58:11.381815 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:58:11.422625 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.active_incidents"
[0m16:58:11.424907 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.active_incidents"
[0m16:58:11.425645 [debug] [Thread-2 (]: On model.incident_management.active_incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.active_incidents"} */
create or replace transient table incident_management.gold_zone.active_incidents
         as
        (

SELECT 
    i.incident_number,
    i.title,
    i.category,
    i.priority,
    i.status,
    i.assignee_id,
    CONCAT(assignee.first_name, ' ', assignee.last_name) AS assignee_name,
    i.reportee_id,
    CONCAT(reportee.first_name, ' ', reportee.last_name) AS reportee_name,
    i.created_at,
    i.updated_at,
    DATEDIFF('hour', i.created_at, CURRENT_TIMESTAMP()) AS age_hours,
    i.source_system,
    i.external_source_id,
    i.has_attachments
FROM incident_management.gold_zone.incidents i
LEFT JOIN incident_management.bronze_zone.users assignee ON i.assignee_id = assignee.id
LEFT JOIN incident_management.bronze_zone.users reportee ON i.reportee_id = reportee.id
WHERE i.status = 'open'
        );
[0m16:58:11.426268 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:58:12.739617 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.313 seconds
[0m16:58:12.743072 [info ] [Thread-2 (]: 2 of 6 OK created sql table model gold_zone.active_incidents ................... [[32mSUCCESS 1[0m in 1.37s]
[0m16:58:12.744059 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:58:12.745252 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:58:12.746168 [info ] [Thread-2 (]: 3 of 6 START sql table model gold_zone.closed_incidents ........................ [RUN]
[0m16:58:12.746887 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:58:12.747473 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:58:12.760315 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:58:12.761251 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:58:12.773605 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.closed_incidents"
[0m16:58:12.775692 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.closed_incidents"
[0m16:58:12.776421 [debug] [Thread-2 (]: On model.incident_management.closed_incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.closed_incidents"} */
create or replace transient table incident_management.gold_zone.closed_incidents
         as
        (

SELECT 
    i.incident_number,
    i.title,
    i.category,
    i.priority,
    i.status,
    i.assignee_id,
    i.reportee_id,
    
    -- Timeline fields (only available DDL fields)
    i.created_at,
    i.closed_at,
    i.updated_at,
    
    -- System information
    i.source_system,
    i.external_source_id,
    i.has_attachments,
    
    -- Resolution metrics (simplified)
    DATEDIFF('minute', i.created_at, i.closed_at) / 60.0 AS total_resolution_hours,
    
    -- Month/Year for trending
    DATE_TRUNC('month', i.closed_at) AS closed_month,
    EXTRACT(year FROM i.closed_at) AS closed_year,
    EXTRACT(quarter FROM i.closed_at) AS closed_quarter

FROM incident_management.gold_zone.incidents i
WHERE LOWER(i.status) IN ('closed', 'resolved') AND i.closed_at IS NOT NULL
        );
[0m16:58:12.777033 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:58:14.252221 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.475 seconds
[0m16:58:14.255611 [info ] [Thread-2 (]: 3 of 6 OK created sql table model gold_zone.closed_incidents ................... [[32mSUCCESS 1[0m in 1.51s]
[0m16:58:14.256610 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:58:14.257784 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:58:14.258788 [info ] [Thread-2 (]: 4 of 6 START sql incremental model gold_zone.incident_attachments .............. [RUN]
[0m16:58:14.259530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:58:14.260147 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:58:14.272995 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:58:14.273895 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:58:14.286023 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m16:58:14.286775 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
create or replace  temporary view incident_management.gold_zone.incident_attachments__dbt_tmp
  
   as (
    

select 
    dm.file_id as id,
    i.incident_number,
    to_file('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', dm.staged_file_path) as attachment_file,
    dm.event_ts as uploaded_at
from incident_management.gold_zone.incidents i
inner join incident_management.bronze_zone.doc_metadata dm 
on i.has_attachments 
and i.reportee_id = dm.user_id 
and i.external_source_id = dm.channel_id
and i.created_at = dm.event_ts
  );
[0m16:58:14.287368 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:58:15.357626 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.070 seconds
[0m16:58:15.368852 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m16:58:15.369526 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
describe table incident_management.gold_zone.incident_attachments__dbt_tmp
[0m16:58:15.443318 [debug] [Thread-2 (]: SQL status: SUCCESS 4 in 0.073 seconds
[0m16:58:15.455299 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m16:58:15.456017 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
describe table incident_management.gold_zone.incident_attachments
[0m16:58:15.547346 [debug] [Thread-2 (]: SQL status: SUCCESS 4 in 0.091 seconds
[0m16:58:15.549908 [debug] [Thread-2 (]: Changing col type from character varying(50) to character varying(16777216) in table database: "incident_management"
schema: "gold_zone"
identifier: "incident_attachments"

[0m16:58:15.562193 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m16:58:15.562968 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
alter  table incident_management.gold_zone.incident_attachments alter "INCIDENT_NUMBER" set data type character varying(16777216);
[0m16:58:15.712044 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m16:58:15.723200 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m16:58:15.723891 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
describe table "INCIDENT_MANAGEMENT"."GOLD_ZONE"."INCIDENT_ATTACHMENTS"
[0m16:58:15.794664 [debug] [Thread-2 (]: SQL status: SUCCESS 4 in 0.070 seconds
[0m16:58:15.798017 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.incident_attachments"
[0m16:58:15.799957 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m16:58:15.800597 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
-- back compat for old kwarg name
  
  begin;
[0m16:58:15.933457 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m16:58:15.934210 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m16:58:15.934914 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
merge into incident_management.gold_zone.incident_attachments as DBT_INTERNAL_DEST
        using incident_management.gold_zone.incident_attachments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DEST.id
                )

    
    when matched then update set
        uploaded_at = DBT_INTERNAL_SOURCE.uploaded_at,attachment_file = DBT_INTERNAL_SOURCE.attachment_file
    

    when not matched then insert
        ("ID", "INCIDENT_NUMBER", "ATTACHMENT_FILE", "UPLOADED_AT")
    values
        ("ID", "INCIDENT_NUMBER", "ATTACHMENT_FILE", "UPLOADED_AT")

;
[0m16:58:16.167199 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.231 seconds
[0m16:58:16.168069 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m16:58:16.168765 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
COMMIT
[0m16:58:16.320746 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m16:58:16.334503 [debug] [Thread-2 (]: Applying DROP to: incident_management.gold_zone.incident_attachments__dbt_tmp
[0m16:58:16.336316 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m16:58:16.336966 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
drop view if exists incident_management.gold_zone.incident_attachments__dbt_tmp cascade
[0m16:58:16.488188 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m16:58:16.491709 [info ] [Thread-2 (]: 4 of 6 OK created sql incremental model gold_zone.incident_attachments ......... [[32mSUCCESS 0[0m in 2.23s]
[0m16:58:16.492709 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:58:16.493881 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:58:16.494755 [info ] [Thread-2 (]: 5 of 6 START sql incremental model gold_zone.incident_comment_history .......... [RUN]
[0m16:58:16.495459 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:58:16.496061 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:58:16.513379 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:58:16.514300 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:58:16.528141 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m16:58:16.528965 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
create or replace  temporary view incident_management.gold_zone.incident_comment_history__dbt_tmp
  
   as (
    

select 
    slack_message_id as id,
    i.incident_number,
    i.reportee_id as author_id,
    i.last_comment as content,
    current_timestamp() as created_at
from incident_management.gold_zone.incidents i


where i.updated_at > (select coalesce(max(created_at), dateadd('day', -1, current_timestamp())) from incident_management.gold_zone.incident_comment_history)
and i.updated_at >= dateadd('day', -1, current_timestamp())
and i.status = 'open'

  );
[0m16:58:16.529570 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:58:17.517533 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.988 seconds
[0m16:58:17.528908 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m16:58:17.529609 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
describe table incident_management.gold_zone.incident_comment_history__dbt_tmp
[0m16:58:17.695185 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.165 seconds
[0m16:58:17.708781 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m16:58:17.709499 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
describe table incident_management.gold_zone.incident_comment_history
[0m16:58:17.818763 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.108 seconds
[0m16:58:17.821152 [debug] [Thread-2 (]: Changing col type from character varying(50) to character varying(16777216) in table database: "incident_management"
schema: "gold_zone"
identifier: "incident_comment_history"

[0m16:58:17.831569 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m16:58:17.832278 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
alter  table incident_management.gold_zone.incident_comment_history alter "INCIDENT_NUMBER" set data type character varying(16777216);
[0m16:58:17.979179 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m16:58:17.990247 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m16:58:17.990975 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
describe table "INCIDENT_MANAGEMENT"."GOLD_ZONE"."INCIDENT_COMMENT_HISTORY"
[0m16:58:18.076428 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.085 seconds
[0m16:58:18.080091 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.incident_comment_history"
[0m16:58:18.082112 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m16:58:18.082726 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
-- back compat for old kwarg name
  
  begin;
[0m16:58:18.196333 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m16:58:18.197123 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m16:58:18.197863 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
merge into incident_management.gold_zone.incident_comment_history as DBT_INTERNAL_DEST
        using incident_management.gold_zone.incident_comment_history__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DEST.id
                )

    
    when matched then update set
        created_at = DBT_INTERNAL_SOURCE.created_at,content = DBT_INTERNAL_SOURCE.content,author_id = DBT_INTERNAL_SOURCE.author_id,incident_number = DBT_INTERNAL_SOURCE.incident_number
    

    when not matched then insert
        ("ID", "INCIDENT_NUMBER", "AUTHOR_ID", "CONTENT", "CREATED_AT")
    values
        ("ID", "INCIDENT_NUMBER", "AUTHOR_ID", "CONTENT", "CREATED_AT")

;
[0m16:58:18.478884 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.280 seconds
[0m16:58:18.479711 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m16:58:18.480327 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
COMMIT
[0m16:58:18.599216 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m16:58:18.612892 [debug] [Thread-2 (]: Applying DROP to: incident_management.gold_zone.incident_comment_history__dbt_tmp
[0m16:58:18.614475 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m16:58:18.615111 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
drop view if exists incident_management.gold_zone.incident_comment_history__dbt_tmp cascade
[0m16:58:18.760213 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m16:58:18.763816 [info ] [Thread-2 (]: 5 of 6 OK created sql incremental model gold_zone.incident_comment_history ..... [[32mSUCCESS 0[0m in 2.27s]
[0m16:58:18.764813 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:58:18.765995 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:58:18.766888 [info ] [Thread-2 (]: 6 of 6 START sql table model gold_zone.weekly_incident_trends .................. [RUN]
[0m16:58:18.767589 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.weekly_incident_trends)
[0m16:58:18.768174 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:58:18.779855 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:58:18.780721 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:58:18.792587 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.weekly_incident_trends"
[0m16:58:18.795765 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.weekly_incident_trends"
[0m16:58:18.796610 [debug] [Thread-2 (]: On model.incident_management.weekly_incident_trends: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.weekly_incident_trends"} */
create or replace transient table incident_management.gold_zone.weekly_incident_trends
         as
        (

SELECT 
    DATE_TRUNC('week', created_at) AS week,
    COUNT(*) AS total_incidents,
    COUNT(CASE WHEN status = 'resolved' THEN 1 END) AS resolved_incidents,
    COUNT(CASE WHEN status = 'closed' THEN 1 END) AS closed_incidents,
    COUNT(CASE WHEN status = 'open' THEN 1 END) AS open_incidents,
    COUNT(CASE WHEN priority = 'critical' THEN 1 END) AS critical_incidents,
    COUNT(CASE WHEN priority = 'high' THEN 1 END) AS high_incidents,
    COUNT(CASE WHEN priority IN ('critical', 'high') THEN 1 END) AS high_severity_incidents,
    
    -- Category breakdown
    COUNT(CASE WHEN category = 'payment' THEN 1 END) AS payment_incidents,
    COUNT(CASE WHEN category = 'authentication' THEN 1 END) AS authentication_incidents,
    COUNT(CASE WHEN category = 'performance' THEN 1 END) AS performance_incidents,
    COUNT(CASE WHEN category = 'security' THEN 1 END) AS security_incidents,
    
    -- Source system breakdown
    COUNT(CASE WHEN source_system = 'monitoring' THEN 1 END) AS monitoring_incidents,
    COUNT(CASE WHEN source_system = 'customer_portal' THEN 1 END) AS customer_portal_incidents,
    
    -- Average resolution time for closed incidents (in hours)
    AVG(
        CASE 
            WHEN closed_at IS NOT NULL 
            THEN DATEDIFF('hour', created_at, closed_at)
            ELSE NULL 
        END
    ) AS avg_resolution_time_hours,
    
    -- Incidents with attachments
    COUNT(CASE WHEN has_attachments = true THEN 1 END) AS incidents_with_attachments,
    
    -- Resolution rate percentage
    ROUND(
        (COUNT(CASE WHEN status IN ('resolved', 'closed') THEN 1 END)::DECIMAL / COUNT(*)) * 100, 2
    ) AS resolution_rate_percentage
FROM incident_management.gold_zone.incidents
WHERE created_at >= DATEADD('year', -1, CURRENT_DATE())
GROUP BY DATE_TRUNC('week', created_at)
ORDER BY week DESC
        );
[0m16:58:18.797284 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:58:19.914839 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.117 seconds
[0m16:58:19.918221 [info ] [Thread-2 (]: 6 of 6 OK created sql table model gold_zone.weekly_incident_trends ............. [[32mSUCCESS 1[0m in 1.15s]
[0m16:58:19.919288 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:58:19.922345 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:58:19.922945 [debug] [Dummy-1   ]: Connection 'model.incident_management.weekly_incident_trends' was properly closed.
[0m16:58:19.923589 [info ] [Dummy-1   ]: 
[0m16:58:19.924144 [info ] [Dummy-1   ]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 20.45 seconds (20.45s).
[0m16:58:19.925962 [debug] [Dummy-1   ]: Command end result
[0m16:58:19.976544 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:58:19.979400 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:58:19.987677 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:58:19.988274 [info ] [Dummy-1   ]: 
[0m16:58:19.989047 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m16:58:19.989541 [info ] [Dummy-1   ]: 
[0m16:58:19.990059 [info ] [Dummy-1   ]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:58:19.991898 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.46961, "process_in_blocks": "0", "process_kernel_time": 1.41, "process_mem_max_rss": "434292", "process_out_blocks": "0", "process_user_time": 6.79}
[0m16:58:19.992652 [debug] [Dummy-1   ]: Command `cli run` succeeded at 16:58:19.992374 after 22.47 seconds
[0m16:58:19.993216 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:59:21.760111 | b67d902d-964b-49fc-b728-67d72ce01b36 ==============================
[0m16:59:21.760111 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:59:21.761220 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m16:59:22.139580 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:59:22.910284 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:59:23.340390 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:59:23.341045 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:59:23.554156 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:59:23.557302 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:59:23.616946 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m16:59:23.620030 [info ] [Dummy-1   ]: 
[0m16:59:23.620695 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:59:23.621256 [info ] [Dummy-1   ]: 
[0m16:59:23.622208 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:59:23.624452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:59:23.774741 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:59:23.775386 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:59:23.776183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:24.611376 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.835 seconds
[0m16:59:24.622343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m16:59:24.644937 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:59:24.645617 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:59:24.646181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:25.307455 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.661 seconds
[0m16:59:25.313413 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:59:25.314081 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:59:25.417417 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.102 seconds
[0m16:59:25.420264 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:59:25.420891 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:59:25.524270 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m16:59:25.526860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:59:25.541680 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:59:25.542299 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:59:25.542808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:26.305162 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.762 seconds
[0m16:59:26.307644 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:59:26.308308 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:59:26.384232 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.075 seconds
[0m16:59:26.387067 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:59:26.387662 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:59:26.494231 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m16:59:26.496909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_semantic_views)
[0m16:59:26.510907 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m16:59:26.511514 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:59:26.512059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:27.246064 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.734 seconds
[0m16:59:27.248621 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m16:59:27.249211 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m16:59:27.336194 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.086 seconds
[0m16:59:27.338617 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m16:59:27.339197 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:59:27.422731 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.083 seconds
[0m16:59:27.430512 [debug] [Thread-2 (]: Began running node model.incident_management.alpha
[0m16:59:27.431450 [info ] [Thread-2 (]: 1 of 1 START sql semantic_view model semantic_views.alpha ...................... [RUN]
[0m16:59:27.432236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now model.incident_management.alpha)
[0m16:59:27.432847 [debug] [Thread-2 (]: Began compiling node model.incident_management.alpha
[0m16:59:27.456926 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.alpha"
[0m16:59:27.457830 [debug] [Thread-2 (]: Began executing node model.incident_management.alpha
[0m16:59:27.487611 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.alpha"
[0m16:59:27.506224 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.alpha"
[0m16:59:27.508905 [debug] [Thread-2 (]: On model.incident_management.alpha: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.alpha"} */
create or replace semantic view incident_management.semantic_views.alpha
  

TABLES(
  doc_extracts as incident_management.bronze_zone.document_full_extracts
    COMMENT = 'All policy documents'
  , users as incident_management.bronze_zone.users
    COMMENT = 'Materialized users table with enriched data'
  , v_new_docs as incident_management.bronze_zone.v_qualify_new_documents
    COMMENT = 'Qualified new documents with derived type and extension'
  , v_slack_msgs as incident_management.bronze_zone.v_qualify_slack_messages
    COMMENT = 'Qualified Slack messages from known reporters with optional attachment metadata and extracted incident number'
  , incidents as incident_management.gold_zone.incidents
    COMMENT = 'Materialized incidents table with enriched data and calculated fields'
  , active_incidents as incident_management.gold_zone.active_incidents
    COMMENT = 'Active incidents requiring attention with SLA status and priority ordering'
  , closed_incidents as incident_management.gold_zone.closed_incidents
    COMMENT = 'Closed incidents with resolution metrics and performance insights'
  , incident_attachments as incident_management.gold_zone.incident_attachments
  incident_attachments as incident_management.gold_zone.incident_attachments
    COMMENT = 'Materialized incident attachments table'
  , incident_comment_history as incident_management.gold_zone.incident_comment_history
  incident_comment_history as incident_management.gold_zone.incident_comment_history
    COMMENT = 'Simplified incident comment history for tracking communication'
  , weekly_incident_trends as incident_management.gold_zone.weekly_incident_trends
    COMMENT = 'Weekly incident trends for the last 12 weeks'

)

 DIMENSIONS (
    doc_extracts.relative_path as relative_path
      COMMENT = 'Path to the file on the stage'
    , doc_extracts.last_modified AS last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    , doc_extracts.md5 AS md5
      COMMENT = 'MD5 checksum for the file'
    ,doc_extracts.etag AS etag
      COMMENT = 'ETag header for the file'
    , doc_extracts.file_url AS file_url
      WITH SYNONYMS = ('file url', 'snowflake file url')
      COMMENT = 'Snowflake file URL to the file'
    ,doc_extracts.doc_type AS doc_type
      WITH SYNONYMS = ('document type', 'doc type', 'analysis type')
      COMMENT = 'Type of document classification (e.g., ''full'', ''question'', ''slack'')'
    ,doc_extracts.extension AS extension
      WITH SYNONYMS = ('extension', 'file extension')
      COMMENT = 'File extension parsed from the path'
    ,doc_extracts.chunk AS chunk
      WITH SYNONYMS = ('chunk', 'text')
      COMMENT = 'Markdown/text chunk content extracted from the document pages'
    ,doc_extracts.headers AS headers
      WITH SYNONYMS = ('headers', 'detected headers')
      COMMENT = 'Object of detected headers for the chunk (e.g., header_1, header_2)'

    , users.id AS user_id
      COMMENT = 'Unique user identifier'
    , users.email AS user_email
      COMMENT = 'Primary email address'
    ,users.first_name AS user_first_name
      COMMENT = 'First name parsed from email user part'
    ,users.last_name AS user_last_name
      COMMENT = 'Last name parsed from email domain part'
    ,users.role AS user_role
      COMMENT = 'User role'
    ,users.department AS user_department
      COMMENT = 'User department'
    ,users.team AS user_team
      COMMENT = 'User team'
    , users.is_active AS user_is_active
      COMMENT = 'Active flag'
    , users.created_at AS user_created_at
      COMMENT = 'Creation timestamp'
    , users.updated_at AS user_updated_at
      COMMENT = 'Last update timestamp'

    , v_new_docs.relative_path AS new_doc_relative_path
      COMMENT = 'Path to the file on the stage'
    ,v_new_docs.last_modified AS new_doc_last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    ,v_new_docs.md5 AS new_doc_md5
      COMMENT = 'MD5 checksum for the file'
    ,v_new_docs.etag AS new_doc_etag
      COMMENT = 'ETag header for the file'
    ,v_new_docs.file_url AS new_doc_file_url
      COMMENT = 'Snowflake file URL to the file'
    ,v_new_docs.doc_type AS new_doc_type
      COMMENT = 'Derived document type based on the path'
    ,v_new_docs.extension AS new_doc_extension
      COMMENT = 'Derived file extension parsed from the path'

    , v_slack_msgs.hasfiles AS slack_hasfiles
      COMMENT = 'Whether the message has attachments'
    , v_slack_msgs.type AS slack_type
      COMMENT = 'Slack message type'
    , v_slack_msgs.subtype AS slack_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_msgs.team AS slack_team
      COMMENT = 'Slack team identifier'
    , v_slack_msgs.channel AS slack_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_msgs.user AS slack_user
      COMMENT = 'Slack user identifier'
    , v_slack_msgs.username AS slack_username
      COMMENT = 'Slack username'
    , v_slack_msgs.reporter_id AS slack_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_msgs.text AS slack_text
      COMMENT = 'Slack message text'
    , v_slack_msgs.ts AS slack_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_msgs.slack_message_id AS slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_msgs.file_id AS slack_file_id
      COMMENT = 'Attachment file id'
    , v_slack_msgs.file_name AS slack_file_name
      COMMENT = 'Attachment file name'
    , v_slack_msgs.file_mimetype AS slack_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_msgs.staged_file_path AS slack_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_msgs.attachment_file AS slack_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_msgs.incident_number AS slack_incident_number
      COMMENT = 'Extracted incident number from image or text'

    , v_slack_incident_msgs.hasfiles AS incmsg_hasfiles
      COMMENT = 'Whether the message has attachments'
    ,  v_slack_incident_msgs.type AS incmsg_type
      COMMENT = 'Slack message type'
    , v_slack_incident_msgs.subtype AS incmsg_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_incident_msgs.team AS incmsg_team
      COMMENT = 'Slack team identifier'
    , v_slack_incident_msgs.channel AS incmsg_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_incident_msgs.user AS incmsg_user
      COMMENT = 'Slack user identifier'
    , v_slack_incident_msgs.username AS incmsg_username
      COMMENT = 'Slack username'
    , v_slack_incident_msgs.reporter_id AS incmsg_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_incident_msgs.text AS incmsg_text
      COMMENT = 'Slack message text'
    , v_slack_incident_msgs.ts AS incmsg_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_incident_msgs.slack_message_id AS incmsg_slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_incident_msgs.file_id AS incmsg_file_id
      COMMENT = 'Attachment file id'
    , v_slack_incident_msgs.file_name AS incmsg_file_name
      COMMENT = 'Attachment file name'
    , v_slack_incident_msgs.file_mimetype AS incmsg_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_incident_msgs.staged_file_path AS incmsg_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_incident_msgs.attachment_file AS incmsg_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_incident_msgs.incident_number AS incmsg_incident_number
      COMMENT = 'Incident number present or derived'

    , incidents.incident_number AS incident_number
      COMMENT = 'Incident identifier'
    , incidents.category AS incident_category
      COMMENT = 'Incident category',
    , incidents.title AS incident_title
      COMMENT = 'Incident title'
    , incidents.priority AS incident_priority
      COMMENT = 'Incident priority',
    , incidents.status AS incident_status
      COMMENT = 'Incident status',
    , incidents.assignee_id AS incident_assignee_id
      COMMENT = 'Assignee user id'
    , incidents.reportee_id AS incident_reportee_id
      COMMENT = 'Reportee user id'
    , incidents.created_at AS incident_created_at
      COMMENT = 'Creation timestamp'
    , incidents.closed_at AS incident_closed_at
      COMMENT = 'Close timestamp'
    , incidents.updated_at AS incident_updated_at
      COMMENT = 'Last update timestamp'
    , incidents.source_system AS incident_source_system
      COMMENT = 'Source system for the incident'
    ,incidents.external_source_id AS incident_external_source_id
      COMMENT = 'External source identifier'
    , incidents.has_attachments AS incident_has_attachments
      COMMENT = 'Whether the incident has attachments'
    , incidents.slack_message_id AS incident_slack_message_id
      COMMENT = 'Associated Slack message id'
    , incidents.last_comment AS incident_last_comment
      COMMENT = 'Latest comment content'

    , active_incidents.incident_number AS active_incident_number
      COMMENT = 'Incident identifier'
    , active_incidents.title AS active_incident_title
      COMMENT = 'Incident title'
    , active_incidents.category AS active_incident_category
      COMMENT = 'Incident category'
    , active_incidents.priority AS active_incident_priority
      COMMENT = 'Incident priority'
    , active_incidents.status AS active_incident_status
      COMMENT = 'Incident status'
    , active_incidents.assignee_id AS active_incident_assignee_id
      COMMENT = 'Assignee user id'
    , active_incidents.assignee_name AS active_incident_assignee_name
      COMMENT = 'Assignee full name'
    , active_incidents.reportee_id AS active_incident_reportee_id
      COMMENT = 'Reportee user id'
    , active_incidents.reportee_name AS active_incident_reportee_name
      COMMENT = 'Reportee full name'
    , active_incidents.created_at AS active_incident_created_at
      COMMENT = 'Creation timestamp'
    , active_incidents.updated_at AS active_incident_updated_at
      COMMENT = 'Last update timestamp'
    , active_incidents.source_system AS active_incident_source_system
      COMMENT = 'Source system for the incident'
    , active_incidents.external_source_id AS active_incident_external_source_id
      COMMENT = 'External source identifier'
    , active_incidents.has_attachments AS active_incident_has_attachments
      COMMENT = 'Whether the incident has attachments'

    , closed_incidents.incident_number AS closed_incident_number
      COMMENT = 'Incident identifier'
    , closed_incidents.title AS closed_incident_title
      COMMENT = 'Incident title'
    , closed_incidents.category AS closed_incident_category
      COMMENT = 'Incident category'
    , closed_incidents.priority AS closed_incident_priority
      COMMENT = 'Incident priority'
    , closed_incidents.status AS closed_incident_status
      COMMENT = 'Incident status'
    , closed_incidents.assignee_id AS closed_incident_assignee_id
      COMMENT = 'Assignee user id'
    , closed_incidents.reportee_id AS closed_incident_reportee_id
      COMMENT = 'Reportee user id'
    , closed_incidents.created_at AS closed_incident_created_at
      COMMENT = 'Creation timestamp'
    , closed_incidents.closed_at AS closed_incident_closed_at
      COMMENT = 'Close timestamp'
    , closed_incidents.updated_at AS closed_incident_updated_at
      COMMENT = 'Last update timestamp'
    , closed_incidents.source_system AS closed_incident_source_system
      COMMENT = 'Source system for the incident'
    , closed_incidents.external_source_id AS closed_incident_external_source_id
      COMMENT = 'External source identifier'
    , closed_incidents.has_attachments AS closed_incident_has_attachments
      COMMENT = 'Whether the incident had attachments'
    , closed_incidents.closed_month AS closed_incident_month
      COMMENT = 'Month when incident was closed'

    , incident_attachments.id AS attachment_id
      COMMENT = 'Attachment id'
    , incident_attachments.incident_number AS attachment_incident_number
      COMMENT = 'Incident identifier'
    , incident_attachments.attachment_file AS attachment_file
      COMMENT = 'Stage file reference for the attachment'
    , incident_attachments.uploaded_at AS attachment_uploaded_at
      COMMENT = 'Attachment upload timestamp'

    , incident_comment_history.id AS comment_id
      COMMENT = 'Comment id'
    , incident_comment_history.incident_number AS comment_incident_number
      COMMENT = 'Incident identifier'
    , incident_comment_history.author_id AS comment_author_id
      COMMENT = 'Comment author user id'
    ,  incident_comment_history.content AS comment_content
      COMMENT = 'Comment content'
    , incident_comment_history.created_at AS comment_created_at
      COMMENT = 'Comment creation timestamp'
    , weekly_incident_trends.week AS trend_week
      COMMENT = 'Week bucket (date truncated to week)'
  )

 FACTS (
    doc_extracts.size AS doc_size
      COMMENT = 'Size of the file in bytes'
    , doc_extracts.page_num AS doc_page_num
      COMMENT = 'Source page number for the extracted content'
    , v_new_docs.size AS new_doc_size
      COMMENT = 'Size of the file in bytes'

    , v_slack_msgs.file_size AS slack_file_size
      COMMENT = 'Attachment file size'
    , v_slack_incident_msgs.file_size AS incmsg_file_size
      COMMENT = 'Attachment file size'

    , active_incidents.age_hours AS active_incident_age_hours
      COMMENT = 'Age of incident in hours'

    , closed_incidents.total_resolution_hours AS total_resolution_hours
      COMMENT = 'Total time from creation to closure in hours'
    , closed_incidents.closed_year AS closed_year
      COMMENT = 'Year when the incident was closed'
    , closed_incidents.closed_quarter AS closed_quarter
      COMMENT = 'Quarter when the incident was closed'

    , weekly_incident_trends.total_incidents AS total_incidents
      COMMENT = 'Total incidents created in the week'
    , weekly_incident_trends.resolved_incidents AS resolved_incidents
      COMMENT = 'Incidents resolved in the week'
    , weekly_incident_trends.closed_incidents AS closed_incidents_count
      COMMENT = 'Incidents closed in the week'
    , weekly_incident_trends.open_incidents AS open_incidents
      COMMENT = 'Incidents open in the week',
    , weekly_incident_trends.critical_incidents AS critical_incidents
      COMMENT = 'Incidents with critical priority'
    , weekly_incident_trends.high_incidents AS high_incidents
      COMMENT = 'Incidents with high priority',
    , weekly_incident_trends.high_severity_incidents AS high_severity_incidents
      COMMENT = 'Incidents with critical or high priority',
    , weekly_incident_trends.payment_incidents AS payment_incidents
      COMMENT = 'Payment category incidents'
    , weekly_incident_trends.authentication_incidents AS authentication_incidents
      COMMENT = 'Authentication category incidents'
    , weekly_incident_trends.performance_incidents AS performance_incidents
      COMMENT = 'Performance category incidents',
    , weekly_incident_trends.security_incidents AS security_incidents
      COMMENT = 'Security category incidents',
    , weekly_incident_trends.monitoring_incidents AS monitoring_incidents
      COMMENT = 'Incidents from monitoring source system'
    , weekly_incident_trends.customer_portal_incidents AS customer_portal_incidents
      COMMENT = 'Incidents from customer portal source system',
    , weekly_incident_trends.avg_resolution_time_hours AS avg_resolution_time_hours
      COMMENT = 'Average resolution time in hours',
    , weekly_incident_trends.incidents_with_attachments AS incidents_with_attachments
      COMMENT = 'Incidents that had attachments',
    , weekly_incident_trends.resolution_rate_percentage AS resolution_rate_percentage
      COMMENT = 'Share of resolved/closed incidents as a percentage'
 )
[0m16:59:27.510625 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:59:28.166574 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0497b-0106-f0aa-0032-31870546bdbe
[0m16:59:28.167329 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 2 unexpected 'incident_attachments'.
syntax error line 22 at position 2 unexpected ','.
[0m16:59:28.173079 [debug] [Thread-2 (]: Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 2 unexpected 'incident_attachments'.
  syntax error line 22 at position 2 unexpected ','.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m16:59:28.176696 [error] [Thread-2 (]: 1 of 1 ERROR creating sql semantic_view model semantic_views.alpha ............. [[31mERROR[0m in 0.74s]
[0m16:59:28.177707 [debug] [Thread-2 (]: Finished running node model.incident_management.alpha
[0m16:59:28.179096 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.alpha' to be skipped because of status 'error'.  Reason: Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 2 unexpected 'incident_attachments'.
  syntax error line 22 at position 2 unexpected ','.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql.
[0m16:59:28.182587 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:59:28.183121 [debug] [Dummy-1   ]: Connection 'model.incident_management.alpha' was properly closed.
[0m16:59:28.183642 [info ] [Dummy-1   ]: 
[0m16:59:28.184213 [info ] [Dummy-1   ]: Finished running 1 semantic view model in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m16:59:28.185177 [debug] [Dummy-1   ]: Command end result
[0m16:59:28.236003 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:59:28.238734 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:59:28.246778 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:59:28.247331 [info ] [Dummy-1   ]: 
[0m16:59:28.247988 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:59:28.248597 [info ] [Dummy-1   ]: 
[0m16:59:28.249347 [error] [Dummy-1   ]:   Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 2 unexpected 'incident_attachments'.
  syntax error line 22 at position 2 unexpected ','.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m16:59:28.249854 [info ] [Dummy-1   ]: 
[0m16:59:28.250374 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:59:28.252253 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.590593, "process_in_blocks": "0", "process_kernel_time": 1.28, "process_mem_max_rss": "430964", "process_out_blocks": "0", "process_user_time": 5.81}
[0m16:59:28.252950 [debug] [Dummy-1   ]: Command `cli run` failed at 16:59:28.252675 after 6.59 seconds
[0m16:59:28.253517 [debug] [Dummy-1   ]: Flushing usage events


============================== 17:00:31.094076 | 48b73396-51f9-4d34-ab9b-f0d559d1cda8 ==============================
[0m17:00:31.094076 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m17:00:31.095217 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:00:31.472896 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m17:00:32.286772 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:00:32.719887 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:00:32.721067 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/semantic_views/alpha.sql
[0m17:00:33.405479 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:00:33.408488 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:00:33.482267 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m17:00:33.485265 [info ] [Dummy-1   ]: 
[0m17:00:33.485902 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m17:00:33.486448 [info ] [Dummy-1   ]: 
[0m17:00:33.487407 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m17:00:33.489784 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m17:00:33.648308 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m17:00:33.649129 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m17:00:33.649700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:35.815974 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.166 seconds
[0m17:00:35.826114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m17:00:35.849072 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:00:35.849784 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:00:35.850331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:37.517732 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.667 seconds
[0m17:00:37.523804 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:00:37.524469 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m17:00:37.678828 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.154 seconds
[0m17:00:37.681579 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:00:37.682141 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:00:37.823025 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.140 seconds
[0m17:00:37.825668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m17:00:37.838138 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:00:37.838824 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:00:37.839310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:39.708388 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.869 seconds
[0m17:00:39.711004 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:00:39.711607 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m17:00:39.856342 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.144 seconds
[0m17:00:39.859281 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:00:39.859869 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:00:39.991268 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.131 seconds
[0m17:00:39.994009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_semantic_views)
[0m17:00:40.007873 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:00:40.008604 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:00:40.009130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:41.274680 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.265 seconds
[0m17:00:41.277275 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:00:41.277888 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m17:00:41.433064 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.154 seconds
[0m17:00:41.435884 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:00:41.436630 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:00:41.614442 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.177 seconds
[0m17:00:41.621761 [debug] [Thread-2 (]: Began running node model.incident_management.alpha
[0m17:00:41.622721 [info ] [Thread-2 (]: 1 of 1 START sql semantic_view model semantic_views.alpha ...................... [RUN]
[0m17:00:41.623486 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now model.incident_management.alpha)
[0m17:00:41.624105 [debug] [Thread-2 (]: Began compiling node model.incident_management.alpha
[0m17:00:41.646790 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.alpha"
[0m17:00:41.647763 [debug] [Thread-2 (]: Began executing node model.incident_management.alpha
[0m17:00:41.679823 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.alpha"
[0m17:00:41.829157 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.alpha"
[0m17:00:41.831739 [debug] [Thread-2 (]: On model.incident_management.alpha: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.alpha"} */
create or replace semantic view incident_management.semantic_views.alpha
  

TABLES(
  doc_extracts as incident_management.bronze_zone.document_full_extracts
    COMMENT = 'All policy documents'
  , users as incident_management.bronze_zone.users
    COMMENT = 'Materialized users table with enriched data'
  , v_new_docs as incident_management.bronze_zone.v_qualify_new_documents
    COMMENT = 'Qualified new documents with derived type and extension'
  , v_slack_msgs as incident_management.bronze_zone.v_qualify_slack_messages
    COMMENT = 'Qualified Slack messages from known reporters with optional attachment metadata and extracted incident number'
  , incidents as incident_management.gold_zone.incidents
    COMMENT = 'Materialized incidents table with enriched data and calculated fields'
  , active_incidents as incident_management.gold_zone.active_incidents
    COMMENT = 'Active incidents requiring attention with SLA status and priority ordering'
  , closed_incidents as incident_management.gold_zone.closed_incidents
    COMMENT = 'Closed incidents with resolution metrics and performance insights'
  , incident_attachments as incident_management.gold_zone.incident_attachments
    COMMENT = 'Materialized incident attachments table'
  , incident_comment_history as incident_management.gold_zone.incident_comment_history
  incident_comment_history as incident_management.gold_zone.incident_comment_history
    COMMENT = 'Simplified incident comment history for tracking communication'
  , weekly_incident_trends as incident_management.gold_zone.weekly_incident_trends
    COMMENT = 'Weekly incident trends for the last 12 weeks'

)

 DIMENSIONS (
    doc_extracts.relative_path as relative_path
      COMMENT = 'Path to the file on the stage'
    , doc_extracts.last_modified AS last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    , doc_extracts.md5 AS md5
      COMMENT = 'MD5 checksum for the file'
    ,doc_extracts.etag AS etag
      COMMENT = 'ETag header for the file'
    , doc_extracts.file_url AS file_url
      WITH SYNONYMS = ('file url', 'snowflake file url')
      COMMENT = 'Snowflake file URL to the file'
    ,doc_extracts.doc_type AS doc_type
      WITH SYNONYMS = ('document type', 'doc type', 'analysis type')
      COMMENT = 'Type of document classification (e.g., ''full'', ''question'', ''slack'')'
    ,doc_extracts.extension AS extension
      WITH SYNONYMS = ('extension', 'file extension')
      COMMENT = 'File extension parsed from the path'
    ,doc_extracts.chunk AS chunk
      WITH SYNONYMS = ('chunk', 'text')
      COMMENT = 'Markdown/text chunk content extracted from the document pages'
    ,doc_extracts.headers AS headers
      WITH SYNONYMS = ('headers', 'detected headers')
      COMMENT = 'Object of detected headers for the chunk (e.g., header_1, header_2)'

    , users.id AS user_id
      COMMENT = 'Unique user identifier'
    , users.email AS user_email
      COMMENT = 'Primary email address'
    ,users.first_name AS user_first_name
      COMMENT = 'First name parsed from email user part'
    ,users.last_name AS user_last_name
      COMMENT = 'Last name parsed from email domain part'
    ,users.role AS user_role
      COMMENT = 'User role'
    ,users.department AS user_department
      COMMENT = 'User department'
    ,users.team AS user_team
      COMMENT = 'User team'
    , users.is_active AS user_is_active
      COMMENT = 'Active flag'
    , users.created_at AS user_created_at
      COMMENT = 'Creation timestamp'
    , users.updated_at AS user_updated_at
      COMMENT = 'Last update timestamp'

    , v_new_docs.relative_path AS new_doc_relative_path
      COMMENT = 'Path to the file on the stage'
    ,v_new_docs.last_modified AS new_doc_last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    ,v_new_docs.md5 AS new_doc_md5
      COMMENT = 'MD5 checksum for the file'
    ,v_new_docs.etag AS new_doc_etag
      COMMENT = 'ETag header for the file'
    ,v_new_docs.file_url AS new_doc_file_url
      COMMENT = 'Snowflake file URL to the file'
    ,v_new_docs.doc_type AS new_doc_type
      COMMENT = 'Derived document type based on the path'
    ,v_new_docs.extension AS new_doc_extension
      COMMENT = 'Derived file extension parsed from the path'

    , v_slack_msgs.hasfiles AS slack_hasfiles
      COMMENT = 'Whether the message has attachments'
    , v_slack_msgs.type AS slack_type
      COMMENT = 'Slack message type'
    , v_slack_msgs.subtype AS slack_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_msgs.team AS slack_team
      COMMENT = 'Slack team identifier'
    , v_slack_msgs.channel AS slack_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_msgs.user AS slack_user
      COMMENT = 'Slack user identifier'
    , v_slack_msgs.username AS slack_username
      COMMENT = 'Slack username'
    , v_slack_msgs.reporter_id AS slack_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_msgs.text AS slack_text
      COMMENT = 'Slack message text'
    , v_slack_msgs.ts AS slack_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_msgs.slack_message_id AS slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_msgs.file_id AS slack_file_id
      COMMENT = 'Attachment file id'
    , v_slack_msgs.file_name AS slack_file_name
      COMMENT = 'Attachment file name'
    , v_slack_msgs.file_mimetype AS slack_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_msgs.staged_file_path AS slack_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_msgs.attachment_file AS slack_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_msgs.incident_number AS slack_incident_number
      COMMENT = 'Extracted incident number from image or text'

    , v_slack_incident_msgs.hasfiles AS incmsg_hasfiles
      COMMENT = 'Whether the message has attachments'
    ,  v_slack_incident_msgs.type AS incmsg_type
      COMMENT = 'Slack message type'
    , v_slack_incident_msgs.subtype AS incmsg_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_incident_msgs.team AS incmsg_team
      COMMENT = 'Slack team identifier'
    , v_slack_incident_msgs.channel AS incmsg_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_incident_msgs.user AS incmsg_user
      COMMENT = 'Slack user identifier'
    , v_slack_incident_msgs.username AS incmsg_username
      COMMENT = 'Slack username'
    , v_slack_incident_msgs.reporter_id AS incmsg_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_incident_msgs.text AS incmsg_text
      COMMENT = 'Slack message text'
    , v_slack_incident_msgs.ts AS incmsg_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_incident_msgs.slack_message_id AS incmsg_slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_incident_msgs.file_id AS incmsg_file_id
      COMMENT = 'Attachment file id'
    , v_slack_incident_msgs.file_name AS incmsg_file_name
      COMMENT = 'Attachment file name'
    , v_slack_incident_msgs.file_mimetype AS incmsg_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_incident_msgs.staged_file_path AS incmsg_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_incident_msgs.attachment_file AS incmsg_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_incident_msgs.incident_number AS incmsg_incident_number
      COMMENT = 'Incident number present or derived'

    , incidents.incident_number AS incident_number
      COMMENT = 'Incident identifier'
    , incidents.category AS incident_category
      COMMENT = 'Incident category',
    , incidents.title AS incident_title
      COMMENT = 'Incident title'
    , incidents.priority AS incident_priority
      COMMENT = 'Incident priority',
    , incidents.status AS incident_status
      COMMENT = 'Incident status',
    , incidents.assignee_id AS incident_assignee_id
      COMMENT = 'Assignee user id'
    , incidents.reportee_id AS incident_reportee_id
      COMMENT = 'Reportee user id'
    , incidents.created_at AS incident_created_at
      COMMENT = 'Creation timestamp'
    , incidents.closed_at AS incident_closed_at
      COMMENT = 'Close timestamp'
    , incidents.updated_at AS incident_updated_at
      COMMENT = 'Last update timestamp'
    , incidents.source_system AS incident_source_system
      COMMENT = 'Source system for the incident'
    ,incidents.external_source_id AS incident_external_source_id
      COMMENT = 'External source identifier'
    , incidents.has_attachments AS incident_has_attachments
      COMMENT = 'Whether the incident has attachments'
    , incidents.slack_message_id AS incident_slack_message_id
      COMMENT = 'Associated Slack message id'
    , incidents.last_comment AS incident_last_comment
      COMMENT = 'Latest comment content'

    , active_incidents.incident_number AS active_incident_number
      COMMENT = 'Incident identifier'
    , active_incidents.title AS active_incident_title
      COMMENT = 'Incident title'
    , active_incidents.category AS active_incident_category
      COMMENT = 'Incident category'
    , active_incidents.priority AS active_incident_priority
      COMMENT = 'Incident priority'
    , active_incidents.status AS active_incident_status
      COMMENT = 'Incident status'
    , active_incidents.assignee_id AS active_incident_assignee_id
      COMMENT = 'Assignee user id'
    , active_incidents.assignee_name AS active_incident_assignee_name
      COMMENT = 'Assignee full name'
    , active_incidents.reportee_id AS active_incident_reportee_id
      COMMENT = 'Reportee user id'
    , active_incidents.reportee_name AS active_incident_reportee_name
      COMMENT = 'Reportee full name'
    , active_incidents.created_at AS active_incident_created_at
      COMMENT = 'Creation timestamp'
    , active_incidents.updated_at AS active_incident_updated_at
      COMMENT = 'Last update timestamp'
    , active_incidents.source_system AS active_incident_source_system
      COMMENT = 'Source system for the incident'
    , active_incidents.external_source_id AS active_incident_external_source_id
      COMMENT = 'External source identifier'
    , active_incidents.has_attachments AS active_incident_has_attachments
      COMMENT = 'Whether the incident has attachments'

    , closed_incidents.incident_number AS closed_incident_number
      COMMENT = 'Incident identifier'
    , closed_incidents.title AS closed_incident_title
      COMMENT = 'Incident title'
    , closed_incidents.category AS closed_incident_category
      COMMENT = 'Incident category'
    , closed_incidents.priority AS closed_incident_priority
      COMMENT = 'Incident priority'
    , closed_incidents.status AS closed_incident_status
      COMMENT = 'Incident status'
    , closed_incidents.assignee_id AS closed_incident_assignee_id
      COMMENT = 'Assignee user id'
    , closed_incidents.reportee_id AS closed_incident_reportee_id
      COMMENT = 'Reportee user id'
    , closed_incidents.created_at AS closed_incident_created_at
      COMMENT = 'Creation timestamp'
    , closed_incidents.closed_at AS closed_incident_closed_at
      COMMENT = 'Close timestamp'
    , closed_incidents.updated_at AS closed_incident_updated_at
      COMMENT = 'Last update timestamp'
    , closed_incidents.source_system AS closed_incident_source_system
      COMMENT = 'Source system for the incident'
    , closed_incidents.external_source_id AS closed_incident_external_source_id
      COMMENT = 'External source identifier'
    , closed_incidents.has_attachments AS closed_incident_has_attachments
      COMMENT = 'Whether the incident had attachments'
    , closed_incidents.closed_month AS closed_incident_month
      COMMENT = 'Month when incident was closed'

    , incident_attachments.id AS attachment_id
      COMMENT = 'Attachment id'
    , incident_attachments.incident_number AS attachment_incident_number
      COMMENT = 'Incident identifier'
    , incident_attachments.attachment_file AS attachment_file
      COMMENT = 'Stage file reference for the attachment'
    , incident_attachments.uploaded_at AS attachment_uploaded_at
      COMMENT = 'Attachment upload timestamp'

    , incident_comment_history.id AS comment_id
      COMMENT = 'Comment id'
    , incident_comment_history.incident_number AS comment_incident_number
      COMMENT = 'Incident identifier'
    , incident_comment_history.author_id AS comment_author_id
      COMMENT = 'Comment author user id'
    ,  incident_comment_history.content AS comment_content
      COMMENT = 'Comment content'
    , incident_comment_history.created_at AS comment_created_at
      COMMENT = 'Comment creation timestamp'
    , weekly_incident_trends.week AS trend_week
      COMMENT = 'Week bucket (date truncated to week)'
  )

 FACTS (
    doc_extracts.size AS doc_size
      COMMENT = 'Size of the file in bytes'
    , doc_extracts.page_num AS doc_page_num
      COMMENT = 'Source page number for the extracted content'
    , v_new_docs.size AS new_doc_size
      COMMENT = 'Size of the file in bytes'

    , v_slack_msgs.file_size AS slack_file_size
      COMMENT = 'Attachment file size'
    , v_slack_incident_msgs.file_size AS incmsg_file_size
      COMMENT = 'Attachment file size'

    , active_incidents.age_hours AS active_incident_age_hours
      COMMENT = 'Age of incident in hours'

    , closed_incidents.total_resolution_hours AS total_resolution_hours
      COMMENT = 'Total time from creation to closure in hours'
    , closed_incidents.closed_year AS closed_year
      COMMENT = 'Year when the incident was closed'
    , closed_incidents.closed_quarter AS closed_quarter
      COMMENT = 'Quarter when the incident was closed'

    , weekly_incident_trends.total_incidents AS total_incidents
      COMMENT = 'Total incidents created in the week'
    , weekly_incident_trends.resolved_incidents AS resolved_incidents
      COMMENT = 'Incidents resolved in the week'
    , weekly_incident_trends.closed_incidents AS closed_incidents_count
      COMMENT = 'Incidents closed in the week'
    , weekly_incident_trends.open_incidents AS open_incidents
      COMMENT = 'Incidents open in the week',
    , weekly_incident_trends.critical_incidents AS critical_incidents
      COMMENT = 'Incidents with critical priority'
    , weekly_incident_trends.high_incidents AS high_incidents
      COMMENT = 'Incidents with high priority',
    , weekly_incident_trends.high_severity_incidents AS high_severity_incidents
      COMMENT = 'Incidents with critical or high priority',
    , weekly_incident_trends.payment_incidents AS payment_incidents
      COMMENT = 'Payment category incidents'
    , weekly_incident_trends.authentication_incidents AS authentication_incidents
      COMMENT = 'Authentication category incidents'
    , weekly_incident_trends.performance_incidents AS performance_incidents
      COMMENT = 'Performance category incidents',
    , weekly_incident_trends.security_incidents AS security_incidents
      COMMENT = 'Security category incidents',
    , weekly_incident_trends.monitoring_incidents AS monitoring_incidents
      COMMENT = 'Incidents from monitoring source system'
    , weekly_incident_trends.customer_portal_incidents AS customer_portal_incidents
      COMMENT = 'Incidents from customer portal source system',
    , weekly_incident_trends.avg_resolution_time_hours AS avg_resolution_time_hours
      COMMENT = 'Average resolution time in hours',
    , weekly_incident_trends.incidents_with_attachments AS incidents_with_attachments
      COMMENT = 'Incidents that had attachments',
    , weekly_incident_trends.resolution_rate_percentage AS resolution_rate_percentage
      COMMENT = 'Share of resolved/closed incidents as a percentage'
 )
[0m17:00:41.833446 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:00:42.730249 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0497c-0106-f145-0032-31870547e016
[0m17:00:42.731002 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 2 unexpected 'incident_comment_history'.
syntax error line 24 at position 2 unexpected ','.
[0m17:00:42.736714 [debug] [Thread-2 (]: Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 2 unexpected 'incident_comment_history'.
  syntax error line 24 at position 2 unexpected ','.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:00:42.740406 [error] [Thread-2 (]: 1 of 1 ERROR creating sql semantic_view model semantic_views.alpha ............. [[31mERROR[0m in 1.11s]
[0m17:00:42.741418 [debug] [Thread-2 (]: Finished running node model.incident_management.alpha
[0m17:00:42.742738 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.alpha' to be skipped because of status 'error'.  Reason: Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 2 unexpected 'incident_comment_history'.
  syntax error line 24 at position 2 unexpected ','.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql.
[0m17:00:42.746268 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m17:00:42.746845 [debug] [Dummy-1   ]: Connection 'model.incident_management.alpha' was properly closed.
[0m17:00:42.747362 [info ] [Dummy-1   ]: 
[0m17:00:42.747971 [info ] [Dummy-1   ]: Finished running 1 semantic view model in 0 hours 0 minutes and 9.26 seconds (9.26s).
[0m17:00:42.749088 [debug] [Dummy-1   ]: Command end result
[0m17:00:42.799585 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:00:42.802474 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:00:42.810664 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m17:00:42.811202 [info ] [Dummy-1   ]: 
[0m17:00:42.811847 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:00:42.812394 [info ] [Dummy-1   ]: 
[0m17:00:42.813130 [error] [Dummy-1   ]:   Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 2 unexpected 'incident_comment_history'.
  syntax error line 24 at position 2 unexpected ','.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:00:42.813641 [info ] [Dummy-1   ]: 
[0m17:00:42.814157 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:00:42.815997 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.819178, "process_in_blocks": "0", "process_kernel_time": 1.44, "process_mem_max_rss": "490364", "process_out_blocks": "0", "process_user_time": 6.51}
[0m17:00:42.816690 [debug] [Dummy-1   ]: Command `cli run` failed at 17:00:42.816425 after 11.82 seconds
[0m17:00:42.817248 [debug] [Dummy-1   ]: Flushing usage events


============================== 17:01:34.932281 | b19328b1-a079-4cde-beef-7fa341413201 ==============================
[0m17:01:34.932281 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m17:01:34.933481 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:01:35.315891 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m17:01:36.041515 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:01:36.469487 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:01:36.470760 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/semantic_views/alpha.sql
[0m17:01:37.153137 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:01:37.156130 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:01:37.218047 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m17:01:37.221238 [info ] [Dummy-1   ]: 
[0m17:01:37.221937 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m17:01:37.222483 [info ] [Dummy-1   ]: 
[0m17:01:37.238848 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m17:01:37.241249 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m17:01:37.395933 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m17:01:37.396727 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m17:01:37.397313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:38.577097 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.180 seconds
[0m17:01:38.587542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_semantic_views)
[0m17:01:38.610981 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:01:38.611627 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:01:38.612134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:39.650619 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.038 seconds
[0m17:01:39.656578 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:01:39.657237 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m17:01:39.767154 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.109 seconds
[0m17:01:39.769843 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:01:39.770527 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:01:39.917771 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.146 seconds
[0m17:01:39.920288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_gold_zone)
[0m17:01:39.931058 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:01:39.931702 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:01:39.932196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:40.908750 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.976 seconds
[0m17:01:40.911325 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:01:40.911923 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m17:01:41.032959 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.120 seconds
[0m17:01:41.035809 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:01:41.036441 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:01:41.142857 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m17:01:41.145565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m17:01:41.158215 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:01:41.158959 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:01:41.159467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:42.565265 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.406 seconds
[0m17:01:42.567778 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:01:42.568471 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m17:01:42.694485 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.125 seconds
[0m17:01:42.697320 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:01:42.697927 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:01:42.798819 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m17:01:42.809607 [debug] [Thread-2 (]: Began running node model.incident_management.alpha
[0m17:01:42.810558 [info ] [Thread-2 (]: 1 of 1 START sql semantic_view model semantic_views.alpha ...................... [RUN]
[0m17:01:42.811324 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.alpha)
[0m17:01:42.811911 [debug] [Thread-2 (]: Began compiling node model.incident_management.alpha
[0m17:01:42.834476 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.alpha"
[0m17:01:42.835460 [debug] [Thread-2 (]: Began executing node model.incident_management.alpha
[0m17:01:42.868625 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.alpha"
[0m17:01:43.022696 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.alpha"
[0m17:01:43.025284 [debug] [Thread-2 (]: On model.incident_management.alpha: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.alpha"} */
create or replace semantic view incident_management.semantic_views.alpha
  

TABLES(
  doc_extracts as incident_management.bronze_zone.document_full_extracts
    COMMENT = 'All policy documents'
  , users as incident_management.bronze_zone.users
    COMMENT = 'Materialized users table with enriched data'
  , v_new_docs as incident_management.bronze_zone.v_qualify_new_documents
    COMMENT = 'Qualified new documents with derived type and extension'
  , v_slack_msgs as incident_management.bronze_zone.v_qualify_slack_messages
    COMMENT = 'Qualified Slack messages from known reporters with optional attachment metadata and extracted incident number'
  , incidents as incident_management.gold_zone.incidents
    COMMENT = 'Materialized incidents table with enriched data and calculated fields'
  , active_incidents as incident_management.gold_zone.active_incidents
    COMMENT = 'Active incidents requiring attention with SLA status and priority ordering'
  , closed_incidents as incident_management.gold_zone.closed_incidents
    COMMENT = 'Closed incidents with resolution metrics and performance insights'
  , incident_attachments as incident_management.gold_zone.incident_attachments
    COMMENT = 'Materialized incident attachments table'
  , incident_comment_history as incident_management.gold_zone.incident_comment_history
    COMMENT = 'Simplified incident comment history for tracking communication'
  , weekly_incident_trends as incident_management.gold_zone.weekly_incident_trends
    COMMENT = 'Weekly incident trends for the last 12 weeks'

)

 DIMENSIONS (
    doc_extracts.relative_path as relative_path
      COMMENT = 'Path to the file on the stage'
    , doc_extracts.last_modified AS last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    , doc_extracts.md5 AS md5
      COMMENT = 'MD5 checksum for the file'
    ,doc_extracts.etag AS etag
      COMMENT = 'ETag header for the file'
    , doc_extracts.file_url AS file_url
      WITH SYNONYMS = ('file url', 'snowflake file url')
      COMMENT = 'Snowflake file URL to the file'
    ,doc_extracts.doc_type AS doc_type
      WITH SYNONYMS = ('document type', 'doc type', 'analysis type')
      COMMENT = 'Type of document classification (e.g., ''full'', ''question'', ''slack'')'
    ,doc_extracts.extension AS extension
      WITH SYNONYMS = ('extension', 'file extension')
      COMMENT = 'File extension parsed from the path'
    ,doc_extracts.chunk AS chunk
      WITH SYNONYMS = ('chunk', 'text')
      COMMENT = 'Markdown/text chunk content extracted from the document pages'
    ,doc_extracts.headers AS headers
      WITH SYNONYMS = ('headers', 'detected headers')
      COMMENT = 'Object of detected headers for the chunk (e.g., header_1, header_2)'

    , users.id AS user_id
      COMMENT = 'Unique user identifier'
    , users.email AS user_email
      COMMENT = 'Primary email address'
    ,users.first_name AS user_first_name
      COMMENT = 'First name parsed from email user part'
    ,users.last_name AS user_last_name
      COMMENT = 'Last name parsed from email domain part'
    ,users.role AS user_role
      COMMENT = 'User role'
    ,users.department AS user_department
      COMMENT = 'User department'
    ,users.team AS user_team
      COMMENT = 'User team'
    , users.is_active AS user_is_active
      COMMENT = 'Active flag'
    , users.created_at AS user_created_at
      COMMENT = 'Creation timestamp'
    , users.updated_at AS user_updated_at
      COMMENT = 'Last update timestamp'

    , v_new_docs.relative_path AS new_doc_relative_path
      COMMENT = 'Path to the file on the stage'
    ,v_new_docs.last_modified AS new_doc_last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    ,v_new_docs.md5 AS new_doc_md5
      COMMENT = 'MD5 checksum for the file'
    ,v_new_docs.etag AS new_doc_etag
      COMMENT = 'ETag header for the file'
    ,v_new_docs.file_url AS new_doc_file_url
      COMMENT = 'Snowflake file URL to the file'
    ,v_new_docs.doc_type AS new_doc_type
      COMMENT = 'Derived document type based on the path'
    ,v_new_docs.extension AS new_doc_extension
      COMMENT = 'Derived file extension parsed from the path'

    , v_slack_msgs.hasfiles AS slack_hasfiles
      COMMENT = 'Whether the message has attachments'
    , v_slack_msgs.type AS slack_type
      COMMENT = 'Slack message type'
    , v_slack_msgs.subtype AS slack_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_msgs.team AS slack_team
      COMMENT = 'Slack team identifier'
    , v_slack_msgs.channel AS slack_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_msgs.user AS slack_user
      COMMENT = 'Slack user identifier'
    , v_slack_msgs.username AS slack_username
      COMMENT = 'Slack username'
    , v_slack_msgs.reporter_id AS slack_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_msgs.text AS slack_text
      COMMENT = 'Slack message text'
    , v_slack_msgs.ts AS slack_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_msgs.slack_message_id AS slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_msgs.file_id AS slack_file_id
      COMMENT = 'Attachment file id'
    , v_slack_msgs.file_name AS slack_file_name
      COMMENT = 'Attachment file name'
    , v_slack_msgs.file_mimetype AS slack_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_msgs.staged_file_path AS slack_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_msgs.attachment_file AS slack_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_msgs.incident_number AS slack_incident_number
      COMMENT = 'Extracted incident number from image or text'

    , v_slack_incident_msgs.hasfiles AS incmsg_hasfiles
      COMMENT = 'Whether the message has attachments'
    ,  v_slack_incident_msgs.type AS incmsg_type
      COMMENT = 'Slack message type'
    , v_slack_incident_msgs.subtype AS incmsg_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_incident_msgs.team AS incmsg_team
      COMMENT = 'Slack team identifier'
    , v_slack_incident_msgs.channel AS incmsg_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_incident_msgs.user AS incmsg_user
      COMMENT = 'Slack user identifier'
    , v_slack_incident_msgs.username AS incmsg_username
      COMMENT = 'Slack username'
    , v_slack_incident_msgs.reporter_id AS incmsg_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_incident_msgs.text AS incmsg_text
      COMMENT = 'Slack message text'
    , v_slack_incident_msgs.ts AS incmsg_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_incident_msgs.slack_message_id AS incmsg_slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_incident_msgs.file_id AS incmsg_file_id
      COMMENT = 'Attachment file id'
    , v_slack_incident_msgs.file_name AS incmsg_file_name
      COMMENT = 'Attachment file name'
    , v_slack_incident_msgs.file_mimetype AS incmsg_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_incident_msgs.staged_file_path AS incmsg_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_incident_msgs.attachment_file AS incmsg_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_incident_msgs.incident_number AS incmsg_incident_number
      COMMENT = 'Incident number present or derived'

    , incidents.incident_number AS incident_number
      COMMENT = 'Incident identifier'
    , incidents.category AS incident_category
      COMMENT = 'Incident category',
    , incidents.title AS incident_title
      COMMENT = 'Incident title'
    , incidents.priority AS incident_priority
      COMMENT = 'Incident priority',
    , incidents.status AS incident_status
      COMMENT = 'Incident status',
    , incidents.assignee_id AS incident_assignee_id
      COMMENT = 'Assignee user id'
    , incidents.reportee_id AS incident_reportee_id
      COMMENT = 'Reportee user id'
    , incidents.created_at AS incident_created_at
      COMMENT = 'Creation timestamp'
    , incidents.closed_at AS incident_closed_at
      COMMENT = 'Close timestamp'
    , incidents.updated_at AS incident_updated_at
      COMMENT = 'Last update timestamp'
    , incidents.source_system AS incident_source_system
      COMMENT = 'Source system for the incident'
    ,incidents.external_source_id AS incident_external_source_id
      COMMENT = 'External source identifier'
    , incidents.has_attachments AS incident_has_attachments
      COMMENT = 'Whether the incident has attachments'
    , incidents.slack_message_id AS incident_slack_message_id
      COMMENT = 'Associated Slack message id'
    , incidents.last_comment AS incident_last_comment
      COMMENT = 'Latest comment content'

    , active_incidents.incident_number AS active_incident_number
      COMMENT = 'Incident identifier'
    , active_incidents.title AS active_incident_title
      COMMENT = 'Incident title'
    , active_incidents.category AS active_incident_category
      COMMENT = 'Incident category'
    , active_incidents.priority AS active_incident_priority
      COMMENT = 'Incident priority'
    , active_incidents.status AS active_incident_status
      COMMENT = 'Incident status'
    , active_incidents.assignee_id AS active_incident_assignee_id
      COMMENT = 'Assignee user id'
    , active_incidents.assignee_name AS active_incident_assignee_name
      COMMENT = 'Assignee full name'
    , active_incidents.reportee_id AS active_incident_reportee_id
      COMMENT = 'Reportee user id'
    , active_incidents.reportee_name AS active_incident_reportee_name
      COMMENT = 'Reportee full name'
    , active_incidents.created_at AS active_incident_created_at
      COMMENT = 'Creation timestamp'
    , active_incidents.updated_at AS active_incident_updated_at
      COMMENT = 'Last update timestamp'
    , active_incidents.source_system AS active_incident_source_system
      COMMENT = 'Source system for the incident'
    , active_incidents.external_source_id AS active_incident_external_source_id
      COMMENT = 'External source identifier'
    , active_incidents.has_attachments AS active_incident_has_attachments
      COMMENT = 'Whether the incident has attachments'

    , closed_incidents.incident_number AS closed_incident_number
      COMMENT = 'Incident identifier'
    , closed_incidents.title AS closed_incident_title
      COMMENT = 'Incident title'
    , closed_incidents.category AS closed_incident_category
      COMMENT = 'Incident category'
    , closed_incidents.priority AS closed_incident_priority
      COMMENT = 'Incident priority'
    , closed_incidents.status AS closed_incident_status
      COMMENT = 'Incident status'
    , closed_incidents.assignee_id AS closed_incident_assignee_id
      COMMENT = 'Assignee user id'
    , closed_incidents.reportee_id AS closed_incident_reportee_id
      COMMENT = 'Reportee user id'
    , closed_incidents.created_at AS closed_incident_created_at
      COMMENT = 'Creation timestamp'
    , closed_incidents.closed_at AS closed_incident_closed_at
      COMMENT = 'Close timestamp'
    , closed_incidents.updated_at AS closed_incident_updated_at
      COMMENT = 'Last update timestamp'
    , closed_incidents.source_system AS closed_incident_source_system
      COMMENT = 'Source system for the incident'
    , closed_incidents.external_source_id AS closed_incident_external_source_id
      COMMENT = 'External source identifier'
    , closed_incidents.has_attachments AS closed_incident_has_attachments
      COMMENT = 'Whether the incident had attachments'
    , closed_incidents.closed_month AS closed_incident_month
      COMMENT = 'Month when incident was closed'

    , incident_attachments.id AS attachment_id
      COMMENT = 'Attachment id'
    , incident_attachments.incident_number AS attachment_incident_number
      COMMENT = 'Incident identifier'
    , incident_attachments.attachment_file AS attachment_file
      COMMENT = 'Stage file reference for the attachment'
    , incident_attachments.uploaded_at AS attachment_uploaded_at
      COMMENT = 'Attachment upload timestamp'

    , incident_comment_history.id AS comment_id
      COMMENT = 'Comment id'
    , incident_comment_history.incident_number AS comment_incident_number
      COMMENT = 'Incident identifier'
    , incident_comment_history.author_id AS comment_author_id
      COMMENT = 'Comment author user id'
    ,  incident_comment_history.content AS comment_content
      COMMENT = 'Comment content'
    , incident_comment_history.created_at AS comment_created_at
      COMMENT = 'Comment creation timestamp'
    , weekly_incident_trends.week AS trend_week
      COMMENT = 'Week bucket (date truncated to week)'
  )

 FACTS (
    doc_extracts.size AS doc_size
      COMMENT = 'Size of the file in bytes'
    , doc_extracts.page_num AS doc_page_num
      COMMENT = 'Source page number for the extracted content'
    , v_new_docs.size AS new_doc_size
      COMMENT = 'Size of the file in bytes'

    , v_slack_msgs.file_size AS slack_file_size
      COMMENT = 'Attachment file size'
    , v_slack_incident_msgs.file_size AS incmsg_file_size
      COMMENT = 'Attachment file size'

    , active_incidents.age_hours AS active_incident_age_hours
      COMMENT = 'Age of incident in hours'

    , closed_incidents.total_resolution_hours AS total_resolution_hours
      COMMENT = 'Total time from creation to closure in hours'
    , closed_incidents.closed_year AS closed_year
      COMMENT = 'Year when the incident was closed'
    , closed_incidents.closed_quarter AS closed_quarter
      COMMENT = 'Quarter when the incident was closed'

    , weekly_incident_trends.total_incidents AS total_incidents
      COMMENT = 'Total incidents created in the week'
    , weekly_incident_trends.resolved_incidents AS resolved_incidents
      COMMENT = 'Incidents resolved in the week'
    , weekly_incident_trends.closed_incidents AS closed_incidents_count
      COMMENT = 'Incidents closed in the week'
    , weekly_incident_trends.open_incidents AS open_incidents
      COMMENT = 'Incidents open in the week',
    , weekly_incident_trends.critical_incidents AS critical_incidents
      COMMENT = 'Incidents with critical priority'
    , weekly_incident_trends.high_incidents AS high_incidents
      COMMENT = 'Incidents with high priority',
    , weekly_incident_trends.high_severity_incidents AS high_severity_incidents
      COMMENT = 'Incidents with critical or high priority',
    , weekly_incident_trends.payment_incidents AS payment_incidents
      COMMENT = 'Payment category incidents'
    , weekly_incident_trends.authentication_incidents AS authentication_incidents
      COMMENT = 'Authentication category incidents'
    , weekly_incident_trends.performance_incidents AS performance_incidents
      COMMENT = 'Performance category incidents',
    , weekly_incident_trends.security_incidents AS security_incidents
      COMMENT = 'Security category incidents',
    , weekly_incident_trends.monitoring_incidents AS monitoring_incidents
      COMMENT = 'Incidents from monitoring source system'
    , weekly_incident_trends.customer_portal_incidents AS customer_portal_incidents
      COMMENT = 'Incidents from customer portal source system',
    , weekly_incident_trends.avg_resolution_time_hours AS avg_resolution_time_hours
      COMMENT = 'Average resolution time in hours',
    , weekly_incident_trends.incidents_with_attachments AS incidents_with_attachments
      COMMENT = 'Incidents that had attachments',
    , weekly_incident_trends.resolution_rate_percentage AS resolution_rate_percentage
      COMMENT = 'Share of resolved/closed incidents as a percentage'
 )
[0m17:01:43.026957 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:01:43.732417 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0497d-0106-f0ea-0032-31870546ead2
[0m17:01:43.733134 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 163 at position 4 unexpected ','.
syntax error line 165 at position 4 unexpected ','.
[0m17:01:43.738965 [debug] [Thread-2 (]: Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 163 at position 4 unexpected ','.
  syntax error line 165 at position 4 unexpected ','.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:01:43.742626 [error] [Thread-2 (]: 1 of 1 ERROR creating sql semantic_view model semantic_views.alpha ............. [[31mERROR[0m in 0.93s]
[0m17:01:43.743645 [debug] [Thread-2 (]: Finished running node model.incident_management.alpha
[0m17:01:43.744988 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.alpha' to be skipped because of status 'error'.  Reason: Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 163 at position 4 unexpected ','.
  syntax error line 165 at position 4 unexpected ','.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql.
[0m17:01:43.748461 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m17:01:43.749042 [debug] [Dummy-1   ]: Connection 'model.incident_management.alpha' was properly closed.
[0m17:01:43.749579 [info ] [Dummy-1   ]: 
[0m17:01:43.750136 [info ] [Dummy-1   ]: Finished running 1 semantic view model in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m17:01:43.751112 [debug] [Dummy-1   ]: Command end result
[0m17:01:43.800945 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:01:43.803866 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:01:43.812071 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m17:01:43.812623 [info ] [Dummy-1   ]: 
[0m17:01:43.813276 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:01:43.813821 [info ] [Dummy-1   ]: 
[0m17:01:43.814571 [error] [Dummy-1   ]:   Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 163 at position 4 unexpected ','.
  syntax error line 165 at position 4 unexpected ','.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:01:43.815097 [info ] [Dummy-1   ]: 
[0m17:01:43.815615 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:01:43.817458 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.9843645, "process_in_blocks": "0", "process_kernel_time": 1.38, "process_mem_max_rss": "488776", "process_out_blocks": "0", "process_user_time": 6.35}
[0m17:01:43.818176 [debug] [Dummy-1   ]: Command `cli run` failed at 17:01:43.817905 after 8.99 seconds
[0m17:01:43.818835 [debug] [Dummy-1   ]: Flushing usage events


============================== 17:03:21.037985 | d9422b34-249d-4b19-9663-11a0d324bc1f ==============================
[0m17:03:21.037985 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m17:03:21.039211 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:03:21.421257 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m17:03:22.212527 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:03:22.645045 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:03:22.646207 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/semantic_views/alpha.sql
[0m17:03:23.343383 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:03:23.346578 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:03:23.411298 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m17:03:23.414446 [info ] [Dummy-1   ]: 
[0m17:03:23.415154 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m17:03:23.415759 [info ] [Dummy-1   ]: 
[0m17:03:23.416695 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m17:03:23.429293 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m17:03:23.579620 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m17:03:23.580334 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m17:03:23.580892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:24.596742 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.016 seconds
[0m17:03:24.607106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_semantic_views)
[0m17:03:24.630533 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:03:24.631192 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:03:24.631688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:25.896745 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.265 seconds
[0m17:03:25.902726 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:03:25.903385 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m17:03:26.062045 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.158 seconds
[0m17:03:26.064572 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:03:26.065169 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:03:26.228665 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.163 seconds
[0m17:03:26.231144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_bronze_zone)
[0m17:03:26.241833 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:03:26.242462 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:03:26.242953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:27.113504 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.870 seconds
[0m17:03:27.116140 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:03:27.116752 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m17:03:27.229383 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.112 seconds
[0m17:03:27.232331 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:03:27.232936 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:03:27.334347 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m17:03:27.337102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m17:03:27.351056 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:03:27.351668 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:03:27.352177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:28.298737 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.946 seconds
[0m17:03:28.301252 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:03:28.301891 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m17:03:28.441614 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.139 seconds
[0m17:03:28.444342 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:03:28.444939 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:03:28.557290 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m17:03:28.568677 [debug] [Thread-2 (]: Began running node model.incident_management.alpha
[0m17:03:28.569741 [info ] [Thread-2 (]: 1 of 1 START sql semantic_view model semantic_views.alpha ...................... [RUN]
[0m17:03:28.570593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.alpha)
[0m17:03:28.571212 [debug] [Thread-2 (]: Began compiling node model.incident_management.alpha
[0m17:03:28.593782 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.alpha"
[0m17:03:28.594789 [debug] [Thread-2 (]: Began executing node model.incident_management.alpha
[0m17:03:28.625975 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.alpha"
[0m17:03:28.783781 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.alpha"
[0m17:03:28.786433 [debug] [Thread-2 (]: On model.incident_management.alpha: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.alpha"} */
create or replace semantic view incident_management.semantic_views.alpha
  

TABLES(
  doc_extracts as incident_management.bronze_zone.document_full_extracts
    COMMENT = 'All policy documents'
  , users as incident_management.bronze_zone.users
    COMMENT = 'Materialized users table with enriched data'
  , v_new_docs as incident_management.bronze_zone.v_qualify_new_documents
    COMMENT = 'Qualified new documents with derived type and extension'
  , v_slack_msgs as incident_management.bronze_zone.v_qualify_slack_messages
    COMMENT = 'Qualified Slack messages from known reporters with optional attachment metadata and extracted incident number'
  , incidents as incident_management.gold_zone.incidents
    COMMENT = 'Materialized incidents table with enriched data and calculated fields'
  , active_incidents as incident_management.gold_zone.active_incidents
    COMMENT = 'Active incidents requiring attention with SLA status and priority ordering'
  , closed_incidents as incident_management.gold_zone.closed_incidents
    COMMENT = 'Closed incidents with resolution metrics and performance insights'
  , incident_attachments as incident_management.gold_zone.incident_attachments
    COMMENT = 'Materialized incident attachments table'
  , incident_comment_history as incident_management.gold_zone.incident_comment_history
    COMMENT = 'Simplified incident comment history for tracking communication'
  , weekly_incident_trends as incident_management.gold_zone.weekly_incident_trends
    COMMENT = 'Weekly incident trends for the last 12 weeks'

)

 DIMENSIONS (
    doc_extracts.relative_path as relative_path
      COMMENT = 'Path to the file on the stage'
    , doc_extracts.last_modified AS last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    , doc_extracts.md5 AS md5
      COMMENT = 'MD5 checksum for the file'
    ,doc_extracts.etag AS etag
      COMMENT = 'ETag header for the file'
    , doc_extracts.file_url AS file_url
      WITH SYNONYMS = ('file url', 'snowflake file url')
      COMMENT = 'Snowflake file URL to the file'
    ,doc_extracts.doc_type AS doc_type
      WITH SYNONYMS = ('document type', 'doc type', 'analysis type')
      COMMENT = 'Type of document classification (e.g., ''full'', ''question'', ''slack'')'
    ,doc_extracts.extension AS extension
      WITH SYNONYMS = ('extension', 'file extension')
      COMMENT = 'File extension parsed from the path'
    ,doc_extracts.chunk AS chunk
      WITH SYNONYMS = ('chunk', 'text')
      COMMENT = 'Markdown/text chunk content extracted from the document pages'
    ,doc_extracts.headers AS headers
      WITH SYNONYMS = ('headers', 'detected headers')
      COMMENT = 'Object of detected headers for the chunk (e.g., header_1, header_2)'

    , users.id AS user_id
      COMMENT = 'Unique user identifier'
    , users.email AS user_email
      COMMENT = 'Primary email address'
    ,users.first_name AS user_first_name
      COMMENT = 'First name parsed from email user part'
    ,users.last_name AS user_last_name
      COMMENT = 'Last name parsed from email domain part'
    ,users.role AS user_role
      COMMENT = 'User role'
    ,users.department AS user_department
      COMMENT = 'User department'
    ,users.team AS user_team
      COMMENT = 'User team'
    , users.is_active AS user_is_active
      COMMENT = 'Active flag'
    , users.created_at AS user_created_at
      COMMENT = 'Creation timestamp'
    , users.updated_at AS user_updated_at
      COMMENT = 'Last update timestamp'

    , v_new_docs.relative_path AS new_doc_relative_path
      COMMENT = 'Path to the file on the stage'
    ,v_new_docs.last_modified AS new_doc_last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    ,v_new_docs.md5 AS new_doc_md5
      COMMENT = 'MD5 checksum for the file'
    ,v_new_docs.etag AS new_doc_etag
      COMMENT = 'ETag header for the file'
    ,v_new_docs.file_url AS new_doc_file_url
      COMMENT = 'Snowflake file URL to the file'
    ,v_new_docs.doc_type AS new_doc_type
      COMMENT = 'Derived document type based on the path'
    ,v_new_docs.extension AS new_doc_extension
      COMMENT = 'Derived file extension parsed from the path'

    , v_slack_msgs.hasfiles AS slack_hasfiles
      COMMENT = 'Whether the message has attachments'
    , v_slack_msgs.type AS slack_type
      COMMENT = 'Slack message type'
    , v_slack_msgs.subtype AS slack_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_msgs.team AS slack_team
      COMMENT = 'Slack team identifier'
    , v_slack_msgs.channel AS slack_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_msgs.user AS slack_user
      COMMENT = 'Slack user identifier'
    , v_slack_msgs.username AS slack_username
      COMMENT = 'Slack username'
    , v_slack_msgs.reporter_id AS slack_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_msgs.text AS slack_text
      COMMENT = 'Slack message text'
    , v_slack_msgs.ts AS slack_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_msgs.slack_message_id AS slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_msgs.file_id AS slack_file_id
      COMMENT = 'Attachment file id'
    , v_slack_msgs.file_name AS slack_file_name
      COMMENT = 'Attachment file name'
    , v_slack_msgs.file_mimetype AS slack_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_msgs.staged_file_path AS slack_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_msgs.attachment_file AS slack_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_msgs.incident_number AS slack_incident_number
      COMMENT = 'Extracted incident number from image or text'

    , v_slack_incident_msgs.hasfiles AS incmsg_hasfiles
      COMMENT = 'Whether the message has attachments'
    ,  v_slack_incident_msgs.type AS incmsg_type
      COMMENT = 'Slack message type'
    , v_slack_incident_msgs.subtype AS incmsg_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_incident_msgs.team AS incmsg_team
      COMMENT = 'Slack team identifier'
    , v_slack_incident_msgs.channel AS incmsg_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_incident_msgs.user AS incmsg_user
      COMMENT = 'Slack user identifier'
    , v_slack_incident_msgs.username AS incmsg_username
      COMMENT = 'Slack username'
    , v_slack_incident_msgs.reporter_id AS incmsg_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_incident_msgs.text AS incmsg_text
      COMMENT = 'Slack message text'
    , v_slack_incident_msgs.ts AS incmsg_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_incident_msgs.slack_message_id AS incmsg_slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_incident_msgs.file_id AS incmsg_file_id
      COMMENT = 'Attachment file id'
    , v_slack_incident_msgs.file_name AS incmsg_file_name
      COMMENT = 'Attachment file name'
    , v_slack_incident_msgs.file_mimetype AS incmsg_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_incident_msgs.staged_file_path AS incmsg_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_incident_msgs.attachment_file AS incmsg_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_incident_msgs.incident_number AS incmsg_incident_number
      COMMENT = 'Incident number present or derived'

    , incidents.incident_number AS incident_number
      COMMENT = 'Incident identifier'
    , incidents.category AS incident_category
      COMMENT = 'Incident category'
    , incidents.title AS incident_title
      COMMENT = 'Incident title'
    , incidents.priority AS incident_priority
      COMMENT = 'Incident priority'
    , incidents.status AS incident_status
      COMMENT = 'Incident status'
    , incidents.assignee_id AS incident_assignee_id
      COMMENT = 'Assignee user id'
    , incidents.reportee_id AS incident_reportee_id
      COMMENT = 'Reportee user id'
    , incidents.created_at AS incident_created_at
      COMMENT = 'Creation timestamp'
    , incidents.closed_at AS incident_closed_at
      COMMENT = 'Close timestamp'
    , incidents.updated_at AS incident_updated_at
      COMMENT = 'Last update timestamp'
    , incidents.source_system AS incident_source_system
      COMMENT = 'Source system for the incident'
    ,incidents.external_source_id AS incident_external_source_id
      COMMENT = 'External source identifier'
    , incidents.has_attachments AS incident_has_attachments
      COMMENT = 'Whether the incident has attachments'
    , incidents.slack_message_id AS incident_slack_message_id
      COMMENT = 'Associated Slack message id'
    , incidents.last_comment AS incident_last_comment
      COMMENT = 'Latest comment content'

    , active_incidents.incident_number AS active_incident_number
      COMMENT = 'Incident identifier'
    , active_incidents.title AS active_incident_title
      COMMENT = 'Incident title'
    , active_incidents.category AS active_incident_category
      COMMENT = 'Incident category'
    , active_incidents.priority AS active_incident_priority
      COMMENT = 'Incident priority'
    , active_incidents.status AS active_incident_status
      COMMENT = 'Incident status'
    , active_incidents.assignee_id AS active_incident_assignee_id
      COMMENT = 'Assignee user id'
    , active_incidents.assignee_name AS active_incident_assignee_name
      COMMENT = 'Assignee full name'
    , active_incidents.reportee_id AS active_incident_reportee_id
      COMMENT = 'Reportee user id'
    , active_incidents.reportee_name AS active_incident_reportee_name
      COMMENT = 'Reportee full name'
    , active_incidents.created_at AS active_incident_created_at
      COMMENT = 'Creation timestamp'
    , active_incidents.updated_at AS active_incident_updated_at
      COMMENT = 'Last update timestamp'
    , active_incidents.source_system AS active_incident_source_system
      COMMENT = 'Source system for the incident'
    , active_incidents.external_source_id AS active_incident_external_source_id
      COMMENT = 'External source identifier'
    , active_incidents.has_attachments AS active_incident_has_attachments
      COMMENT = 'Whether the incident has attachments'

    , closed_incidents.incident_number AS closed_incident_number
      COMMENT = 'Incident identifier'
    , closed_incidents.title AS closed_incident_title
      COMMENT = 'Incident title'
    , closed_incidents.category AS closed_incident_category
      COMMENT = 'Incident category'
    , closed_incidents.priority AS closed_incident_priority
      COMMENT = 'Incident priority'
    , closed_incidents.status AS closed_incident_status
      COMMENT = 'Incident status'
    , closed_incidents.assignee_id AS closed_incident_assignee_id
      COMMENT = 'Assignee user id'
    , closed_incidents.reportee_id AS closed_incident_reportee_id
      COMMENT = 'Reportee user id'
    , closed_incidents.created_at AS closed_incident_created_at
      COMMENT = 'Creation timestamp'
    , closed_incidents.closed_at AS closed_incident_closed_at
      COMMENT = 'Close timestamp'
    , closed_incidents.updated_at AS closed_incident_updated_at
      COMMENT = 'Last update timestamp'
    , closed_incidents.source_system AS closed_incident_source_system
      COMMENT = 'Source system for the incident'
    , closed_incidents.external_source_id AS closed_incident_external_source_id
      COMMENT = 'External source identifier'
    , closed_incidents.has_attachments AS closed_incident_has_attachments
      COMMENT = 'Whether the incident had attachments'
    , closed_incidents.closed_month AS closed_incident_month
      COMMENT = 'Month when incident was closed'

    , incident_attachments.id AS attachment_id
      COMMENT = 'Attachment id'
    , incident_attachments.incident_number AS attachment_incident_number
      COMMENT = 'Incident identifier'
    , incident_attachments.attachment_file AS attachment_file
      COMMENT = 'Stage file reference for the attachment'
    , incident_attachments.uploaded_at AS attachment_uploaded_at
      COMMENT = 'Attachment upload timestamp'

    , incident_comment_history.id AS comment_id
      COMMENT = 'Comment id'
    , incident_comment_history.incident_number AS comment_incident_number
      COMMENT = 'Incident identifier'
    , incident_comment_history.author_id AS comment_author_id
      COMMENT = 'Comment author user id'
    ,  incident_comment_history.content AS comment_content
      COMMENT = 'Comment content'
    , incident_comment_history.created_at AS comment_created_at
      COMMENT = 'Comment creation timestamp'
    , weekly_incident_trends.week AS trend_week
      COMMENT = 'Week bucket (date truncated to week)'
  )

 FACTS (
    doc_extracts.size AS doc_size
      COMMENT = 'Size of the file in bytes'
    , doc_extracts.page_num AS doc_page_num
      COMMENT = 'Source page number for the extracted content'
    , v_new_docs.size AS new_doc_size
      COMMENT = 'Size of the file in bytes'

    , v_slack_msgs.file_size AS slack_file_size
      COMMENT = 'Attachment file size'
    , v_slack_incident_msgs.file_size AS incmsg_file_size
      COMMENT = 'Attachment file size'

    , active_incidents.age_hours AS active_incident_age_hours
      COMMENT = 'Age of incident in hours'

    , closed_incidents.total_resolution_hours AS total_resolution_hours
      COMMENT = 'Total time from creation to closure in hours'
    , closed_incidents.closed_year AS closed_year
      COMMENT = 'Year when the incident was closed'
    , closed_incidents.closed_quarter AS closed_quarter
      COMMENT = 'Quarter when the incident was closed'

    , weekly_incident_trends.total_incidents AS total_incidents
      COMMENT = 'Total incidents created in the week'
    , weekly_incident_trends.resolved_incidents AS resolved_incidents
      COMMENT = 'Incidents resolved in the week'
    , weekly_incident_trends.closed_incidents AS closed_incidents_count
      COMMENT = 'Incidents closed in the week'
    , weekly_incident_trends.open_incidents AS open_incidents
      COMMENT = 'Incidents open in the week'
    , weekly_incident_trends.critical_incidents AS critical_incidents
      COMMENT = 'Incidents with critical priority'
    , weekly_incident_trends.high_incidents AS high_incidents
      COMMENT = 'Incidents with high priority'
    , weekly_incident_trends.high_severity_incidents AS high_severity_incidents
      COMMENT = 'Incidents with critical or high priority'
    , weekly_incident_trends.payment_incidents AS payment_incidents
      COMMENT = 'Payment category incidents'
    , weekly_incident_trends.authentication_incidents AS authentication_incidents
      COMMENT = 'Authentication category incidents'
    , weekly_incident_trends.performance_incidents AS performance_incidents
      COMMENT = 'Performance category incidents'
    , weekly_incident_trends.security_incidents AS security_incidents
      COMMENT = 'Security category incidents'
    , weekly_incident_trends.monitoring_incidents AS monitoring_incidents
      COMMENT = 'Incidents from monitoring source system'
    , weekly_incident_trends.customer_portal_incidents AS customer_portal_incidents
      COMMENT = 'Incidents from customer portal source system',
    , weekly_incident_trends.avg_resolution_time_hours AS avg_resolution_time_hours
      COMMENT = 'Average resolution time in hours'
    , weekly_incident_trends.incidents_with_attachments AS incidents_with_attachments
      COMMENT = 'Incidents that had attachments'
    , weekly_incident_trends.resolution_rate_percentage AS resolution_rate_percentage
      COMMENT = 'Share of resolved/closed incidents as a percentage'
 )
[0m17:03:28.788107 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:03:29.654067 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0497f-0106-f145-0032-31870547e14e
[0m17:03:29.654804 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 271 at position 1 unexpected 'FACTS'.
[0m17:03:29.660533 [debug] [Thread-2 (]: Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 271 at position 1 unexpected 'FACTS'.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:03:29.664182 [error] [Thread-2 (]: 1 of 1 ERROR creating sql semantic_view model semantic_views.alpha ............. [[31mERROR[0m in 1.09s]
[0m17:03:29.665205 [debug] [Thread-2 (]: Finished running node model.incident_management.alpha
[0m17:03:29.666566 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.alpha' to be skipped because of status 'error'.  Reason: Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 271 at position 1 unexpected 'FACTS'.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql.
[0m17:03:29.670182 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m17:03:29.670734 [debug] [Dummy-1   ]: Connection 'model.incident_management.alpha' was properly closed.
[0m17:03:29.671236 [info ] [Dummy-1   ]: 
[0m17:03:29.671752 [info ] [Dummy-1   ]: Finished running 1 semantic view model in 0 hours 0 minutes and 6.25 seconds (6.25s).
[0m17:03:29.672715 [debug] [Dummy-1   ]: Command end result
[0m17:03:29.723574 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:03:29.726641 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:03:29.735094 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m17:03:29.735666 [info ] [Dummy-1   ]: 
[0m17:03:29.736323 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:03:29.736827 [info ] [Dummy-1   ]: 
[0m17:03:29.737569 [error] [Dummy-1   ]:   Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 271 at position 1 unexpected 'FACTS'.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:03:29.738097 [info ] [Dummy-1   ]: 
[0m17:03:29.738706 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:03:29.740728 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.802655, "process_in_blocks": "0", "process_kernel_time": 1.41, "process_mem_max_rss": "483084", "process_out_blocks": "0", "process_user_time": 6.39}
[0m17:03:29.741436 [debug] [Dummy-1   ]: Command `cli run` failed at 17:03:29.741160 after 8.80 seconds
[0m17:03:29.742051 [debug] [Dummy-1   ]: Flushing usage events


============================== 17:04:20.981987 | 8fb044f0-2bbb-4178-979b-2c1c37f13728 ==============================
[0m17:04:20.981987 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m17:04:20.983095 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m17:04:21.365385 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m17:04:22.116819 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:04:22.581462 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:04:22.582615 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/semantic_views/alpha.sql
[0m17:04:23.249136 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:04:23.251978 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:04:23.308622 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m17:04:23.311847 [info ] [Dummy-1   ]: 
[0m17:04:23.312664 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m17:04:23.313257 [info ] [Dummy-1   ]: 
[0m17:04:23.314424 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m17:04:23.317039 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m17:04:23.460607 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m17:04:23.461271 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m17:04:23.461802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:24.719548 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.258 seconds
[0m17:04:24.729586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m17:04:24.752526 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:04:24.753177 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:04:24.753764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:25.655887 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.902 seconds
[0m17:04:25.661892 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:04:25.662523 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m17:04:25.770970 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.108 seconds
[0m17:04:25.773922 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:04:25.774512 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:04:25.874447 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m17:04:25.877122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_semantic_views)
[0m17:04:25.891122 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:04:25.891791 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:04:25.892316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:26.827104 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.935 seconds
[0m17:04:26.829692 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:04:26.830288 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m17:04:26.919884 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.089 seconds
[0m17:04:26.922217 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:04:26.922777 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:04:27.033246 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m17:04:27.035589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_gold_zone)
[0m17:04:27.046119 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:04:27.046724 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:04:27.047207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:28.595954 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.549 seconds
[0m17:04:28.598491 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:04:28.599109 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m17:04:28.753256 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.153 seconds
[0m17:04:28.755900 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:04:28.756478 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:04:28.994589 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.237 seconds
[0m17:04:29.003997 [debug] [Thread-2 (]: Began running node model.incident_management.alpha
[0m17:04:29.004895 [info ] [Thread-2 (]: 1 of 1 START sql semantic_view model semantic_views.alpha ...................... [RUN]
[0m17:04:29.005631 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.alpha)
[0m17:04:29.006213 [debug] [Thread-2 (]: Began compiling node model.incident_management.alpha
[0m17:04:29.028436 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.alpha"
[0m17:04:29.029387 [debug] [Thread-2 (]: Began executing node model.incident_management.alpha
[0m17:04:29.061140 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.alpha"
[0m17:04:29.207376 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.alpha"
[0m17:04:29.210032 [debug] [Thread-2 (]: On model.incident_management.alpha: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.alpha"} */
create or replace semantic view incident_management.semantic_views.alpha
  

TABLES(
  doc_extracts as incident_management.bronze_zone.document_full_extracts
    COMMENT = 'All policy documents'
  , users as incident_management.bronze_zone.users
    COMMENT = 'Materialized users table with enriched data'
  , v_new_docs as incident_management.bronze_zone.v_qualify_new_documents
    COMMENT = 'Qualified new documents with derived type and extension'
  , v_slack_msgs as incident_management.bronze_zone.v_qualify_slack_messages
    COMMENT = 'Qualified Slack messages from known reporters with optional attachment metadata and extracted incident number'
  , incidents as incident_management.gold_zone.incidents
    COMMENT = 'Materialized incidents table with enriched data and calculated fields'
  , active_incidents as incident_management.gold_zone.active_incidents
    COMMENT = 'Active incidents requiring attention with SLA status and priority ordering'
  , closed_incidents as incident_management.gold_zone.closed_incidents
    COMMENT = 'Closed incidents with resolution metrics and performance insights'
  , incident_attachments as incident_management.gold_zone.incident_attachments
    COMMENT = 'Materialized incident attachments table'
  , incident_comment_history as incident_management.gold_zone.incident_comment_history
    COMMENT = 'Simplified incident comment history for tracking communication'
  , weekly_incident_trends as incident_management.gold_zone.weekly_incident_trends
    COMMENT = 'Weekly incident trends for the last 12 weeks'

)

FACTS (
    doc_extracts.size AS doc_size
      COMMENT = 'Size of the file in bytes'
    , doc_extracts.page_num AS doc_page_num
      COMMENT = 'Source page number for the extracted content'
    , v_new_docs.size AS new_doc_size
      COMMENT = 'Size of the file in bytes'

    , v_slack_msgs.file_size AS slack_file_size
      COMMENT = 'Attachment file size'
    , v_slack_incident_msgs.file_size AS incmsg_file_size
      COMMENT = 'Attachment file size'

    , active_incidents.age_hours AS active_incident_age_hours
      COMMENT = 'Age of incident in hours'

    , closed_incidents.total_resolution_hours AS total_resolution_hours
      COMMENT = 'Total time from creation to closure in hours'
    , closed_incidents.closed_year AS closed_year
      COMMENT = 'Year when the incident was closed'
    , closed_incidents.closed_quarter AS closed_quarter
      COMMENT = 'Quarter when the incident was closed'

    , weekly_incident_trends.total_incidents AS total_incidents
      COMMENT = 'Total incidents created in the week'
    , weekly_incident_trends.resolved_incidents AS resolved_incidents
      COMMENT = 'Incidents resolved in the week'
    , weekly_incident_trends.closed_incidents AS closed_incidents_count
      COMMENT = 'Incidents closed in the week'
    , weekly_incident_trends.open_incidents AS open_incidents
      COMMENT = 'Incidents open in the week'
    , weekly_incident_trends.critical_incidents AS critical_incidents
      COMMENT = 'Incidents with critical priority'
    , weekly_incident_trends.high_incidents AS high_incidents
      COMMENT = 'Incidents with high priority'
    , weekly_incident_trends.high_severity_incidents AS high_severity_incidents
      COMMENT = 'Incidents with critical or high priority'
    , weekly_incident_trends.payment_incidents AS payment_incidents
      COMMENT = 'Payment category incidents'
    , weekly_incident_trends.authentication_incidents AS authentication_incidents
      COMMENT = 'Authentication category incidents'
    , weekly_incident_trends.performance_incidents AS performance_incidents
      COMMENT = 'Performance category incidents'
    , weekly_incident_trends.security_incidents AS security_incidents
      COMMENT = 'Security category incidents'
    , weekly_incident_trends.monitoring_incidents AS monitoring_incidents
      COMMENT = 'Incidents from monitoring source system'
    , weekly_incident_trends.customer_portal_incidents AS customer_portal_incidents
      COMMENT = 'Incidents from customer portal source system',
    , weekly_incident_trends.avg_resolution_time_hours AS avg_resolution_time_hours
      COMMENT = 'Average resolution time in hours'
    , weekly_incident_trends.incidents_with_attachments AS incidents_with_attachments
      COMMENT = 'Incidents that had attachments'
    , weekly_incident_trends.resolution_rate_percentage AS resolution_rate_percentage
      COMMENT = 'Share of resolved/closed incidents as a percentage'
 )

 DIMENSIONS (
    doc_extracts.relative_path as relative_path
      COMMENT = 'Path to the file on the stage'
    , doc_extracts.last_modified AS last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    , doc_extracts.md5 AS md5
      COMMENT = 'MD5 checksum for the file'
    ,doc_extracts.etag AS etag
      COMMENT = 'ETag header for the file'
    , doc_extracts.file_url AS file_url
      WITH SYNONYMS = ('file url', 'snowflake file url')
      COMMENT = 'Snowflake file URL to the file'
    ,doc_extracts.doc_type AS doc_type
      WITH SYNONYMS = ('document type', 'doc type', 'analysis type')
      COMMENT = 'Type of document classification (e.g., ''full'', ''question'', ''slack'')'
    ,doc_extracts.extension AS extension
      WITH SYNONYMS = ('extension', 'file extension')
      COMMENT = 'File extension parsed from the path'
    ,doc_extracts.chunk AS chunk
      WITH SYNONYMS = ('chunk', 'text')
      COMMENT = 'Markdown/text chunk content extracted from the document pages'
    ,doc_extracts.headers AS headers
      WITH SYNONYMS = ('headers', 'detected headers')
      COMMENT = 'Object of detected headers for the chunk (e.g., header_1, header_2)'

    , users.id AS user_id
      COMMENT = 'Unique user identifier'
    , users.email AS user_email
      COMMENT = 'Primary email address'
    ,users.first_name AS user_first_name
      COMMENT = 'First name parsed from email user part'
    ,users.last_name AS user_last_name
      COMMENT = 'Last name parsed from email domain part'
    ,users.role AS user_role
      COMMENT = 'User role'
    ,users.department AS user_department
      COMMENT = 'User department'
    ,users.team AS user_team
      COMMENT = 'User team'
    , users.is_active AS user_is_active
      COMMENT = 'Active flag'
    , users.created_at AS user_created_at
      COMMENT = 'Creation timestamp'
    , users.updated_at AS user_updated_at
      COMMENT = 'Last update timestamp'

    , v_new_docs.relative_path AS new_doc_relative_path
      COMMENT = 'Path to the file on the stage'
    ,v_new_docs.last_modified AS new_doc_last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    ,v_new_docs.md5 AS new_doc_md5
      COMMENT = 'MD5 checksum for the file'
    ,v_new_docs.etag AS new_doc_etag
      COMMENT = 'ETag header for the file'
    ,v_new_docs.file_url AS new_doc_file_url
      COMMENT = 'Snowflake file URL to the file'
    ,v_new_docs.doc_type AS new_doc_type
      COMMENT = 'Derived document type based on the path'
    ,v_new_docs.extension AS new_doc_extension
      COMMENT = 'Derived file extension parsed from the path'

    , v_slack_msgs.hasfiles AS slack_hasfiles
      COMMENT = 'Whether the message has attachments'
    , v_slack_msgs.type AS slack_type
      COMMENT = 'Slack message type'
    , v_slack_msgs.subtype AS slack_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_msgs.team AS slack_team
      COMMENT = 'Slack team identifier'
    , v_slack_msgs.channel AS slack_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_msgs.user AS slack_user
      COMMENT = 'Slack user identifier'
    , v_slack_msgs.username AS slack_username
      COMMENT = 'Slack username'
    , v_slack_msgs.reporter_id AS slack_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_msgs.text AS slack_text
      COMMENT = 'Slack message text'
    , v_slack_msgs.ts AS slack_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_msgs.slack_message_id AS slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_msgs.file_id AS slack_file_id
      COMMENT = 'Attachment file id'
    , v_slack_msgs.file_name AS slack_file_name
      COMMENT = 'Attachment file name'
    , v_slack_msgs.file_mimetype AS slack_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_msgs.staged_file_path AS slack_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_msgs.attachment_file AS slack_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_msgs.incident_number AS slack_incident_number
      COMMENT = 'Extracted incident number from image or text'

    , v_slack_incident_msgs.hasfiles AS incmsg_hasfiles
      COMMENT = 'Whether the message has attachments'
    ,  v_slack_incident_msgs.type AS incmsg_type
      COMMENT = 'Slack message type'
    , v_slack_incident_msgs.subtype AS incmsg_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_incident_msgs.team AS incmsg_team
      COMMENT = 'Slack team identifier'
    , v_slack_incident_msgs.channel AS incmsg_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_incident_msgs.user AS incmsg_user
      COMMENT = 'Slack user identifier'
    , v_slack_incident_msgs.username AS incmsg_username
      COMMENT = 'Slack username'
    , v_slack_incident_msgs.reporter_id AS incmsg_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_incident_msgs.text AS incmsg_text
      COMMENT = 'Slack message text'
    , v_slack_incident_msgs.ts AS incmsg_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_incident_msgs.slack_message_id AS incmsg_slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_incident_msgs.file_id AS incmsg_file_id
      COMMENT = 'Attachment file id'
    , v_slack_incident_msgs.file_name AS incmsg_file_name
      COMMENT = 'Attachment file name'
    , v_slack_incident_msgs.file_mimetype AS incmsg_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_incident_msgs.staged_file_path AS incmsg_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_incident_msgs.attachment_file AS incmsg_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_incident_msgs.incident_number AS incmsg_incident_number
      COMMENT = 'Incident number present or derived'

    , incidents.incident_number AS incident_number
      COMMENT = 'Incident identifier'
    , incidents.category AS incident_category
      COMMENT = 'Incident category'
    , incidents.title AS incident_title
      COMMENT = 'Incident title'
    , incidents.priority AS incident_priority
      COMMENT = 'Incident priority'
    , incidents.status AS incident_status
      COMMENT = 'Incident status'
    , incidents.assignee_id AS incident_assignee_id
      COMMENT = 'Assignee user id'
    , incidents.reportee_id AS incident_reportee_id
      COMMENT = 'Reportee user id'
    , incidents.created_at AS incident_created_at
      COMMENT = 'Creation timestamp'
    , incidents.closed_at AS incident_closed_at
      COMMENT = 'Close timestamp'
    , incidents.updated_at AS incident_updated_at
      COMMENT = 'Last update timestamp'
    , incidents.source_system AS incident_source_system
      COMMENT = 'Source system for the incident'
    ,incidents.external_source_id AS incident_external_source_id
      COMMENT = 'External source identifier'
    , incidents.has_attachments AS incident_has_attachments
      COMMENT = 'Whether the incident has attachments'
    , incidents.slack_message_id AS incident_slack_message_id
      COMMENT = 'Associated Slack message id'
    , incidents.last_comment AS incident_last_comment
      COMMENT = 'Latest comment content'

    , active_incidents.incident_number AS active_incident_number
      COMMENT = 'Incident identifier'
    , active_incidents.title AS active_incident_title
      COMMENT = 'Incident title'
    , active_incidents.category AS active_incident_category
      COMMENT = 'Incident category'
    , active_incidents.priority AS active_incident_priority
      COMMENT = 'Incident priority'
    , active_incidents.status AS active_incident_status
      COMMENT = 'Incident status'
    , active_incidents.assignee_id AS active_incident_assignee_id
      COMMENT = 'Assignee user id'
    , active_incidents.assignee_name AS active_incident_assignee_name
      COMMENT = 'Assignee full name'
    , active_incidents.reportee_id AS active_incident_reportee_id
      COMMENT = 'Reportee user id'
    , active_incidents.reportee_name AS active_incident_reportee_name
      COMMENT = 'Reportee full name'
    , active_incidents.created_at AS active_incident_created_at
      COMMENT = 'Creation timestamp'
    , active_incidents.updated_at AS active_incident_updated_at
      COMMENT = 'Last update timestamp'
    , active_incidents.source_system AS active_incident_source_system
      COMMENT = 'Source system for the incident'
    , active_incidents.external_source_id AS active_incident_external_source_id
      COMMENT = 'External source identifier'
    , active_incidents.has_attachments AS active_incident_has_attachments
      COMMENT = 'Whether the incident has attachments'

    , closed_incidents.incident_number AS closed_incident_number
      COMMENT = 'Incident identifier'
    , closed_incidents.title AS closed_incident_title
      COMMENT = 'Incident title'
    , closed_incidents.category AS closed_incident_category
      COMMENT = 'Incident category'
    , closed_incidents.priority AS closed_incident_priority
      COMMENT = 'Incident priority'
    , closed_incidents.status AS closed_incident_status
      COMMENT = 'Incident status'
    , closed_incidents.assignee_id AS closed_incident_assignee_id
      COMMENT = 'Assignee user id'
    , closed_incidents.reportee_id AS closed_incident_reportee_id
      COMMENT = 'Reportee user id'
    , closed_incidents.created_at AS closed_incident_created_at
      COMMENT = 'Creation timestamp'
    , closed_incidents.closed_at AS closed_incident_closed_at
      COMMENT = 'Close timestamp'
    , closed_incidents.updated_at AS closed_incident_updated_at
      COMMENT = 'Last update timestamp'
    , closed_incidents.source_system AS closed_incident_source_system
      COMMENT = 'Source system for the incident'
    , closed_incidents.external_source_id AS closed_incident_external_source_id
      COMMENT = 'External source identifier'
    , closed_incidents.has_attachments AS closed_incident_has_attachments
      COMMENT = 'Whether the incident had attachments'
    , closed_incidents.closed_month AS closed_incident_month
      COMMENT = 'Month when incident was closed'

    , incident_attachments.id AS attachment_id
      COMMENT = 'Attachment id'
    , incident_attachments.incident_number AS attachment_incident_number
      COMMENT = 'Incident identifier'
    , incident_attachments.attachment_file AS attachment_file
      COMMENT = 'Stage file reference for the attachment'
    , incident_attachments.uploaded_at AS attachment_uploaded_at
      COMMENT = 'Attachment upload timestamp'

    , incident_comment_history.id AS comment_id
      COMMENT = 'Comment id'
    , incident_comment_history.incident_number AS comment_incident_number
      COMMENT = 'Incident identifier'
    , incident_comment_history.author_id AS comment_author_id
      COMMENT = 'Comment author user id'
    ,  incident_comment_history.content AS comment_content
      COMMENT = 'Comment content'
    , incident_comment_history.created_at AS comment_created_at
      COMMENT = 'Comment creation timestamp'
    , weekly_incident_trends.week AS trend_week
      COMMENT = 'Week bucket (date truncated to week)'
  )
[0m17:04:29.211647 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:04:30.911307 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c04980-0106-f0aa-0032-31870546bf16
[0m17:04:30.912041 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 77 at position 4 unexpected ','.
syntax error line 79 at position 4 unexpected ','.
[0m17:04:30.917817 [debug] [Thread-2 (]: Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 77 at position 4 unexpected ','.
  syntax error line 79 at position 4 unexpected ','.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:04:30.921566 [error] [Thread-2 (]: 1 of 1 ERROR creating sql semantic_view model semantic_views.alpha ............. [[31mERROR[0m in 1.91s]
[0m17:04:30.922599 [debug] [Thread-2 (]: Finished running node model.incident_management.alpha
[0m17:04:30.923959 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.alpha' to be skipped because of status 'error'.  Reason: Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 77 at position 4 unexpected ','.
  syntax error line 79 at position 4 unexpected ','.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql.
[0m17:04:30.927587 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m17:04:30.928171 [debug] [Dummy-1   ]: Connection 'model.incident_management.alpha' was properly closed.
[0m17:04:30.928810 [info ] [Dummy-1   ]: 
[0m17:04:30.929341 [info ] [Dummy-1   ]: Finished running 1 semantic view model in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m17:04:30.930349 [debug] [Dummy-1   ]: Command end result
[0m17:04:30.980889 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:04:30.983781 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:04:30.991868 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m17:04:30.992425 [info ] [Dummy-1   ]: 
[0m17:04:30.993061 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:04:30.993579 [info ] [Dummy-1   ]: 
[0m17:04:30.994342 [error] [Dummy-1   ]:   Database Error in model alpha (models/semantic_views/alpha.sql)
  001003 (42000): SQL compilation error:
  syntax error line 77 at position 4 unexpected ','.
  syntax error line 79 at position 4 unexpected ','.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:04:30.994865 [info ] [Dummy-1   ]: 
[0m17:04:30.995385 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:04:30.997213 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.112949, "process_in_blocks": "0", "process_kernel_time": 1.32, "process_mem_max_rss": "492032", "process_out_blocks": "0", "process_user_time": 6.27}
[0m17:04:30.997925 [debug] [Dummy-1   ]: Command `cli run` failed at 17:04:30.997649 after 10.11 seconds
[0m17:04:30.998592 [debug] [Dummy-1   ]: Flushing usage events


============================== 17:05:06.119093 | 3fe5b0ab-ebd1-40b7-927a-8474effce3d5 ==============================
[0m17:05:06.119093 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m17:05:06.120271 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m17:05:06.509456 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m17:05:07.280817 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:05:07.714613 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:07.715840 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/semantic_views/alpha.sql
[0m17:05:08.391655 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:05:08.394645 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:05:08.456109 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m17:05:08.459221 [info ] [Dummy-1   ]: 
[0m17:05:08.459825 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m17:05:08.460289 [info ] [Dummy-1   ]: 
[0m17:05:08.461101 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m17:05:08.463142 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m17:05:08.614036 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m17:05:08.614778 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m17:05:08.615339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:09.341660 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.726 seconds
[0m17:05:09.351698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_semantic_views)
[0m17:05:09.375022 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:05:09.375692 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:05:09.376187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:09.983543 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.607 seconds
[0m17:05:09.989509 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:05:09.990229 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m17:05:10.057099 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.066 seconds
[0m17:05:10.059678 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:05:10.060272 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:05:10.135630 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.075 seconds
[0m17:05:10.137985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_bronze_zone)
[0m17:05:10.148656 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:05:10.149292 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:05:10.149807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:10.797954 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.648 seconds
[0m17:05:10.800614 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:05:10.801198 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m17:05:10.906587 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.105 seconds
[0m17:05:10.909550 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:05:10.910235 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:05:10.990256 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.079 seconds
[0m17:05:10.992916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m17:05:11.006883 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:05:11.007532 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:05:11.008019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:11.653174 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.645 seconds
[0m17:05:11.655674 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:05:11.656262 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m17:05:11.751160 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.094 seconds
[0m17:05:11.753809 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:05:11.754381 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:05:11.851265 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m17:05:11.860725 [debug] [Thread-2 (]: Began running node model.incident_management.alpha
[0m17:05:11.861673 [info ] [Thread-2 (]: 1 of 1 START sql semantic_view model semantic_views.alpha ...................... [RUN]
[0m17:05:11.862424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.alpha)
[0m17:05:11.863042 [debug] [Thread-2 (]: Began compiling node model.incident_management.alpha
[0m17:05:11.885288 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.alpha"
[0m17:05:11.886293 [debug] [Thread-2 (]: Began executing node model.incident_management.alpha
[0m17:05:11.916367 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.alpha"
[0m17:05:12.061825 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.alpha"
[0m17:05:12.064419 [debug] [Thread-2 (]: On model.incident_management.alpha: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.alpha"} */
create or replace semantic view incident_management.semantic_views.alpha
  

TABLES(
  doc_extracts as incident_management.bronze_zone.document_full_extracts
    COMMENT = 'All policy documents'
  , users as incident_management.bronze_zone.users
    COMMENT = 'Materialized users table with enriched data'
  , v_new_docs as incident_management.bronze_zone.v_qualify_new_documents
    COMMENT = 'Qualified new documents with derived type and extension'
  , v_slack_msgs as incident_management.bronze_zone.v_qualify_slack_messages
    COMMENT = 'Qualified Slack messages from known reporters with optional attachment metadata and extracted incident number'
  , incidents as incident_management.gold_zone.incidents
    COMMENT = 'Materialized incidents table with enriched data and calculated fields'
  , active_incidents as incident_management.gold_zone.active_incidents
    COMMENT = 'Active incidents requiring attention with SLA status and priority ordering'
  , closed_incidents as incident_management.gold_zone.closed_incidents
    COMMENT = 'Closed incidents with resolution metrics and performance insights'
  , incident_attachments as incident_management.gold_zone.incident_attachments
    COMMENT = 'Materialized incident attachments table'
  , incident_comment_history as incident_management.gold_zone.incident_comment_history
    COMMENT = 'Simplified incident comment history for tracking communication'
  , weekly_incident_trends as incident_management.gold_zone.weekly_incident_trends
    COMMENT = 'Weekly incident trends for the last 12 weeks'

)

FACTS (
    doc_extracts.size AS doc_size
      COMMENT = 'Size of the file in bytes'
    , doc_extracts.page_num AS doc_page_num
      COMMENT = 'Source page number for the extracted content'
    , v_new_docs.size AS new_doc_size
      COMMENT = 'Size of the file in bytes'

    , v_slack_msgs.file_size AS slack_file_size
      COMMENT = 'Attachment file size'
    , v_slack_incident_msgs.file_size AS incmsg_file_size
      COMMENT = 'Attachment file size'

    , active_incidents.age_hours AS active_incident_age_hours
      COMMENT = 'Age of incident in hours'

    , closed_incidents.total_resolution_hours AS total_resolution_hours
      COMMENT = 'Total time from creation to closure in hours'
    , closed_incidents.closed_year AS closed_year
      COMMENT = 'Year when the incident was closed'
    , closed_incidents.closed_quarter AS closed_quarter
      COMMENT = 'Quarter when the incident was closed'

    , weekly_incident_trends.total_incidents AS total_incidents
      COMMENT = 'Total incidents created in the week'
    , weekly_incident_trends.resolved_incidents AS resolved_incidents
      COMMENT = 'Incidents resolved in the week'
    , weekly_incident_trends.closed_incidents AS closed_incidents_count
      COMMENT = 'Incidents closed in the week'
    , weekly_incident_trends.open_incidents AS open_incidents
      COMMENT = 'Incidents open in the week'
    , weekly_incident_trends.critical_incidents AS critical_incidents
      COMMENT = 'Incidents with critical priority'
    , weekly_incident_trends.high_incidents AS high_incidents
      COMMENT = 'Incidents with high priority'
    , weekly_incident_trends.high_severity_incidents AS high_severity_incidents
      COMMENT = 'Incidents with critical or high priority'
    , weekly_incident_trends.payment_incidents AS payment_incidents
      COMMENT = 'Payment category incidents'
    , weekly_incident_trends.authentication_incidents AS authentication_incidents
      COMMENT = 'Authentication category incidents'
    , weekly_incident_trends.performance_incidents AS performance_incidents
      COMMENT = 'Performance category incidents'
    , weekly_incident_trends.security_incidents AS security_incidents
      COMMENT = 'Security category incidents'
    , weekly_incident_trends.monitoring_incidents AS monitoring_incidents
      COMMENT = 'Incidents from monitoring source system'
    , weekly_incident_trends.customer_portal_incidents AS customer_portal_incidents
      COMMENT = 'Incidents from customer portal source system'
    , weekly_incident_trends.avg_resolution_time_hours AS avg_resolution_time_hours
      COMMENT = 'Average resolution time in hours'
    , weekly_incident_trends.incidents_with_attachments AS incidents_with_attachments
      COMMENT = 'Incidents that had attachments'
    , weekly_incident_trends.resolution_rate_percentage AS resolution_rate_percentage
      COMMENT = 'Share of resolved/closed incidents as a percentage'
 )

 DIMENSIONS (
    doc_extracts.relative_path as relative_path
      COMMENT = 'Path to the file on the stage'
    , doc_extracts.last_modified AS last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    , doc_extracts.md5 AS md5
      COMMENT = 'MD5 checksum for the file'
    ,doc_extracts.etag AS etag
      COMMENT = 'ETag header for the file'
    , doc_extracts.file_url AS file_url
      WITH SYNONYMS = ('file url', 'snowflake file url')
      COMMENT = 'Snowflake file URL to the file'
    ,doc_extracts.doc_type AS doc_type
      WITH SYNONYMS = ('document type', 'doc type', 'analysis type')
      COMMENT = 'Type of document classification (e.g., ''full'', ''question'', ''slack'')'
    ,doc_extracts.extension AS extension
      WITH SYNONYMS = ('extension', 'file extension')
      COMMENT = 'File extension parsed from the path'
    ,doc_extracts.chunk AS chunk
      WITH SYNONYMS = ('chunk', 'text')
      COMMENT = 'Markdown/text chunk content extracted from the document pages'
    ,doc_extracts.headers AS headers
      WITH SYNONYMS = ('headers', 'detected headers')
      COMMENT = 'Object of detected headers for the chunk (e.g., header_1, header_2)'

    , users.id AS user_id
      COMMENT = 'Unique user identifier'
    , users.email AS user_email
      COMMENT = 'Primary email address'
    ,users.first_name AS user_first_name
      COMMENT = 'First name parsed from email user part'
    ,users.last_name AS user_last_name
      COMMENT = 'Last name parsed from email domain part'
    ,users.role AS user_role
      COMMENT = 'User role'
    ,users.department AS user_department
      COMMENT = 'User department'
    ,users.team AS user_team
      COMMENT = 'User team'
    , users.is_active AS user_is_active
      COMMENT = 'Active flag'
    , users.created_at AS user_created_at
      COMMENT = 'Creation timestamp'
    , users.updated_at AS user_updated_at
      COMMENT = 'Last update timestamp'

    , v_new_docs.relative_path AS new_doc_relative_path
      COMMENT = 'Path to the file on the stage'
    ,v_new_docs.last_modified AS new_doc_last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    ,v_new_docs.md5 AS new_doc_md5
      COMMENT = 'MD5 checksum for the file'
    ,v_new_docs.etag AS new_doc_etag
      COMMENT = 'ETag header for the file'
    ,v_new_docs.file_url AS new_doc_file_url
      COMMENT = 'Snowflake file URL to the file'
    ,v_new_docs.doc_type AS new_doc_type
      COMMENT = 'Derived document type based on the path'
    ,v_new_docs.extension AS new_doc_extension
      COMMENT = 'Derived file extension parsed from the path'

    , v_slack_msgs.hasfiles AS slack_hasfiles
      COMMENT = 'Whether the message has attachments'
    , v_slack_msgs.type AS slack_type
      COMMENT = 'Slack message type'
    , v_slack_msgs.subtype AS slack_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_msgs.team AS slack_team
      COMMENT = 'Slack team identifier'
    , v_slack_msgs.channel AS slack_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_msgs.user AS slack_user
      COMMENT = 'Slack user identifier'
    , v_slack_msgs.username AS slack_username
      COMMENT = 'Slack username'
    , v_slack_msgs.reporter_id AS slack_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_msgs.text AS slack_text
      COMMENT = 'Slack message text'
    , v_slack_msgs.ts AS slack_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_msgs.slack_message_id AS slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_msgs.file_id AS slack_file_id
      COMMENT = 'Attachment file id'
    , v_slack_msgs.file_name AS slack_file_name
      COMMENT = 'Attachment file name'
    , v_slack_msgs.file_mimetype AS slack_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_msgs.staged_file_path AS slack_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_msgs.attachment_file AS slack_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_msgs.incident_number AS slack_incident_number
      COMMENT = 'Extracted incident number from image or text'

    , v_slack_incident_msgs.hasfiles AS incmsg_hasfiles
      COMMENT = 'Whether the message has attachments'
    ,  v_slack_incident_msgs.type AS incmsg_type
      COMMENT = 'Slack message type'
    , v_slack_incident_msgs.subtype AS incmsg_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_incident_msgs.team AS incmsg_team
      COMMENT = 'Slack team identifier'
    , v_slack_incident_msgs.channel AS incmsg_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_incident_msgs.user AS incmsg_user
      COMMENT = 'Slack user identifier'
    , v_slack_incident_msgs.username AS incmsg_username
      COMMENT = 'Slack username'
    , v_slack_incident_msgs.reporter_id AS incmsg_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_incident_msgs.text AS incmsg_text
      COMMENT = 'Slack message text'
    , v_slack_incident_msgs.ts AS incmsg_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_incident_msgs.slack_message_id AS incmsg_slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_incident_msgs.file_id AS incmsg_file_id
      COMMENT = 'Attachment file id'
    , v_slack_incident_msgs.file_name AS incmsg_file_name
      COMMENT = 'Attachment file name'
    , v_slack_incident_msgs.file_mimetype AS incmsg_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_incident_msgs.staged_file_path AS incmsg_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_incident_msgs.attachment_file AS incmsg_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_incident_msgs.incident_number AS incmsg_incident_number
      COMMENT = 'Incident number present or derived'

    , incidents.incident_number AS incident_number
      COMMENT = 'Incident identifier'
    , incidents.category AS incident_category
      COMMENT = 'Incident category'
    , incidents.title AS incident_title
      COMMENT = 'Incident title'
    , incidents.priority AS incident_priority
      COMMENT = 'Incident priority'
    , incidents.status AS incident_status
      COMMENT = 'Incident status'
    , incidents.assignee_id AS incident_assignee_id
      COMMENT = 'Assignee user id'
    , incidents.reportee_id AS incident_reportee_id
      COMMENT = 'Reportee user id'
    , incidents.created_at AS incident_created_at
      COMMENT = 'Creation timestamp'
    , incidents.closed_at AS incident_closed_at
      COMMENT = 'Close timestamp'
    , incidents.updated_at AS incident_updated_at
      COMMENT = 'Last update timestamp'
    , incidents.source_system AS incident_source_system
      COMMENT = 'Source system for the incident'
    ,incidents.external_source_id AS incident_external_source_id
      COMMENT = 'External source identifier'
    , incidents.has_attachments AS incident_has_attachments
      COMMENT = 'Whether the incident has attachments'
    , incidents.slack_message_id AS incident_slack_message_id
      COMMENT = 'Associated Slack message id'
    , incidents.last_comment AS incident_last_comment
      COMMENT = 'Latest comment content'

    , active_incidents.incident_number AS active_incident_number
      COMMENT = 'Incident identifier'
    , active_incidents.title AS active_incident_title
      COMMENT = 'Incident title'
    , active_incidents.category AS active_incident_category
      COMMENT = 'Incident category'
    , active_incidents.priority AS active_incident_priority
      COMMENT = 'Incident priority'
    , active_incidents.status AS active_incident_status
      COMMENT = 'Incident status'
    , active_incidents.assignee_id AS active_incident_assignee_id
      COMMENT = 'Assignee user id'
    , active_incidents.assignee_name AS active_incident_assignee_name
      COMMENT = 'Assignee full name'
    , active_incidents.reportee_id AS active_incident_reportee_id
      COMMENT = 'Reportee user id'
    , active_incidents.reportee_name AS active_incident_reportee_name
      COMMENT = 'Reportee full name'
    , active_incidents.created_at AS active_incident_created_at
      COMMENT = 'Creation timestamp'
    , active_incidents.updated_at AS active_incident_updated_at
      COMMENT = 'Last update timestamp'
    , active_incidents.source_system AS active_incident_source_system
      COMMENT = 'Source system for the incident'
    , active_incidents.external_source_id AS active_incident_external_source_id
      COMMENT = 'External source identifier'
    , active_incidents.has_attachments AS active_incident_has_attachments
      COMMENT = 'Whether the incident has attachments'

    , closed_incidents.incident_number AS closed_incident_number
      COMMENT = 'Incident identifier'
    , closed_incidents.title AS closed_incident_title
      COMMENT = 'Incident title'
    , closed_incidents.category AS closed_incident_category
      COMMENT = 'Incident category'
    , closed_incidents.priority AS closed_incident_priority
      COMMENT = 'Incident priority'
    , closed_incidents.status AS closed_incident_status
      COMMENT = 'Incident status'
    , closed_incidents.assignee_id AS closed_incident_assignee_id
      COMMENT = 'Assignee user id'
    , closed_incidents.reportee_id AS closed_incident_reportee_id
      COMMENT = 'Reportee user id'
    , closed_incidents.created_at AS closed_incident_created_at
      COMMENT = 'Creation timestamp'
    , closed_incidents.closed_at AS closed_incident_closed_at
      COMMENT = 'Close timestamp'
    , closed_incidents.updated_at AS closed_incident_updated_at
      COMMENT = 'Last update timestamp'
    , closed_incidents.source_system AS closed_incident_source_system
      COMMENT = 'Source system for the incident'
    , closed_incidents.external_source_id AS closed_incident_external_source_id
      COMMENT = 'External source identifier'
    , closed_incidents.has_attachments AS closed_incident_has_attachments
      COMMENT = 'Whether the incident had attachments'
    , closed_incidents.closed_month AS closed_incident_month
      COMMENT = 'Month when incident was closed'

    , incident_attachments.id AS attachment_id
      COMMENT = 'Attachment id'
    , incident_attachments.incident_number AS attachment_incident_number
      COMMENT = 'Incident identifier'
    , incident_attachments.attachment_file AS attachment_file
      COMMENT = 'Stage file reference for the attachment'
    , incident_attachments.uploaded_at AS attachment_uploaded_at
      COMMENT = 'Attachment upload timestamp'

    , incident_comment_history.id AS comment_id
      COMMENT = 'Comment id'
    , incident_comment_history.incident_number AS comment_incident_number
      COMMENT = 'Incident identifier'
    , incident_comment_history.author_id AS comment_author_id
      COMMENT = 'Comment author user id'
    ,  incident_comment_history.content AS comment_content
      COMMENT = 'Comment content'
    , incident_comment_history.created_at AS comment_created_at
      COMMENT = 'Comment creation timestamp'
    , weekly_incident_trends.week AS trend_week
      COMMENT = 'Week bucket (date truncated to week)'
  )
[0m17:05:12.066089 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:05:12.931884 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c04981-0106-f535-0032-3187054762de
[0m17:05:12.932618 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 010203 (42601): SQL compilation error:
Invalid table name 'V_SLACK_INCIDENT_MSGS' in the facts definition.
[0m17:05:12.938161 [debug] [Thread-2 (]: Database Error in model alpha (models/semantic_views/alpha.sql)
  010203 (42601): SQL compilation error:
  Invalid table name 'V_SLACK_INCIDENT_MSGS' in the facts definition.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:05:12.941677 [error] [Thread-2 (]: 1 of 1 ERROR creating sql semantic_view model semantic_views.alpha ............. [[31mERROR[0m in 1.08s]
[0m17:05:12.942631 [debug] [Thread-2 (]: Finished running node model.incident_management.alpha
[0m17:05:12.943915 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.alpha' to be skipped because of status 'error'.  Reason: Database Error in model alpha (models/semantic_views/alpha.sql)
  010203 (42601): SQL compilation error:
  Invalid table name 'V_SLACK_INCIDENT_MSGS' in the facts definition.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql.
[0m17:05:12.947338 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m17:05:12.947861 [debug] [Dummy-1   ]: Connection 'model.incident_management.alpha' was properly closed.
[0m17:05:12.948437 [info ] [Dummy-1   ]: 
[0m17:05:12.948997 [info ] [Dummy-1   ]: Finished running 1 semantic view model in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m17:05:12.949951 [debug] [Dummy-1   ]: Command end result
[0m17:05:12.999848 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:05:13.002738 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:05:13.010770 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m17:05:13.011328 [info ] [Dummy-1   ]: 
[0m17:05:13.011965 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:05:13.012474 [info ] [Dummy-1   ]: 
[0m17:05:13.013194 [error] [Dummy-1   ]:   Database Error in model alpha (models/semantic_views/alpha.sql)
  010203 (42601): SQL compilation error:
  Invalid table name 'V_SLACK_INCIDENT_MSGS' in the facts definition.
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:05:13.013739 [info ] [Dummy-1   ]: 
[0m17:05:13.014274 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:05:13.016068 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.9973645, "process_in_blocks": "0", "process_kernel_time": 1.4, "process_mem_max_rss": "493276", "process_out_blocks": "0", "process_user_time": 6.44}
[0m17:05:13.016789 [debug] [Dummy-1   ]: Command `cli run` failed at 17:05:13.016471 after 7.00 seconds
[0m17:05:13.017368 [debug] [Dummy-1   ]: Flushing usage events


============================== 17:07:04.303208 | 5c5001c8-6c82-4258-aed9-8406a449959f ==============================
[0m17:07:04.303208 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m17:07:04.304325 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:07:04.685059 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m17:07:05.449392 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:07:05.871927 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:07:05.873122 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/semantic_views/alpha.sql
[0m17:07:06.541538 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:07:06.544474 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:07:06.606276 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m17:07:06.609587 [info ] [Dummy-1   ]: 
[0m17:07:06.610251 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m17:07:06.610783 [info ] [Dummy-1   ]: 
[0m17:07:06.611670 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m17:07:06.613946 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m17:07:06.786480 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m17:07:06.787203 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m17:07:06.787716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:07.639883 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.852 seconds
[0m17:07:07.650335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m17:07:07.673647 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:07:07.674365 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:07:07.674935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:08.525632 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.850 seconds
[0m17:07:08.531719 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:07:08.532357 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m17:07:08.632455 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.099 seconds
[0m17:07:08.635453 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:07:08.636051 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:07:08.775452 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.139 seconds
[0m17:07:08.778229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_semantic_views)
[0m17:07:08.792180 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:07:08.792890 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:07:08.793445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:09.675736 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.882 seconds
[0m17:07:09.678254 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:07:09.678920 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m17:07:09.774544 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.095 seconds
[0m17:07:09.776957 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:07:09.777848 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:07:09.907825 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.129 seconds
[0m17:07:09.910333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_gold_zone)
[0m17:07:09.920876 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:07:09.921486 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:07:09.922029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:10.904406 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.982 seconds
[0m17:07:10.906966 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:07:10.907602 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m17:07:11.125056 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.217 seconds
[0m17:07:11.127828 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:07:11.128513 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:07:11.257218 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m17:07:11.266860 [debug] [Thread-2 (]: Began running node model.incident_management.alpha
[0m17:07:11.267782 [info ] [Thread-2 (]: 1 of 1 START sql semantic_view model semantic_views.alpha ...................... [RUN]
[0m17:07:11.268607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.alpha)
[0m17:07:11.269208 [debug] [Thread-2 (]: Began compiling node model.incident_management.alpha
[0m17:07:11.291469 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.alpha"
[0m17:07:11.292449 [debug] [Thread-2 (]: Began executing node model.incident_management.alpha
[0m17:07:11.325758 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.alpha"
[0m17:07:11.477732 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.alpha"
[0m17:07:11.480205 [debug] [Thread-2 (]: On model.incident_management.alpha: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.alpha"} */
create or replace semantic view incident_management.semantic_views.alpha
  

TABLES(
  doc_extracts as incident_management.bronze_zone.document_full_extracts
    COMMENT = 'All policy documents'
  , users as incident_management.bronze_zone.users
    COMMENT = 'Materialized users table with enriched data'
  , v_new_docs as incident_management.bronze_zone.v_qualify_new_documents
    COMMENT = 'Qualified new documents with derived type and extension'
  , v_slack_msgs as incident_management.bronze_zone.v_qualify_slack_messages
    COMMENT = 'Qualified Slack messages from known reporters with optional attachment metadata and extracted incident number'
  , incidents as incident_management.gold_zone.incidents
    COMMENT = 'Materialized incidents table with enriched data and calculated fields'
  , active_incidents as incident_management.gold_zone.active_incidents
    COMMENT = 'Active incidents requiring attention with SLA status and priority ordering'
  , closed_incidents as incident_management.gold_zone.closed_incidents
    COMMENT = 'Closed incidents with resolution metrics and performance insights'
  , incident_attachments as incident_management.gold_zone.incident_attachments
    COMMENT = 'Materialized incident attachments table'
  , incident_comment_history as incident_management.gold_zone.incident_comment_history
    COMMENT = 'Simplified incident comment history for tracking communication'
  , weekly_incident_trends as incident_management.gold_zone.weekly_incident_trends
    COMMENT = 'Weekly incident trends for the last 12 weeks'

)

FACTS (
    doc_extracts.size AS doc_size
      COMMENT = 'Size of the file in bytes'
    , doc_extracts.page_num AS doc_page_num
      COMMENT = 'Source page number for the extracted content'
    , v_new_docs.size AS new_doc_size
      COMMENT = 'Size of the file in bytes'

    , v_slack_msgs.file_size AS slack_file_size
      COMMENT = 'Attachment file size'

    , active_incidents.age_hours AS active_incident_age_hours
      COMMENT = 'Age of incident in hours'

    , closed_incidents.total_resolution_hours AS total_resolution_hours
      COMMENT = 'Total time from creation to closure in hours'
    , closed_incidents.closed_year AS closed_year
      COMMENT = 'Year when the incident was closed'
    , closed_incidents.closed_quarter AS closed_quarter
      COMMENT = 'Quarter when the incident was closed'

    , weekly_incident_trends.total_incidents AS total_incidents
      COMMENT = 'Total incidents created in the week'
    , weekly_incident_trends.resolved_incidents AS resolved_incidents
      COMMENT = 'Incidents resolved in the week'
    , weekly_incident_trends.closed_incidents AS closed_incidents_count
      COMMENT = 'Incidents closed in the week'
    , weekly_incident_trends.open_incidents AS open_incidents
      COMMENT = 'Incidents open in the week'
    , weekly_incident_trends.critical_incidents AS critical_incidents
      COMMENT = 'Incidents with critical priority'
    , weekly_incident_trends.high_incidents AS high_incidents
      COMMENT = 'Incidents with high priority'
    , weekly_incident_trends.high_severity_incidents AS high_severity_incidents
      COMMENT = 'Incidents with critical or high priority'
    , weekly_incident_trends.payment_incidents AS payment_incidents
      COMMENT = 'Payment category incidents'
    , weekly_incident_trends.authentication_incidents AS authentication_incidents
      COMMENT = 'Authentication category incidents'
    , weekly_incident_trends.performance_incidents AS performance_incidents
      COMMENT = 'Performance category incidents'
    , weekly_incident_trends.security_incidents AS security_incidents
      COMMENT = 'Security category incidents'
    , weekly_incident_trends.monitoring_incidents AS monitoring_incidents
      COMMENT = 'Incidents from monitoring source system'
    , weekly_incident_trends.customer_portal_incidents AS customer_portal_incidents
      COMMENT = 'Incidents from customer portal source system'
    , weekly_incident_trends.avg_resolution_time_hours AS avg_resolution_time_hours
      COMMENT = 'Average resolution time in hours'
    , weekly_incident_trends.incidents_with_attachments AS incidents_with_attachments
      COMMENT = 'Incidents that had attachments'
    , weekly_incident_trends.resolution_rate_percentage AS resolution_rate_percentage
      COMMENT = 'Share of resolved/closed incidents as a percentage'
 )

 DIMENSIONS (
    doc_extracts.relative_path as relative_path
      COMMENT = 'Path to the file on the stage'
    , doc_extracts.last_modified AS last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    , doc_extracts.md5 AS md5
      COMMENT = 'MD5 checksum for the file'
    ,doc_extracts.etag AS etag
      COMMENT = 'ETag header for the file'
    , doc_extracts.file_url AS file_url
      WITH SYNONYMS = ('file url', 'snowflake file url')
      COMMENT = 'Snowflake file URL to the file'
    ,doc_extracts.doc_type AS doc_type
      WITH SYNONYMS = ('document type', 'doc type', 'analysis type')
      COMMENT = 'Type of document classification (e.g., ''full'', ''question'', ''slack'')'
    ,doc_extracts.extension AS extension
      WITH SYNONYMS = ('extension', 'file extension')
      COMMENT = 'File extension parsed from the path'
    ,doc_extracts.chunk AS chunk
      WITH SYNONYMS = ('chunk', 'text')
      COMMENT = 'Markdown/text chunk content extracted from the document pages'
    ,doc_extracts.headers AS headers
      WITH SYNONYMS = ('headers', 'detected headers')
      COMMENT = 'Object of detected headers for the chunk (e.g., header_1, header_2)'

    , users.id AS user_id
      COMMENT = 'Unique user identifier'
    , users.email AS user_email
      COMMENT = 'Primary email address'
    ,users.first_name AS user_first_name
      COMMENT = 'First name parsed from email user part'
    ,users.last_name AS user_last_name
      COMMENT = 'Last name parsed from email domain part'
    ,users.role AS user_role
      COMMENT = 'User role'
    ,users.department AS user_department
      COMMENT = 'User department'
    ,users.team AS user_team
      COMMENT = 'User team'
    , users.is_active AS user_is_active
      COMMENT = 'Active flag'
    , users.created_at AS user_created_at
      COMMENT = 'Creation timestamp'
    , users.updated_at AS user_updated_at
      COMMENT = 'Last update timestamp'

    , v_new_docs.relative_path AS new_doc_relative_path
      COMMENT = 'Path to the file on the stage'
    ,v_new_docs.last_modified AS new_doc_last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    ,v_new_docs.md5 AS new_doc_md5
      COMMENT = 'MD5 checksum for the file'
    ,v_new_docs.etag AS new_doc_etag
      COMMENT = 'ETag header for the file'
    ,v_new_docs.file_url AS new_doc_file_url
      COMMENT = 'Snowflake file URL to the file'
    ,v_new_docs.doc_type AS new_doc_type
      COMMENT = 'Derived document type based on the path'
    ,v_new_docs.extension AS new_doc_extension
      COMMENT = 'Derived file extension parsed from the path'

    , v_slack_msgs.hasfiles AS slack_hasfiles
      COMMENT = 'Whether the message has attachments'
    , v_slack_msgs.type AS slack_type
      COMMENT = 'Slack message type'
    , v_slack_msgs.subtype AS slack_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_msgs.team AS slack_team
      COMMENT = 'Slack team identifier'
    , v_slack_msgs.channel AS slack_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_msgs.user AS slack_user
      COMMENT = 'Slack user identifier'
    , v_slack_msgs.username AS slack_username
      COMMENT = 'Slack username'
    , v_slack_msgs.reporter_id AS slack_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_msgs.text AS slack_text
      COMMENT = 'Slack message text'
    , v_slack_msgs.ts AS slack_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_msgs.slack_message_id AS slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_msgs.file_id AS slack_file_id
      COMMENT = 'Attachment file id'
    , v_slack_msgs.file_name AS slack_file_name
      COMMENT = 'Attachment file name'
    , v_slack_msgs.file_mimetype AS slack_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_msgs.staged_file_path AS slack_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_msgs.attachment_file AS slack_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_msgs.incident_number AS slack_incident_number
      COMMENT = 'Extracted incident number from image or text'


    , incidents.incident_number AS incident_number
      COMMENT = 'Incident identifier'
    , incidents.category AS incident_category
      COMMENT = 'Incident category'
    , incidents.title AS incident_title
      COMMENT = 'Incident title'
    , incidents.priority AS incident_priority
      COMMENT = 'Incident priority'
    , incidents.status AS incident_status
      COMMENT = 'Incident status'
    , incidents.assignee_id AS incident_assignee_id
      COMMENT = 'Assignee user id'
    , incidents.reportee_id AS incident_reportee_id
      COMMENT = 'Reportee user id'
    , incidents.created_at AS incident_created_at
      COMMENT = 'Creation timestamp'
    , incidents.closed_at AS incident_closed_at
      COMMENT = 'Close timestamp'
    , incidents.updated_at AS incident_updated_at
      COMMENT = 'Last update timestamp'
    , incidents.source_system AS incident_source_system
      COMMENT = 'Source system for the incident'
    ,incidents.external_source_id AS incident_external_source_id
      COMMENT = 'External source identifier'
    , incidents.has_attachments AS incident_has_attachments
      COMMENT = 'Whether the incident has attachments'
    , incidents.slack_message_id AS incident_slack_message_id
      COMMENT = 'Associated Slack message id'
    , incidents.last_comment AS incident_last_comment
      COMMENT = 'Latest comment content'

    , active_incidents.incident_number AS active_incident_number
      COMMENT = 'Incident identifier'
    , active_incidents.title AS active_incident_title
      COMMENT = 'Incident title'
    , active_incidents.category AS active_incident_category
      COMMENT = 'Incident category'
    , active_incidents.priority AS active_incident_priority
      COMMENT = 'Incident priority'
    , active_incidents.status AS active_incident_status
      COMMENT = 'Incident status'
    , active_incidents.assignee_id AS active_incident_assignee_id
      COMMENT = 'Assignee user id'
    , active_incidents.assignee_name AS active_incident_assignee_name
      COMMENT = 'Assignee full name'
    , active_incidents.reportee_id AS active_incident_reportee_id
      COMMENT = 'Reportee user id'
    , active_incidents.reportee_name AS active_incident_reportee_name
      COMMENT = 'Reportee full name'
    , active_incidents.created_at AS active_incident_created_at
      COMMENT = 'Creation timestamp'
    , active_incidents.updated_at AS active_incident_updated_at
      COMMENT = 'Last update timestamp'
    , active_incidents.source_system AS active_incident_source_system
      COMMENT = 'Source system for the incident'
    , active_incidents.external_source_id AS active_incident_external_source_id
      COMMENT = 'External source identifier'
    , active_incidents.has_attachments AS active_incident_has_attachments
      COMMENT = 'Whether the incident has attachments'

    , closed_incidents.incident_number AS closed_incident_number
      COMMENT = 'Incident identifier'
    , closed_incidents.title AS closed_incident_title
      COMMENT = 'Incident title'
    , closed_incidents.category AS closed_incident_category
      COMMENT = 'Incident category'
    , closed_incidents.priority AS closed_incident_priority
      COMMENT = 'Incident priority'
    , closed_incidents.status AS closed_incident_status
      COMMENT = 'Incident status'
    , closed_incidents.assignee_id AS closed_incident_assignee_id
      COMMENT = 'Assignee user id'
    , closed_incidents.reportee_id AS closed_incident_reportee_id
      COMMENT = 'Reportee user id'
    , closed_incidents.created_at AS closed_incident_created_at
      COMMENT = 'Creation timestamp'
    , closed_incidents.closed_at AS closed_incident_closed_at
      COMMENT = 'Close timestamp'
    , closed_incidents.updated_at AS closed_incident_updated_at
      COMMENT = 'Last update timestamp'
    , closed_incidents.source_system AS closed_incident_source_system
      COMMENT = 'Source system for the incident'
    , closed_incidents.external_source_id AS closed_incident_external_source_id
      COMMENT = 'External source identifier'
    , closed_incidents.has_attachments AS closed_incident_has_attachments
      COMMENT = 'Whether the incident had attachments'
    , closed_incidents.closed_month AS closed_incident_month
      COMMENT = 'Month when incident was closed'

    , incident_attachments.id AS attachment_id
      COMMENT = 'Attachment id'
    , incident_attachments.incident_number AS attachment_incident_number
      COMMENT = 'Incident identifier'
    , incident_attachments.attachment_file AS attachment_file
      COMMENT = 'Stage file reference for the attachment'
    , incident_attachments.uploaded_at AS attachment_uploaded_at
      COMMENT = 'Attachment upload timestamp'

    , incident_comment_history.id AS comment_id
      COMMENT = 'Comment id'
    , incident_comment_history.incident_number AS comment_incident_number
      COMMENT = 'Incident identifier'
    , incident_comment_history.author_id AS comment_author_id
      COMMENT = 'Comment author user id'
    ,  incident_comment_history.content AS comment_content
      COMMENT = 'Comment content'
    , incident_comment_history.created_at AS comment_created_at
      COMMENT = 'Comment creation timestamp'
    , weekly_incident_trends.week AS trend_week
      COMMENT = 'Week bucket (date truncated to week)'
  )
[0m17:07:11.481785 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:07:12.853410 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c04983-0106-f0aa-0032-31870547f08e
[0m17:07:12.854191 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 25
invalid identifier 'DOC_SIZE'
[0m17:07:12.860002 [debug] [Thread-2 (]: Database Error in model alpha (models/semantic_views/alpha.sql)
  000904 (42000): SQL compilation error: error line 29 at position 25
  invalid identifier 'DOC_SIZE'
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:07:12.863728 [error] [Thread-2 (]: 1 of 1 ERROR creating sql semantic_view model semantic_views.alpha ............. [[31mERROR[0m in 1.59s]
[0m17:07:12.864783 [debug] [Thread-2 (]: Finished running node model.incident_management.alpha
[0m17:07:12.866234 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.alpha' to be skipped because of status 'error'.  Reason: Database Error in model alpha (models/semantic_views/alpha.sql)
  000904 (42000): SQL compilation error: error line 29 at position 25
  invalid identifier 'DOC_SIZE'
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql.
[0m17:07:12.869915 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m17:07:12.870539 [debug] [Dummy-1   ]: Connection 'model.incident_management.alpha' was properly closed.
[0m17:07:12.871080 [info ] [Dummy-1   ]: 
[0m17:07:12.871617 [info ] [Dummy-1   ]: Finished running 1 semantic view model in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m17:07:12.872622 [debug] [Dummy-1   ]: Command end result
[0m17:07:12.924442 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:07:12.927533 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:07:12.935973 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m17:07:12.936560 [info ] [Dummy-1   ]: 
[0m17:07:12.937229 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:07:12.937807 [info ] [Dummy-1   ]: 
[0m17:07:12.938671 [error] [Dummy-1   ]:   Database Error in model alpha (models/semantic_views/alpha.sql)
  000904 (42000): SQL compilation error: error line 29 at position 25
  invalid identifier 'DOC_SIZE'
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:07:12.939223 [info ] [Dummy-1   ]: 
[0m17:07:12.939752 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:07:12.941672 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.737158, "process_in_blocks": "0", "process_kernel_time": 1.4, "process_mem_max_rss": "486252", "process_out_blocks": "0", "process_user_time": 6.26}
[0m17:07:12.942381 [debug] [Dummy-1   ]: Command `cli run` failed at 17:07:12.942103 after 8.74 seconds
[0m17:07:12.942959 [debug] [Dummy-1   ]: Flushing usage events


============================== 17:11:52.417209 | 1b1183be-8c8c-4b17-80c6-2c537e600bc3 ==============================
[0m17:11:52.417209 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m17:11:52.418448 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:11:52.806808 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m17:11:53.621316 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:11:54.068337 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:11:54.069946 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/semantic_views/alpha.sql
[0m17:11:54.748768 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:11:54.751896 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:11:54.816595 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m17:11:54.819726 [info ] [Dummy-1   ]: 
[0m17:11:54.820455 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m17:11:54.821088 [info ] [Dummy-1   ]: 
[0m17:11:54.822062 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m17:11:54.824363 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m17:11:54.989155 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m17:11:54.989862 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m17:11:54.990389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:55.793304 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.803 seconds
[0m17:11:55.803486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_semantic_views)
[0m17:11:55.827503 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:11:55.828170 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:11:55.828775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:56.539407 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.710 seconds
[0m17:11:56.545513 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:11:56.546183 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m17:11:56.629897 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.083 seconds
[0m17:11:56.632449 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m17:11:56.633122 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:11:56.769978 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m17:11:56.772435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_gold_zone)
[0m17:11:56.783400 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:11:56.784109 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:11:56.784707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:57.630673 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.846 seconds
[0m17:11:57.633193 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:11:57.633813 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m17:11:57.764343 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.130 seconds
[0m17:11:57.767149 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:11:57.767765 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:11:57.855054 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.087 seconds
[0m17:11:57.857727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m17:11:57.870940 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:11:57.871603 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:11:57.872104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:58.748135 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.876 seconds
[0m17:11:58.750778 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:11:58.751387 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m17:11:58.871048 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.119 seconds
[0m17:11:58.873885 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:11:58.874457 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:11:58.953140 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.078 seconds
[0m17:11:58.964176 [debug] [Thread-2 (]: Began running node model.incident_management.alpha
[0m17:11:58.965129 [info ] [Thread-2 (]: 1 of 1 START sql semantic_view model semantic_views.alpha ...................... [RUN]
[0m17:11:58.965929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.alpha)
[0m17:11:58.966550 [debug] [Thread-2 (]: Began compiling node model.incident_management.alpha
[0m17:11:58.989075 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.alpha"
[0m17:11:58.990099 [debug] [Thread-2 (]: Began executing node model.incident_management.alpha
[0m17:11:59.023563 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.alpha"
[0m17:11:59.193285 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.alpha"
[0m17:11:59.195597 [debug] [Thread-2 (]: On model.incident_management.alpha: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.alpha"} */
create or replace semantic view incident_management.semantic_views.alpha
  

TABLES(
  full_doc_extracts as incident_management.bronze_zone.document_full_extracts
    COMMENT = 'All policy documents'
  , users as incident_management.bronze_zone.users
    COMMENT = 'Materialized users table with enriched data'
  , v_slack_msgs as incident_management.bronze_zone.v_qualify_slack_messages
    COMMENT = 'Qualified Slack messages from known reporters with optional attachment metadata and extracted incident number'
  , incidents as incident_management.gold_zone.incidents
    COMMENT = 'Materialized incidents table with enriched data and calculated fields'
  , active_incidents as incident_management.gold_zone.active_incidents
    COMMENT = 'Active incidents requiring attention with SLA status and priority ordering'
  , closed_incidents as incident_management.gold_zone.closed_incidents
    COMMENT = 'Closed incidents with resolution metrics and performance insights'
  , incident_attachments as incident_management.gold_zone.incident_attachments
    COMMENT = 'Materialized incident attachments table'
  , incident_comment_history as incident_management.gold_zone.incident_comment_history
    COMMENT = 'Simplified incident comment history for tracking communication'
  , weekly_incident_trends as incident_management.gold_zone.weekly_incident_trends
    COMMENT = 'Weekly incident trends for the last 12 weeks'

)

FACTS (
    full_doc_extracts.size AS size
      COMMENT = 'Size of the file in bytes'
      
    , full_doc_extracts.page_num AS page_num
      COMMENT = 'Source page number for the extracted content'
      
    , v_slack_msgs.file_size AS slack_file_size
      COMMENT = 'Attachment file size'

    , active_incidents.age_hours AS active_incident_age_hours
      COMMENT = 'Age of incident in hours'

    , closed_incidents.total_resolution_hours AS total_resolution_hours
      COMMENT = 'Total time from creation to closure in hours'
    , closed_incidents.closed_year AS closed_year
      COMMENT = 'Year when the incident was closed'
    , closed_incidents.closed_quarter AS closed_quarter
      COMMENT = 'Quarter when the incident was closed'

    , weekly_incident_trends.total_incidents AS total_incidents
      COMMENT = 'Total incidents created in the week'
    , weekly_incident_trends.resolved_incidents AS resolved_incidents
      COMMENT = 'Incidents resolved in the week'
    , weekly_incident_trends.closed_incidents AS closed_incidents_count
      COMMENT = 'Incidents closed in the week'
    , weekly_incident_trends.open_incidents AS open_incidents
      COMMENT = 'Incidents open in the week'
    , weekly_incident_trends.critical_incidents AS critical_incidents
      COMMENT = 'Incidents with critical priority'
    , weekly_incident_trends.high_incidents AS high_incidents
      COMMENT = 'Incidents with high priority'
    , weekly_incident_trends.high_severity_incidents AS high_severity_incidents
      COMMENT = 'Incidents with critical or high priority'
    , weekly_incident_trends.payment_incidents AS payment_incidents
      COMMENT = 'Payment category incidents'
    , weekly_incident_trends.authentication_incidents AS authentication_incidents
      COMMENT = 'Authentication category incidents'
    , weekly_incident_trends.performance_incidents AS performance_incidents
      COMMENT = 'Performance category incidents'
    , weekly_incident_trends.security_incidents AS security_incidents
      COMMENT = 'Security category incidents'
    , weekly_incident_trends.monitoring_incidents AS monitoring_incidents
      COMMENT = 'Incidents from monitoring source system'
    , weekly_incident_trends.customer_portal_incidents AS customer_portal_incidents
      COMMENT = 'Incidents from customer portal source system'
    , weekly_incident_trends.avg_resolution_time_hours AS avg_resolution_time_hours
      COMMENT = 'Average resolution time in hours'
    , weekly_incident_trends.incidents_with_attachments AS incidents_with_attachments
      COMMENT = 'Incidents that had attachments'
    , weekly_incident_trends.resolution_rate_percentage AS resolution_rate_percentage
      COMMENT = 'Share of resolved/closed incidents as a percentage'
 )

 DIMENSIONS (
    full_doc_extracts.relative_path as relative_path
      COMMENT = 'Path to the file on the stage'
    , full_doc_extracts.last_modified AS last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    , full_doc_extracts.md5 AS md5
      COMMENT = 'MD5 checksum for the file'
    ,full_doc_extracts.etag AS etag
      COMMENT = 'ETag header for the file'
    , full_doc_extracts.file_url AS file_url
      WITH SYNONYMS = ('file url', 'snowflake file url')
      COMMENT = 'Snowflake file URL to the file'
    ,full_doc_extracts.doc_type AS doc_type
      WITH SYNONYMS = ('document type', 'doc type', 'analysis type')
      COMMENT = 'Type of document classification (e.g., ''full'', ''question'', ''slack'')'
    ,full_doc_extracts.extension AS extension
      WITH SYNONYMS = ('extension', 'file extension')
      COMMENT = 'File extension parsed from the path'
    ,full_doc_extracts.chunk AS chunk
      WITH SYNONYMS = ('chunk', 'text')
      COMMENT = 'Markdown/text chunk content extracted from the document pages'
    ,full_doc_extracts.headers AS headers
      WITH SYNONYMS = ('headers', 'detected headers')
      COMMENT = 'Object of detected headers for the chunk (e.g., header_1, header_2)'

    , users.id AS user_id
      COMMENT = 'Unique user identifier'
    , users.email AS user_email
      COMMENT = 'Primary email address'
    ,users.first_name AS user_first_name
      COMMENT = 'First name parsed from email user part'
    ,users.last_name AS user_last_name
      COMMENT = 'Last name parsed from email domain part'
    ,users.role AS user_role
      COMMENT = 'User role'
    ,users.department AS user_department
      COMMENT = 'User department'
    ,users.team AS user_team
      COMMENT = 'User team'
    , users.is_active AS user_is_active
      COMMENT = 'Active flag'
    , users.created_at AS user_created_at
      COMMENT = 'Creation timestamp'
    , users.updated_at AS user_updated_at
      COMMENT = 'Last update timestamp'

    , v_slack_msgs.hasfiles AS slack_hasfiles
      COMMENT = 'Whether the message has attachments'
    , v_slack_msgs.type AS slack_type
      COMMENT = 'Slack message type'
    , v_slack_msgs.subtype AS slack_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_msgs.team AS slack_team
      COMMENT = 'Slack team identifier'
    , v_slack_msgs.channel AS slack_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_msgs.user AS slack_user
      COMMENT = 'Slack user identifier'
    , v_slack_msgs.username AS slack_username
      COMMENT = 'Slack username'
    , v_slack_msgs.reporter_id AS slack_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_msgs.text AS slack_text
      COMMENT = 'Slack message text'
    , v_slack_msgs.ts AS slack_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_msgs.slack_message_id AS slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_msgs.file_id AS slack_file_id
      COMMENT = 'Attachment file id'
    , v_slack_msgs.file_name AS slack_file_name
      COMMENT = 'Attachment file name'
    , v_slack_msgs.file_mimetype AS slack_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_msgs.staged_file_path AS slack_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_msgs.attachment_file AS slack_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_msgs.incident_number AS slack_incident_number
      COMMENT = 'Extracted incident number from image or text'


    , incidents.incident_number AS incident_number
      COMMENT = 'Incident identifier'
    , incidents.category AS incident_category
      COMMENT = 'Incident category'
    , incidents.title AS incident_title
      COMMENT = 'Incident title'
    , incidents.priority AS incident_priority
      COMMENT = 'Incident priority'
    , incidents.status AS incident_status
      COMMENT = 'Incident status'
    , incidents.assignee_id AS incident_assignee_id
      COMMENT = 'Assignee user id'
    , incidents.reportee_id AS incident_reportee_id
      COMMENT = 'Reportee user id'
    , incidents.created_at AS incident_created_at
      COMMENT = 'Creation timestamp'
    , incidents.closed_at AS incident_closed_at
      COMMENT = 'Close timestamp'
    , incidents.updated_at AS incident_updated_at
      COMMENT = 'Last update timestamp'
    , incidents.source_system AS incident_source_system
      COMMENT = 'Source system for the incident'
    ,incidents.external_source_id AS incident_external_source_id
      COMMENT = 'External source identifier'
    , incidents.has_attachments AS incident_has_attachments
      COMMENT = 'Whether the incident has attachments'
    , incidents.slack_message_id AS incident_slack_message_id
      COMMENT = 'Associated Slack message id'
    , incidents.last_comment AS incident_last_comment
      COMMENT = 'Latest comment content'

    , active_incidents.incident_number AS active_incident_number
      COMMENT = 'Incident identifier'
    , active_incidents.title AS active_incident_title
      COMMENT = 'Incident title'
    , active_incidents.category AS active_incident_category
      COMMENT = 'Incident category'
    , active_incidents.priority AS active_incident_priority
      COMMENT = 'Incident priority'
    , active_incidents.status AS active_incident_status
      COMMENT = 'Incident status'
    , active_incidents.assignee_id AS active_incident_assignee_id
      COMMENT = 'Assignee user id'
    , active_incidents.assignee_name AS active_incident_assignee_name
      COMMENT = 'Assignee full name'
    , active_incidents.reportee_id AS active_incident_reportee_id
      COMMENT = 'Reportee user id'
    , active_incidents.reportee_name AS active_incident_reportee_name
      COMMENT = 'Reportee full name'
    , active_incidents.created_at AS active_incident_created_at
      COMMENT = 'Creation timestamp'
    , active_incidents.updated_at AS active_incident_updated_at
      COMMENT = 'Last update timestamp'
    , active_incidents.source_system AS active_incident_source_system
      COMMENT = 'Source system for the incident'
    , active_incidents.external_source_id AS active_incident_external_source_id
      COMMENT = 'External source identifier'
    , active_incidents.has_attachments AS active_incident_has_attachments
      COMMENT = 'Whether the incident has attachments'

    , closed_incidents.incident_number AS closed_incident_number
      COMMENT = 'Incident identifier'
    , closed_incidents.title AS closed_incident_title
      COMMENT = 'Incident title'
    , closed_incidents.category AS closed_incident_category
      COMMENT = 'Incident category'
    , closed_incidents.priority AS closed_incident_priority
      COMMENT = 'Incident priority'
    , closed_incidents.status AS closed_incident_status
      COMMENT = 'Incident status'
    , closed_incidents.assignee_id AS closed_incident_assignee_id
      COMMENT = 'Assignee user id'
    , closed_incidents.reportee_id AS closed_incident_reportee_id
      COMMENT = 'Reportee user id'
    , closed_incidents.created_at AS closed_incident_created_at
      COMMENT = 'Creation timestamp'
    , closed_incidents.closed_at AS closed_incident_closed_at
      COMMENT = 'Close timestamp'
    , closed_incidents.updated_at AS closed_incident_updated_at
      COMMENT = 'Last update timestamp'
    , closed_incidents.source_system AS closed_incident_source_system
      COMMENT = 'Source system for the incident'
    , closed_incidents.external_source_id AS closed_incident_external_source_id
      COMMENT = 'External source identifier'
    , closed_incidents.has_attachments AS closed_incident_has_attachments
      COMMENT = 'Whether the incident had attachments'
    , closed_incidents.closed_month AS closed_incident_month
      COMMENT = 'Month when incident was closed'

    , incident_attachments.id AS attachment_id
      COMMENT = 'Attachment id'
    , incident_attachments.incident_number AS attachment_incident_number
      COMMENT = 'Incident identifier'
    , incident_attachments.attachment_file AS attachment_file
      COMMENT = 'Stage file reference for the attachment'
    , incident_attachments.uploaded_at AS attachment_uploaded_at
      COMMENT = 'Attachment upload timestamp'

    , incident_comment_history.id AS comment_id
      COMMENT = 'Comment id'
    , incident_comment_history.incident_number AS comment_incident_number
      COMMENT = 'Incident identifier'
    , incident_comment_history.author_id AS comment_author_id
      COMMENT = 'Comment author user id'
    ,  incident_comment_history.content AS comment_content
      COMMENT = 'Comment content'
    , incident_comment_history.created_at AS comment_created_at
      COMMENT = 'Comment creation timestamp'
    , weekly_incident_trends.week AS trend_week
      COMMENT = 'Week bucket (date truncated to week)'
  )
[0m17:11:59.197140 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:12:00.072617 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c04987-0106-f0aa-0032-31870547f1fe
[0m17:12:00.073383 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 117 at position 19
invalid identifier 'USER_TEAM'
[0m17:12:00.079374 [debug] [Thread-2 (]: Database Error in model alpha (models/semantic_views/alpha.sql)
  000904 (42000): SQL compilation error: error line 117 at position 19
  invalid identifier 'USER_TEAM'
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:12:00.082984 [error] [Thread-2 (]: 1 of 1 ERROR creating sql semantic_view model semantic_views.alpha ............. [[31mERROR[0m in 1.11s]
[0m17:12:00.083986 [debug] [Thread-2 (]: Finished running node model.incident_management.alpha
[0m17:12:00.085292 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.alpha' to be skipped because of status 'error'.  Reason: Database Error in model alpha (models/semantic_views/alpha.sql)
  000904 (42000): SQL compilation error: error line 117 at position 19
  invalid identifier 'USER_TEAM'
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql.
[0m17:12:00.088782 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m17:12:00.089347 [debug] [Dummy-1   ]: Connection 'model.incident_management.alpha' was properly closed.
[0m17:12:00.089914 [info ] [Dummy-1   ]: 
[0m17:12:00.090469 [info ] [Dummy-1   ]: Finished running 1 semantic view model in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m17:12:00.091454 [debug] [Dummy-1   ]: Command end result
[0m17:12:00.143097 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:12:00.146158 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:12:00.154575 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m17:12:00.155154 [info ] [Dummy-1   ]: 
[0m17:12:00.155836 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:12:00.156360 [info ] [Dummy-1   ]: 
[0m17:12:00.157105 [error] [Dummy-1   ]:   Database Error in model alpha (models/semantic_views/alpha.sql)
  000904 (42000): SQL compilation error: error line 117 at position 19
  invalid identifier 'USER_TEAM'
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m17:12:00.157659 [info ] [Dummy-1   ]: 
[0m17:12:00.158199 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:12:00.160162 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.8429894, "process_in_blocks": "0", "process_kernel_time": 1.3, "process_mem_max_rss": "491252", "process_out_blocks": "0", "process_user_time": 6.53}
[0m17:12:00.160853 [debug] [Dummy-1   ]: Command `cli run` failed at 17:12:00.160575 after 7.84 seconds
[0m17:12:00.161432 [debug] [Dummy-1   ]: Flushing usage events


============================== 18:08:30.765531 | fe6f304b-ee25-47a1-838e-7aa7799c0147 ==============================
[0m18:08:30.765531 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m18:08:30.766707 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m18:08:31.163027 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m18:08:31.902748 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:08:32.324955 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m18:08:32.326625 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.yml
[0m18:08:32.327393 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/semantic_views/alpha.sql
[0m18:08:32.327977 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m18:08:33.404014 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:08:33.407084 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:08:33.609234 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m18:08:33.614533 [info ] [Dummy-1   ]: 
[0m18:08:33.615249 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m18:08:33.615746 [info ] [Dummy-1   ]: 
[0m18:08:33.616641 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m18:08:33.625087 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m18:08:33.773168 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:08:33.773932 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:08:33.774514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:34.644197 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.869 seconds
[0m18:08:34.651324 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:08:34.652037 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m18:08:34.763923 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.111 seconds
[0m18:08:34.766872 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:08:34.767506 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:08:34.922082 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.154 seconds
[0m18:08:34.924815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_semantic_views)
[0m18:08:34.937857 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:08:34.938637 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:08:34.939253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:35.800093 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.861 seconds
[0m18:08:35.802703 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:08:35.803348 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m18:08:35.886948 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.083 seconds
[0m18:08:35.889430 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:08:35.890043 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:08:36.008650 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m18:08:36.011155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_bronze_zone)
[0m18:08:36.024161 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:08:36.024837 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:08:36.025364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:36.844421 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.819 seconds
[0m18:08:36.847036 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:08:36.847704 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m18:08:36.962469 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.114 seconds
[0m18:08:36.965368 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:08:36.966027 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:08:37.087797 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m18:08:37.099945 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m18:08:37.100806 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m18:08:37.101457 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m18:08:37.120032 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m18:08:37.121037 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m18:08:37.122168 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m18:08:37.123433 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m18:08:37.124537 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m18:08:37.125157 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m18:08:37.139196 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m18:08:37.140123 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m18:08:37.141207 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m18:08:37.142394 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m18:08:37.143580 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m18:08:37.144260 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m18:08:37.158146 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m18:08:37.159136 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m18:08:37.160218 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m18:08:37.161392 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m18:08:37.162505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m18:08:37.163179 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m18:08:37.182987 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m18:08:37.183940 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m18:08:37.185015 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m18:08:37.186211 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m18:08:37.187072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m18:08:37.187676 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m18:08:37.202706 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m18:08:37.203664 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m18:08:37.204721 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m18:08:37.205814 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m18:08:37.206626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m18:08:37.207249 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m18:08:37.220319 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m18:08:37.221238 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m18:08:37.222279 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m18:08:37.223447 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m18:08:37.224242 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m18:08:37.224840 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m18:08:37.239516 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m18:08:37.240431 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m18:08:37.241468 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m18:08:37.242543 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m18:08:37.243399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m18:08:37.243997 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m18:08:37.257467 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m18:08:37.258406 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m18:08:37.259530 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m18:08:37.260619 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m18:08:37.261444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m18:08:37.262035 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m18:08:37.276554 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m18:08:37.277439 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m18:08:37.278466 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m18:08:37.279600 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m18:08:37.280403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m18:08:37.280988 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m18:08:37.294076 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m18:08:37.295027 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m18:08:37.296079 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m18:08:37.297153 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m18:08:37.297932 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m18:08:37.298590 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m18:08:37.311916 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m18:08:37.312826 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m18:08:37.313860 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m18:08:37.314945 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m18:08:37.317802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m18:08:37.318478 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m18:08:37.331269 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m18:08:37.332204 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m18:08:37.333236 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m18:08:37.334308 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m18:08:37.335117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m18:08:37.335699 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m18:08:37.348545 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m18:08:37.349443 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m18:08:37.350478 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m18:08:37.351568 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m18:08:37.352338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m18:08:37.352935 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m18:08:37.371022 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m18:08:37.371926 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m18:08:37.372956 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m18:08:37.374067 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_users_EMAIL.561bd8e6a0
[0m18:08:37.374885 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now test.incident_management.not_null_users_EMAIL.561bd8e6a0)
[0m18:08:37.375481 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_users_EMAIL.561bd8e6a0
[0m18:08:37.388624 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_users_EMAIL.561bd8e6a0"
[0m18:08:37.389540 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_users_EMAIL.561bd8e6a0
[0m18:08:37.390549 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_users_EMAIL.561bd8e6a0
[0m18:08:37.391730 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_users_ID.3d3e87fab3
[0m18:08:37.392520 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_users_EMAIL.561bd8e6a0, now test.incident_management.not_null_users_ID.3d3e87fab3)
[0m18:08:37.393105 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_users_ID.3d3e87fab3
[0m18:08:37.407609 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_users_ID.3d3e87fab3"
[0m18:08:37.408518 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_users_ID.3d3e87fab3
[0m18:08:37.409561 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_users_ID.3d3e87fab3
[0m18:08:37.410713 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m18:08:37.411495 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_users_ID.3d3e87fab3, now model.incident_management.document_full_extracts)
[0m18:08:37.412071 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m18:08:37.425228 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m18:08:37.426126 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m18:08:37.427175 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m18:08:37.428935 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m18:08:37.430013 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m18:08:37.431111 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m18:08:37.471907 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m18:08:37.473404 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m18:08:37.475007 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m18:08:37.476227 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m18:08:37.477229 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m18:08:37.477833 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m18:08:37.490973 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m18:08:37.491872 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m18:08:37.492883 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m18:08:37.494028 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f
[0m18:08:37.495209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f)
[0m18:08:37.495854 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f
[0m18:08:37.511220 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f"
[0m18:08:37.512184 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f
[0m18:08:37.513240 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f
[0m18:08:37.514416 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149
[0m18:08:37.515224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f, now test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149)
[0m18:08:37.515816 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149
[0m18:08:37.528820 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149"
[0m18:08:37.529719 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149
[0m18:08:37.530740 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149
[0m18:08:37.531912 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d
[0m18:08:37.532689 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149, now test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d)
[0m18:08:37.533272 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d
[0m18:08:37.546383 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d"
[0m18:08:37.547264 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d
[0m18:08:37.548283 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d
[0m18:08:37.549475 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m18:08:37.550277 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m18:08:37.550897 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m18:08:37.566076 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m18:08:37.567048 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m18:08:37.568109 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m18:08:37.569286 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m18:08:37.570099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m18:08:37.570688 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m18:08:37.583833 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m18:08:37.584723 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m18:08:37.585753 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m18:08:37.586916 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m18:08:37.587699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m18:08:37.588283 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m18:08:37.602523 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m18:08:37.603469 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m18:08:37.604527 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m18:08:37.605675 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m18:08:37.606639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m18:08:37.607252 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m18:08:37.619154 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m18:08:37.620047 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m18:08:37.621084 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m18:08:37.622238 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m18:08:37.623381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m18:08:37.623979 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m18:08:37.638634 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m18:08:37.639556 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m18:08:37.640560 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m18:08:37.641684 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m18:08:37.642750 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m18:08:37.643404 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m18:08:37.659375 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m18:08:37.660257 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m18:08:37.661335 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m18:08:37.662489 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m18:08:37.663538 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.weekly_incident_trends)
[0m18:08:37.664153 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m18:08:37.676375 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m18:08:37.677258 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m18:08:37.678275 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m18:08:37.679454 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e
[0m18:08:37.680492 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e)
[0m18:08:37.681149 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e
[0m18:08:37.696065 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e"
[0m18:08:37.696971 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e
[0m18:08:37.697983 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e
[0m18:08:37.699170 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9
[0m18:08:37.699982 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e, now test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9)
[0m18:08:37.700569 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9
[0m18:08:37.713476 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9"
[0m18:08:37.714359 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9
[0m18:08:37.715408 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9
[0m18:08:37.716559 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m18:08:37.717338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m18:08:37.717940 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m18:08:37.735866 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m18:08:37.736764 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m18:08:37.737788 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m18:08:37.738973 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m18:08:37.739786 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m18:08:37.740384 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m18:08:37.755155 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m18:08:37.756007 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m18:08:37.757028 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m18:08:37.758163 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m18:08:37.759042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m18:08:37.759637 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m18:08:37.928643 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m18:08:37.929612 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m18:08:37.930683 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m18:08:37.931895 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m18:08:37.932741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m18:08:37.933343 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m18:08:37.946274 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m18:08:37.947165 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m18:08:37.948186 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m18:08:37.949360 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m18:08:37.950139 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m18:08:37.950715 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m18:08:37.963877 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m18:08:37.964739 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m18:08:37.965766 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m18:08:37.966943 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m18:08:37.967756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m18:08:37.968384 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m18:08:37.983522 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m18:08:37.984406 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m18:08:37.985427 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m18:08:37.986580 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m18:08:37.987425 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m18:08:37.988016 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m18:08:38.001118 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m18:08:38.001998 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m18:08:38.003078 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m18:08:38.004249 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m18:08:38.005062 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m18:08:38.005657 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m18:08:38.020477 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m18:08:38.021387 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m18:08:38.022426 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m18:08:38.023628 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_incident_attachments_ID.18eb3015c5
[0m18:08:38.024440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.unique_closed_incidents_incident_number.dd9483020e, now test.incident_management.not_null_incident_attachments_ID.18eb3015c5)
[0m18:08:38.025027 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_incident_attachments_ID.18eb3015c5
[0m18:08:38.038061 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_incident_attachments_ID.18eb3015c5"
[0m18:08:38.039066 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_incident_attachments_ID.18eb3015c5
[0m18:08:38.040123 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_incident_attachments_ID.18eb3015c5
[0m18:08:38.041295 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d
[0m18:08:38.042096 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_incident_attachments_ID.18eb3015c5, now test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d)
[0m18:08:38.042680 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d
[0m18:08:38.057737 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d"
[0m18:08:38.058699 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d
[0m18:08:38.059787 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d
[0m18:08:38.060984 [debug] [Thread-2 (]: Began running node model.incident_management.alpha
[0m18:08:38.061765 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d, now model.incident_management.alpha)
[0m18:08:38.062344 [debug] [Thread-2 (]: Began compiling node model.incident_management.alpha
[0m18:08:38.078067 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.alpha"
[0m18:08:38.079120 [debug] [Thread-2 (]: Began executing node model.incident_management.alpha
[0m18:08:38.080174 [debug] [Thread-2 (]: Finished running node model.incident_management.alpha
[0m18:08:38.081487 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709
[0m18:08:38.082324 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.alpha, now test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709)
[0m18:08:38.082929 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709
[0m18:08:38.096122 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709"
[0m18:08:38.097147 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709
[0m18:08:38.098192 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709
[0m18:08:38.101151 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m18:08:38.101756 [debug] [Dummy-1   ]: Connection 'test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709' was properly closed.
[0m18:08:38.109731 [debug] [Dummy-1   ]: Command end result
[0m18:08:38.165441 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:08:38.168877 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:08:38.180561 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m18:08:38.182759 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 7.5184064, "process_in_blocks": "0", "process_kernel_time": 1.38, "process_mem_max_rss": "482996", "process_out_blocks": "0", "process_user_time": 7.63}
[0m18:08:38.183560 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 18:08:38.183259 after 7.52 seconds
[0m18:08:38.184157 [debug] [Dummy-1   ]: Flushing usage events


============================== 18:10:46.694527 | dc4d5063-048d-4eb8-becd-c2e3e7ef6b53 ==============================
[0m18:10:46.694527 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m18:10:46.695804 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m18:10:47.113254 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m18:10:47.934598 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:10:48.404897 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:10:48.406167 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_new_documents.sql
[0m18:10:49.335961 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:10:49.339652 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:10:49.399898 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m18:10:49.405350 [info ] [Dummy-1   ]: 
[0m18:10:49.406129 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m18:10:49.406968 [info ] [Dummy-1   ]: 
[0m18:10:49.408251 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m18:10:49.417432 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m18:10:49.763651 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:10:49.764378 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:10:49.764958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:50.457007 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.692 seconds
[0m18:10:50.464638 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:10:50.465357 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m18:10:50.556108 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.090 seconds
[0m18:10:50.559408 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:10:50.560120 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:10:50.644449 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.084 seconds
[0m18:10:50.647355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_semantic_views)
[0m18:10:50.661978 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:10:50.662622 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:10:50.663123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:51.374401 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.711 seconds
[0m18:10:51.377028 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:10:51.377734 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m18:10:51.476993 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.098 seconds
[0m18:10:51.479689 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:10:51.480424 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:10:51.546159 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.065 seconds
[0m18:10:51.548736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_gold_zone)
[0m18:10:51.563317 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:10:51.563971 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:10:51.564501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:52.552204 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.987 seconds
[0m18:10:52.555017 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:10:52.555686 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m18:10:52.796468 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.240 seconds
[0m18:10:52.799385 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:10:52.800006 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:10:52.920849 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.120 seconds
[0m18:10:52.932327 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m18:10:52.933209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m18:10:52.933896 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m18:10:52.953006 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m18:10:52.954003 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m18:10:52.955161 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m18:10:52.956455 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m18:10:52.957548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m18:10:52.958180 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m18:10:52.972948 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m18:10:52.973931 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m18:10:52.975104 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m18:10:52.976324 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m18:10:52.977511 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m18:10:52.978178 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m18:10:52.992540 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m18:10:52.993505 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m18:10:52.994634 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m18:10:52.995880 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m18:10:52.997022 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m18:10:52.997666 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m18:10:53.025255 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m18:10:53.026310 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m18:10:53.027451 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m18:10:53.028824 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m18:10:53.029761 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m18:10:53.030424 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m18:10:53.044150 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m18:10:53.045092 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m18:10:53.046201 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m18:10:53.047445 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m18:10:53.048342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m18:10:53.049036 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m18:10:53.062924 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m18:10:53.063869 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m18:10:53.064963 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m18:10:53.066167 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m18:10:53.067039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m18:10:53.067646 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m18:10:53.083558 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m18:10:53.084553 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m18:10:53.085662 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m18:10:53.086860 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m18:10:53.087752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m18:10:53.088431 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m18:10:53.101950 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m18:10:53.102929 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m18:10:53.104036 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m18:10:53.105199 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m18:10:53.106083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m18:10:53.106691 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m18:10:53.121926 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m18:10:53.122876 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m18:10:53.123952 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m18:10:53.125054 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m18:10:53.125854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m18:10:53.126495 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m18:10:53.140138 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m18:10:53.141083 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m18:10:53.142172 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m18:10:53.143332 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m18:10:53.144165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m18:10:53.144753 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m18:10:53.159928 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m18:10:53.160854 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m18:10:53.161925 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m18:10:53.163050 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m18:10:53.164205 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m18:10:53.164836 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m18:10:53.178448 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m18:10:53.179380 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m18:10:53.180442 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m18:10:53.181551 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m18:10:53.182401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m18:10:53.182988 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m18:10:53.196562 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m18:10:53.197490 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m18:10:53.198672 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m18:10:53.199847 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m18:10:53.200692 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m18:10:53.201282 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m18:10:53.219823 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m18:10:53.220750 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m18:10:53.221817 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m18:10:53.223060 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_users_EMAIL.561bd8e6a0
[0m18:10:53.223919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now test.incident_management.not_null_users_EMAIL.561bd8e6a0)
[0m18:10:53.224521 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_users_EMAIL.561bd8e6a0
[0m18:10:53.238140 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_users_EMAIL.561bd8e6a0"
[0m18:10:53.239188 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_users_EMAIL.561bd8e6a0
[0m18:10:53.240255 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_users_EMAIL.561bd8e6a0
[0m18:10:53.241465 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_users_ID.3d3e87fab3
[0m18:10:53.242317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_users_EMAIL.561bd8e6a0, now test.incident_management.not_null_users_ID.3d3e87fab3)
[0m18:10:53.242898 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_users_ID.3d3e87fab3
[0m18:10:53.258014 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_users_ID.3d3e87fab3"
[0m18:10:53.259020 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_users_ID.3d3e87fab3
[0m18:10:53.260099 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_users_ID.3d3e87fab3
[0m18:10:53.261316 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m18:10:53.262176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_users_ID.3d3e87fab3, now model.incident_management.document_full_extracts)
[0m18:10:53.262772 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m18:10:53.276344 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m18:10:53.277269 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m18:10:53.278417 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m18:10:53.280192 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m18:10:53.281446 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m18:10:53.282608 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m18:10:53.325358 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m18:10:53.326984 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m18:10:53.328710 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m18:10:53.330015 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m18:10:53.331182 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m18:10:53.331836 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m18:10:53.345316 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m18:10:53.346317 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m18:10:53.347424 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m18:10:53.348741 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f
[0m18:10:53.349987 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f)
[0m18:10:53.350635 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f
[0m18:10:53.366155 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f"
[0m18:10:53.367069 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f
[0m18:10:53.368109 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f
[0m18:10:53.369398 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149
[0m18:10:53.370274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_v_qualify_slack_messages_SLACK_MESSAGE_ID.b99d07fd3f, now test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149)
[0m18:10:53.370889 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149
[0m18:10:53.384212 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149"
[0m18:10:53.385168 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149
[0m18:10:53.386258 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149
[0m18:10:53.387460 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d
[0m18:10:53.388302 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_CHUNK.82c90db149, now test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d)
[0m18:10:53.389064 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d
[0m18:10:53.402532 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d"
[0m18:10:53.403468 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d
[0m18:10:53.404551 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d
[0m18:10:53.405779 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m18:10:53.406653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_full_extracts_RELATIVE_PATH.13ce0db60d, now test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee)
[0m18:10:53.407248 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m18:10:53.429018 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee"
[0m18:10:53.430012 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m18:10:53.431111 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee
[0m18:10:53.432313 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m18:10:53.433152 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_document_question_extracts_analysis_type__question.db1181c5ee, now test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf)
[0m18:10:53.433745 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m18:10:53.447135 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf"
[0m18:10:53.448121 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m18:10:53.449287 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf
[0m18:10:53.450536 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m18:10:53.451378 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_document_question_extracts_relative_path.cf91da63bf, now model.incident_management.active_incidents)
[0m18:10:53.451983 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m18:10:53.466638 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m18:10:53.467566 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m18:10:53.468734 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m18:10:53.470008 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m18:10:53.471160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m18:10:53.471804 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m18:10:53.484064 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m18:10:53.484998 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m18:10:53.486076 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m18:10:53.487266 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m18:10:53.488485 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m18:10:53.489137 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m18:10:53.504008 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m18:10:53.504962 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m18:10:53.506043 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m18:10:53.507221 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m18:10:53.508231 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m18:10:53.508923 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m18:10:53.525454 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m18:10:53.526454 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m18:10:53.527538 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m18:10:53.528822 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m18:10:53.529889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.weekly_incident_trends)
[0m18:10:53.530522 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m18:10:53.544511 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m18:10:53.545443 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m18:10:53.546545 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m18:10:53.547758 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e
[0m18:10:53.548925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e)
[0m18:10:53.549563 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e
[0m18:10:53.563037 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e"
[0m18:10:53.563975 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e
[0m18:10:53.565037 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e
[0m18:10:53.566239 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9
[0m18:10:53.567030 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_incidents_INCIDENT_NUMBER.b6d171038e, now test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9)
[0m18:10:53.567635 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9
[0m18:10:53.581070 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9"
[0m18:10:53.581985 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9
[0m18:10:53.583028 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9
[0m18:10:53.584529 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m18:10:53.585409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_active_incidents_INCIDENT_NUMBER.1a30a5faf9, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m18:10:53.586050 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m18:10:53.605041 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m18:10:53.606037 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m18:10:53.607105 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m18:10:53.608305 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m18:10:53.609260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m18:10:53.609904 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m18:10:53.624772 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m18:10:53.625714 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m18:10:53.626809 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m18:10:53.628004 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m18:10:53.628904 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m18:10:53.629511 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m18:10:53.644546 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m18:10:53.645485 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m18:10:53.646553 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m18:10:53.647733 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m18:10:53.648650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m18:10:53.649271 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m18:10:53.663063 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m18:10:53.663992 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m18:10:53.665030 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m18:10:53.666241 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m18:10:53.667082 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m18:10:53.667673 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m18:10:53.879957 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m18:10:53.880990 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m18:10:53.882081 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m18:10:53.883317 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m18:10:53.884146 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m18:10:53.884735 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m18:10:53.898180 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m18:10:53.899257 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m18:10:53.900321 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m18:10:53.901509 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m18:10:53.902358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m18:10:53.902956 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m18:10:53.916614 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m18:10:53.917579 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m18:10:53.918746 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m18:10:53.919965 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m18:10:53.920826 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m18:10:53.921427 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m18:10:53.937247 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m18:10:53.938245 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m18:10:53.939434 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m18:10:53.940669 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_incident_attachments_ID.18eb3015c5
[0m18:10:53.941496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.unique_closed_incidents_incident_number.dd9483020e, now test.incident_management.not_null_incident_attachments_ID.18eb3015c5)
[0m18:10:53.942113 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_incident_attachments_ID.18eb3015c5
[0m18:10:53.955498 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_incident_attachments_ID.18eb3015c5"
[0m18:10:53.956437 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_incident_attachments_ID.18eb3015c5
[0m18:10:53.957495 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_incident_attachments_ID.18eb3015c5
[0m18:10:53.958800 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d
[0m18:10:53.959680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_incident_attachments_ID.18eb3015c5, now test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d)
[0m18:10:53.960283 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d
[0m18:10:53.975708 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d"
[0m18:10:53.976665 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d
[0m18:10:53.977716 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d
[0m18:10:53.979099 [debug] [Thread-2 (]: Began running node model.incident_management.alpha
[0m18:10:53.979946 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_incident_comment_history_ID.c0ecf47c3d, now model.incident_management.alpha)
[0m18:10:53.980538 [debug] [Thread-2 (]: Began compiling node model.incident_management.alpha
[0m18:10:53.996558 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.alpha"
[0m18:10:53.997552 [debug] [Thread-2 (]: Began executing node model.incident_management.alpha
[0m18:10:53.998760 [debug] [Thread-2 (]: Finished running node model.incident_management.alpha
[0m18:10:54.000151 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709
[0m18:10:54.001045 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.alpha, now test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709)
[0m18:10:54.001642 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709
[0m18:10:54.017478 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709"
[0m18:10:54.018552 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709
[0m18:10:54.019667 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709
[0m18:10:54.022610 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m18:10:54.023293 [debug] [Dummy-1   ]: Connection 'test.incident_management.not_null_weekly_incident_trends_WEEK.e4ef7b7709' was properly closed.
[0m18:10:54.031085 [debug] [Dummy-1   ]: Command end result
[0m18:10:54.085348 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:10:54.088726 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:10:54.100657 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m18:10:54.102968 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 7.5154085, "process_in_blocks": "0", "process_kernel_time": 1.52, "process_mem_max_rss": "483996", "process_out_blocks": "0", "process_user_time": 8.1}
[0m18:10:54.103769 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 18:10:54.103466 after 7.52 seconds
[0m18:10:54.104375 [debug] [Dummy-1   ]: Flushing usage events


============================== 18:13:43.993667 | 2763604a-5ca9-4696-ba39-a26bc5af63a6 ==============================
[0m18:13:43.993667 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m18:13:43.994956 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:13:44.382338 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m18:13:45.132877 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:13:45.564510 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:45.565221 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:45.787174 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:13:45.790382 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:13:45.854416 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m18:13:45.858407 [info ] [Dummy-1   ]: 
[0m18:13:45.859171 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m18:13:45.859737 [info ] [Dummy-1   ]: 
[0m18:13:45.860701 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m18:13:45.868222 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m18:13:46.016835 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m18:13:46.017504 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m18:13:46.018009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:46.813962 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.796 seconds
[0m18:13:46.819314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m18:13:46.842922 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:13:46.843594 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:13:46.844168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:47.675864 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.831 seconds
[0m18:13:47.682020 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:13:47.682666 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m18:13:47.794115 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.111 seconds
[0m18:13:47.797038 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:13:47.797672 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:13:47.904730 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m18:13:47.907364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_semantic_views)
[0m18:13:47.922183 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:13:47.922867 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:13:47.923388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:48.787684 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.864 seconds
[0m18:13:48.790365 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:13:48.791038 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m18:13:48.878316 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.087 seconds
[0m18:13:48.880811 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:13:48.881455 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:13:48.970356 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m18:13:48.972736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_bronze_zone)
[0m18:13:48.983488 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:13:48.984123 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:13:48.984617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:50.043324 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.058 seconds
[0m18:13:50.045896 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:13:50.046499 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m18:13:50.193002 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.146 seconds
[0m18:13:50.195811 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:13:50.196395 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:13:50.277448 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.080 seconds
[0m18:13:50.288771 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m18:13:50.289737 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m18:13:50.290534 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m18:13:50.291162 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m18:13:50.311152 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m18:13:50.312132 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m18:13:50.371695 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m18:13:50.373672 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m18:13:50.374418 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE METADATA@ACTION != 'DELETE'
relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m18:13:50.375115 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:13:51.127728 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c049c5-0106-e9ca-0032-31870548345a
[0m18:13:51.128561 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 14 unexpected '@ACTION'.
syntax error line 16 at position 0 unexpected 'relative_path'.
[0m18:13:51.134424 [debug] [Thread-2 (]: Database Error in model v_qualify_new_documents (models/bronze_zone/v_qualify_new_documents.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 14 unexpected '@ACTION'.
  syntax error line 16 at position 0 unexpected 'relative_path'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/v_qualify_new_documents.sql
[0m18:13:51.138105 [error] [Thread-2 (]: 1 of 2 ERROR creating sql view model bronze_zone.v_qualify_new_documents ....... [[31mERROR[0m in 0.84s]
[0m18:13:51.139278 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m18:13:51.140683 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.v_qualify_new_documents' to be skipped because of status 'error'.  Reason: Database Error in model v_qualify_new_documents (models/bronze_zone/v_qualify_new_documents.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 14 unexpected '@ACTION'.
  syntax error line 16 at position 0 unexpected 'relative_path'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/v_qualify_new_documents.sql.
[0m18:13:51.143167 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m18:13:51.144543 [info ] [Thread-2 (]: 2 of 2 SKIP relation bronze_zone.document_question_extracts .................... [[33mSKIP[0m]
[0m18:13:51.145748 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m18:13:51.149513 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m18:13:51.150109 [debug] [Dummy-1   ]: Connection 'model.incident_management.v_qualify_new_documents' was properly closed.
[0m18:13:51.150639 [info ] [Dummy-1   ]: 
[0m18:13:51.151207 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m18:13:51.152241 [debug] [Dummy-1   ]: Command end result
[0m18:13:51.204319 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:13:51.207123 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:13:51.215405 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m18:13:51.215973 [info ] [Dummy-1   ]: 
[0m18:13:51.216613 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:13:51.217115 [info ] [Dummy-1   ]: 
[0m18:13:51.217855 [error] [Dummy-1   ]:   Database Error in model v_qualify_new_documents (models/bronze_zone/v_qualify_new_documents.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 14 unexpected '@ACTION'.
  syntax error line 16 at position 0 unexpected 'relative_path'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/v_qualify_new_documents.sql
[0m18:13:51.218450 [info ] [Dummy-1   ]: 
[0m18:13:51.219038 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m18:13:51.220841 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.325796, "process_in_blocks": "0", "process_kernel_time": 1.21, "process_mem_max_rss": "436588", "process_out_blocks": "0", "process_user_time": 5.97}
[0m18:13:51.221517 [debug] [Dummy-1   ]: Command `cli run` failed at 18:13:51.221248 after 7.33 seconds
[0m18:13:51.222070 [debug] [Dummy-1   ]: Flushing usage events


============================== 18:14:29.011483 | cceaa2ba-e3e9-476e-b485-6ac4ce3634b9 ==============================
[0m18:14:29.011483 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m18:14:29.012709 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m18:14:29.404714 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m18:14:30.186479 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:14:30.628966 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:14:30.630406 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_new_documents.sql
[0m18:14:31.504087 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:14:31.507496 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:14:31.573745 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m18:14:31.577512 [info ] [Dummy-1   ]: 
[0m18:14:31.578218 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m18:14:31.578847 [info ] [Dummy-1   ]: 
[0m18:14:31.579864 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m18:14:31.587387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m18:14:31.885510 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m18:14:31.886229 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m18:14:31.886798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:32.768336 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.881 seconds
[0m18:14:32.773610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m18:14:32.796162 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:14:32.796829 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:14:32.797343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:33.553785 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.756 seconds
[0m18:14:33.560152 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:14:33.560854 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m18:14:33.664454 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.103 seconds
[0m18:14:33.667459 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:14:33.668094 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:14:33.804340 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.135 seconds
[0m18:14:33.807164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m18:14:33.824205 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:14:33.824866 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:14:33.825362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:34.646756 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.821 seconds
[0m18:14:34.649420 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:14:34.650055 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m18:14:34.752946 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.102 seconds
[0m18:14:34.756076 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:14:34.756721 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:14:34.845800 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m18:14:34.848545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_semantic_views)
[0m18:14:34.861107 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:14:34.861733 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:14:34.862229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:35.653574 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.791 seconds
[0m18:14:35.656169 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:14:35.656779 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m18:14:35.753798 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.096 seconds
[0m18:14:35.756197 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:14:35.756796 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:14:35.841270 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.084 seconds
[0m18:14:35.848929 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m18:14:35.849923 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m18:14:35.850727 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now model.incident_management.v_qualify_new_documents)
[0m18:14:35.851377 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m18:14:35.871137 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m18:14:35.872129 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m18:14:35.932506 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m18:14:35.934454 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m18:14:35.935211 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE METADATA$ACTION != 'DELETE'
relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m18:14:35.935874 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:14:36.717683 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c049c6-0106-f548-0032-31870548833e
[0m18:14:36.718511 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 0 unexpected 'relative_path'.
[0m18:14:36.724322 [debug] [Thread-2 (]: Database Error in model v_qualify_new_documents (models/bronze_zone/v_qualify_new_documents.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 0 unexpected 'relative_path'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/v_qualify_new_documents.sql
[0m18:14:36.727852 [error] [Thread-2 (]: 1 of 2 ERROR creating sql view model bronze_zone.v_qualify_new_documents ....... [[31mERROR[0m in 0.87s]
[0m18:14:36.728943 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m18:14:36.730304 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.v_qualify_new_documents' to be skipped because of status 'error'.  Reason: Database Error in model v_qualify_new_documents (models/bronze_zone/v_qualify_new_documents.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 0 unexpected 'relative_path'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/v_qualify_new_documents.sql.
[0m18:14:36.732691 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m18:14:36.734051 [info ] [Thread-2 (]: 2 of 2 SKIP relation bronze_zone.document_question_extracts .................... [[33mSKIP[0m]
[0m18:14:36.735249 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m18:14:36.737922 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m18:14:36.738553 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m18:14:36.739080 [debug] [Dummy-1   ]: Connection 'model.incident_management.v_qualify_new_documents' was properly closed.
[0m18:14:36.739619 [info ] [Dummy-1   ]: 
[0m18:14:36.740159 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m18:14:36.741235 [debug] [Dummy-1   ]: Command end result
[0m18:14:36.793464 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:14:36.796454 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:14:36.804451 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m18:14:36.805051 [info ] [Dummy-1   ]: 
[0m18:14:36.805710 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:14:36.806231 [info ] [Dummy-1   ]: 
[0m18:14:36.807013 [error] [Dummy-1   ]:   Database Error in model v_qualify_new_documents (models/bronze_zone/v_qualify_new_documents.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 0 unexpected 'relative_path'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/v_qualify_new_documents.sql
[0m18:14:36.807550 [info ] [Dummy-1   ]: 
[0m18:14:36.808074 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m18:14:36.810060 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.897892, "process_in_blocks": "0", "process_kernel_time": 1.26, "process_mem_max_rss": "479016", "process_out_blocks": "0", "process_user_time": 6.9}
[0m18:14:36.810767 [debug] [Dummy-1   ]: Command `cli run` failed at 18:14:36.810484 after 7.90 seconds
[0m18:14:36.811383 [debug] [Dummy-1   ]: Flushing usage events


============================== 18:14:48.977725 | 131abf44-407a-4480-b8bc-fb32d73232fa ==============================
[0m18:14:48.977725 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m18:14:48.979097 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:14:49.379714 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m18:14:50.128011 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:14:50.585622 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:14:50.586948 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_new_documents.sql
[0m18:14:51.484335 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:14:51.487777 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:14:51.556167 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m18:14:51.560304 [info ] [Dummy-1   ]: 
[0m18:14:51.561061 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m18:14:51.561606 [info ] [Dummy-1   ]: 
[0m18:14:51.562544 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m18:14:51.570371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m18:14:51.893264 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m18:14:51.893944 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m18:14:51.894473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:52.734437 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.840 seconds
[0m18:14:52.739671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m18:14:52.762749 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:14:52.763442 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:14:52.763947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:53.510503 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.746 seconds
[0m18:14:53.516754 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:14:53.517503 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m18:14:53.595783 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.077 seconds
[0m18:14:53.598953 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:14:53.599595 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:14:53.685931 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.086 seconds
[0m18:14:53.688933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m18:14:53.706850 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:14:53.707562 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:14:53.708099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:54.387721 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.679 seconds
[0m18:14:54.390430 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:14:54.391082 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m18:14:54.498007 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.106 seconds
[0m18:14:54.501285 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:14:54.501921 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:14:54.599038 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m18:14:54.601740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_semantic_views)
[0m18:14:54.614709 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:14:54.615372 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:14:54.615899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:55.248767 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.633 seconds
[0m18:14:55.251413 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:14:55.252024 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m18:14:55.324979 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.072 seconds
[0m18:14:55.327397 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:14:55.327984 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:14:55.398684 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.070 seconds
[0m18:14:55.406736 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m18:14:55.407761 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m18:14:55.408662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now model.incident_management.v_qualify_new_documents)
[0m18:14:55.409317 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m18:14:55.429832 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m18:14:55.430848 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m18:14:55.492119 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m18:14:55.494059 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m18:14:55.494788 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE METADATA$ACTION != 'DELETE'
and relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m18:14:55.495476 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:14:56.468522 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.973 seconds
[0m18:14:56.505220 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.09s]
[0m18:14:56.506274 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m18:14:56.508759 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m18:14:56.510318 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m18:14:56.511151 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m18:14:56.512194 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m18:14:56.553999 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m18:14:56.555518 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m18:14:56.600715 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m18:14:56.607071 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m18:14:56.609446 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session

    
def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    docs_stage = dbt.config.get("docs_stage_path")

    all_meta = dbt.config.get("meta")
    # global_inm_policy_schema = dbt.config.get("meta")['global_inm_policy_schema']
    reponse_schema = {
        'schema': {
            'type': 'object',
            'properties': {}
        }
    }
    for key in all_meta.keys():
        if all_meta[key]['enabled']:
            reponse_schema['schema']['properties'][key] = all_meta[key]['schema']['properties']

    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.lower(F.col('doc_type')) == 'question'
    )
    
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}'), F.col('relative_path')),
            reponse_schema
        )
    )    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'docs_stage_path': None, 'meta': {'global_inm_policy_schema': {'enabled': False, 'schema': {'type': 'object', 'properties': {'purpose': {'description': 'Purpose of this policy', 'type': 'string'}, 'objectives': {'description': 'Objectives achieved by this policy', 'type': 'string'}, 'policy_statement': {'description': 'Primary policy statement', 'type': 'string'}, 'in_scope_services': {'description': 'Services explicitly in scope', 'type': 'array'}, 'out_of_scope_services': {'description': 'Services explicitly out of scope', 'type': 'array'}, 'geographical_coverage': {'description': 'Countries/regions covered', 'type': 'array'}, 'business_units_in_scope': {'description': 'Business units covered by the policy', 'type': 'array'}, 'applicability_conditions': {'description': 'Conditions determining when policy applies', 'type': 'array'}, 'exclusions': {'description': 'Explicit exceptions to scope', 'type': 'array'}, 'definitions_and_glossary': {'description': 'Terms, acronyms, and reference standards', 'type': 'object', 'properties': {'defined_terms': {'description': 'Key defined terms', 'type': 'array'}, 'acronyms': {'description': 'Acronyms used within the document', 'type': 'array'}, 'reference_standards': {'description': 'Referenced standards and frameworks', 'type': 'array'}}}}}}, 'quaterly_review_metrics': {'enabled': True, 'schema': {'type': 'object', 'properties': {'quarter': {'description': 'What is the year and quarter of the review metrics?', 'type': 'string'}, 'service_operational_health': {'description': 'Service operational health for a given quarter', 'type': 'object', 'properties': {'overall_uptime': {'description': 'What was the actual recorded overall uptime of all services', 'type': 'number'}, 'critical_services_uptime': {'description': 'What was the actual recorded  uptime of critical services', 'type': 'number'}, 'sev_1_incidents': {'description': 'What were the actual recorded number of Sev-1 incidents', 'type': 'number'}, 'sev_2_incidents': {'description': 'What were the actual recorded number of Sev-2 incidents', 'type': 'number'}, 'mtta': {'description': 'What was the actual recorded mean time to acknowledge an incident', 'type': 'number'}, 'mttr': {'description': 'What was the actual recorded mean time to recover from an incident', 'type': 'number'}, 'change_failure_rate': {'description': 'What was the actual recorded change failure rate', 'type': 'number'}, 'slo_breaches': {'description': 'What was the actual recorded number of SLO breaches', 'type': 'number'}, 'error_budget_consumed': {'description': 'What was the actual recorded error budget consumed', 'type': 'number'}, 'service_downtime': {'description': 'What was the actual recorded service downtime', 'type': 'number'}, 'unplanned_outage_hours': {'description': 'What was the actual recorded unplanned outage hours', 'type': 'number'}, 'planned_maintenance_hours': {'description': 'What was the actual recorded planned maintenance hours', 'type': 'number'}, 'sev_1_outage_minutes': {'description': 'What was the actual recorded Sev-1 outage minutes', 'type': 'number'}, 'sev_2_outage_minutes': {'description': 'What was the actual recorded Sev-2 outage minutes', 'type': 'number'}, 'longest_single_outage': {'description': 'What was the actual recorded longest single outage', 'type': 'number'}, 'mtbft': {'description': 'What was the actual recorded mean time between failures', 'type': 'number'}}}, 'team_utilisation': {'description': 'Team utilisation for a given quarter', 'type': 'object', 'properties': {'end_of_quarter_it_headcount': {'description': 'What was the actual recorded end of quarter IT headcount', 'type': 'number'}, 'engineering_headcount': {'description': 'What was the actual recorded engineering headcount', 'type': 'number'}, 'on_call_coverage': {'description': 'What was the actual recorded on call coverage', 'type': 'number'}, 'project_work_allocation': {'description': 'What was the actual recorded project work allocation', 'type': 'number'}, 'bau_operations_allocation': {'description': 'What was the actual recorded BAU/Operations allocation', 'type': 'number'}, 'on_call_hours_per_engineer': {'description': 'What was the actual recorded on call hours per engineer', 'type': 'number'}, 'after_hours_incidents_handled': {'description': 'What was the actual recorded after hours incidents handled', 'type': 'number'}, 'training_hours_per_fte': {'description': 'What was the actual recorded training hours per FTE', 'type': 'number'}, 'certifications_earned': {'description': 'What was the actual recorded certifications earned', 'type': 'number'}, 'attrition': {'description': 'What was the actual recorded attrition', 'type': 'number'}}}, 'tool_licensing_spend': {'description': 'Tool licensing spend for a given quarter', 'type': 'object', 'properties': {'atlassian_spend': {'description': 'What was the actual spend on Atlassian licenses', 'type': 'number'}, 'github_spend': {'description': 'What was the actual spend on GitHub licenses', 'type': 'number'}, 'slack_spend': {'description': 'What was the actual spend on Slack licenses', 'type': 'number'}, 'pagerduty_spend': {'description': 'What was the actual spend on PagerDuty licenses', 'type': 'number'}, 'datadog_spend': {'description': 'What was the actual spend on Datadog licenses', 'type': 'number'}, 'sentry_spend': {'description': 'What was the actual spend on Sentry licenses', 'type': 'number'}, 'okta_spend': {'description': 'What was the actual spend on Okta licenses', 'type': 'number'}, 'aws_spend': {'description': 'What was the actual spend on AWS licenses', 'type': 'number'}, 'total_spend': {'description': 'What was the actual spend on total licenses', 'type': 'number'}}}}}}}}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m18:14:56.611229 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:15:02.525520 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c049c6-0106-f535-0032-318705476c2a
[0m18:15:02.527435 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 122, in main
    materialize(session, df, dbt.this)
  File "_udf_code.py", line 117, in materialize
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
    result = func(*args, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 510, in save_as_table
    result = session._conn.execute(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 648, in execute
    result_set, result_meta = self.get_result_set(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 426, in wrap
    raise ne.with_traceback(tb) from None
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 770, in get_result_set
    result = self.run_query(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 137, in wrap
    raise ex
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 131, in wrap
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 544, in run_query
    raise ex
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 529, in run_query
    results_cursor = self.execute_and_notify_query_listener(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 459, in execute_and_notify_query_listener
    raise ex
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 450, in execute_and_notify_query_listener
    results_cursor = self._cursor.execute(query, **kwargs)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
    Error.errorhandler_wrapper(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
    raise error_class(
snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c049c7-0106-f535-0032-318705476c3a: 100112 (22000): Remote file 'None/qa/incm_quaterly_review_metrics_2024_Q1.pptx' was not found. There are several potential causes. The file might not exist. The required credentials may be missing or invalid. If you are running a copy command, please make sure files are not deleted when they are being loaded or files are not being loaded into two different tables concurrently with auto purge option.
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m18:15:02.535421 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 122, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 117, in materialize
      df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 510, in save_as_table
      result = session._conn.execute(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 648, in execute
      result_set, result_meta = self.get_result_set(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 426, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 770, in get_result_set
      result = self.run_query(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 137, in wrap
      raise ex
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 131, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 544, in run_query
      raise ex
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 529, in run_query
      results_cursor = self.execute_and_notify_query_listener(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 459, in execute_and_notify_query_listener
      raise ex
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 450, in execute_and_notify_query_listener
      results_cursor = self._cursor.execute(query, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c049c7-0106-f535-0032-318705476c3a: 100112 (22000): Remote file 'None/qa/incm_quaterly_review_metrics_2024_Q1.pptx' was not found. There are several potential causes. The file might not exist. The required credentials may be missing or invalid. If you are running a copy command, please make sure files are not deleted when they are being loaded or files are not being loaded into two different tables concurrently with auto purge option.
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m18:15:02.537945 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 6.03s]
[0m18:15:02.539844 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m18:15:02.541886 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 122, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 117, in materialize
      df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 510, in save_as_table
      result = session._conn.execute(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 648, in execute
      result_set, result_meta = self.get_result_set(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 426, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 770, in get_result_set
      result = self.run_query(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 137, in wrap
      raise ex
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 131, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 544, in run_query
      raise ex
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 529, in run_query
      results_cursor = self.execute_and_notify_query_listener(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 459, in execute_and_notify_query_listener
      raise ex
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 450, in execute_and_notify_query_listener
      results_cursor = self._cursor.execute(query, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c049c7-0106-f535-0032-318705476c3a: 100112 (22000): Remote file 'None/qa/incm_quaterly_review_metrics_2024_Q1.pptx' was not found. There are several potential causes. The file might not exist. The required credentials may be missing or invalid. If you are running a copy command, please make sure files are not deleted when they are being loaded or files are not being loaded into two different tables concurrently with auto purge option.
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m18:15:02.545300 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m18:15:02.545947 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m18:15:02.546507 [info ] [Dummy-1   ]: 
[0m18:15:02.547076 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.98 seconds (10.98s).
[0m18:15:02.548644 [debug] [Dummy-1   ]: Command end result
[0m18:15:02.602035 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:15:02.605039 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:15:02.613469 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m18:15:02.614036 [info ] [Dummy-1   ]: 
[0m18:15:02.614702 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:15:02.615259 [info ] [Dummy-1   ]: 
[0m18:15:02.617120 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 122, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 117, in materialize
      df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/telemetry.py", line 333, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/utils.py", line 1148, in call_wrapper
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/dataframe_writer.py", line 510, in save_as_table
      result = session._conn.execute(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 648, in execute
      result_set, result_meta = self.get_result_set(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 426, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 179, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 770, in get_result_set
      result = self.run_query(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 137, in wrap
      raise ex
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 131, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 544, in run_query
      raise ex
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 529, in run_query
      results_cursor = self.execute_and_notify_query_listener(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 459, in execute_and_notify_query_listener
      raise ex
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/snowpark/_internal/server_connection.py", line 450, in execute_and_notify_query_listener
      results_cursor = self._cursor.execute(query, **kwargs)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 1092, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/b88fc6cee03bfbfe0f52de3d47a8154b8df05d909884183e6abe6e122fd3dafb/lib/python3.9/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01c049c7-0106-f535-0032-318705476c3a: 100112 (22000): Remote file 'None/qa/incm_quaterly_review_metrics_2024_Q1.pptx' was not found. There are several potential causes. The file might not exist. The required credentials may be missing or invalid. If you are running a copy command, please make sure files are not deleted when they are being loaded or files are not being loaded into two different tables concurrently with auto purge option.
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m18:15:02.618057 [info ] [Dummy-1   ]: 
[0m18:15:02.618682 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:15:02.620606 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.745549, "process_in_blocks": "0", "process_kernel_time": 1.45, "process_mem_max_rss": "486888", "process_out_blocks": "0", "process_user_time": 6.97}
[0m18:15:02.621300 [debug] [Dummy-1   ]: Command `cli run` failed at 18:15:02.621024 after 13.75 seconds
[0m18:15:02.621874 [debug] [Dummy-1   ]: Flushing usage events


============================== 18:18:38.012119 | 42cb20bd-ea8b-4ab3-b138-5b5b5aa0aa35 ==============================
[0m18:18:38.012119 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m18:18:38.013313 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m18:18:38.397584 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m18:18:39.194173 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:18:39.641914 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:18:39.643716 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.yml
[0m18:18:40.687000 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:18:40.690190 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:18:40.902375 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m18:18:40.906287 [info ] [Dummy-1   ]: 
[0m18:18:40.907056 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m18:18:40.907553 [info ] [Dummy-1   ]: 
[0m18:18:40.908518 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m18:18:40.916010 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m18:18:41.061912 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m18:18:41.062614 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m18:18:41.063130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:42.122782 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.059 seconds
[0m18:18:42.127767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m18:18:42.150555 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:18:42.151224 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:18:42.151720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:43.134679 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.983 seconds
[0m18:18:43.140832 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:18:43.141494 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m18:18:43.264505 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.122 seconds
[0m18:18:43.267559 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:18:43.268182 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:18:43.395676 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.127 seconds
[0m18:18:43.398521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_semantic_views)
[0m18:18:43.414529 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:18:43.415167 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:18:43.415662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:44.700920 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.285 seconds
[0m18:18:44.703459 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:18:44.704054 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m18:18:44.867334 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.163 seconds
[0m18:18:44.869880 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:18:44.870496 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:18:44.983445 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m18:18:44.985822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_gold_zone)
[0m18:18:44.996355 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:18:44.996988 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:18:44.997516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:46.015875 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.018 seconds
[0m18:18:46.018475 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:18:46.019117 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m18:18:46.124857 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.105 seconds
[0m18:18:46.127630 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:18:46.128234 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:18:46.261925 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.133 seconds
[0m18:18:46.271798 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m18:18:46.272761 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m18:18:46.273555 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m18:18:46.274176 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m18:18:46.293904 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m18:18:46.294881 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m18:18:46.354376 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m18:18:46.356319 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m18:18:46.357050 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE METADATA$ACTION != 'DELETE'
and relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m18:18:46.357704 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:18:47.436289 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.078 seconds
[0m18:18:47.472171 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.20s]
[0m18:18:47.473196 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m18:18:47.475634 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m18:18:47.477196 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m18:18:47.478055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m18:18:47.479216 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m18:18:47.520319 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m18:18:47.521906 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m18:18:47.566231 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m18:18:47.572517 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m18:18:47.574918 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session

    
def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    docs_stage = dbt.config.get("docs_stage_path")

    all_meta = dbt.config.get("meta")
    # global_inm_policy_schema = dbt.config.get("meta")['global_inm_policy_schema']
    reponse_schema = {
        'schema': {
            'type': 'object',
            'properties': {}
        }
    }
    for key in all_meta.keys():
        if all_meta[key]['enabled']:
            reponse_schema['schema']['properties'][key] = all_meta[key]['schema']['properties']

    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.lower(F.col('doc_type')) == 'question'
    )
    
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}'), F.col('relative_path')),
            reponse_schema
        )
    )    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'docs_stage_path': '@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', 'meta': {'global_inm_policy_schema': {'enabled': False, 'schema': {'type': 'object', 'properties': {'purpose': {'description': 'Purpose of this policy', 'type': 'string'}, 'objectives': {'description': 'Objectives achieved by this policy', 'type': 'string'}, 'policy_statement': {'description': 'Primary policy statement', 'type': 'string'}, 'in_scope_services': {'description': 'Services explicitly in scope', 'type': 'array'}, 'out_of_scope_services': {'description': 'Services explicitly out of scope', 'type': 'array'}, 'geographical_coverage': {'description': 'Countries/regions covered', 'type': 'array'}, 'business_units_in_scope': {'description': 'Business units covered by the policy', 'type': 'array'}, 'applicability_conditions': {'description': 'Conditions determining when policy applies', 'type': 'array'}, 'exclusions': {'description': 'Explicit exceptions to scope', 'type': 'array'}, 'definitions_and_glossary': {'description': 'Terms, acronyms, and reference standards', 'type': 'object', 'properties': {'defined_terms': {'description': 'Key defined terms', 'type': 'array'}, 'acronyms': {'description': 'Acronyms used within the document', 'type': 'array'}, 'reference_standards': {'description': 'Referenced standards and frameworks', 'type': 'array'}}}}}}, 'quaterly_review_metrics': {'enabled': True, 'schema': {'type': 'object', 'properties': {'quarter': {'description': 'What is the year and quarter of the review metrics?', 'type': 'string'}, 'service_operational_health': {'description': 'Service operational health for a given quarter', 'type': 'object', 'properties': {'overall_uptime': {'description': 'What was the actual recorded overall uptime of all services', 'type': 'number'}, 'critical_services_uptime': {'description': 'What was the actual recorded  uptime of critical services', 'type': 'number'}, 'sev_1_incidents': {'description': 'What were the actual recorded number of Sev-1 incidents', 'type': 'number'}, 'sev_2_incidents': {'description': 'What were the actual recorded number of Sev-2 incidents', 'type': 'number'}, 'mtta': {'description': 'What was the actual recorded mean time to acknowledge an incident', 'type': 'number'}, 'mttr': {'description': 'What was the actual recorded mean time to recover from an incident', 'type': 'number'}, 'change_failure_rate': {'description': 'What was the actual recorded change failure rate', 'type': 'number'}, 'slo_breaches': {'description': 'What was the actual recorded number of SLO breaches', 'type': 'number'}, 'error_budget_consumed': {'description': 'What was the actual recorded error budget consumed', 'type': 'number'}, 'service_downtime': {'description': 'What was the actual recorded service downtime', 'type': 'number'}, 'unplanned_outage_hours': {'description': 'What was the actual recorded unplanned outage hours', 'type': 'number'}, 'planned_maintenance_hours': {'description': 'What was the actual recorded planned maintenance hours', 'type': 'number'}, 'sev_1_outage_minutes': {'description': 'What was the actual recorded Sev-1 outage minutes', 'type': 'number'}, 'sev_2_outage_minutes': {'description': 'What was the actual recorded Sev-2 outage minutes', 'type': 'number'}, 'longest_single_outage': {'description': 'What was the actual recorded longest single outage', 'type': 'number'}, 'mtbft': {'description': 'What was the actual recorded mean time between failures', 'type': 'number'}}}, 'team_utilisation': {'description': 'Team utilisation for a given quarter', 'type': 'object', 'properties': {'end_of_quarter_it_headcount': {'description': 'What was the actual recorded end of quarter IT headcount', 'type': 'number'}, 'engineering_headcount': {'description': 'What was the actual recorded engineering headcount', 'type': 'number'}, 'on_call_coverage': {'description': 'What was the actual recorded on call coverage', 'type': 'number'}, 'project_work_allocation': {'description': 'What was the actual recorded project work allocation', 'type': 'number'}, 'bau_operations_allocation': {'description': 'What was the actual recorded BAU/Operations allocation', 'type': 'number'}, 'on_call_hours_per_engineer': {'description': 'What was the actual recorded on call hours per engineer', 'type': 'number'}, 'after_hours_incidents_handled': {'description': 'What was the actual recorded after hours incidents handled', 'type': 'number'}, 'training_hours_per_fte': {'description': 'What was the actual recorded training hours per FTE', 'type': 'number'}, 'certifications_earned': {'description': 'What was the actual recorded certifications earned', 'type': 'number'}, 'attrition': {'description': 'What was the actual recorded attrition', 'type': 'number'}}}, 'tool_licensing_spend': {'description': 'Tool licensing spend for a given quarter', 'type': 'object', 'properties': {'atlassian_spend': {'description': 'What was the actual spend on Atlassian licenses', 'type': 'number'}, 'github_spend': {'description': 'What was the actual spend on GitHub licenses', 'type': 'number'}, 'slack_spend': {'description': 'What was the actual spend on Slack licenses', 'type': 'number'}, 'pagerduty_spend': {'description': 'What was the actual spend on PagerDuty licenses', 'type': 'number'}, 'datadog_spend': {'description': 'What was the actual spend on Datadog licenses', 'type': 'number'}, 'sentry_spend': {'description': 'What was the actual spend on Sentry licenses', 'type': 'number'}, 'okta_spend': {'description': 'What was the actual spend on Okta licenses', 'type': 'number'}, 'aws_spend': {'description': 'What was the actual spend on AWS licenses', 'type': 'number'}, 'total_spend': {'description': 'What was the actual spend on total licenses', 'type': 'number'}}}}}}}}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m18:18:47.576763 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:19:05.724579 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 18.148 seconds
[0m18:19:05.729448 [info ] [Thread-2 (]: 2 of 2 OK created python table model bronze_zone.document_question_extracts .... [[32mSUCCESS 1[0m in 18.25s]
[0m18:19:05.730954 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m18:19:05.734011 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m18:19:05.734587 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m18:19:05.735114 [info ] [Dummy-1   ]: 
[0m18:19:05.735652 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 24.83 seconds (24.83s).
[0m18:19:05.736840 [debug] [Dummy-1   ]: Command end result
[0m18:19:05.789962 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:19:05.792923 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:19:05.800947 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m18:19:05.801521 [info ] [Dummy-1   ]: 
[0m18:19:05.802234 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m18:19:05.802719 [info ] [Dummy-1   ]: 
[0m18:19:05.803233 [info ] [Dummy-1   ]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:19:05.805117 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.892288, "process_in_blocks": "0", "process_kernel_time": 1.35, "process_mem_max_rss": "443304", "process_out_blocks": "0", "process_user_time": 7.1}
[0m18:19:05.805816 [debug] [Dummy-1   ]: Command `cli run` succeeded at 18:19:05.805544 after 27.89 seconds
[0m18:19:05.806402 [debug] [Dummy-1   ]: Flushing usage events


============================== 18:22:24.396624 | f4d76dfb-e60a-4dd1-b532-45fc5fb366ca ==============================
[0m18:22:24.396624 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m18:22:24.397854 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:22:24.797479 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m18:22:25.607485 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:22:26.041678 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:22:26.043071 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m18:22:27.102151 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:22:27.105271 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:22:27.322261 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m18:22:27.326154 [info ] [Dummy-1   ]: 
[0m18:22:27.326839 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m18:22:27.327411 [info ] [Dummy-1   ]: 
[0m18:22:27.328327 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m18:22:27.336108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m18:22:27.478284 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m18:22:27.479095 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m18:22:27.479635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:28.353001 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.873 seconds
[0m18:22:28.358036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_semantic_views)
[0m18:22:28.382746 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:22:28.383468 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:22:28.383974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:29.286687 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.902 seconds
[0m18:22:29.292896 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:22:29.293599 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m18:22:29.395178 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.101 seconds
[0m18:22:29.397707 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:22:29.398430 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:22:29.484200 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.085 seconds
[0m18:22:29.486677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_gold_zone)
[0m18:22:29.497616 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:22:29.498249 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:22:29.498876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:30.272585 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.774 seconds
[0m18:22:30.275143 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:22:30.275752 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m18:22:30.386096 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.110 seconds
[0m18:22:30.389019 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:22:30.389622 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:22:30.492801 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m18:22:30.495454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m18:22:30.509833 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:22:30.510470 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:22:30.511001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:31.252713 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.742 seconds
[0m18:22:31.255198 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:22:31.255818 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m18:22:31.372970 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.116 seconds
[0m18:22:31.375777 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:22:31.376369 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:22:31.502320 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.125 seconds
[0m18:22:31.515073 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m18:22:31.516083 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m18:22:31.516902 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m18:22:31.517537 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m18:22:31.535608 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m18:22:31.536610 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m18:22:31.598703 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m18:22:31.600655 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m18:22:31.601377 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE METADATA$ACTION != 'DELETE'
and relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m18:22:31.602033 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:22:32.730031 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.128 seconds
[0m18:22:32.765922 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.25s]
[0m18:22:32.767015 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m18:22:32.769541 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m18:22:32.771330 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m18:22:32.772207 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m18:22:32.773303 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m18:22:32.815093 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m18:22:32.816568 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m18:22:32.861543 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m18:22:32.867927 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m18:22:32.870367 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session

    
def model(dbt, session: Session):

    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    docs_stage = dbt.config.get("docs_stage_path")

    all_meta = dbt.config.get("meta")
    
    reponse_schema = {
        'schema': {
            'type': 'object',
            'properties': {}
        }
    }
    
    for key in all_meta.keys():
        if all_meta[key]['enabled']:
            reponse_schema['schema']['properties'][key] = all_meta[key]['schema']['properties']

    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.lower(F.col('doc_type')) == 'question'
    ).drop(
        "METADATA$ACTION",
        "METADATA$ISUPDATE",
        "METADATA$ROW_ID"
    )
    
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}'), F.col('relative_path')),
            reponse_schema
        )
    )    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'docs_stage_path': '@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', 'meta': {'global_inm_policy_schema': {'enabled': False, 'schema': {'type': 'object', 'properties': {'purpose': {'description': 'Purpose of this policy', 'type': 'string'}, 'objectives': {'description': 'Objectives achieved by this policy', 'type': 'string'}, 'policy_statement': {'description': 'Primary policy statement', 'type': 'string'}, 'in_scope_services': {'description': 'Services explicitly in scope', 'type': 'array'}, 'out_of_scope_services': {'description': 'Services explicitly out of scope', 'type': 'array'}, 'geographical_coverage': {'description': 'Countries/regions covered', 'type': 'array'}, 'business_units_in_scope': {'description': 'Business units covered by the policy', 'type': 'array'}, 'applicability_conditions': {'description': 'Conditions determining when policy applies', 'type': 'array'}, 'exclusions': {'description': 'Explicit exceptions to scope', 'type': 'array'}, 'definitions_and_glossary': {'description': 'Terms, acronyms, and reference standards', 'type': 'object', 'properties': {'defined_terms': {'description': 'Key defined terms', 'type': 'array'}, 'acronyms': {'description': 'Acronyms used within the document', 'type': 'array'}, 'reference_standards': {'description': 'Referenced standards and frameworks', 'type': 'array'}}}}}}, 'quaterly_review_metrics': {'enabled': True, 'schema': {'type': 'object', 'properties': {'quarter': {'description': 'What is the year and quarter of the review metrics?', 'type': 'string'}, 'service_operational_health': {'description': 'Service operational health for a given quarter', 'type': 'object', 'properties': {'overall_uptime': {'description': 'What was the actual recorded overall uptime of all services', 'type': 'number'}, 'critical_services_uptime': {'description': 'What was the actual recorded  uptime of critical services', 'type': 'number'}, 'sev_1_incidents': {'description': 'What were the actual recorded number of Sev-1 incidents', 'type': 'number'}, 'sev_2_incidents': {'description': 'What were the actual recorded number of Sev-2 incidents', 'type': 'number'}, 'mtta': {'description': 'What was the actual recorded mean time to acknowledge an incident', 'type': 'number'}, 'mttr': {'description': 'What was the actual recorded mean time to recover from an incident', 'type': 'number'}, 'change_failure_rate': {'description': 'What was the actual recorded change failure rate', 'type': 'number'}, 'slo_breaches': {'description': 'What was the actual recorded number of SLO breaches', 'type': 'number'}, 'error_budget_consumed': {'description': 'What was the actual recorded error budget consumed', 'type': 'number'}, 'service_downtime': {'description': 'What was the actual recorded service downtime', 'type': 'number'}, 'unplanned_outage_hours': {'description': 'What was the actual recorded unplanned outage hours', 'type': 'number'}, 'planned_maintenance_hours': {'description': 'What was the actual recorded planned maintenance hours', 'type': 'number'}, 'sev_1_outage_minutes': {'description': 'What was the actual recorded Sev-1 outage minutes', 'type': 'number'}, 'sev_2_outage_minutes': {'description': 'What was the actual recorded Sev-2 outage minutes', 'type': 'number'}, 'longest_single_outage': {'description': 'What was the actual recorded longest single outage', 'type': 'number'}, 'mtbft': {'description': 'What was the actual recorded mean time between failures', 'type': 'number'}}}, 'team_utilisation': {'description': 'Team utilisation for a given quarter', 'type': 'object', 'properties': {'end_of_quarter_it_headcount': {'description': 'What was the actual recorded end of quarter IT headcount', 'type': 'number'}, 'engineering_headcount': {'description': 'What was the actual recorded engineering headcount', 'type': 'number'}, 'on_call_coverage': {'description': 'What was the actual recorded on call coverage', 'type': 'number'}, 'project_work_allocation': {'description': 'What was the actual recorded project work allocation', 'type': 'number'}, 'bau_operations_allocation': {'description': 'What was the actual recorded BAU/Operations allocation', 'type': 'number'}, 'on_call_hours_per_engineer': {'description': 'What was the actual recorded on call hours per engineer', 'type': 'number'}, 'after_hours_incidents_handled': {'description': 'What was the actual recorded after hours incidents handled', 'type': 'number'}, 'training_hours_per_fte': {'description': 'What was the actual recorded training hours per FTE', 'type': 'number'}, 'certifications_earned': {'description': 'What was the actual recorded certifications earned', 'type': 'number'}, 'attrition': {'description': 'What was the actual recorded attrition', 'type': 'number'}}}, 'tool_licensing_spend': {'description': 'Tool licensing spend for a given quarter', 'type': 'object', 'properties': {'atlassian_spend': {'description': 'What was the actual spend on Atlassian licenses', 'type': 'number'}, 'github_spend': {'description': 'What was the actual spend on GitHub licenses', 'type': 'number'}, 'slack_spend': {'description': 'What was the actual spend on Slack licenses', 'type': 'number'}, 'pagerduty_spend': {'description': 'What was the actual spend on PagerDuty licenses', 'type': 'number'}, 'datadog_spend': {'description': 'What was the actual spend on Datadog licenses', 'type': 'number'}, 'sentry_spend': {'description': 'What was the actual spend on Sentry licenses', 'type': 'number'}, 'okta_spend': {'description': 'What was the actual spend on Okta licenses', 'type': 'number'}, 'aws_spend': {'description': 'What was the actual spend on AWS licenses', 'type': 'number'}, 'total_spend': {'description': 'What was the actual spend on total licenses', 'type': 'number'}}}}}}}}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m18:22:32.872179 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:22:38.624773 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 5.752 seconds
[0m18:22:38.629609 [info ] [Thread-2 (]: 2 of 2 OK created python table model bronze_zone.document_question_extracts .... [[32mSUCCESS 1[0m in 5.86s]
[0m18:22:38.631132 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m18:22:38.634241 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m18:22:38.634815 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m18:22:38.635378 [info ] [Dummy-1   ]: 
[0m18:22:38.635910 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 11.31 seconds (11.31s).
[0m18:22:38.637062 [debug] [Dummy-1   ]: Command end result
[0m18:22:38.689148 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:22:38.692142 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:22:38.700178 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m18:22:38.700769 [info ] [Dummy-1   ]: 
[0m18:22:38.701484 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m18:22:38.701986 [info ] [Dummy-1   ]: 
[0m18:22:38.702509 [info ] [Dummy-1   ]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:22:38.704406 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.410395, "process_in_blocks": "0", "process_kernel_time": 1.32, "process_mem_max_rss": "433776", "process_out_blocks": "0", "process_user_time": 7.21}
[0m18:22:38.705128 [debug] [Dummy-1   ]: Command `cli run` succeeded at 18:22:38.704850 after 14.41 seconds
[0m18:22:38.705691 [debug] [Dummy-1   ]: Flushing usage events


============================== 18:23:58.060363 | 6620eaae-94e4-4310-8eb9-4c0549ba0de0 ==============================
[0m18:23:58.060363 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m18:23:58.061589 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:23:58.461209 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m18:23:59.196587 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:23:59.652909 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:23:59.654312 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m18:24:00.739965 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:24:00.743309 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:24:00.970827 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m18:24:00.975024 [info ] [Dummy-1   ]: 
[0m18:24:00.975794 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m18:24:00.976376 [info ] [Dummy-1   ]: 
[0m18:24:00.977320 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m18:24:00.985077 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m18:24:01.133201 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m18:24:01.133904 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m18:24:01.134445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:02.104819 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.970 seconds
[0m18:24:02.110010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m18:24:02.133368 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:24:02.134061 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:24:02.134579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:03.130881 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.996 seconds
[0m18:24:03.137113 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:24:03.137802 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m18:24:03.284326 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.146 seconds
[0m18:24:03.287323 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:24:03.287992 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:24:03.377899 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m18:24:03.380732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_semantic_views)
[0m18:24:03.395302 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:24:03.395968 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:24:03.396477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:04.483977 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.087 seconds
[0m18:24:04.486574 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:24:04.487251 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m18:24:04.641453 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.153 seconds
[0m18:24:04.643962 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:24:04.644590 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:24:04.821359 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.176 seconds
[0m18:24:04.823940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_bronze_zone)
[0m18:24:04.835091 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:24:04.835803 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:24:04.836311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:05.876652 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.040 seconds
[0m18:24:05.879361 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:24:05.880003 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m18:24:06.048413 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.168 seconds
[0m18:24:06.051298 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:24:06.051901 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:24:06.187273 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.134 seconds
[0m18:24:06.198888 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m18:24:06.199919 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m18:24:06.200757 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m18:24:06.201388 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m18:24:06.221574 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m18:24:06.222584 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m18:24:06.283959 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m18:24:06.285967 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m18:24:06.286729 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE METADATA$ACTION != 'DELETE'
and relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m18:24:06.287429 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:24:07.708139 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.420 seconds
[0m18:24:07.744927 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.54s]
[0m18:24:07.745990 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m18:24:07.748335 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m18:24:07.749732 [info ] [Thread-2 (]: 2 of 2 START sql table model bronze_zone.document_full_extracts ................ [RUN]
[0m18:24:07.750581 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_full_extracts)
[0m18:24:07.751247 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m18:24:07.766915 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m18:24:07.767865 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m18:24:07.809052 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.document_full_extracts"
[0m18:24:07.811799 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_full_extracts"
[0m18:24:07.812634 [debug] [Thread-2 (]: On model.incident_management.document_full_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_full_extracts"} */
create or replace transient table incident_management.bronze_zone.document_full_extracts
         as
        (

with 
documents_raw_extracts as(
    select
        * exclude (METADATA$ACTION, METADATA$ISUPDATE, METADATA$ROW_ID) ,
        AI_PARSE_DOCUMENT (
            TO_FILE('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS',relative_path),
             {
                'mode': 'LAYOUT'
                ,'page_split': True
             }
        ) as raw_extracts
        FROM incident_management.bronze_zone.v_qualify_new_documents
        WHERE lower(doc_type) = 'full'
),
documents_chunked_extracts as
(
    select 
    og1.* exclude (raw_extracts),
    SNOWFLAKE.CORTEX.SPLIT_TEXT_MARKDOWN_HEADER(
        lf1.value:content::STRING,
        OBJECT_CONSTRUCT('#', 'header_1', '##', 'header_2'),
        500,
        5
    ) as page_chunks,
    lf1.index::int as page_num
    from documents_raw_extracts og1,
    LATERAL FLATTEN(input => raw_extracts:pages) lf1
)

select 
    og2.* exclude (page_chunks), 
    lf2.value['chunk']::varchar as chunk,
    lf2.value['headers']::object as headers
from documents_chunked_extracts og2,
lateral flatten(input => page_chunks) lf2
        );
[0m18:24:07.813314 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:24:24.332309 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 16.519 seconds
[0m18:24:24.336069 [info ] [Thread-2 (]: 2 of 2 OK created sql table model bronze_zone.document_full_extracts ........... [[32mSUCCESS 1[0m in 16.59s]
[0m18:24:24.337080 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m18:24:24.341082 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m18:24:24.341686 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_full_extracts' was properly closed.
[0m18:24:24.342231 [info ] [Dummy-1   ]: 
[0m18:24:24.342772 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 23.37 seconds (23.37s).
[0m18:24:24.344025 [debug] [Dummy-1   ]: Command end result
[0m18:24:24.396954 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:24:24.400100 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:24:24.408107 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m18:24:24.408767 [info ] [Dummy-1   ]: 
[0m18:24:24.409490 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m18:24:24.409982 [info ] [Dummy-1   ]: 
[0m18:24:24.410514 [info ] [Dummy-1   ]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:24:24.412394 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.455605, "process_in_blocks": "0", "process_kernel_time": 1.34, "process_mem_max_rss": "440092", "process_out_blocks": "0", "process_user_time": 7.24}
[0m18:24:24.413096 [debug] [Dummy-1   ]: Command `cli run` succeeded at 18:24:24.412818 after 26.46 seconds
[0m18:24:24.413675 [debug] [Dummy-1   ]: Flushing usage events


============================== 18:25:32.867405 | 8c2196f8-fcef-49aa-a0ba-e096fb2ab9bc ==============================
[0m18:25:32.867405 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m18:25:32.868581 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m18:25:33.254533 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m18:25:34.041788 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:25:34.504323 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:25:34.505001 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m18:25:34.725068 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:25:34.728030 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:25:34.791260 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m18:25:34.794654 [info ] [Dummy-1   ]: 
[0m18:25:34.795326 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m18:25:34.795803 [info ] [Dummy-1   ]: 
[0m18:25:34.796686 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m18:25:34.804511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m18:25:34.953438 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m18:25:34.954188 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m18:25:34.954727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:35.687630 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.733 seconds
[0m18:25:35.710142 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m18:25:35.733550 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:25:35.734307 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:25:35.734860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:36.432572 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.697 seconds
[0m18:25:36.438692 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:25:36.439389 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m18:25:36.533052 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.093 seconds
[0m18:25:36.535925 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:25:36.536595 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:25:36.695137 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.158 seconds
[0m18:25:36.697802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_semantic_views)
[0m18:25:36.712782 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:25:36.713497 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:25:36.714127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:37.370720 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.656 seconds
[0m18:25:37.373235 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:25:37.373924 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m18:25:37.455777 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.081 seconds
[0m18:25:37.458194 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:25:37.458956 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:25:37.539032 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.079 seconds
[0m18:25:37.541484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_bronze_zone)
[0m18:25:37.552357 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:25:37.553105 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:25:37.553728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:38.276328 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.722 seconds
[0m18:25:38.278888 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:25:38.279524 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m18:25:38.387441 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.107 seconds
[0m18:25:38.390529 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:25:38.391171 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:25:38.464471 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.073 seconds
[0m18:25:38.475784 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m18:25:38.476724 [info ] [Thread-2 (]: 1 of 5 START sql incremental model bronze_zone.users ........................... [RUN]
[0m18:25:38.477489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m18:25:38.478093 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m18:25:38.497940 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m18:25:38.499002 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m18:25:38.578321 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m18:25:38.579274 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
create or replace  temporary view incident_management.bronze_zone.users__dbt_tmp
  
   as (
    

select 
    sm.MEMBERIDS[0] as id,
    sm.memberemails[0] as email,
    split(sm.memberemails[0], '@')[0] as first_name,
    split(sm.memberemails[0], '@')[1] as last_name,
    'reporter' as role,
    '' as department,
    '' as team,
    true as is_active,
    current_timestamp() as created_at,
    current_timestamp() as updated_at
from incident_management.bronze_zone.slack_members sm
  );
[0m18:25:38.579925 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:25:39.469369 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.889 seconds
[0m18:25:39.489690 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m18:25:39.490472 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
describe table incident_management.bronze_zone.users__dbt_tmp
[0m18:25:39.560386 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.069 seconds
[0m18:25:39.573132 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m18:25:39.573849 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
describe table incident_management.bronze_zone.users
[0m18:25:39.658218 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.084 seconds
[0m18:25:39.678645 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m18:25:39.679390 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
describe table "INCIDENT_MANAGEMENT"."BRONZE_ZONE"."USERS"
[0m18:25:39.750529 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.070 seconds
[0m18:25:39.853199 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.users"
[0m18:25:39.855461 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m18:25:39.856093 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
-- back compat for old kwarg name
  
  begin;
[0m18:25:39.980890 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m18:25:39.981669 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m18:25:39.982423 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
merge into incident_management.bronze_zone.users as DBT_INTERNAL_DEST
        using incident_management.bronze_zone.users__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.email = DBT_INTERNAL_DEST.email))

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","EMAIL" = DBT_INTERNAL_SOURCE."EMAIL","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","ROLE" = DBT_INTERNAL_SOURCE."ROLE","DEPARTMENT" = DBT_INTERNAL_SOURCE."DEPARTMENT","TEAM" = DBT_INTERNAL_SOURCE."TEAM","IS_ACTIVE" = DBT_INTERNAL_SOURCE."IS_ACTIVE","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("ID", "EMAIL", "FIRST_NAME", "LAST_NAME", "ROLE", "DEPARTMENT", "TEAM", "IS_ACTIVE", "CREATED_AT", "UPDATED_AT")
    values
        ("ID", "EMAIL", "FIRST_NAME", "LAST_NAME", "ROLE", "DEPARTMENT", "TEAM", "IS_ACTIVE", "CREATED_AT", "UPDATED_AT")

;
[0m18:25:40.737465 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.754 seconds
[0m18:25:40.738334 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m18:25:40.739073 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
COMMIT
[0m18:25:41.031392 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m18:25:41.052061 [debug] [Thread-2 (]: Applying DROP to: incident_management.bronze_zone.users__dbt_tmp
[0m18:25:41.073434 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m18:25:41.074189 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
drop view if exists incident_management.bronze_zone.users__dbt_tmp cascade
[0m18:25:41.176238 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m18:25:41.208600 [info ] [Thread-2 (]: 1 of 5 OK created sql incremental model bronze_zone.users ...................... [[32mSUCCESS 0[0m in 2.73s]
[0m18:25:41.209694 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m18:25:41.210899 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m18:25:41.211901 [info ] [Thread-2 (]: 2 of 5 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m18:25:41.212670 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m18:25:41.213240 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m18:25:41.225136 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m18:25:41.226058 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m18:25:41.255006 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m18:25:41.256878 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m18:25:41.257596 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'slack'
    end as doc_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE METADATA$ACTION != 'DELETE'
and relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m18:25:41.258267 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:25:42.218237 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.960 seconds
[0m18:25:42.227640 [info ] [Thread-2 (]: 2 of 5 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.01s]
[0m18:25:42.228729 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m18:25:42.229837 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m18:25:42.231144 [info ] [Thread-2 (]: 3 of 5 START sql view model bronze_zone.v_qualify_slack_messages ............... [RUN]
[0m18:25:42.231929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m18:25:42.232507 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m18:25:42.246076 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m18:25:42.247016 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m18:25:42.258196 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_slack_messages"
[0m18:25:42.262655 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_slack_messages"
[0m18:25:42.263759 [debug] [Thread-2 (]: On model.incident_management.v_qualify_slack_messages: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_slack_messages"} */
create or replace   view incident_management.bronze_zone.v_qualify_slack_messages
  
   as (
    

-- Only propagate messages from known reporters (users in channel)
with slack_messages_from_known_reporters as (
    select sm.*, r.id as reporter_id
    from incident_management.bronze_zone.slack_messages sm
    inner join incident_management.bronze_zone.users r on sm.username = split(r.email, '@')[0]
    where sm.clientmsgid is not null
    and to_date(sm.ingestts) >= to_date(current_timestamp())
)

-- Messages with attachments (with join to doc_metadata)
select 
    true as hasfiles,
    sm.type,
    sm.subtype,
    sm.team,
    sm.channel,
    sm.user,
    sm.username,
    sm.reporter_id,
    sm.text,
    sm.ts,
    sm.clientmsgid as slack_message_id,
    
    -- Attachment metadata from doc_metadata
    dm.file_id,
    dm.file_name, 
    dm.file_mimetype, 
    dm.file_size, 
    dm.staged_file_path,
    to_file('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', dm.staged_file_path) as attachment_file,
    case 
        -- When there is an attachment file and it is an image, use the image to extract the incident code
        when dm.staged_file_path is not null and fl_is_image(to_file('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', dm.staged_file_path)) then 
        ai_complete('claude-3-5-sonnet',
            prompt(
            $$
            Find the incident number that may be present either in the image {0} or in the text {1}. 
            Use the one in the image if found.Look for alphanumeric codes preceded by the keyword 'incident' (case-insensitive). 
            Examples: INC-12345, incident_001, INC-2025-001.
            Respond only in JSON format with a single key called 'incident_code'.
            Do not add any explanation in the response.
            $$, 
            attachment_file,
            text
            )
        )
        else null
    end as incident_number

from slack_messages_from_known_reporters sm
inner join incident_management.bronze_zone.doc_metadata dm 
on (sm.hasfiles and (sm.channel = dm.channel_id) and (sm.ts = dm.event_ts))

UNION ALL

-- Messages without attachments (no join to doc_metadata)
select 
    false as hasfiles,
    sm.type,
    sm.subtype,
    sm.team,
    sm.channel,
    sm.user,
    sm.username,
    sm.reporter_id,
    sm.text,
    sm.ts,
    sm.clientmsgid as slack_message_id,
    
    -- No attachment metadata for messages without files
    null as file_id,
    null as file_name, 
    null as file_mimetype, 
    null as file_size, 
    null as staged_file_path,
    null as attachment_file,
    case 
        -- Only use text to extract the incident code since there are no attachments
        when sm.text is not null then ai_complete('claude-3-5-sonnet',
                prompt(
                $$
                Extract incident codes from Slack text {0}. 
                Look for alphanumeric codes preceded by the keyword 'incident' (case-insensitive). 
                Examples: INC-12345, incident_001, INC-2025-001.
                Respond only in JSON format with a single key called 'incident_code'.
                Do not add any explanation in the response.
                $$, 
                text
            )
        )
        else null
    end as incident_number

from slack_messages_from_known_reporters sm
where not sm.hasfiles or sm.hasfiles is null
  );
[0m18:25:42.264685 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:25:43.257044 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.992 seconds
[0m18:25:43.260850 [info ] [Thread-2 (]: 3 of 5 OK created sql view model bronze_zone.v_qualify_slack_messages .......... [[32mSUCCESS 1[0m in 1.03s]
[0m18:25:43.261848 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m18:25:43.262998 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m18:25:43.263966 [info ] [Thread-2 (]: 4 of 5 START sql table model bronze_zone.document_full_extracts ................ [RUN]
[0m18:25:43.264725 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now model.incident_management.document_full_extracts)
[0m18:25:43.265306 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m18:25:43.278811 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m18:25:43.279782 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m18:25:43.320569 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.document_full_extracts"
[0m18:25:43.323311 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_full_extracts"
[0m18:25:43.324148 [debug] [Thread-2 (]: On model.incident_management.document_full_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_full_extracts"} */
create or replace transient table incident_management.bronze_zone.document_full_extracts
         as
        (

with 
documents_raw_extracts as(
    select
        * exclude (METADATA$ACTION, METADATA$ISUPDATE, METADATA$ROW_ID) ,
        AI_PARSE_DOCUMENT (
            TO_FILE('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS',relative_path),
             {
                'mode': 'LAYOUT'
                ,'page_split': True
             }
        ) as raw_extracts
        FROM incident_management.bronze_zone.v_qualify_new_documents
        WHERE lower(doc_type) = 'full'
),
documents_chunked_extracts as
(
    select 
    og1.* exclude (raw_extracts),
    SNOWFLAKE.CORTEX.SPLIT_TEXT_MARKDOWN_HEADER(
        lf1.value:content::STRING,
        OBJECT_CONSTRUCT('#', 'header_1', '##', 'header_2'),
        500,
        5
    ) as page_chunks,
    lf1.index::int as page_num
    from documents_raw_extracts og1,
    LATERAL FLATTEN(input => raw_extracts:pages) lf1
)

select 
    og2.* exclude (page_chunks), 
    lf2.value['chunk']::varchar as chunk,
    lf2.value['headers']::object as headers
from documents_chunked_extracts og2,
lateral flatten(input => page_chunks) lf2
        );
[0m18:25:43.324807 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:25:44.861449 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.536 seconds
[0m18:25:44.864957 [info ] [Thread-2 (]: 4 of 5 OK created sql table model bronze_zone.document_full_extracts ........... [[32mSUCCESS 1[0m in 1.60s]
[0m18:25:44.865928 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m18:25:44.867538 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m18:25:44.869030 [info ] [Thread-2 (]: 5 of 5 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m18:25:44.869818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m18:25:44.870871 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m18:25:44.911357 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m18:25:44.912827 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m18:25:44.927724 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m18:25:44.934062 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m18:25:44.936382 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session

    
def model(dbt, session: Session):

    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    docs_stage = dbt.config.get("docs_stage_path")

    all_meta = dbt.config.get("meta")
    
    reponse_schema = {
        'schema': {
            'type': 'object',
            'properties': {}
        }
    }
    
    for key in all_meta.keys():
        if all_meta[key]['enabled']:
            reponse_schema['schema']['properties'][key] = all_meta[key]['schema']['properties']

    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.lower(F.col('doc_type')) == 'question'
    ).drop(
        "METADATA$ACTION",
        "METADATA$ISUPDATE",
        "METADATA$ROW_ID"
    )
    
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}'), F.col('relative_path')),
            reponse_schema
        )
    ) 
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'docs_stage_path': '@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', 'meta': {'global_inm_policy_schema': {'enabled': False, 'schema': {'type': 'object', 'properties': {'purpose': {'description': 'Purpose of this policy', 'type': 'string'}, 'objectives': {'description': 'Objectives achieved by this policy', 'type': 'string'}, 'policy_statement': {'description': 'Primary policy statement', 'type': 'string'}, 'in_scope_services': {'description': 'Services explicitly in scope', 'type': 'array'}, 'out_of_scope_services': {'description': 'Services explicitly out of scope', 'type': 'array'}, 'geographical_coverage': {'description': 'Countries/regions covered', 'type': 'array'}, 'business_units_in_scope': {'description': 'Business units covered by the policy', 'type': 'array'}, 'applicability_conditions': {'description': 'Conditions determining when policy applies', 'type': 'array'}, 'exclusions': {'description': 'Explicit exceptions to scope', 'type': 'array'}, 'definitions_and_glossary': {'description': 'Terms, acronyms, and reference standards', 'type': 'object', 'properties': {'defined_terms': {'description': 'Key defined terms', 'type': 'array'}, 'acronyms': {'description': 'Acronyms used within the document', 'type': 'array'}, 'reference_standards': {'description': 'Referenced standards and frameworks', 'type': 'array'}}}}}}, 'quaterly_review_metrics': {'enabled': True, 'schema': {'type': 'object', 'properties': {'quarter': {'description': 'What is the year and quarter of the review metrics?', 'type': 'string'}, 'service_operational_health': {'description': 'Service operational health for a given quarter', 'type': 'object', 'properties': {'overall_uptime': {'description': 'What was the actual recorded overall uptime of all services', 'type': 'number'}, 'critical_services_uptime': {'description': 'What was the actual recorded  uptime of critical services', 'type': 'number'}, 'sev_1_incidents': {'description': 'What were the actual recorded number of Sev-1 incidents', 'type': 'number'}, 'sev_2_incidents': {'description': 'What were the actual recorded number of Sev-2 incidents', 'type': 'number'}, 'mtta': {'description': 'What was the actual recorded mean time to acknowledge an incident', 'type': 'number'}, 'mttr': {'description': 'What was the actual recorded mean time to recover from an incident', 'type': 'number'}, 'change_failure_rate': {'description': 'What was the actual recorded change failure rate', 'type': 'number'}, 'slo_breaches': {'description': 'What was the actual recorded number of SLO breaches', 'type': 'number'}, 'error_budget_consumed': {'description': 'What was the actual recorded error budget consumed', 'type': 'number'}, 'service_downtime': {'description': 'What was the actual recorded service downtime', 'type': 'number'}, 'unplanned_outage_hours': {'description': 'What was the actual recorded unplanned outage hours', 'type': 'number'}, 'planned_maintenance_hours': {'description': 'What was the actual recorded planned maintenance hours', 'type': 'number'}, 'sev_1_outage_minutes': {'description': 'What was the actual recorded Sev-1 outage minutes', 'type': 'number'}, 'sev_2_outage_minutes': {'description': 'What was the actual recorded Sev-2 outage minutes', 'type': 'number'}, 'longest_single_outage': {'description': 'What was the actual recorded longest single outage', 'type': 'number'}, 'mtbft': {'description': 'What was the actual recorded mean time between failures', 'type': 'number'}}}, 'team_utilisation': {'description': 'Team utilisation for a given quarter', 'type': 'object', 'properties': {'end_of_quarter_it_headcount': {'description': 'What was the actual recorded end of quarter IT headcount', 'type': 'number'}, 'engineering_headcount': {'description': 'What was the actual recorded engineering headcount', 'type': 'number'}, 'on_call_coverage': {'description': 'What was the actual recorded on call coverage', 'type': 'number'}, 'project_work_allocation': {'description': 'What was the actual recorded project work allocation', 'type': 'number'}, 'bau_operations_allocation': {'description': 'What was the actual recorded BAU/Operations allocation', 'type': 'number'}, 'on_call_hours_per_engineer': {'description': 'What was the actual recorded on call hours per engineer', 'type': 'number'}, 'after_hours_incidents_handled': {'description': 'What was the actual recorded after hours incidents handled', 'type': 'number'}, 'training_hours_per_fte': {'description': 'What was the actual recorded training hours per FTE', 'type': 'number'}, 'certifications_earned': {'description': 'What was the actual recorded certifications earned', 'type': 'number'}, 'attrition': {'description': 'What was the actual recorded attrition', 'type': 'number'}}}, 'tool_licensing_spend': {'description': 'Tool licensing spend for a given quarter', 'type': 'object', 'properties': {'atlassian_spend': {'description': 'What was the actual spend on Atlassian licenses', 'type': 'number'}, 'github_spend': {'description': 'What was the actual spend on GitHub licenses', 'type': 'number'}, 'slack_spend': {'description': 'What was the actual spend on Slack licenses', 'type': 'number'}, 'pagerduty_spend': {'description': 'What was the actual spend on PagerDuty licenses', 'type': 'number'}, 'datadog_spend': {'description': 'What was the actual spend on Datadog licenses', 'type': 'number'}, 'sentry_spend': {'description': 'What was the actual spend on Sentry licenses', 'type': 'number'}, 'okta_spend': {'description': 'What was the actual spend on Okta licenses', 'type': 'number'}, 'aws_spend': {'description': 'What was the actual spend on AWS licenses', 'type': 'number'}, 'total_spend': {'description': 'What was the actual spend on total licenses', 'type': 'number'}}}}}}}}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m18:25:44.938209 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:25:49.940629 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 5.002 seconds
[0m18:25:49.945352 [info ] [Thread-2 (]: 5 of 5 OK created python table model bronze_zone.document_question_extracts .... [[32mSUCCESS 1[0m in 5.07s]
[0m18:25:49.946861 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m18:25:49.950278 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m18:25:49.950875 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m18:25:49.951343 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m18:25:49.951985 [info ] [Dummy-1   ]: 
[0m18:25:49.952530 [info ] [Dummy-1   ]: Finished running 1 incremental model, 2 table models, 2 view models in 0 hours 0 minutes and 15.16 seconds (15.16s).
[0m18:25:49.954238 [debug] [Dummy-1   ]: Command end result
[0m18:25:50.156582 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:25:50.159715 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:25:50.168342 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m18:25:50.169073 [info ] [Dummy-1   ]: 
[0m18:25:50.169753 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m18:25:50.170294 [info ] [Dummy-1   ]: 
[0m18:25:50.170829 [info ] [Dummy-1   ]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:25:50.172833 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.404934, "process_in_blocks": "0", "process_kernel_time": 1.61, "process_mem_max_rss": "432120", "process_out_blocks": "0", "process_user_time": 6.59}
[0m18:25:50.173551 [debug] [Dummy-1   ]: Command `cli run` succeeded at 18:25:50.173267 after 17.41 seconds
[0m18:25:50.174142 [debug] [Dummy-1   ]: Flushing usage events


============================== 18:26:10.057740 | e50290a5-54e9-476f-a153-001cfd1e763d ==============================
[0m18:26:10.057740 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m18:26:10.058982 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m18:26:10.438925 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m18:26:11.202669 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:26:11.625486 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:26:11.626170 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m18:26:11.843971 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:26:11.846853 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:26:11.905887 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m18:26:11.909248 [info ] [Dummy-1   ]: 
[0m18:26:11.909933 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m18:26:11.910459 [info ] [Dummy-1   ]: 
[0m18:26:11.911382 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m18:26:11.930009 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m18:26:12.071451 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m18:26:12.072148 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m18:26:12.072716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:12.883107 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.810 seconds
[0m18:26:12.900210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_semantic_views'
[0m18:26:12.923578 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:26:12.924297 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:26:12.924843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:13.754469 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.829 seconds
[0m18:26:13.760432 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:26:13.761067 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m18:26:13.847590 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.086 seconds
[0m18:26:13.850116 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:26:13.850753 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:26:13.945378 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m18:26:13.947844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_bronze_zone)
[0m18:26:13.960349 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:26:13.960961 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:26:13.961466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:14.748931 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.787 seconds
[0m18:26:14.751418 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:26:14.752014 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m18:26:14.869164 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.116 seconds
[0m18:26:14.872022 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:26:14.872657 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:26:14.963342 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m18:26:14.966083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m18:26:14.980258 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:26:14.980916 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:26:14.981470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:15.813731 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.832 seconds
[0m18:26:15.816265 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:26:15.816881 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m18:26:15.930718 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.113 seconds
[0m18:26:15.933363 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:26:15.933929 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:26:16.033764 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m18:26:16.043610 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m18:26:16.044582 [info ] [Thread-2 (]: 1 of 6 START sql incremental model gold_zone.incidents ......................... [RUN]
[0m18:26:16.045370 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.incidents)
[0m18:26:16.045991 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m18:26:16.066667 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m18:26:16.067708 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m18:26:16.150800 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m18:26:16.152050 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
create or replace  temporary view incident_management.gold_zone.incidents__dbt_tmp
  
   as (
    -- Create only new incidents in this incremental mode; new incidents are detected by absence of an incident number from previous step in the pipeline or,
-- they are not related to any existing incident by title and text.


-- Get recent open incidents for lookback when incident_code is null
with 

recent_open_incidents as (
    select * from incident_management.gold_zone.incidents
    where lower(status) = 'open' 
    and reportee_id is not null
    and created_at > dateadd('day', -7, current_timestamp())
)

, new_slack_messages as (
    select lh.*
    from incident_management.bronze_zone.v_qualify_slack_messages lh 
    left join recent_open_incidents rh 
    on lh.slack_message_id = rh.slack_message_id
    where rh.slack_message_id is null
)

-- Split messages based on whether they have valid incident codes
, messages_with_incident_code as (
    select *
    from new_slack_messages
    where not IS_NULL_VALUE(parse_json(incident_number):incident_code)
)

, messages_without_incident_code as (
    select *
    from new_slack_messages
    where IS_NULL_VALUE(parse_json(incident_number):incident_code)
)

-- For messages without incident codes, try to find existing incidents
, messages_with_matching_incidents as (
    select 
        sm.*,
        ai_classify(sm.text, ['payment gateway error', 'login error', 'other']):labels[0] as text_category,
        roi.incident_number as existing_incident_number
    from messages_without_incident_code sm
    left join recent_open_incidents roi 
    on sm.channel = roi.external_source_id 
    and sm.username = roi.reportee_id 
    and ai_filter(
     prompt('The text category {0} is logically relatable to this record\'s category {1}', text_category, roi.category)
    )
)

-- Combine all messages with their appropriate incident numbers
, all_processed_messages as (
    -- Messages that already have incident codes
    select *, incident_number as final_incident_number
    from messages_with_incident_code
    
    union
    
    -- Messages without incident codes, use existing if found, otherwise generate new
    select 
        * exclude (existing_incident_number, text_category),
        coalesce(existing_incident_number, concat_ws('-', 'INC', '2025', randstr(3, random()))) as final_incident_number
    from messages_with_matching_incidents
)

, enriched_incidents as (
    select
        -- Core incident fields matching DDL schema
        case 
            when not IS_NULL_VALUE(parse_json(sri.incident_number):incident_code) then 
                parse_json(sri.incident_number):incident_code::string
            else sri.final_incident_number
        end as incident_number,        
        
        -- Image or Text Classification
        case 
            when sri.attachment_file is not null then 
                ai_classify(sri.attachment_file, ['payment gateway error', 'login error', 'other']):labels[0]
            else ai_classify(sri.text, ['payment gateway error', 'login error', 'other']):labels[0]
        end as category,
        ai_classify(sri.text, ['payment gateway error', 'login error', 'other']):labels[0] as title, 
        case 
            when category = 'payment gateway error' then 'critical'
            when category = 'login error' then 'high'
            else 'low'
        end as priority,
        
        -- Status tracking
        'open' as status,
        
        -- People involved
        '' as assignee_id,
        sri.reporter_id as reportee_id,
        
        -- Timestamps
        sri.ts as created_at,
        null as closed_at,
        sri.ts as updated_at,
        
        -- System fields
        'Slack' as source_system,
        sri.channel as external_source_id,
        sri.hasfiles as has_attachments,
        sri.slack_message_id,
        
        -- Latest comment
        sri.text as last_comment

        
    from all_processed_messages sri
)

select * 
from enriched_incidents
  );
[0m18:26:16.152944 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:26:19.128738 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.975 seconds
[0m18:26:19.148512 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m18:26:19.149248 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
describe table incident_management.gold_zone.incidents__dbt_tmp
[0m18:26:19.247710 [debug] [Thread-2 (]: SQL status: SUCCESS 15 in 0.098 seconds
[0m18:26:19.260705 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m18:26:19.261400 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
describe table incident_management.gold_zone.incidents
[0m18:26:19.351971 [debug] [Thread-2 (]: SQL status: SUCCESS 15 in 0.090 seconds
[0m18:26:19.372569 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m18:26:19.373276 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
describe table "INCIDENT_MANAGEMENT"."GOLD_ZONE"."INCIDENTS"
[0m18:26:19.454880 [debug] [Thread-2 (]: SQL status: SUCCESS 15 in 0.081 seconds
[0m18:26:19.557708 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.incidents"
[0m18:26:19.559983 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m18:26:19.560635 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
-- back compat for old kwarg name
  
  begin;
[0m18:26:19.701837 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m18:26:19.702573 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m18:26:19.703279 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
merge into incident_management.gold_zone.incidents as DBT_INTERNAL_DEST
        using incident_management.gold_zone.incidents__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.incident_number = DBT_INTERNAL_DEST.incident_number))

    
    when matched then update set
        updated_at = DBT_INTERNAL_SOURCE.updated_at,slack_message_id = DBT_INTERNAL_SOURCE.slack_message_id,last_comment = DBT_INTERNAL_SOURCE.last_comment
    

    when not matched then insert
        ("INCIDENT_NUMBER", "TITLE", "CATEGORY", "PRIORITY", "STATUS", "ASSIGNEE_ID", "REPORTEE_ID", "CREATED_AT", "CLOSED_AT", "UPDATED_AT", "SOURCE_SYSTEM", "EXTERNAL_SOURCE_ID", "HAS_ATTACHMENTS", "SLACK_MESSAGE_ID", "LAST_COMMENT")
    values
        ("INCIDENT_NUMBER", "TITLE", "CATEGORY", "PRIORITY", "STATUS", "ASSIGNEE_ID", "REPORTEE_ID", "CREATED_AT", "CLOSED_AT", "UPDATED_AT", "SOURCE_SYSTEM", "EXTERNAL_SOURCE_ID", "HAS_ATTACHMENTS", "SLACK_MESSAGE_ID", "LAST_COMMENT")

;
[0m18:26:22.859619 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 3.155 seconds
[0m18:26:22.860481 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m18:26:22.861073 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
COMMIT
[0m18:26:23.030900 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m18:26:23.053715 [debug] [Thread-2 (]: Applying DROP to: incident_management.gold_zone.incidents__dbt_tmp
[0m18:26:23.075460 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incidents"
[0m18:26:23.076188 [debug] [Thread-2 (]: On model.incident_management.incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incidents"} */
drop view if exists incident_management.gold_zone.incidents__dbt_tmp cascade
[0m18:26:23.194567 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m18:26:23.225818 [info ] [Thread-2 (]: 1 of 6 OK created sql incremental model gold_zone.incidents .................... [[32mSUCCESS 0[0m in 7.18s]
[0m18:26:23.226893 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m18:26:23.229164 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m18:26:23.230271 [info ] [Thread-2 (]: 2 of 6 START sql table model gold_zone.active_incidents ........................ [RUN]
[0m18:26:23.231104 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m18:26:23.231704 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m18:26:23.244332 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m18:26:23.245281 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m18:26:23.287421 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.active_incidents"
[0m18:26:23.289881 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.active_incidents"
[0m18:26:23.290649 [debug] [Thread-2 (]: On model.incident_management.active_incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.active_incidents"} */
create or replace transient table incident_management.gold_zone.active_incidents
         as
        (

SELECT 
    i.incident_number,
    i.title,
    i.category,
    i.priority,
    i.status,
    i.assignee_id,
    CONCAT(assignee.first_name, ' ', assignee.last_name) AS assignee_name,
    i.reportee_id,
    CONCAT(reportee.first_name, ' ', reportee.last_name) AS reportee_name,
    i.created_at,
    i.updated_at,
    DATEDIFF('hour', i.created_at, CURRENT_TIMESTAMP()) AS age_hours,
    i.source_system,
    i.external_source_id,
    i.has_attachments
FROM incident_management.gold_zone.incidents i
LEFT JOIN incident_management.bronze_zone.users assignee ON i.assignee_id = assignee.id
LEFT JOIN incident_management.bronze_zone.users reportee ON i.reportee_id = reportee.id
WHERE i.status = 'open'
        );
[0m18:26:23.291295 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:26:24.543450 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.252 seconds
[0m18:26:24.550755 [info ] [Thread-2 (]: 2 of 6 OK created sql table model gold_zone.active_incidents ................... [[32mSUCCESS 1[0m in 1.32s]
[0m18:26:24.551735 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m18:26:24.552884 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m18:26:24.553800 [info ] [Thread-2 (]: 3 of 6 START sql table model gold_zone.closed_incidents ........................ [RUN]
[0m18:26:24.554498 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m18:26:24.555087 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m18:26:24.566875 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m18:26:24.567761 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m18:26:24.578799 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.closed_incidents"
[0m18:26:24.580919 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.closed_incidents"
[0m18:26:24.581622 [debug] [Thread-2 (]: On model.incident_management.closed_incidents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.closed_incidents"} */
create or replace transient table incident_management.gold_zone.closed_incidents
         as
        (

SELECT 
    i.incident_number,
    i.title,
    i.category,
    i.priority,
    i.status,
    i.assignee_id,
    i.reportee_id,
    
    -- Timeline fields (only available DDL fields)
    i.created_at,
    i.closed_at,
    i.updated_at,
    
    -- System information
    i.source_system,
    i.external_source_id,
    i.has_attachments,
    
    -- Resolution metrics (simplified)
    DATEDIFF('minute', i.created_at, i.closed_at) / 60.0 AS total_resolution_hours,
    
    -- Month/Year for trending
    DATE_TRUNC('month', i.closed_at) AS closed_month,
    EXTRACT(year FROM i.closed_at) AS closed_year,
    EXTRACT(quarter FROM i.closed_at) AS closed_quarter

FROM incident_management.gold_zone.incidents i
WHERE LOWER(i.status) IN ('closed', 'resolved') AND i.closed_at IS NOT NULL
        );
[0m18:26:24.582219 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:26:26.112054 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.530 seconds
[0m18:26:26.115529 [info ] [Thread-2 (]: 3 of 6 OK created sql table model gold_zone.closed_incidents ................... [[32mSUCCESS 1[0m in 1.56s]
[0m18:26:26.116479 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m18:26:26.117643 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m18:26:26.118661 [info ] [Thread-2 (]: 4 of 6 START sql incremental model gold_zone.incident_attachments .............. [RUN]
[0m18:26:26.119421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m18:26:26.119987 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m18:26:26.132796 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m18:26:26.133706 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m18:26:26.145860 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m18:26:26.146580 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
create or replace  temporary view incident_management.gold_zone.incident_attachments__dbt_tmp
  
   as (
    

select 
    dm.file_id as id,
    i.incident_number,
    to_file('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', dm.staged_file_path) as attachment_file,
    dm.event_ts as uploaded_at
from incident_management.gold_zone.incidents i
inner join incident_management.bronze_zone.doc_metadata dm 
on i.has_attachments 
and i.reportee_id = dm.user_id 
and i.external_source_id = dm.channel_id
and i.created_at = dm.event_ts
  );
[0m18:26:26.147186 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:26:27.128697 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.981 seconds
[0m18:26:27.275024 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m18:26:27.275749 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
describe table incident_management.gold_zone.incident_attachments__dbt_tmp
[0m18:26:27.366421 [debug] [Thread-2 (]: SQL status: SUCCESS 4 in 0.090 seconds
[0m18:26:27.378450 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m18:26:27.379184 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
describe table incident_management.gold_zone.incident_attachments
[0m18:26:27.453613 [debug] [Thread-2 (]: SQL status: SUCCESS 4 in 0.074 seconds
[0m18:26:27.467511 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m18:26:27.468235 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
describe table "INCIDENT_MANAGEMENT"."GOLD_ZONE"."INCIDENT_ATTACHMENTS"
[0m18:26:27.553735 [debug] [Thread-2 (]: SQL status: SUCCESS 4 in 0.085 seconds
[0m18:26:27.557163 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.incident_attachments"
[0m18:26:27.559220 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m18:26:27.559891 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
-- back compat for old kwarg name
  
  begin;
[0m18:26:27.715083 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m18:26:27.715867 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m18:26:27.716555 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
merge into incident_management.gold_zone.incident_attachments as DBT_INTERNAL_DEST
        using incident_management.gold_zone.incident_attachments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DEST.id
                )

    
    when matched then update set
        uploaded_at = DBT_INTERNAL_SOURCE.uploaded_at,attachment_file = DBT_INTERNAL_SOURCE.attachment_file
    

    when not matched then insert
        ("ID", "INCIDENT_NUMBER", "ATTACHMENT_FILE", "UPLOADED_AT")
    values
        ("ID", "INCIDENT_NUMBER", "ATTACHMENT_FILE", "UPLOADED_AT")

;
[0m18:26:28.437776 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.720 seconds
[0m18:26:28.438721 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m18:26:28.439377 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
COMMIT
[0m18:26:28.603331 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m18:26:28.615266 [debug] [Thread-2 (]: Applying DROP to: incident_management.gold_zone.incident_attachments__dbt_tmp
[0m18:26:28.616904 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_attachments"
[0m18:26:28.617530 [debug] [Thread-2 (]: On model.incident_management.incident_attachments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_attachments"} */
drop view if exists incident_management.gold_zone.incident_attachments__dbt_tmp cascade
[0m18:26:28.760028 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m18:26:28.763530 [info ] [Thread-2 (]: 4 of 6 OK created sql incremental model gold_zone.incident_attachments ......... [[32mSUCCESS 0[0m in 2.64s]
[0m18:26:28.764506 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m18:26:28.765681 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m18:26:28.766574 [info ] [Thread-2 (]: 5 of 6 START sql incremental model gold_zone.incident_comment_history .......... [RUN]
[0m18:26:28.767320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m18:26:28.767919 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m18:26:28.787264 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m18:26:28.788177 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m18:26:28.800679 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m18:26:28.801423 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
create or replace  temporary view incident_management.gold_zone.incident_comment_history__dbt_tmp
  
   as (
    

select 
    slack_message_id as id,
    i.incident_number,
    i.reportee_id as author_id,
    i.last_comment as content,
    current_timestamp() as created_at
from incident_management.gold_zone.incidents i


where i.updated_at > (select coalesce(max(created_at), dateadd('day', -1, current_timestamp())) from incident_management.gold_zone.incident_comment_history)
and i.updated_at >= dateadd('day', -1, current_timestamp())
and i.status = 'open'

  );
[0m18:26:28.802019 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:26:29.779263 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.977 seconds
[0m18:26:29.792147 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m18:26:29.792849 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
describe table incident_management.gold_zone.incident_comment_history__dbt_tmp
[0m18:26:29.887385 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.094 seconds
[0m18:26:29.899525 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m18:26:29.900234 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
describe table incident_management.gold_zone.incident_comment_history
[0m18:26:29.978930 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.078 seconds
[0m18:26:29.990791 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m18:26:29.991516 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
describe table "INCIDENT_MANAGEMENT"."GOLD_ZONE"."INCIDENT_COMMENT_HISTORY"
[0m18:26:30.112114 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.120 seconds
[0m18:26:30.115646 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.incident_comment_history"
[0m18:26:30.117716 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m18:26:30.118346 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
-- back compat for old kwarg name
  
  begin;
[0m18:26:30.253780 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m18:26:30.254565 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m18:26:30.255276 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
merge into incident_management.gold_zone.incident_comment_history as DBT_INTERNAL_DEST
        using incident_management.gold_zone.incident_comment_history__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DEST.id
                )

    
    when matched then update set
        created_at = DBT_INTERNAL_SOURCE.created_at,content = DBT_INTERNAL_SOURCE.content,author_id = DBT_INTERNAL_SOURCE.author_id,incident_number = DBT_INTERNAL_SOURCE.incident_number
    

    when not matched then insert
        ("ID", "INCIDENT_NUMBER", "AUTHOR_ID", "CONTENT", "CREATED_AT")
    values
        ("ID", "INCIDENT_NUMBER", "AUTHOR_ID", "CONTENT", "CREATED_AT")

;
[0m18:26:30.469918 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.214 seconds
[0m18:26:30.470750 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m18:26:30.471373 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
COMMIT
[0m18:26:30.592898 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m18:26:30.606591 [debug] [Thread-2 (]: Applying DROP to: incident_management.gold_zone.incident_comment_history__dbt_tmp
[0m18:26:30.608287 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.incident_comment_history"
[0m18:26:30.609029 [debug] [Thread-2 (]: On model.incident_management.incident_comment_history: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.incident_comment_history"} */
drop view if exists incident_management.gold_zone.incident_comment_history__dbt_tmp cascade
[0m18:26:30.758575 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m18:26:30.762025 [info ] [Thread-2 (]: 5 of 6 OK created sql incremental model gold_zone.incident_comment_history ..... [[32mSUCCESS 0[0m in 1.99s]
[0m18:26:30.762999 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m18:26:30.764211 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m18:26:30.765112 [info ] [Thread-2 (]: 6 of 6 START sql table model gold_zone.weekly_incident_trends .................. [RUN]
[0m18:26:30.765829 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.weekly_incident_trends)
[0m18:26:30.766400 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m18:26:30.778279 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m18:26:30.779294 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m18:26:30.791805 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.weekly_incident_trends"
[0m18:26:30.795133 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.weekly_incident_trends"
[0m18:26:30.795989 [debug] [Thread-2 (]: On model.incident_management.weekly_incident_trends: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.weekly_incident_trends"} */
create or replace transient table incident_management.gold_zone.weekly_incident_trends
         as
        (

SELECT 
    DATE_TRUNC('week', created_at) AS week,
    COUNT(*) AS total_incidents,
    COUNT(CASE WHEN status = 'resolved' THEN 1 END) AS resolved_incidents,
    COUNT(CASE WHEN status = 'closed' THEN 1 END) AS closed_incidents,
    COUNT(CASE WHEN status = 'open' THEN 1 END) AS open_incidents,
    COUNT(CASE WHEN priority = 'critical' THEN 1 END) AS critical_incidents,
    COUNT(CASE WHEN priority = 'high' THEN 1 END) AS high_incidents,
    COUNT(CASE WHEN priority IN ('critical', 'high') THEN 1 END) AS high_severity_incidents,
    
    -- Category breakdown
    COUNT(CASE WHEN category = 'payment' THEN 1 END) AS payment_incidents,
    COUNT(CASE WHEN category = 'authentication' THEN 1 END) AS authentication_incidents,
    COUNT(CASE WHEN category = 'performance' THEN 1 END) AS performance_incidents,
    COUNT(CASE WHEN category = 'security' THEN 1 END) AS security_incidents,
    
    -- Source system breakdown
    COUNT(CASE WHEN source_system = 'monitoring' THEN 1 END) AS monitoring_incidents,
    COUNT(CASE WHEN source_system = 'customer_portal' THEN 1 END) AS customer_portal_incidents,
    
    -- Average resolution time for closed incidents (in hours)
    AVG(
        CASE 
            WHEN closed_at IS NOT NULL 
            THEN DATEDIFF('hour', created_at, closed_at)
            ELSE NULL 
        END
    ) AS avg_resolution_time_hours,
    
    -- Incidents with attachments
    COUNT(CASE WHEN has_attachments = true THEN 1 END) AS incidents_with_attachments,
    
    -- Resolution rate percentage
    ROUND(
        (COUNT(CASE WHEN status IN ('resolved', 'closed') THEN 1 END)::DECIMAL / COUNT(*)) * 100, 2
    ) AS resolution_rate_percentage
FROM incident_management.gold_zone.incidents
WHERE created_at >= DATEADD('year', -1, CURRENT_DATE())
GROUP BY DATE_TRUNC('week', created_at)
ORDER BY week DESC
        );
[0m18:26:30.796716 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:26:32.240473 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.444 seconds
[0m18:26:32.243985 [info ] [Thread-2 (]: 6 of 6 OK created sql table model gold_zone.weekly_incident_trends ............. [[32mSUCCESS 1[0m in 1.48s]
[0m18:26:32.244940 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m18:26:32.247865 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m18:26:32.248567 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m18:26:32.249057 [debug] [Dummy-1   ]: Connection 'model.incident_management.weekly_incident_trends' was properly closed.
[0m18:26:32.249697 [info ] [Dummy-1   ]: 
[0m18:26:32.250233 [info ] [Dummy-1   ]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 20.34 seconds (20.34s).
[0m18:26:32.252070 [debug] [Dummy-1   ]: Command end result
[0m18:26:32.303171 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:26:32.305962 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:26:32.314451 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m18:26:32.315069 [info ] [Dummy-1   ]: 
[0m18:26:32.315759 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m18:26:32.316261 [info ] [Dummy-1   ]: 
[0m18:26:32.316786 [info ] [Dummy-1   ]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:26:32.318716 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.358442, "process_in_blocks": "0", "process_kernel_time": 1.48, "process_mem_max_rss": "437112", "process_out_blocks": "0", "process_user_time": 6.65}
[0m18:26:32.319453 [debug] [Dummy-1   ]: Command `cli run` succeeded at 18:26:32.319167 after 22.36 seconds
[0m18:26:32.320012 [debug] [Dummy-1   ]: Flushing usage events


============================== 18:26:59.097366 | 22af05b5-124d-4dcc-ab61-4797dcb02410 ==============================
[0m18:26:59.097366 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m18:26:59.098609 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:26:59.485236 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m18:27:00.285226 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:27:00.740553 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:27:00.741220 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m18:27:00.963805 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:27:00.966745 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:27:01.028660 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m18:27:01.031807 [info ] [Dummy-1   ]: 
[0m18:27:01.032476 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m18:27:01.033005 [info ] [Dummy-1   ]: 
[0m18:27:01.033955 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m18:27:01.060915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m18:27:01.207763 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m18:27:01.208543 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m18:27:01.209212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:01.923396 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.714 seconds
[0m18:27:01.934890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m18:27:01.957658 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:27:01.958555 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:27:01.959155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:02.624687 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.665 seconds
[0m18:27:02.630749 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:27:02.631574 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m18:27:02.742900 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.111 seconds
[0m18:27:02.745820 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:27:02.746520 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:27:02.872697 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.125 seconds
[0m18:27:02.875513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m18:27:02.892164 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:27:02.892822 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:27:02.893342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:03.536211 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.643 seconds
[0m18:27:03.538793 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:27:03.539438 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m18:27:03.628812 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.089 seconds
[0m18:27:03.631616 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:27:03.632250 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:27:03.704320 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.071 seconds
[0m18:27:03.706973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_semantic_views)
[0m18:27:03.720396 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:27:03.721067 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:27:03.721577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:04.302658 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.581 seconds
[0m18:27:04.305155 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:27:04.305752 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m18:27:04.377110 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.071 seconds
[0m18:27:04.379585 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:27:04.380177 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:27:04.493210 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m18:27:04.501595 [debug] [Thread-2 (]: Began running node model.incident_management.alpha
[0m18:27:04.502589 [info ] [Thread-2 (]: 1 of 1 START sql semantic_view model semantic_views.alpha ...................... [RUN]
[0m18:27:04.503383 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now model.incident_management.alpha)
[0m18:27:04.503977 [debug] [Thread-2 (]: Began compiling node model.incident_management.alpha
[0m18:27:04.527336 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.alpha"
[0m18:27:04.528339 [debug] [Thread-2 (]: Began executing node model.incident_management.alpha
[0m18:27:04.559439 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.alpha"
[0m18:27:04.575549 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.alpha"
[0m18:27:04.577875 [debug] [Thread-2 (]: On model.incident_management.alpha: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.alpha"} */
create or replace semantic view incident_management.semantic_views.alpha
  

TABLES(
  full_doc_extracts as incident_management.bronze_zone.document_full_extracts
    COMMENT = 'All policy documents'
  , users as incident_management.bronze_zone.users
    COMMENT = 'Materialized users table with enriched data'
  , v_slack_msgs as incident_management.bronze_zone.v_qualify_slack_messages
    COMMENT = 'Qualified Slack messages from known reporters with optional attachment metadata and extracted incident number'
  , incidents as incident_management.gold_zone.incidents
    COMMENT = 'Materialized incidents table with enriched data and calculated fields'
  , active_incidents as incident_management.gold_zone.active_incidents
    COMMENT = 'Active incidents requiring attention with SLA status and priority ordering'
  , closed_incidents as incident_management.gold_zone.closed_incidents
    COMMENT = 'Closed incidents with resolution metrics and performance insights'
  , incident_attachments as incident_management.gold_zone.incident_attachments
    COMMENT = 'Materialized incident attachments table'
  , incident_comment_history as incident_management.gold_zone.incident_comment_history
    COMMENT = 'Simplified incident comment history for tracking communication'
  , weekly_incident_trends as incident_management.gold_zone.weekly_incident_trends
    COMMENT = 'Weekly incident trends for the last 12 weeks'

)

FACTS (
    full_doc_extracts.size AS size
      COMMENT = 'Size of the file in bytes'
      
    , full_doc_extracts.page_num AS page_num
      COMMENT = 'Source page number for the extracted content'
      
    , v_slack_msgs.file_size AS file_size
      COMMENT = 'Attachment file size'

    , active_incidents.age_hours AS age_hours
      COMMENT = 'Age of incident in hours'

    , closed_incidents.total_resolution_hours AS total_resolution_hours
      COMMENT = 'Total time from creation to closure in hours'
    , closed_incidents.closed_year AS closed_year
      COMMENT = 'Year when the incident was closed'
    , closed_incidents.closed_quarter AS closed_quarter
      COMMENT = 'Quarter when the incident was closed'

    , weekly_incident_trends.total_incidents AS total_incidents
      COMMENT = 'Total incidents created in the week'
    , weekly_incident_trends.resolved_incidents AS resolved_incidents
      COMMENT = 'Incidents resolved in the week'
    , weekly_incident_trends.closed_incidents AS closed_incidents
      COMMENT = 'Incidents closed in the week'
    , weekly_incident_trends.open_incidents AS open_incidents
      COMMENT = 'Incidents open in the week'
    , weekly_incident_trends.critical_incidents AS critical_incidents
      COMMENT = 'Incidents with critical priority'
    , weekly_incident_trends.high_incidents AS high_incidents
      COMMENT = 'Incidents with high priority'
    , weekly_incident_trends.high_severity_incidents AS high_severity_incidents
      COMMENT = 'Incidents with critical or high priority'
    , weekly_incident_trends.payment_incidents AS payment_incidents
      COMMENT = 'Payment category incidents'
    , weekly_incident_trends.authentication_incidents AS authentication_incidents
      COMMENT = 'Authentication category incidents'
    , weekly_incident_trends.performance_incidents AS performance_incidents
      COMMENT = 'Performance category incidents'
    , weekly_incident_trends.security_incidents AS security_incidents
      COMMENT = 'Security category incidents'
    , weekly_incident_trends.monitoring_incidents AS monitoring_incidents
      COMMENT = 'Incidents from monitoring source system'
    , weekly_incident_trends.customer_portal_incidents AS customer_portal_incidents
      COMMENT = 'Incidents from customer portal source system'
    , weekly_incident_trends.avg_resolution_time_hours AS avg_resolution_time_hours
      COMMENT = 'Average resolution time in hours'
    , weekly_incident_trends.incidents_with_attachments AS incidents_with_attachments
      COMMENT = 'Incidents that had attachments'
    , weekly_incident_trends.resolution_rate_percentage AS resolution_rate_percentage
      COMMENT = 'Share of resolved/closed incidents as a percentage'
 )

 DIMENSIONS (
    full_doc_extracts.relative_path as relative_path
      COMMENT = 'Path to the file on the stage'
    , full_doc_extracts.last_modified AS last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    , full_doc_extracts.md5 AS md5
      COMMENT = 'MD5 checksum for the file'
    ,full_doc_extracts.etag AS etag
      COMMENT = 'ETag header for the file'
    , full_doc_extracts.file_url AS file_url
      WITH SYNONYMS = ('file url', 'snowflake file url')
      COMMENT = 'Snowflake file URL to the file'
    ,full_doc_extracts.doc_type AS doc_type
      WITH SYNONYMS = ('document type', 'doc type', 'analysis type')
      COMMENT = 'Type of document classification (e.g., ''full'', ''question'', ''slack'')'
    ,full_doc_extracts.extension AS extension
      WITH SYNONYMS = ('extension', 'file extension')
      COMMENT = 'File extension parsed from the path'
    ,full_doc_extracts.chunk AS chunk
      WITH SYNONYMS = ('chunk', 'text')
      COMMENT = 'Markdown/text chunk content extracted from the document pages'
    ,full_doc_extracts.headers AS headers
      WITH SYNONYMS = ('headers', 'detected headers')
      COMMENT = 'Object of detected headers for the chunk (e.g., header_1, header_2)'

    , users.id AS id
      COMMENT = 'Unique user identifier'
    , users.email AS email
      COMMENT = 'Primary email address'
    ,users.first_name AS first_name
      COMMENT = 'First name parsed from email user part'
    ,users.last_name AS last_name
      COMMENT = 'Last name parsed from email domain part'
    ,users.role AS role
      COMMENT = 'User role'
    ,users.department AS user_department
      COMMENT = 'User department'
    ,users.team AS team
      COMMENT = 'User team'
    , users.is_active AS is_active
      COMMENT = 'Active flag'
    , users.created_at AS created_at
      COMMENT = 'Creation timestamp'
    , users.updated_at AS updated_at
      COMMENT = 'Last update timestamp'

    , v_slack_msgs.hasfiles AS hasfiles
      COMMENT = 'Whether the message has attachments'
    , v_slack_msgs.type AS slack_type
      COMMENT = 'Slack message type'
    , v_slack_msgs.subtype AS slack_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_msgs.team AS slack_team
      COMMENT = 'Slack team identifier'
    , v_slack_msgs.channel AS slack_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_msgs.user AS slack_user
      COMMENT = 'Slack user identifier'
    , v_slack_msgs.username AS slack_username
      COMMENT = 'Slack username'
    , v_slack_msgs.reporter_id AS slack_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_msgs.text AS slack_text
      COMMENT = 'Slack message text'
    , v_slack_msgs.ts AS slack_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_msgs.slack_message_id AS slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_msgs.file_id AS slack_file_id
      COMMENT = 'Attachment file id'
    , v_slack_msgs.file_name AS slack_file_name
      COMMENT = 'Attachment file name'
    , v_slack_msgs.file_mimetype AS slack_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_msgs.staged_file_path AS slack_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_msgs.attachment_file AS slack_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_msgs.incident_number AS slack_incident_number
      COMMENT = 'Extracted incident number from image or text'


    , incidents.incident_number AS incident_number
      COMMENT = 'Incident identifier'
    , incidents.category AS incident_category
      COMMENT = 'Incident category'
    , incidents.title AS incident_title
      COMMENT = 'Incident title'
    , incidents.priority AS incident_priority
      COMMENT = 'Incident priority'
    , incidents.status AS incident_status
      COMMENT = 'Incident status'
    , incidents.assignee_id AS incident_assignee_id
      COMMENT = 'Assignee user id'
    , incidents.reportee_id AS incident_reportee_id
      COMMENT = 'Reportee user id'
    , incidents.created_at AS incident_created_at
      COMMENT = 'Creation timestamp'
    , incidents.closed_at AS incident_closed_at
      COMMENT = 'Close timestamp'
    , incidents.updated_at AS incident_updated_at
      COMMENT = 'Last update timestamp'
    , incidents.source_system AS incident_source_system
      COMMENT = 'Source system for the incident'
    ,incidents.external_source_id AS incident_external_source_id
      COMMENT = 'External source identifier'
    , incidents.has_attachments AS incident_has_attachments
      COMMENT = 'Whether the incident has attachments'
    , incidents.slack_message_id AS incident_slack_message_id
      COMMENT = 'Associated Slack message id'
    , incidents.last_comment AS incident_last_comment
      COMMENT = 'Latest comment content'

    , active_incidents.incident_number AS active_incident_number
      COMMENT = 'Incident identifier'
    , active_incidents.title AS active_incident_title
      COMMENT = 'Incident title'
    , active_incidents.category AS active_incident_category
      COMMENT = 'Incident category'
    , active_incidents.priority AS active_incident_priority
      COMMENT = 'Incident priority'
    , active_incidents.status AS active_incident_status
      COMMENT = 'Incident status'
    , active_incidents.assignee_id AS active_incident_assignee_id
      COMMENT = 'Assignee user id'
    , active_incidents.assignee_name AS active_incident_assignee_name
      COMMENT = 'Assignee full name'
    , active_incidents.reportee_id AS active_incident_reportee_id
      COMMENT = 'Reportee user id'
    , active_incidents.reportee_name AS active_incident_reportee_name
      COMMENT = 'Reportee full name'
    , active_incidents.created_at AS active_incident_created_at
      COMMENT = 'Creation timestamp'
    , active_incidents.updated_at AS active_incident_updated_at
      COMMENT = 'Last update timestamp'
    , active_incidents.source_system AS active_incident_source_system
      COMMENT = 'Source system for the incident'
    , active_incidents.external_source_id AS active_incident_external_source_id
      COMMENT = 'External source identifier'
    , active_incidents.has_attachments AS active_incident_has_attachments
      COMMENT = 'Whether the incident has attachments'

    , closed_incidents.incident_number AS closed_incident_number
      COMMENT = 'Incident identifier'
    , closed_incidents.title AS closed_incident_title
      COMMENT = 'Incident title'
    , closed_incidents.category AS closed_incident_category
      COMMENT = 'Incident category'
    , closed_incidents.priority AS closed_incident_priority
      COMMENT = 'Incident priority'
    , closed_incidents.status AS closed_incident_status
      COMMENT = 'Incident status'
    , closed_incidents.assignee_id AS closed_incident_assignee_id
      COMMENT = 'Assignee user id'
    , closed_incidents.reportee_id AS closed_incident_reportee_id
      COMMENT = 'Reportee user id'
    , closed_incidents.created_at AS closed_incident_created_at
      COMMENT = 'Creation timestamp'
    , closed_incidents.closed_at AS closed_incident_closed_at
      COMMENT = 'Close timestamp'
    , closed_incidents.updated_at AS closed_incident_updated_at
      COMMENT = 'Last update timestamp'
    , closed_incidents.source_system AS closed_incident_source_system
      COMMENT = 'Source system for the incident'
    , closed_incidents.external_source_id AS closed_incident_external_source_id
      COMMENT = 'External source identifier'
    , closed_incidents.has_attachments AS closed_incident_has_attachments
      COMMENT = 'Whether the incident had attachments'
    , closed_incidents.closed_month AS closed_incident_month
      COMMENT = 'Month when incident was closed'

    , incident_attachments.id AS attachment_id
      COMMENT = 'Attachment id'
    , incident_attachments.incident_number AS attachment_incident_number
      COMMENT = 'Incident identifier'
    , incident_attachments.attachment_file AS attachment_file
      COMMENT = 'Stage file reference for the attachment'
    , incident_attachments.uploaded_at AS attachment_uploaded_at
      COMMENT = 'Attachment upload timestamp'

    , incident_comment_history.id AS comment_id
      COMMENT = 'Comment id'
    , incident_comment_history.incident_number AS comment_incident_number
      COMMENT = 'Incident identifier'
    , incident_comment_history.author_id AS comment_author_id
      COMMENT = 'Comment author user id'
    ,  incident_comment_history.content AS comment_content
      COMMENT = 'Comment content'
    , incident_comment_history.created_at AS comment_created_at
      COMMENT = 'Comment creation timestamp'
    , weekly_incident_trends.week AS trend_week
      COMMENT = 'Week bucket (date truncated to week)'
  )
[0m18:27:04.579515 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:27:05.466401 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c049d3-0106-f0aa-0032-31870547fb36
[0m18:27:05.467176 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 115 at position 25
invalid identifier 'USER_DEPARTMENT'
[0m18:27:05.473379 [debug] [Thread-2 (]: Database Error in model alpha (models/semantic_views/alpha.sql)
  000904 (42000): SQL compilation error: error line 115 at position 25
  invalid identifier 'USER_DEPARTMENT'
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m18:27:05.476854 [error] [Thread-2 (]: 1 of 1 ERROR creating sql semantic_view model semantic_views.alpha ............. [[31mERROR[0m in 0.97s]
[0m18:27:05.477842 [debug] [Thread-2 (]: Finished running node model.incident_management.alpha
[0m18:27:05.479224 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.alpha' to be skipped because of status 'error'.  Reason: Database Error in model alpha (models/semantic_views/alpha.sql)
  000904 (42000): SQL compilation error: error line 115 at position 25
  invalid identifier 'USER_DEPARTMENT'
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql.
[0m18:27:05.482587 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m18:27:05.483141 [debug] [Dummy-1   ]: Connection 'model.incident_management.alpha' was properly closed.
[0m18:27:05.483651 [info ] [Dummy-1   ]: 
[0m18:27:05.484174 [info ] [Dummy-1   ]: Finished running 1 semantic view model in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m18:27:05.485153 [debug] [Dummy-1   ]: Command end result
[0m18:27:05.536860 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:27:05.539678 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:27:05.547801 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m18:27:05.548418 [info ] [Dummy-1   ]: 
[0m18:27:05.549123 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:27:05.549638 [info ] [Dummy-1   ]: 
[0m18:27:05.550404 [error] [Dummy-1   ]:   Database Error in model alpha (models/semantic_views/alpha.sql)
  000904 (42000): SQL compilation error: error line 115 at position 25
  invalid identifier 'USER_DEPARTMENT'
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m18:27:05.550921 [info ] [Dummy-1   ]: 
[0m18:27:05.551442 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:27:05.553300 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.5553737, "process_in_blocks": "0", "process_kernel_time": 1.44, "process_mem_max_rss": "433864", "process_out_blocks": "0", "process_user_time": 5.91}
[0m18:27:05.554022 [debug] [Dummy-1   ]: Command `cli run` failed at 18:27:05.553720 after 6.56 seconds
[0m18:27:05.554601 [debug] [Dummy-1   ]: Flushing usage events


============================== 18:27:34.472120 | de6b2ee0-7535-4620-bf02-bc2e31371605 ==============================
[0m18:27:34.472120 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m18:27:34.473296 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m18:27:34.853963 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m18:27:35.609618 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:27:36.034155 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:36.035276 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/semantic_views/alpha.sql
[0m18:27:36.725720 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:27:36.728813 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:27:36.786666 [info ] [Dummy-1   ]: Found 12 models, 31 data tests, 6 sources, 483 macros
[0m18:27:36.789804 [info ] [Dummy-1   ]: 
[0m18:27:36.790479 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m18:27:36.791025 [info ] [Dummy-1   ]: 
[0m18:27:36.791900 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m18:27:36.794104 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m18:27:36.954178 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m18:27:36.954876 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m18:27:36.955386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:37.844901 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.889 seconds
[0m18:27:37.855069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m18:27:37.879260 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:27:37.880014 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:27:37.880552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:38.818208 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.937 seconds
[0m18:27:38.824163 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:27:38.824857 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m18:27:38.919008 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.093 seconds
[0m18:27:38.921978 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m18:27:38.922675 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:27:39.025307 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m18:27:39.028063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_semantic_views)
[0m18:27:39.042134 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:27:39.042832 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:27:39.043357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:40.335531 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.292 seconds
[0m18:27:40.338170 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:27:40.338897 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
show objects in incident_management.semantic_views
    limit 10000
    
;
[0m18:27:40.408897 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.069 seconds
[0m18:27:40.411295 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_semantic_views"
[0m18:27:40.411858 [debug] [ThreadPool]: On list_incident_management_semantic_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_semantic_views"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:27:40.524947 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m18:27:40.527358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_semantic_views, now list_incident_management_gold_zone)
[0m18:27:40.539390 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:27:40.540020 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:27:40.540510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:41.303589 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.763 seconds
[0m18:27:41.306030 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:27:41.306626 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m18:27:41.404090 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.097 seconds
[0m18:27:41.406725 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m18:27:41.407301 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:27:41.486556 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.079 seconds
[0m18:27:41.496108 [debug] [Thread-2 (]: Began running node model.incident_management.alpha
[0m18:27:41.497050 [info ] [Thread-2 (]: 1 of 1 START sql semantic_view model semantic_views.alpha ...................... [RUN]
[0m18:27:41.497808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.alpha)
[0m18:27:41.498490 [debug] [Thread-2 (]: Began compiling node model.incident_management.alpha
[0m18:27:41.520113 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.alpha"
[0m18:27:41.521069 [debug] [Thread-2 (]: Began executing node model.incident_management.alpha
[0m18:27:41.683263 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.alpha"
[0m18:27:41.697675 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.alpha"
[0m18:27:41.700017 [debug] [Thread-2 (]: On model.incident_management.alpha: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.alpha"} */
create or replace semantic view incident_management.semantic_views.alpha
  

TABLES(
  full_doc_extracts as incident_management.bronze_zone.document_full_extracts
    COMMENT = 'All policy documents'
  , users as incident_management.bronze_zone.users
    COMMENT = 'Materialized users table with enriched data'
  , v_slack_msgs as incident_management.bronze_zone.v_qualify_slack_messages
    COMMENT = 'Qualified Slack messages from known reporters with optional attachment metadata and extracted incident number'
  , incidents as incident_management.gold_zone.incidents
    COMMENT = 'Materialized incidents table with enriched data and calculated fields'
  , active_incidents as incident_management.gold_zone.active_incidents
    COMMENT = 'Active incidents requiring attention with SLA status and priority ordering'
  , closed_incidents as incident_management.gold_zone.closed_incidents
    COMMENT = 'Closed incidents with resolution metrics and performance insights'
  , incident_attachments as incident_management.gold_zone.incident_attachments
    COMMENT = 'Materialized incident attachments table'
  , incident_comment_history as incident_management.gold_zone.incident_comment_history
    COMMENT = 'Simplified incident comment history for tracking communication'
  , weekly_incident_trends as incident_management.gold_zone.weekly_incident_trends
    COMMENT = 'Weekly incident trends for the last 12 weeks'

)

FACTS (
    full_doc_extracts.size AS size
      COMMENT = 'Size of the file in bytes'
      
    , full_doc_extracts.page_num AS page_num
      COMMENT = 'Source page number for the extracted content'
      
    , v_slack_msgs.file_size AS file_size
      COMMENT = 'Attachment file size'

    , active_incidents.age_hours AS age_hours
      COMMENT = 'Age of incident in hours'

    , closed_incidents.total_resolution_hours AS total_resolution_hours
      COMMENT = 'Total time from creation to closure in hours'
    , closed_incidents.closed_year AS closed_year
      COMMENT = 'Year when the incident was closed'
    , closed_incidents.closed_quarter AS closed_quarter
      COMMENT = 'Quarter when the incident was closed'

    , weekly_incident_trends.total_incidents AS total_incidents
      COMMENT = 'Total incidents created in the week'
    , weekly_incident_trends.resolved_incidents AS resolved_incidents
      COMMENT = 'Incidents resolved in the week'
    , weekly_incident_trends.closed_incidents AS closed_incidents
      COMMENT = 'Incidents closed in the week'
    , weekly_incident_trends.open_incidents AS open_incidents
      COMMENT = 'Incidents open in the week'
    , weekly_incident_trends.critical_incidents AS critical_incidents
      COMMENT = 'Incidents with critical priority'
    , weekly_incident_trends.high_incidents AS high_incidents
      COMMENT = 'Incidents with high priority'
    , weekly_incident_trends.high_severity_incidents AS high_severity_incidents
      COMMENT = 'Incidents with critical or high priority'
    , weekly_incident_trends.payment_incidents AS payment_incidents
      COMMENT = 'Payment category incidents'
    , weekly_incident_trends.authentication_incidents AS authentication_incidents
      COMMENT = 'Authentication category incidents'
    , weekly_incident_trends.performance_incidents AS performance_incidents
      COMMENT = 'Performance category incidents'
    , weekly_incident_trends.security_incidents AS security_incidents
      COMMENT = 'Security category incidents'
    , weekly_incident_trends.monitoring_incidents AS monitoring_incidents
      COMMENT = 'Incidents from monitoring source system'
    , weekly_incident_trends.customer_portal_incidents AS customer_portal_incidents
      COMMENT = 'Incidents from customer portal source system'
    , weekly_incident_trends.avg_resolution_time_hours AS avg_resolution_time_hours
      COMMENT = 'Average resolution time in hours'
    , weekly_incident_trends.incidents_with_attachments AS incidents_with_attachments
      COMMENT = 'Incidents that had attachments'
    , weekly_incident_trends.resolution_rate_percentage AS resolution_rate_percentage
      COMMENT = 'Share of resolved/closed incidents as a percentage'
 )

 DIMENSIONS (
    full_doc_extracts.relative_path as relative_path
      COMMENT = 'Path to the file on the stage'
    , full_doc_extracts.last_modified AS last_modified
      COMMENT = 'Timestamp when the file was last updated in the stage'
    , full_doc_extracts.md5 AS md5
      COMMENT = 'MD5 checksum for the file'
    ,full_doc_extracts.etag AS etag
      COMMENT = 'ETag header for the file'
    , full_doc_extracts.file_url AS file_url
      WITH SYNONYMS = ('file url', 'snowflake file url')
      COMMENT = 'Snowflake file URL to the file'
    ,full_doc_extracts.doc_type AS doc_type
      WITH SYNONYMS = ('document type', 'doc type', 'analysis type')
      COMMENT = 'Type of document classification (e.g., ''full'', ''question'', ''slack'')'
    ,full_doc_extracts.extension AS extension
      WITH SYNONYMS = ('extension', 'file extension')
      COMMENT = 'File extension parsed from the path'
    ,full_doc_extracts.chunk AS chunk
      WITH SYNONYMS = ('chunk', 'text')
      COMMENT = 'Markdown/text chunk content extracted from the document pages'
    ,full_doc_extracts.headers AS headers
      WITH SYNONYMS = ('headers', 'detected headers')
      COMMENT = 'Object of detected headers for the chunk (e.g., header_1, header_2)'

    , users.id AS id
      COMMENT = 'Unique user identifier'
    , users.email AS email
      COMMENT = 'Primary email address'
    ,users.first_name AS first_name
      COMMENT = 'First name parsed from email user part'
    ,users.last_name AS last_name
      COMMENT = 'Last name parsed from email domain part'
    ,users.role AS role
      COMMENT = 'User role'
    ,users.team AS team
      COMMENT = 'User team'
    , users.is_active AS is_active
      COMMENT = 'Active flag'
    , users.created_at AS created_at
      COMMENT = 'Creation timestamp'
    , users.updated_at AS updated_at
      COMMENT = 'Last update timestamp'

    , v_slack_msgs.hasfiles AS hasfiles
      COMMENT = 'Whether the message has attachments'
    , v_slack_msgs.type AS slack_type
      COMMENT = 'Slack message type'
    , v_slack_msgs.subtype AS slack_subtype
      COMMENT = 'Slack message subtype'
    , v_slack_msgs.team AS slack_team
      COMMENT = 'Slack team identifier'
    , v_slack_msgs.channel AS slack_channel
      COMMENT = 'Slack channel identifier'
    , v_slack_msgs.user AS slack_user
      COMMENT = 'Slack user identifier'
    , v_slack_msgs.username AS slack_username
      COMMENT = 'Slack username'
    , v_slack_msgs.reporter_id AS slack_reporter_id
      COMMENT = 'Matched reporter id from users'
    , v_slack_msgs.text AS slack_text
      COMMENT = 'Slack message text'
    , v_slack_msgs.ts AS slack_ts
      COMMENT = 'Slack message timestamp'
    , v_slack_msgs.slack_message_id AS slack_message_id
      COMMENT = 'Unique Slack message id'
    , v_slack_msgs.file_id AS slack_file_id
      COMMENT = 'Attachment file id'
    , v_slack_msgs.file_name AS slack_file_name
      COMMENT = 'Attachment file name'
    , v_slack_msgs.file_mimetype AS slack_file_mimetype
      COMMENT = 'Attachment file mimetype'
    , v_slack_msgs.staged_file_path AS slack_staged_file_path
      COMMENT = 'Path to staged file'
    , v_slack_msgs.attachment_file AS slack_attachment_file
      COMMENT = 'Stage file reference'
    , v_slack_msgs.incident_number AS slack_incident_number
      COMMENT = 'Extracted incident number from image or text'


    , incidents.incident_number AS incident_number
      COMMENT = 'Incident identifier'
    , incidents.category AS incident_category
      COMMENT = 'Incident category'
    , incidents.title AS incident_title
      COMMENT = 'Incident title'
    , incidents.priority AS incident_priority
      COMMENT = 'Incident priority'
    , incidents.status AS incident_status
      COMMENT = 'Incident status'
    , incidents.assignee_id AS incident_assignee_id
      COMMENT = 'Assignee user id'
    , incidents.reportee_id AS incident_reportee_id
      COMMENT = 'Reportee user id'
    , incidents.created_at AS incident_created_at
      COMMENT = 'Creation timestamp'
    , incidents.closed_at AS incident_closed_at
      COMMENT = 'Close timestamp'
    , incidents.updated_at AS incident_updated_at
      COMMENT = 'Last update timestamp'
    , incidents.source_system AS incident_source_system
      COMMENT = 'Source system for the incident'
    ,incidents.external_source_id AS incident_external_source_id
      COMMENT = 'External source identifier'
    , incidents.has_attachments AS incident_has_attachments
      COMMENT = 'Whether the incident has attachments'
    , incidents.slack_message_id AS incident_slack_message_id
      COMMENT = 'Associated Slack message id'
    , incidents.last_comment AS incident_last_comment
      COMMENT = 'Latest comment content'

    , active_incidents.incident_number AS active_incident_number
      COMMENT = 'Incident identifier'
    , active_incidents.title AS active_incident_title
      COMMENT = 'Incident title'
    , active_incidents.category AS active_incident_category
      COMMENT = 'Incident category'
    , active_incidents.priority AS active_incident_priority
      COMMENT = 'Incident priority'
    , active_incidents.status AS active_incident_status
      COMMENT = 'Incident status'
    , active_incidents.assignee_id AS active_incident_assignee_id
      COMMENT = 'Assignee user id'
    , active_incidents.assignee_name AS active_incident_assignee_name
      COMMENT = 'Assignee full name'
    , active_incidents.reportee_id AS active_incident_reportee_id
      COMMENT = 'Reportee user id'
    , active_incidents.reportee_name AS active_incident_reportee_name
      COMMENT = 'Reportee full name'
    , active_incidents.created_at AS active_incident_created_at
      COMMENT = 'Creation timestamp'
    , active_incidents.updated_at AS active_incident_updated_at
      COMMENT = 'Last update timestamp'
    , active_incidents.source_system AS active_incident_source_system
      COMMENT = 'Source system for the incident'
    , active_incidents.external_source_id AS active_incident_external_source_id
      COMMENT = 'External source identifier'
    , active_incidents.has_attachments AS active_incident_has_attachments
      COMMENT = 'Whether the incident has attachments'

    , closed_incidents.incident_number AS closed_incident_number
      COMMENT = 'Incident identifier'
    , closed_incidents.title AS closed_incident_title
      COMMENT = 'Incident title'
    , closed_incidents.category AS closed_incident_category
      COMMENT = 'Incident category'
    , closed_incidents.priority AS closed_incident_priority
      COMMENT = 'Incident priority'
    , closed_incidents.status AS closed_incident_status
      COMMENT = 'Incident status'
    , closed_incidents.assignee_id AS closed_incident_assignee_id
      COMMENT = 'Assignee user id'
    , closed_incidents.reportee_id AS closed_incident_reportee_id
      COMMENT = 'Reportee user id'
    , closed_incidents.created_at AS closed_incident_created_at
      COMMENT = 'Creation timestamp'
    , closed_incidents.closed_at AS closed_incident_closed_at
      COMMENT = 'Close timestamp'
    , closed_incidents.updated_at AS closed_incident_updated_at
      COMMENT = 'Last update timestamp'
    , closed_incidents.source_system AS closed_incident_source_system
      COMMENT = 'Source system for the incident'
    , closed_incidents.external_source_id AS closed_incident_external_source_id
      COMMENT = 'External source identifier'
    , closed_incidents.has_attachments AS closed_incident_has_attachments
      COMMENT = 'Whether the incident had attachments'
    , closed_incidents.closed_month AS closed_incident_month
      COMMENT = 'Month when incident was closed'

    , incident_attachments.id AS attachment_id
      COMMENT = 'Attachment id'
    , incident_attachments.incident_number AS attachment_incident_number
      COMMENT = 'Incident identifier'
    , incident_attachments.attachment_file AS attachment_file
      COMMENT = 'Stage file reference for the attachment'
    , incident_attachments.uploaded_at AS attachment_uploaded_at
      COMMENT = 'Attachment upload timestamp'

    , incident_comment_history.id AS comment_id
      COMMENT = 'Comment id'
    , incident_comment_history.incident_number AS comment_incident_number
      COMMENT = 'Incident identifier'
    , incident_comment_history.author_id AS comment_author_id
      COMMENT = 'Comment author user id'
    ,  incident_comment_history.content AS comment_content
      COMMENT = 'Comment content'
    , incident_comment_history.created_at AS comment_created_at
      COMMENT = 'Comment creation timestamp'
    , weekly_incident_trends.week AS trend_week
      COMMENT = 'Week bucket (date truncated to week)'
  )
[0m18:27:41.701537 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:27:42.597632 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c049d3-0106-f548-0032-318705488816
[0m18:27:42.598418 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 142 at position 25
invalid identifier 'SLACK_TS'
[0m18:27:42.604081 [debug] [Thread-2 (]: Database Error in model alpha (models/semantic_views/alpha.sql)
  000904 (42000): SQL compilation error: error line 142 at position 25
  invalid identifier 'SLACK_TS'
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m18:27:42.607572 [error] [Thread-2 (]: 1 of 1 ERROR creating sql semantic_view model semantic_views.alpha ............. [[31mERROR[0m in 1.11s]
[0m18:27:42.608644 [debug] [Thread-2 (]: Finished running node model.incident_management.alpha
[0m18:27:42.609997 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.alpha' to be skipped because of status 'error'.  Reason: Database Error in model alpha (models/semantic_views/alpha.sql)
  000904 (42000): SQL compilation error: error line 142 at position 25
  invalid identifier 'SLACK_TS'
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql.
[0m18:27:42.613354 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m18:27:42.613889 [debug] [Dummy-1   ]: Connection 'model.incident_management.alpha' was properly closed.
[0m18:27:42.614424 [info ] [Dummy-1   ]: 
[0m18:27:42.614938 [info ] [Dummy-1   ]: Finished running 1 semantic view model in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m18:27:42.615880 [debug] [Dummy-1   ]: Command end result
[0m18:27:42.667297 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m18:27:42.670403 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m18:27:42.678520 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m18:27:42.679122 [info ] [Dummy-1   ]: 
[0m18:27:42.679764 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:27:42.680275 [info ] [Dummy-1   ]: 
[0m18:27:42.681069 [error] [Dummy-1   ]:   Database Error in model alpha (models/semantic_views/alpha.sql)
  000904 (42000): SQL compilation error: error line 142 at position 25
  invalid identifier 'SLACK_TS'
  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/alpha.sql
[0m18:27:42.681612 [info ] [Dummy-1   ]: 
[0m18:27:42.682224 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:27:42.684105 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.309379, "process_in_blocks": "0", "process_kernel_time": 1.47, "process_mem_max_rss": "487956", "process_out_blocks": "0", "process_user_time": 6.22}
[0m18:27:42.684776 [debug] [Dummy-1   ]: Command `cli run` failed at 18:27:42.684512 after 8.31 seconds
[0m18:27:42.685329 [debug] [Dummy-1   ]: Flushing usage events
