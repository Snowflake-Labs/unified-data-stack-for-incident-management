

============================== 15:12:43.328561 | 990a1491-bcb3-4689-9c5d-87f79ae688bc ==============================
[0m15:12:43.328561 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:12:43.329860 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m15:12:43.590120 [debug] [Dummy-1   ]: Set downloads directory='/tmp/dbt-downloads-bo4ptyy0'
[0m15:12:43.591132 [debug] [Dummy-1   ]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:12:43.812464 [debug] [Dummy-1   ]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:12:43.813629 [debug] [Dummy-1   ]: Making package registry request: GET https://hub.getdbt.com/api/v1/Snowflake-Labs/dbt_semantic_view.json
[0m15:12:43.997128 [debug] [Dummy-1   ]: Response from registry: GET https://hub.getdbt.com/api/v1/Snowflake-Labs/dbt_semantic_view.json 200
[0m15:12:44.006803 [info ] [Dummy-1   ]: Updating lock file in file path: /tmp/dbt/package-lock.yml
[0m15:12:44.009509 [debug] [Dummy-1   ]: Set downloads directory='/tmp/dbt-downloads-r77in6nx'
[0m15:12:44.011039 [info ] [Dummy-1   ]: Installing Snowflake-Labs/dbt_semantic_view
[0m15:12:44.436574 [info ] [Dummy-1   ]: Installed from version 1.0.3
[0m15:12:44.437188 [info ] [Dummy-1   ]: Up to date!
[0m15:12:44.439662 [debug] [Dummy-1   ]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2150646, "process_in_blocks": "0", "process_kernel_time": 0.89, "process_mem_max_rss": "397856", "process_out_blocks": "0", "process_user_time": 4.26}
[0m15:12:44.440431 [debug] [Dummy-1   ]: Command `cli deps` succeeded at 15:12:44.440140 after 1.22 seconds
[0m15:12:44.440993 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:13:13.401174 | 2aafbc4a-2eb5-4575-89dd-50053985e220 ==============================
[0m15:13:13.401174 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:13:13.402285 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:13:13.472329 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:13:13.781498 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:13:14.525265 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:13:14.527006 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:13:16.966174 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.v_qualify_slack_messages' (models/bronze_zone/v_qualify_slack_messages.sql) depends on a source named 'bronze_zone.users' which was not found
[0m15:13:16.968433 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.6631558, "process_in_blocks": "0", "process_kernel_time": 1.47, "process_mem_max_rss": "456992", "process_out_blocks": "0", "process_user_time": 6.8}
[0m15:13:16.969237 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:13:16.968947 after 3.66 seconds
[0m15:13:16.969934 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:15:24.179284 | 00f90ef4-f8b3-4e3d-b1f2-b287fead49cb ==============================
[0m15:15:24.179284 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:15:24.180378 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:15:24.251213 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:15:24.558549 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:15:25.302669 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:15:25.304461 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:15:27.729003 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.v_qualify_slack_messages' (models/bronze_zone/v_qualify_slack_messages.sql) depends on a source named 'bronze_zone.users' which was not found
[0m15:15:27.731287 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.6493266, "process_in_blocks": "0", "process_kernel_time": 1.21, "process_mem_max_rss": "450348", "process_out_blocks": "0", "process_user_time": 6.87}
[0m15:15:27.732076 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:15:27.731783 after 3.65 seconds
[0m15:15:27.732732 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:19:15.642255 | b93fb2b6-6f83-4390-9f6e-d07fa0cb660a ==============================
[0m15:19:15.642255 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:19:15.643573 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:19:15.719257 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:19:16.045839 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:19:16.820878 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:19:16.822329 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:19:18.479988 [error] [Dummy-1   ]: Encountered an error:
Parsing Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  No jinja in python model code is allowed
[0m15:19:18.482069 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.9435775, "process_in_blocks": "0", "process_kernel_time": 1.37, "process_mem_max_rss": "459032", "process_out_blocks": "0", "process_user_time": 6.16}
[0m15:19:18.482859 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:19:18.482560 after 2.94 seconds
[0m15:19:18.483608 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:20:29.732229 | 100732fe-e3f3-4771-9776-11001ee3b1cb ==============================
[0m15:20:29.732229 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:20:29.733340 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m15:20:29.803564 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:20:30.110661 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:20:30.893415 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:20:30.895063 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:20:33.352387 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.v_stg_servicenow_incidents' (models/bronze_zone/v_stg_servicenow_incidents.sql) depends on a source named 'servicenow.incident' which was not found
[0m15:20:33.354558 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.7193732, "process_in_blocks": "0", "process_kernel_time": 1.49, "process_mem_max_rss": "456680", "process_out_blocks": "0", "process_user_time": 6.63}
[0m15:20:33.355327 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:20:33.355031 after 3.72 seconds
[0m15:20:33.355972 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:22:29.132783 | 5ab5bdb2-6aa1-4a5c-b782-a9db3e7a4f04 ==============================
[0m15:22:29.132783 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:22:29.133925 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:22:29.206062 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:22:29.518111 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:22:30.302681 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:22:30.304101 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:22:32.761104 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.build_semantic_view' (models/activation/build_semantic_view.sql) depends on a source named '<source_name>.<table_name>' which was not found
[0m15:22:32.763412 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.7291534, "process_in_blocks": "0", "process_kernel_time": 1.31, "process_mem_max_rss": "457100", "process_out_blocks": "0", "process_user_time": 6.78}
[0m15:22:32.764199 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:22:32.763908 after 3.73 seconds
[0m15:22:32.764897 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:22:54.861744 | 39a7d734-a187-4e95-86c3-25817ceec97c ==============================
[0m15:22:54.861744 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:22:54.862883 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m15:22:54.935458 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:22:55.250791 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:22:56.034218 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:22:56.036614 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:22:58.543142 [error] [Dummy-1   ]: Encountered an error:
Compilation Error
  Model 'model.incident_management.active_incidents' (models/gold_zone/active_incidents.sql) depends on a source named 'bronze_zone.incidents' which was not found
[0m15:22:58.545202 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.7819717, "process_in_blocks": "0", "process_kernel_time": 1.21, "process_mem_max_rss": "460560", "process_out_blocks": "0", "process_user_time": 6.89}
[0m15:22:58.545932 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:22:58.545651 after 3.78 seconds
[0m15:22:58.546561 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:27:04.619939 | 03750df2-1bed-45a8-be26-92d8d212992e ==============================
[0m15:27:04.619939 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:27:04.621220 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:27:04.697207 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:27:05.025401 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:27:05.825750 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:27:05.827262 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:27:07.453196 [error] [Dummy-1   ]: Encountered an error:
Compilation Error in model incidents (models/gold_zone/incidents.sql)
  unexpected '}', expected ')'
    line 25
      from {{(ref('v_qualify_slack_messages')}} lh
[0m15:27:07.455334 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.938486, "process_in_blocks": "0", "process_kernel_time": 1.27, "process_mem_max_rss": "455504", "process_out_blocks": "0", "process_user_time": 6.17}
[0m15:27:07.456188 [debug] [Dummy-1   ]: Command `cli compile` failed at 15:27:07.455885 after 2.94 seconds
[0m15:27:07.456892 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:27:48.273515 | 76e05c14-c406-42de-a49e-bb106a69b500 ==============================
[0m15:27:48.273515 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:27:48.274681 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m15:27:48.347392 [error] [Dummy-1   ]:  adapter: Invalid profile: 'user' is a required property.
[0m15:27:48.660711 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:27:49.436116 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:27:49.437439 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:27:52.241884 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m15:27:52.244608 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m15:27:52.457071 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m15:27:52.461596 [info ] [Dummy-1   ]: 
[0m15:27:52.462277 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m15:27:52.462769 [info ] [Dummy-1   ]: 
[0m15:27:52.463611 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m15:27:52.472187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m15:27:52.626767 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:27:52.627428 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:27:52.627935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:53.689787 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.062 seconds
[0m15:27:53.695667 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:27:53.696285 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m15:27:53.868936 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.172 seconds
[0m15:27:53.872585 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:27:53.873197 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:27:53.990250 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.116 seconds
[0m15:27:53.992893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m15:27:54.004794 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:27:54.005452 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:27:54.005950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:54.981928 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.976 seconds
[0m15:27:54.984463 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:27:54.985056 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m15:27:55.051307 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c02cff-0206-e1f0-0032-318704d6e3be
[0m15:27:55.051965 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:27:55.052633 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:27:55.053146 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:27:55.059877 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m15:27:55.060717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m15:27:55.061340 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m15:27:55.081421 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m15:27:55.082462 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m15:27:55.083528 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m15:27:55.084752 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m15:27:55.085588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m15:27:55.086215 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m15:27:55.098370 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m15:27:55.099315 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m15:27:55.100355 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m15:27:55.101512 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m15:27:55.102821 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m15:27:55.103452 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m15:27:55.117972 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m15:27:55.118947 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m15:27:55.120176 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m15:27:55.121330 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:27:55.122336 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m15:27:55.122942 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:27:55.141602 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m15:27:55.142568 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:27:55.143635 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:27:55.144775 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:27:55.145583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m15:27:55.146194 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:27:55.160635 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m15:27:55.161527 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:27:55.162561 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:27:55.163696 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:27:55.164464 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m15:27:55.165047 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:27:55.177577 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m15:27:55.178577 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:27:55.179622 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:27:55.180681 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:27:55.181463 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m15:27:55.182078 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:27:55.194659 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m15:27:55.195486 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:27:55.196478 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:27:55.197504 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:27:55.198298 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m15:27:55.198962 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:27:55.213001 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m15:27:55.213825 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:27:55.214835 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:27:55.215847 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:27:55.216641 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m15:27:55.217228 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:27:55.229283 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m15:27:55.230078 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:27:55.231059 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:27:55.232058 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:27:55.232810 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m15:27:55.233385 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:27:55.246987 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m15:27:55.247785 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:27:55.248804 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:27:55.249819 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:27:55.250559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m15:27:55.251142 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:27:55.263489 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m15:27:55.264271 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:27:55.265221 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:27:55.266231 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:27:55.266976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m15:27:55.267545 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:27:55.281066 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m15:27:55.281862 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:27:55.282845 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:27:55.283828 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:27:55.284564 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m15:27:55.285131 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:27:55.297172 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m15:27:55.297951 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:27:55.298980 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:27:55.299998 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:27:55.300748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m15:27:55.301331 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:27:55.316450 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m15:27:55.317251 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:27:55.318227 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:27:55.321393 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m15:27:55.322188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m15:27:55.322767 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m15:27:55.334167 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m15:27:55.335018 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m15:27:55.336180 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m15:27:55.337351 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m15:27:55.338159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m15:27:55.338889 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m15:27:55.372308 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m15:27:55.373199 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m15:27:55.374230 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m15:27:55.375381 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m15:27:55.376159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m15:27:55.376735 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m15:27:55.391476 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m15:27:55.392396 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m15:27:55.393401 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m15:27:55.395344 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m15:27:55.396238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m15:27:55.396816 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m15:27:55.408818 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m15:27:55.409640 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m15:27:55.410662 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m15:27:55.411769 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m15:27:55.412517 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m15:27:55.413096 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m15:27:55.426184 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m15:27:55.427007 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m15:27:55.427981 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m15:27:55.429112 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m15:27:55.430172 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m15:27:55.430753 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m15:27:55.443277 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m15:27:55.444164 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m15:27:55.445157 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m15:27:55.446240 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m15:27:55.446981 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m15:27:55.447564 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m15:27:55.461463 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m15:27:55.462345 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m15:27:55.463323 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m15:27:55.464453 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m15:27:55.465228 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m15:27:55.465803 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m15:27:55.477495 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m15:27:55.478368 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m15:27:55.479480 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m15:27:55.480565 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m15:27:55.481326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m15:27:55.481895 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m15:27:55.493997 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m15:27:55.494846 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m15:27:55.495989 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m15:27:55.497108 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m15:27:55.497874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m15:27:55.498529 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m15:27:55.511856 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m15:27:55.512714 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m15:27:55.513698 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m15:27:55.514837 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:27:55.515653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m15:27:55.516248 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:27:55.529074 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m15:27:55.529925 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:27:55.530923 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:27:55.531972 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:27:55.532730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m15:27:55.533301 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:27:55.546828 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m15:27:55.547637 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:27:55.548663 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:27:55.549702 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:27:55.550450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m15:27:55.551020 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:27:55.563325 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m15:27:55.564151 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:27:55.565128 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:27:55.566212 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:27:55.566980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m15:27:55.567549 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:27:55.581431 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m15:27:55.582287 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:27:55.583252 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:27:55.584298 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:27:55.585027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m15:27:55.585593 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:27:55.597852 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m15:27:55.598719 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:27:55.599682 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:27:55.600710 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:27:55.601450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m15:27:55.602024 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:27:55.614135 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m15:27:55.614915 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:27:55.615879 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:27:55.616930 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:27:55.617680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m15:27:55.618272 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:27:55.631977 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m15:27:55.632765 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:27:55.633712 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:27:55.634765 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:27:55.635501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m15:27:55.636067 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:27:55.647806 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m15:27:55.648638 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:27:55.649592 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:27:55.651998 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m15:27:55.652530 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m15:27:55.658230 [debug] [Dummy-1   ]: Command end result
[0m15:27:55.701142 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m15:27:55.703683 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m15:27:55.714106 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m15:27:55.716200 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 7.5425835, "process_in_blocks": "0", "process_kernel_time": 1.28, "process_mem_max_rss": "493632", "process_out_blocks": "0", "process_user_time": 8.35}
[0m15:27:55.716914 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 15:27:55.716635 after 7.54 seconds
[0m15:27:55.717474 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:45:18.940306 | 8c900d9c-4338-4b5b-8773-509c42ee1975 ==============================
[0m15:45:18.940306 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:45:18.941417 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:45:19.313314 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:45:20.056869 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:45:20.358930 [info ] [Dummy-1   ]: Unable to do partial parsing because profile has changed
[0m15:45:23.062010 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m15:45:23.064583 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m15:45:23.118650 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m15:45:23.122133 [info ] [Dummy-1   ]: 
[0m15:45:23.122708 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m15:45:23.123244 [info ] [Dummy-1   ]: 
[0m15:45:23.124151 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m15:45:23.132187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m15:45:23.289330 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m15:45:23.290050 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m15:45:23.290613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:24.142704 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.852 seconds
[0m15:45:24.156602 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m15:45:24.157244 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m15:45:24.157735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:24.937463 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.779 seconds
[0m15:45:24.940342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now create_incident_management_gold_zone)
[0m15:45:24.941141 [debug] [ThreadPool]: Creating schema "database: "incident_management"
schema: "gold_zone"
"
[0m15:45:24.954416 [debug] [ThreadPool]: Using snowflake connection "create_incident_management_gold_zone"
[0m15:45:24.955007 [debug] [ThreadPool]: On create_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "create_incident_management_gold_zone"} */
create schema if not exists incident_management.gold_zone
[0m15:45:24.955496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:25.720246 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.765 seconds
[0m15:45:25.724600 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m15:45:25.747781 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:45:25.748434 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:45:25.748992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:26.606556 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.857 seconds
[0m15:45:26.612272 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:45:26.612888 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m15:45:26.727525 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.114 seconds
[0m15:45:26.730227 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:45:26.730785 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:45:26.834865 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m15:45:26.837409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m15:45:26.849167 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:45:26.849735 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:45:26.850223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:27.670168 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.820 seconds
[0m15:45:27.672606 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:45:27.673185 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m15:45:27.753552 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.080 seconds
[0m15:45:27.755897 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:45:27.756436 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:45:27.845513 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m15:45:27.852601 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m15:45:27.853569 [info ] [Thread-2 (]: 1 of 13 START sql incremental model bronze_zone.users .......................... [RUN]
[0m15:45:27.854321 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m15:45:27.854902 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m15:45:27.874151 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m15:45:27.875029 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m15:45:27.950220 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.users"
[0m15:45:27.950977 [debug] [Thread-2 (]: On model.incident_management.users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.users"} */
create or replace  temporary view incident_management.bronze_zone.users__dbt_tmp
  
   as (
    

select 
    sm.MEMBERIDS[0] as id,
    sm.memberemails[0] as email,
    split(sm.memberemails[0], '@')[0] as first_name,
    split(sm.memberemails[0], '@')[1] as last_name,
    'reporter' as role,
    '' as department,
    '' as team,
    true as is_active,
    current_timestamp() as created_at,
    current_timestamp() as updated_at
from incident_management.bronze_zone.slack_members sm
  );
[0m15:45:27.951574 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:28.760452 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d11-0206-cee1-0032-318704d5be82
[0m15:45:28.761201 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MEMBERS' does not exist or not authorized.
[0m15:45:28.766474 [debug] [Thread-2 (]: Database Error in model users (models/bronze_zone/users.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MEMBERS' does not exist or not authorized.
[0m15:45:28.769804 [error] [Thread-2 (]: 1 of 13 ERROR creating sql incremental model bronze_zone.users ................. [[31mERROR[0m in 0.91s]
[0m15:45:28.770759 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m15:45:28.771897 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m15:45:28.772749 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.users' to be skipped because of status 'error'.  Reason: Database Error in model users (models/bronze_zone/users.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MEMBERS' does not exist or not authorized..
[0m15:45:28.773593 [info ] [Thread-2 (]: 2 of 13 START sql view model bronze_zone.v_qualify_new_documents ............... [RUN]
[0m15:45:28.775287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m15:45:28.775871 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m15:45:28.789789 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m15:45:28.790734 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m15:45:28.818609 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m15:45:28.820335 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m15:45:28.821037 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and contains(relative_path, 'pdf|docx|doc|txt|text|html|md|pptx|ppt|png|eml|jpg|jpeg|gif|bmp|tiff|tif|webp|htm')
and size > 0
  );
[0m15:45:28.821634 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:29.991522 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.170 seconds
[0m15:45:30.019284 [info ] [Thread-2 (]: 2 of 13 OK created sql view model bronze_zone.v_qualify_new_documents .......... [[32mSUCCESS 1[0m in 1.24s]
[0m15:45:30.020288 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m15:45:30.021407 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m15:45:30.022506 [info ] [Thread-2 (]: 3 of 13 START sql view model bronze_zone.v_qualify_slack_messages .............. [RUN]
[0m15:45:30.023202 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m15:45:30.023766 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m15:45:30.037837 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m15:45:30.038755 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m15:45:30.049236 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_slack_messages"
[0m15:45:30.053301 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_slack_messages"
[0m15:45:30.054360 [debug] [Thread-2 (]: On model.incident_management.v_qualify_slack_messages: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_slack_messages"} */
create or replace   view incident_management.bronze_zone.v_qualify_slack_messages
  
   as (
    

-- Only propagate messages from known reporters (users in channel)
with slack_messages_from_known_reporters as (
    select sm.*, r.id as reporter_id
    from incident_management.bronze_zone.slack_messages sm
    inner join incident_management.bronze_zone.users r on sm.username = split(r.email, '@')[0]
    where sm.clientmsgid is not null
    and to_date(sm.ingestts) >= to_date(current_timestamp())
)

-- Messages with attachments (with join to doc_metadata)
select 
    true as hasfiles,
    sm.type,
    sm.subtype,
    sm.team,
    sm.channel,
    sm.user,
    sm.username,
    sm.reporter_id,
    sm.text,
    sm.ts,
    sm.clientmsgid as slack_message_id,
    
    -- Attachment metadata from doc_metadata
    dm.file_id,
    dm.file_name, 
    dm.file_mimetype, 
    dm.file_size, 
    dm.staged_file_path,
    to_file('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', dm.staged_file_path) as attachment_file,
    case 
        -- When there is an attachment file and it is an image, use the image to extract the incident code
        when dm.staged_file_path is not null and fl_is_image(to_file('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS', dm.staged_file_path)) then 
        ai_complete('claude-3-5-sonnet',
            prompt(
            $$
            Find the incident number that may be present either in the image {0} or in the text {1}. 
            Use the one in the image if found.Look for alphanumeric codes preceded by the keyword 'incident' (case-insensitive). 
            Examples: INC-12345, incident_001, INC-2025-001.
            Respond only in JSON format with a single key called 'incident_code'.
            Do not add any explanation in the response.
            $$, 
            attachment_file,
            text
            )
        )
        else null
    end as incident_number

from slack_messages_from_known_reporters sm
inner join incident_management.bronze_zone.doc_metadata dm 
on (sm.hasfiles and (sm.channel = dm.channel_id) and (sm.ts = dm.event_ts))

UNION ALL

-- Messages without attachments (no join to doc_metadata)
select 
    false as hasfiles,
    sm.type,
    sm.subtype,
    sm.team,
    sm.channel,
    sm.user,
    sm.username,
    sm.reporter_id,
    sm.text,
    sm.ts,
    sm.clientmsgid as slack_message_id,
    
    -- No attachment metadata for messages without files
    null as file_id,
    null as file_name, 
    null as file_mimetype, 
    null as file_size, 
    null as staged_file_path,
    null as attachment_file,
    case 
        -- Only use text to extract the incident code since there are no attachments
        when sm.text is not null then ai_complete('claude-3-5-sonnet',
                prompt(
                $$
                Extract incident codes from Slack text {0}. 
                Look for alphanumeric codes preceded by the keyword 'incident' (case-insensitive). 
                Examples: INC-12345, incident_001, INC-2025-001.
                Respond only in JSON format with a single key called 'incident_code'.
                Do not add any explanation in the response.
                $$, 
                text
            )
        )
        else null
    end as incident_number

from slack_messages_from_known_reporters sm
where not sm.hasfiles or sm.hasfiles is null
  );
[0m15:45:30.055256 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:30.814042 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d11-0206-cee1-0032-318704d5bec2
[0m15:45:30.814773 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MESSAGES' does not exist or not authorized.
[0m15:45:30.820258 [debug] [Thread-2 (]: Database Error in model v_qualify_slack_messages (models/bronze_zone/v_qualify_slack_messages.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MESSAGES' does not exist or not authorized.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/v_qualify_slack_messages.sql
[0m15:45:30.821650 [error] [Thread-2 (]: 3 of 13 ERROR creating sql view model bronze_zone.v_qualify_slack_messages ..... [[31mERROR[0m in 0.80s]
[0m15:45:30.822588 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m15:45:30.823659 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m15:45:30.824404 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.v_qualify_slack_messages' to be skipped because of status 'error'.  Reason: Database Error in model v_qualify_slack_messages (models/bronze_zone/v_qualify_slack_messages.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MESSAGES' does not exist or not authorized.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/v_qualify_slack_messages.sql.
[0m15:45:30.825245 [info ] [Thread-2 (]: 4 of 13 START sql table model bronze_zone.document_full_extracts ............... [RUN]
[0m15:45:30.826394 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now model.incident_management.document_full_extracts)
[0m15:45:30.826964 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m15:45:30.839842 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m15:45:30.840685 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m15:45:30.878679 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.document_full_extracts"
[0m15:45:30.880592 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_full_extracts"
[0m15:45:30.881300 [debug] [Thread-2 (]: On model.incident_management.document_full_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_full_extracts"} */
create or replace transient table incident_management.bronze_zone.document_full_extracts
         as
        (


with document_all_pages
as
(
    select
        *,
        AI_PARSE_DOCUMENT (
            TO_FILE('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS/full',relative_path),
            parse_mode => 'LAYOUT', 
            page_split => true
        ) as chunk
        FROM incident_management.bronze_zone.v_qualify_new_documents
        WHERE analysis_type = 'full'
)

select 
*,
f.value:content::STRING as page_content,
f.index::int as page_num
from document_all_pages,
LATERAL FLATTEN(input => chunk:pages) f;
[0m15:45:30.881896 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:31.582805 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d11-0206-cee1-0032-318704d5bee2
[0m15:45:31.583554 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 39 unexpected ';'.
[0m15:45:31.588538 [debug] [Thread-2 (]: Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 39 unexpected ';'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql
[0m15:45:31.590046 [error] [Thread-2 (]: 4 of 13 ERROR creating sql table model bronze_zone.document_full_extracts ...... [[31mERROR[0m in 0.76s]
[0m15:45:31.591046 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m15:45:31.592205 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m15:45:31.593014 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_full_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 39 unexpected ';'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql.
[0m15:45:31.593842 [info ] [Thread-2 (]: 5 of 13 START python table model bronze_zone.document_question_extracts ........ [RUN]
[0m15:45:31.594809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m15:45:31.595381 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m15:45:31.629164 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m15:45:31.630116 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m15:45:31.643787 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m15:45:31.646530 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m15:45:31.647615 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(relative_path: str):
    asset_path = dbt.config.get("asset_path")
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{dbt.config.get("docs_stage_path")}/qa'), F.col('relative_path')),
            get_response_format(F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m15:45:31.648597 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:36.252419 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d11-0206-cee1-0032-318704d5bf06
[0m15:45:36.253207 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
    df = model(dbt, session)
  File "_udf_code.py", line 39, in model
    get_response_format(F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    asset_path = dbt.config.get("asset_path")
NameError: name 'dbt' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m15:45:36.258505 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m15:45:36.259887 [error] [Thread-2 (]: 5 of 13 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.66s]
[0m15:45:36.260865 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m15:45:36.261988 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m15:45:36.262823 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m15:45:36.263582 [info ] [Thread-2 (]: 6 of 13 SKIP relation gold_zone.incidents ...................................... [[33mSKIP[0m]
[0m15:45:36.264510 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m15:45:36.266225 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m15:45:36.267048 [info ] [Thread-2 (]: 7 of 13 SKIP relation gold_zone.active_incidents ............................... [[33mSKIP[0m]
[0m15:45:36.267682 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m15:45:36.268699 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m15:45:36.269422 [info ] [Thread-2 (]: 8 of 13 SKIP relation gold_zone.closed_incidents ............................... [[33mSKIP[0m]
[0m15:45:36.270040 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m15:45:36.270919 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m15:45:36.271609 [info ] [Thread-2 (]: 9 of 13 SKIP relation gold_zone.incident_attachments ........................... [[33mSKIP[0m]
[0m15:45:36.272226 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m15:45:36.273129 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m15:45:36.273819 [info ] [Thread-2 (]: 10 of 13 SKIP relation gold_zone.incident_comment_history ...................... [[33mSKIP[0m]
[0m15:45:36.274437 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m15:45:36.275325 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m15:45:36.275994 [info ] [Thread-2 (]: 11 of 13 SKIP relation gold_zone.monthly_incident_trends ....................... [[33mSKIP[0m]
[0m15:45:36.276606 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m15:45:36.277506 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m15:45:36.278178 [info ] [Thread-2 (]: 12 of 13 SKIP relation bronze_zone.v_slack_msg_incident_number ................. [[33mSKIP[0m]
[0m15:45:36.278878 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m15:45:36.279820 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m15:45:36.280506 [info ] [Thread-2 (]: 13 of 13 SKIP relation gold_zone.weekly_incident_trends ........................ [[33mSKIP[0m]
[0m15:45:36.281149 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m15:45:36.283617 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m15:45:36.284214 [debug] [Dummy-1   ]: Connection 'create_incident_management_gold_zone' was properly closed.
[0m15:45:36.284685 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m15:45:36.285369 [info ] [Dummy-1   ]: 
[0m15:45:36.285902 [info ] [Dummy-1   ]: Finished running 4 incremental models, 6 table models, 3 view models in 0 hours 0 minutes and 13.16 seconds (13.16s).
[0m15:45:36.287841 [debug] [Dummy-1   ]: Command end result
[0m15:45:36.329792 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m15:45:36.332277 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m15:45:36.340259 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m15:45:36.340826 [info ] [Dummy-1   ]: 
[0m15:45:36.341480 [info ] [Dummy-1   ]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m15:45:36.341978 [info ] [Dummy-1   ]: 
[0m15:45:36.342667 [error] [Dummy-1   ]:   Database Error in model users (models/bronze_zone/users.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MEMBERS' does not exist or not authorized.
[0m15:45:36.343160 [info ] [Dummy-1   ]: 
[0m15:45:36.343808 [error] [Dummy-1   ]:   Database Error in model v_qualify_slack_messages (models/bronze_zone/v_qualify_slack_messages.sql)
  002003 (42S02): SQL compilation error:
  Object 'INCIDENT_MANAGEMENT.BRONZE_ZONE.SLACK_MESSAGES' does not exist or not authorized.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/v_qualify_slack_messages.sql
[0m15:45:36.344304 [info ] [Dummy-1   ]: 
[0m15:45:36.344986 [error] [Dummy-1   ]:   Database Error in model document_full_extracts (models/bronze_zone/document_full_extracts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 39 unexpected ';'.
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_full_extracts.sql
[0m15:45:36.345494 [info ] [Dummy-1   ]: 
[0m15:45:36.346180 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m15:45:36.346714 [info ] [Dummy-1   ]: 
[0m15:45:36.347218 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=4 SKIP=8 TOTAL=13
[0m15:45:36.349059 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.50519, "process_in_blocks": "0", "process_kernel_time": 1.49, "process_mem_max_rss": "486768", "process_out_blocks": "0", "process_user_time": 8.34}
[0m15:45:36.349732 [debug] [Dummy-1   ]: Command `cli run` failed at 15:45:36.349465 after 17.51 seconds
[0m15:45:36.350292 [debug] [Dummy-1   ]: Flushing usage events


============================== 15:49:18.903299 | 60dc5aab-949c-49c1-8e4f-84ea5d754972 ==============================
[0m15:49:18.903299 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m15:49:18.904469 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:49:19.292583 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m15:49:20.107565 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:49:20.497718 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:49:20.498896 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_slack_msg_incident_number.sql
[0m15:49:20.499663 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_full_extracts.sql
[0m15:49:20.500340 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/users.sql
[0m15:49:20.501033 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_slack_messages.sql
[0m15:49:21.217241 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m15:49:21.220165 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m15:49:21.271805 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m15:49:21.276338 [info ] [Dummy-1   ]: 
[0m15:49:21.277031 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m15:49:21.277555 [info ] [Dummy-1   ]: 
[0m15:49:21.278520 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m15:49:21.287206 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m15:49:21.453931 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:49:21.454726 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:49:21.455369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:22.289487 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.834 seconds
[0m15:49:22.295555 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:49:22.296250 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m15:49:22.387451 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.090 seconds
[0m15:49:22.390759 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m15:49:22.391444 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:49:22.504929 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m15:49:22.507449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m15:49:22.518217 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:49:22.519003 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:49:22.519638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:23.342020 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.822 seconds
[0m15:49:23.344617 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:49:23.345277 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m15:49:23.466529 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.121 seconds
[0m15:49:23.469528 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m15:49:23.470172 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:49:23.577656 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.107 seconds
[0m15:49:23.603841 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m15:49:23.604813 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m15:49:23.605502 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m15:49:23.625801 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m15:49:23.626850 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m15:49:23.628005 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m15:49:23.629323 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m15:49:23.630360 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m15:49:23.630991 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m15:49:23.643464 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m15:49:23.644479 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m15:49:23.645603 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m15:49:23.646818 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m15:49:23.648015 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m15:49:23.648713 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m15:49:23.663946 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m15:49:23.664905 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m15:49:23.666002 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m15:49:23.667181 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:49:23.668229 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m15:49:23.668951 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:49:23.692088 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m15:49:23.693039 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:49:23.694096 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m15:49:23.695290 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:49:23.696144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m15:49:23.696759 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:49:23.711194 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m15:49:23.712168 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:49:23.713250 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m15:49:23.714425 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:49:23.715219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m15:49:23.715820 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:49:23.728580 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m15:49:23.729577 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:49:23.730632 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m15:49:23.731752 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:49:23.732614 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m15:49:23.733258 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:49:23.747549 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m15:49:23.748583 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:49:23.749640 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m15:49:23.750729 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:49:23.751630 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m15:49:23.752263 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:49:23.900377 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m15:49:23.901348 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:49:23.902390 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m15:49:23.903484 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:49:23.904306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m15:49:23.904900 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:49:23.917535 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m15:49:23.918552 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:49:23.919706 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m15:49:23.920858 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:49:23.921680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m15:49:23.922319 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:49:23.936713 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m15:49:23.937764 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:49:23.938907 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m15:49:23.940039 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:49:23.940874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m15:49:23.941514 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:49:23.954522 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m15:49:23.955495 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:49:23.956535 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m15:49:23.957629 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:49:23.958575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m15:49:23.959292 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:49:23.974050 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m15:49:23.974999 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:49:23.976060 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m15:49:23.977148 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:49:23.977995 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m15:49:23.978701 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:49:23.991527 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m15:49:23.992459 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:49:23.993481 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m15:49:23.994617 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:49:23.995413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m15:49:23.996012 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:49:24.014216 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m15:49:24.015223 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:49:24.016263 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m15:49:24.017401 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m15:49:24.018236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m15:49:24.018988 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m15:49:24.031189 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m15:49:24.032158 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m15:49:24.033186 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m15:49:24.034348 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m15:49:24.035188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m15:49:24.035816 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m15:49:24.076136 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m15:49:24.077118 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m15:49:24.078150 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m15:49:24.079432 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m15:49:24.080256 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m15:49:24.080843 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m15:49:24.093785 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m15:49:24.094739 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m15:49:24.095767 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m15:49:24.097665 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m15:49:24.098623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m15:49:24.099243 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m15:49:24.111401 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m15:49:24.112314 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m15:49:24.113339 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m15:49:24.114511 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m15:49:24.115329 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m15:49:24.115916 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m15:49:24.130096 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m15:49:24.131022 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m15:49:24.132102 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m15:49:24.133266 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m15:49:24.134396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m15:49:24.134982 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m15:49:24.147774 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m15:49:24.148750 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m15:49:24.149790 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m15:49:24.150958 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m15:49:24.151761 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m15:49:24.152345 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m15:49:24.166805 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m15:49:24.167718 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m15:49:24.168825 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m15:49:24.169996 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m15:49:24.170798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m15:49:24.171387 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m15:49:24.183262 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m15:49:24.184123 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m15:49:24.185116 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m15:49:24.186271 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m15:49:24.187163 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m15:49:24.187806 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m15:49:24.200107 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m15:49:24.201008 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m15:49:24.204396 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m15:49:24.205586 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m15:49:24.206392 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m15:49:24.206976 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m15:49:24.218614 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m15:49:24.219539 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m15:49:24.220574 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m15:49:24.221704 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:49:24.222469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m15:49:24.223059 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:49:24.244064 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m15:49:24.245070 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:49:24.246161 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m15:49:24.247390 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:49:24.248334 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m15:49:24.249065 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:49:24.265466 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m15:49:24.266420 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:49:24.267482 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m15:49:24.268732 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:49:24.269547 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m15:49:24.270135 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:49:24.283181 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m15:49:24.284075 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:49:24.285088 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m15:49:24.286230 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:49:24.286998 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m15:49:24.287618 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:49:24.301799 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m15:49:24.302684 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:49:24.303714 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m15:49:24.304828 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:49:24.305594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m15:49:24.306185 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:49:24.318846 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m15:49:24.319726 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:49:24.320722 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m15:49:24.321819 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:49:24.322567 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m15:49:24.323152 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:49:24.337413 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m15:49:24.338320 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:49:24.339452 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m15:49:24.340559 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:49:24.341330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m15:49:24.341913 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:49:24.354665 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m15:49:24.355617 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:49:24.356627 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m15:49:24.357765 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:49:24.358607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m15:49:24.359241 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:49:24.371868 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m15:49:24.372821 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:49:24.373872 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m15:49:24.376457 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m15:49:24.377031 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m15:49:24.382885 [debug] [Dummy-1   ]: Command end result
[0m15:49:24.427552 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m15:49:24.430487 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m15:49:24.441434 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m15:49:24.443541 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.6405015, "process_in_blocks": "0", "process_kernel_time": 1.29, "process_mem_max_rss": "437588", "process_out_blocks": "0", "process_user_time": 6.92}
[0m15:49:24.444274 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 15:49:24.443992 after 5.64 seconds
[0m15:49:24.444847 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:03:46.110907 | 7443801a-b52e-440c-b8d8-62fb53356d5e ==============================
[0m16:03:46.110907 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:03:46.112210 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:03:46.524825 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:03:47.288556 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:03:47.723278 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:47.724544 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_new_documents.sql
[0m16:03:48.453479 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:03:48.456733 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:03:48.508085 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:03:48.512942 [info ] [Dummy-1   ]: 
[0m16:03:48.513667 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:03:48.514249 [info ] [Dummy-1   ]: 
[0m16:03:48.515259 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:03:48.549750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:03:48.732687 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:03:48.733517 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:03:48.734175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:49.586904 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.852 seconds
[0m16:03:49.593218 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:03:49.593928 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:03:49.721955 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.127 seconds
[0m16:03:49.725968 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:03:49.726735 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:03:49.823073 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m16:03:49.825884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:03:49.838723 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:03:49.839462 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:03:49.840070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:50.616366 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.776 seconds
[0m16:03:50.619156 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:03:50.619808 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:03:50.733001 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.112 seconds
[0m16:03:50.735563 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:03:50.736263 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:03:50.830240 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m16:03:50.856223 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:03:50.857167 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m16:03:50.857882 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:03:50.878936 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:03:50.880072 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:03:50.881310 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:03:50.882852 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:03:50.883974 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:03:50.884640 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:03:50.897023 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:03:50.898163 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:03:50.899693 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:03:50.901051 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:03:50.902330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:03:50.903055 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:03:50.916985 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:03:50.918098 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:03:50.919385 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:03:50.920841 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:03:50.922095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:03:50.922803 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:03:50.949737 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:03:50.950849 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:03:50.952052 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:03:50.953346 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:03:50.954310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:03:50.955138 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:03:50.968975 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:03:50.970092 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:03:50.971267 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:03:50.972621 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:03:50.973566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:03:50.974283 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:03:50.989583 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:03:50.990711 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:03:50.991893 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:03:50.993131 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:03:50.994133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:03:50.994790 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:03:51.008076 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:03:51.009217 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:03:51.010427 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:03:51.011696 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:03:51.012715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:03:51.013415 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:03:51.028512 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:03:51.029606 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:03:51.030810 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:03:51.032013 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:03:51.032980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:03:51.033620 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:03:51.047029 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:03:51.048001 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:03:51.049151 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:03:51.050465 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:03:51.051479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:03:51.052162 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:03:51.067367 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:03:51.068380 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:03:51.069557 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:03:51.070787 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:03:51.071693 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:03:51.072308 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:03:51.250775 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:03:51.251923 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:03:51.253059 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:03:51.254333 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:03:51.255287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:03:51.255972 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:03:51.269266 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:03:51.270376 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:03:51.271534 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:03:51.273159 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:03:51.274139 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:03:51.274812 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:03:51.290273 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:03:51.291282 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:03:51.292408 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:03:51.293664 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:03:51.294669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:03:51.295340 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:03:51.312072 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:03:51.313086 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:03:51.314291 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:03:51.315562 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:03:51.316672 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:03:51.318433 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:03:51.333909 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:03:51.334980 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:03:51.336151 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:03:51.337472 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:03:51.338452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:03:51.339114 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:03:51.379722 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:03:51.380736 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:03:51.381853 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:03:51.383108 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:03:51.384013 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:03:51.384668 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:03:51.401175 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:03:51.402202 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:03:51.403351 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:03:51.405465 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:03:51.406528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:03:51.407182 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:03:51.420064 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:03:51.421111 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:03:51.422303 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:03:51.423856 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:03:51.424765 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:03:51.425383 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:03:51.437296 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:03:51.438330 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:03:51.439506 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:03:51.440837 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:03:51.442071 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:03:51.442709 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:03:51.458380 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:03:51.459443 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:03:51.460565 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:03:51.461811 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:03:51.462759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:03:51.463418 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:03:51.476562 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:03:51.477637 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:03:51.478841 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:03:51.480104 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:03:51.481021 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:03:51.481690 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:03:51.495996 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:03:51.497098 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:03:51.498220 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:03:51.499597 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:03:51.500509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:03:51.501142 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:03:51.513874 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:03:51.514833 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:03:51.515922 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:03:51.517166 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:03:51.518074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:03:51.518725 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:03:51.532600 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:03:51.533543 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:03:51.534655 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:03:51.535956 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:03:51.536891 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:03:51.537524 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:03:51.559540 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:03:51.560548 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:03:51.561669 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:03:51.562949 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:03:51.563867 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:03:51.564494 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:03:51.579426 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:03:51.580398 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:03:51.581476 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:03:51.582737 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:03:51.583636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:03:51.584254 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:03:51.599920 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:03:51.600888 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:03:51.602022 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:03:51.603277 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:03:51.604165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:03:51.604785 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:03:51.618109 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:03:51.619148 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:03:51.620259 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:03:51.621573 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:03:51.622574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:03:51.623209 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:03:51.638323 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:03:51.639335 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:03:51.640433 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:03:51.641664 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:03:51.642568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:03:51.643189 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:03:51.656250 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:03:51.657199 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:03:51.658331 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:03:51.659639 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:03:51.660509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:03:51.661116 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:03:51.675967 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:03:51.676958 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:03:51.678084 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:03:51.679426 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:03:51.680338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:03:51.680965 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:03:51.694222 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:03:51.695207 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:03:51.696311 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:03:51.699048 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:03:51.699680 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:03:51.705622 [debug] [Dummy-1   ]: Command end result
[0m16:03:51.750851 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:03:51.753793 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:03:51.765424 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:03:51.767695 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.7631245, "process_in_blocks": "0", "process_kernel_time": 1.54, "process_mem_max_rss": "484896", "process_out_blocks": "0", "process_user_time": 7.05}
[0m16:03:51.768531 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:03:51.768189 after 5.76 seconds
[0m16:03:51.769179 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:09:25.757701 | e32c99eb-3e9e-4915-9c06-50c67b2c854a ==============================
[0m16:09:25.757701 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:09:25.759158 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:09:26.175832 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:09:26.913771 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:09:27.364413 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:09:27.365703 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/v_qualify_new_documents.sql
[0m16:09:28.086325 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:09:28.089651 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:09:28.140542 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:09:28.145212 [info ] [Dummy-1   ]: 
[0m16:09:28.145933 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:09:28.146474 [info ] [Dummy-1   ]: 
[0m16:09:28.147366 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:09:28.156460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:09:28.317758 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:09:28.318647 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:09:28.319386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:29.123942 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.804 seconds
[0m16:09:29.130339 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:09:29.131027 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:09:30.094877 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.963 seconds
[0m16:09:30.099245 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:09:30.099936 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:09:30.225489 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.125 seconds
[0m16:09:30.228448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:09:30.241278 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:09:30.242058 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:09:30.242673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:31.296025 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.053 seconds
[0m16:09:31.298826 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:09:31.299493 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:09:31.410807 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.111 seconds
[0m16:09:31.413399 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:09:31.414103 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:09:31.570676 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.156 seconds
[0m16:09:31.579359 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:09:31.580292 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m16:09:31.580982 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:09:31.601843 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:09:31.602882 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:09:31.604033 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:09:31.605402 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:09:31.606415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:09:31.607076 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:09:31.619616 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:09:31.620627 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:09:31.622038 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:09:31.623375 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:09:31.624593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:09:31.625271 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:09:31.639390 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:09:31.640407 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:09:31.641571 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:09:31.642968 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:09:31.644221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:09:31.644929 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:09:31.672057 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:09:31.673064 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:09:31.674230 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:09:31.675539 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:09:31.676479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:09:31.677116 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:09:31.690869 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:09:31.691869 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:09:31.692963 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:09:31.694259 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:09:31.695171 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:09:31.695809 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:09:31.711221 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:09:31.712229 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:09:31.713345 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:09:31.714631 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:09:31.715560 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:09:31.716185 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:09:31.729728 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:09:31.730801 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:09:31.731927 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:09:31.733115 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:09:31.734083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:09:31.734721 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:09:31.749816 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:09:31.750806 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:09:31.751937 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:09:31.753141 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:09:31.754076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:09:31.754717 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:09:31.768048 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:09:31.769141 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:09:31.770312 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:09:31.771539 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:09:31.772443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:09:31.773069 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:09:31.788536 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:09:31.789528 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:09:31.790686 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:09:31.791902 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:09:31.792793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:09:31.793413 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:09:31.967254 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:09:31.968287 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:09:31.969501 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:09:31.970729 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:09:31.971627 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:09:31.972246 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:09:31.985594 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:09:31.986611 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:09:31.987725 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:09:31.989298 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:09:31.990241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:09:31.990860 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:09:32.006386 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:09:32.007378 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:09:32.008571 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:09:32.009863 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:09:32.010772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:09:32.011396 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:09:32.028035 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:09:32.029126 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:09:32.030305 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:09:32.031614 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:09:32.032539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:09:32.033170 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:09:32.048173 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:09:32.049281 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:09:32.050422 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:09:32.051691 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:09:32.052548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:09:32.053161 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:09:32.093598 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:09:32.094750 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:09:32.095917 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:09:32.097242 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:09:32.098223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:09:32.098957 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:09:32.114648 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:09:32.115746 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:09:32.116913 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:09:32.119159 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:09:32.120357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:09:32.121018 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:09:32.133765 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:09:32.134852 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:09:32.135965 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:09:32.137501 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:09:32.138546 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:09:32.139215 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:09:32.151173 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:09:32.152182 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:09:32.153282 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:09:32.154593 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:09:32.155948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:09:32.156625 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:09:32.172629 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:09:32.173603 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:09:32.174785 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:09:32.176113 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:09:32.177044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:09:32.177670 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:09:32.190914 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:09:32.191908 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:09:32.193031 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:09:32.194340 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:09:32.195220 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:09:32.195855 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:09:32.210323 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:09:32.211296 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:09:32.212407 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:09:32.213668 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:09:32.214601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:09:32.215241 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:09:32.227939 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:09:32.229095 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:09:32.230266 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:09:32.231530 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:09:32.232417 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:09:32.233035 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:09:32.247142 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:09:32.248132 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:09:32.249332 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:09:32.250660 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:09:32.251550 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:09:32.252185 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:09:32.274469 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:09:32.275469 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:09:32.276595 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:09:32.277894 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:09:32.278943 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:09:32.279630 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:09:32.294700 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:09:32.295703 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:09:32.296845 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:09:32.298222 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:09:32.299281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:09:32.299932 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:09:32.315843 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:09:32.316872 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:09:32.318018 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:09:32.319413 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:09:32.320348 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:09:32.320987 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:09:32.334464 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:09:32.335429 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:09:32.336527 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:09:32.337800 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:09:32.338826 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:09:32.339485 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:09:32.354762 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:09:32.355748 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:09:32.356854 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:09:32.358128 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:09:32.359113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:09:32.359741 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:09:32.373054 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:09:32.374113 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:09:32.375249 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:09:32.376562 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:09:32.377470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:09:32.378183 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:09:32.393342 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:09:32.394350 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:09:32.395468 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:09:32.396735 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:09:32.397623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:09:32.398275 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:09:32.411682 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:09:32.412691 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:09:32.413818 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:09:32.416642 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:09:32.417260 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:09:32.423291 [debug] [Dummy-1   ]: Command end result
[0m16:09:32.469708 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:09:32.472723 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:09:32.484549 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:09:32.486845 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.8370533, "process_in_blocks": "0", "process_kernel_time": 1.35, "process_mem_max_rss": "482480", "process_out_blocks": "0", "process_user_time": 7.26}
[0m16:09:32.487651 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:09:32.487345 after 6.84 seconds
[0m16:09:32.488280 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:10:43.573904 | c2581932-6a91-4b68-a175-eb78a5563f30 ==============================
[0m16:10:43.573904 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:10:43.575160 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:10:43.982588 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:10:44.745615 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:10:45.184427 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:45.185194 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:45.404123 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:10:45.407421 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:10:45.484084 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:10:45.486218 [warn ] [Dummy-1   ]: The selection criterion '+bronze_zone.v_qualify_new_documents.sql' does not match any enabled nodes
[0m16:10:45.488452 [warn ] [Dummy-1   ]: Nothing to do. Try checking your model configs and model specification args
[0m16:10:45.491351 [debug] [Dummy-1   ]: Command end result
[0m16:10:45.537866 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:10:45.541006 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:10:45.545841 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:10:45.548208 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0785942, "process_in_blocks": "0", "process_kernel_time": 1.2, "process_mem_max_rss": "414048", "process_out_blocks": "0", "process_user_time": 5.49}
[0m16:10:45.549208 [debug] [Dummy-1   ]: Command `cli run` succeeded at 16:10:45.548862 after 2.08 seconds
[0m16:10:45.549936 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:11:06.590633 | b36b3dbf-7b33-4797-91d0-e2c1399d7be7 ==============================
[0m16:11:06.590633 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:11:06.591944 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:11:07.010577 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:11:07.769755 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:11:08.195687 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:08.196473 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:08.420091 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:11:08.423525 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:11:08.489080 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:11:08.492915 [info ] [Dummy-1   ]: 
[0m16:11:08.493693 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:11:08.494396 [info ] [Dummy-1   ]: 
[0m16:11:08.495473 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:11:08.498777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:11:08.675330 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:11:08.676106 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:11:08.676703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:09.599679 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.923 seconds
[0m16:11:09.610741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m16:11:09.636092 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:11:09.636809 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:11:09.637342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:10.602219 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.965 seconds
[0m16:11:10.608697 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:11:10.609448 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:11:10.703707 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.093 seconds
[0m16:11:10.706701 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:11:10.707412 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:11:10.898572 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.190 seconds
[0m16:11:10.901389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:11:10.914476 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:11:10.915148 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:11:10.915669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:11.804116 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.888 seconds
[0m16:11:11.806796 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:11:11.807519 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:11:11.887213 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.079 seconds
[0m16:11:11.890414 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:11:11.891168 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:11:12.012783 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m16:11:12.020700 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:11:12.021771 [info ] [Thread-2 (]: 1 of 1 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:11:12.022698 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:11:12.023367 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:11:12.043952 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:11:12.045125 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:11:12.107704 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:11:12.109919 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:11:12.110730 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:11:12.111408 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:11:13.254686 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.143 seconds
[0m16:11:13.293569 [info ] [Thread-2 (]: 1 of 1 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.27s]
[0m16:11:13.294719 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:11:13.298281 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:11:13.299086 [debug] [Dummy-1   ]: Connection 'model.incident_management.v_qualify_new_documents' was properly closed.
[0m16:11:13.299696 [info ] [Dummy-1   ]: 
[0m16:11:13.300262 [info ] [Dummy-1   ]: Finished running 1 view model in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m16:11:13.301320 [debug] [Dummy-1   ]: Command end result
[0m16:11:13.347959 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:11:13.351224 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:11:13.359954 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:11:13.360571 [info ] [Dummy-1   ]: 
[0m16:11:13.361331 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m16:11:13.361883 [info ] [Dummy-1   ]: 
[0m16:11:13.362482 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:11:13.364468 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8812003, "process_in_blocks": "0", "process_kernel_time": 1.53, "process_mem_max_rss": "442484", "process_out_blocks": "0", "process_user_time": 5.97}
[0m16:11:13.365236 [debug] [Dummy-1   ]: Command `cli run` succeeded at 16:11:13.364943 after 6.88 seconds
[0m16:11:13.365848 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:12:25.202855 | 58b3de11-86a6-44cd-803b-3f06b1f80fa2 ==============================
[0m16:12:25.202855 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:12:25.204149 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:12:25.618958 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:12:26.345706 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:12:26.778209 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:26.779179 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:27.001715 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:12:27.005066 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:12:27.071290 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:12:27.075215 [info ] [Dummy-1   ]: 
[0m16:12:27.075887 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:12:27.076395 [info ] [Dummy-1   ]: 
[0m16:12:27.077357 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:12:27.085481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:12:27.244235 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:12:27.244983 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:12:27.245548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:27.952617 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.707 seconds
[0m16:12:27.960207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m16:12:27.985323 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:12:27.986164 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:12:27.986820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:29.488882 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.502 seconds
[0m16:12:29.495264 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:12:29.496039 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:12:29.584696 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.088 seconds
[0m16:12:29.587361 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:12:29.588016 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:12:29.710805 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.122 seconds
[0m16:12:29.713497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:12:29.724818 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:12:29.725523 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:12:29.726094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:30.510822 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.784 seconds
[0m16:12:30.513593 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:12:30.514313 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:12:30.671610 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.157 seconds
[0m16:12:30.674603 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:12:30.675268 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:12:30.768572 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.092 seconds
[0m16:12:30.778194 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:12:30.779401 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:12:30.780251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m16:12:30.781386 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:12:30.801516 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:12:30.802662 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:12:30.865151 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:12:30.867300 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:12:30.868100 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:12:30.868934 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:12:31.996150 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.127 seconds
[0m16:12:32.034641 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.25s]
[0m16:12:32.035784 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:12:32.037989 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:12:32.039276 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:12:32.040176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:12:32.040897 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:12:32.083515 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:12:32.084625 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:12:32.129447 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:12:32.132639 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:12:32.133871 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(relative_path: str):
    asset_path = dbt.config.get("asset_path")
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{dbt.config.get("docs_stage_path")}/qa'), F.col('relative_path')),
            get_response_format(F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:12:32.134866 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:12:36.356377 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d2c-0206-d87f-0032-318704d7741a
[0m16:12:36.357248 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
    df = model(dbt, session)
  File "_udf_code.py", line 39, in model
    get_response_format(F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    asset_path = dbt.config.get("asset_path")
NameError: name 'dbt' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:12:36.363191 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:12:36.364846 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.32s]
[0m16:12:36.365953 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:12:36.367619 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:12:36.371092 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:12:36.371709 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m16:12:36.372212 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:12:36.372762 [info ] [Dummy-1   ]: 
[0m16:12:36.373331 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.30 seconds (9.30s).
[0m16:12:36.374625 [debug] [Dummy-1   ]: Command end result
[0m16:12:36.421439 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:12:36.424567 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:12:36.433369 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:12:36.434035 [info ] [Dummy-1   ]: 
[0m16:12:36.434775 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:12:36.435345 [info ] [Dummy-1   ]: 
[0m16:12:36.436177 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:12:36.436763 [info ] [Dummy-1   ]: 
[0m16:12:36.437305 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:12:36.439457 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.343254, "process_in_blocks": "0", "process_kernel_time": 1.37, "process_mem_max_rss": "438192", "process_out_blocks": "0", "process_user_time": 6.32}
[0m16:12:36.440235 [debug] [Dummy-1   ]: Command `cli run` failed at 16:12:36.439940 after 11.34 seconds
[0m16:12:36.440875 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:14:24.688904 | aa586803-8765-4748-aef6-e8219d10cfc6 ==============================
[0m16:14:24.688904 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:14:24.690273 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:14:25.095230 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:14:25.862754 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:14:26.294011 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:26.294751 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:26.511217 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:14:26.514251 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:14:26.575313 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:14:26.579944 [info ] [Dummy-1   ]: 
[0m16:14:26.580676 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:14:26.581244 [info ] [Dummy-1   ]: 
[0m16:14:26.582293 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:14:26.590162 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:14:26.747938 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:14:26.748891 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:14:26.749482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:27.625880 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.876 seconds
[0m16:14:27.631187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m16:14:27.655786 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:14:27.656465 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:14:27.657039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:28.415029 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.758 seconds
[0m16:14:28.421172 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:14:28.421894 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:14:28.537929 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.115 seconds
[0m16:14:28.540879 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:14:28.541553 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:14:28.642784 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m16:14:28.645491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:14:28.658168 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:14:28.658973 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:14:28.659565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:29.468567 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.809 seconds
[0m16:14:29.471281 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:14:29.471985 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:14:29.586466 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.114 seconds
[0m16:14:29.589075 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:14:29.589780 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:14:29.685466 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m16:14:29.692908 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:14:29.693974 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:14:29.695398 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:14:29.696138 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:14:29.715703 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:14:29.716715 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:14:29.777300 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:14:29.779445 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:14:29.780286 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:14:29.780981 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:14:30.989824 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.209 seconds
[0m16:14:31.026133 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.33s]
[0m16:14:31.027194 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:14:31.029372 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:14:31.030552 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:14:31.031384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:14:31.032028 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:14:31.072698 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:14:31.073729 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:14:31.117369 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:14:31.120521 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:14:31.121723 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(relative_path: str):
    asset_path = dbt.config.get("asset_path")
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{dbt.config.get("docs_stage_path")}/qa'), F.col('relative_path')),
            get_response_format(F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:14:31.122666 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:14:34.472851 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d2e-0206-cee1-0032-318704d764e6
[0m16:14:34.473672 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
    df = model(dbt, session)
  File "_udf_code.py", line 39, in model
    get_response_format(F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    asset_path = dbt.config.get("asset_path")
NameError: name 'dbt' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:14:34.479529 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:14:34.481138 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.45s]
[0m16:14:34.482213 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:14:34.483732 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:14:34.486945 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:14:34.487527 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:14:34.488067 [info ] [Dummy-1   ]: 
[0m16:14:34.488725 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.91 seconds (7.91s).
[0m16:14:34.490030 [debug] [Dummy-1   ]: Command end result
[0m16:14:34.535475 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:14:34.538463 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:14:34.546905 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:14:34.547512 [info ] [Dummy-1   ]: 
[0m16:14:34.548217 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:14:34.548937 [info ] [Dummy-1   ]: 
[0m16:14:34.549789 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:14:34.550387 [info ] [Dummy-1   ]: 
[0m16:14:34.550932 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:14:34.552898 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.969219, "process_in_blocks": "0", "process_kernel_time": 1.33, "process_mem_max_rss": "432296", "process_out_blocks": "0", "process_user_time": 6.15}
[0m16:14:34.553607 [debug] [Dummy-1   ]: Command `cli run` failed at 16:14:34.553328 after 9.97 seconds
[0m16:14:34.554231 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:15:37.430306 | 057505c4-6d24-4afb-8f68-7dd2bff28881 ==============================
[0m16:15:37.430306 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:15:37.431528 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:15:37.828337 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:15:38.563177 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:15:38.983295 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:38.984017 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:39.197474 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:15:39.200558 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:15:39.250469 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:15:39.254949 [info ] [Dummy-1   ]: 
[0m16:15:39.255694 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:15:39.256280 [info ] [Dummy-1   ]: 
[0m16:15:39.257320 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:15:39.266093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:15:39.429985 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:15:39.430695 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:15:39.431227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:40.424004 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.993 seconds
[0m16:15:40.430999 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:15:40.431765 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:15:40.556558 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.124 seconds
[0m16:15:40.559659 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:15:40.560307 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:15:40.648800 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m16:15:40.651507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:15:40.665399 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:15:40.666074 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:15:40.666591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:41.467423 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.801 seconds
[0m16:15:41.470221 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:15:41.470938 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:15:41.608673 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.137 seconds
[0m16:15:41.611130 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:15:41.611770 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:15:41.688287 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.076 seconds
[0m16:15:41.697410 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:15:41.698319 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m16:15:41.699126 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:15:41.717578 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:15:41.718692 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:15:41.719858 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:15:41.721186 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:15:41.722230 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:15:41.723001 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:15:41.736956 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:15:41.738015 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:15:41.739248 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:15:41.740585 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:15:41.741752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:15:41.742429 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:15:41.756186 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:15:41.757222 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:15:41.758478 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:15:41.759787 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:15:41.760960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:15:41.761615 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:15:41.786354 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:15:41.787339 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:15:41.788661 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:15:41.790013 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:15:41.790995 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:15:41.791629 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:15:41.806657 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:15:41.807638 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:15:41.808868 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:15:41.810163 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:15:41.811055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:15:41.811668 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:15:41.824801 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:15:41.825775 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:15:41.826831 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:15:41.827950 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:15:41.828999 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:15:41.829790 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:15:41.844188 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:15:41.845177 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:15:41.846238 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:15:41.847327 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:15:41.848208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:15:41.848924 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:15:41.862058 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:15:41.862995 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:15:41.864038 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:15:41.865156 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:15:41.865992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:15:41.866606 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:15:41.881271 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:15:41.882233 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:15:41.883284 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:15:41.884431 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:15:41.885284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:15:41.885886 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:15:41.898987 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:15:41.899901 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:15:41.900961 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:15:41.902029 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:15:41.902809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:15:41.903408 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:15:41.916347 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:15:41.917308 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:15:41.918425 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:15:41.919549 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:15:41.920367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:15:41.921119 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:15:41.935632 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:15:41.936592 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:15:41.937672 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:15:41.938857 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:15:41.939682 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:15:41.940255 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:15:41.953378 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:15:41.954433 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:15:41.955502 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:15:41.956677 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:15:41.957598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:15:41.958249 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:15:41.976068 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:15:41.977156 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:15:41.978259 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:15:41.979610 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:15:41.980585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:15:41.981247 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:15:41.993436 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:15:41.994429 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:15:41.995502 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:15:41.996690 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:15:41.997590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:15:41.998241 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:15:42.039060 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:15:42.040237 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:15:42.041479 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:15:42.042728 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:15:42.043665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:15:42.044429 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:15:42.057633 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:15:42.058688 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:15:42.059809 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:15:42.062082 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:15:42.063133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:15:42.063807 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:15:42.077958 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:15:42.079094 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:15:42.080234 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:15:42.081518 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:15:42.082399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:15:42.083090 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:15:42.095190 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:15:42.096333 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:15:42.097635 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:15:42.099007 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:15:42.100288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:15:42.100991 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:15:42.113925 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:15:42.114870 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:15:42.116033 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:15:42.117332 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:15:42.118308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:15:42.119214 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:15:42.280963 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:15:42.282156 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:15:42.283281 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:15:42.284589 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:15:42.285509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:15:42.286160 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:15:42.298173 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:15:42.299376 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:15:42.300466 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:15:42.301892 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:15:42.302795 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:15:42.303457 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:15:42.317752 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:15:42.318789 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:15:42.319847 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:15:42.321065 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:15:42.321952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:15:42.322606 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:15:42.334490 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:15:42.335401 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:15:42.336407 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:15:42.337671 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:15:42.338624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:15:42.339271 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:15:42.362965 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:15:42.363944 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:15:42.365056 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:15:42.366236 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:15:42.367089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:15:42.367683 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:15:42.382070 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:15:42.383088 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:15:42.384150 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:15:42.385363 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:15:42.386254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:15:42.386872 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:15:42.399786 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:15:42.400747 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:15:42.401794 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:15:42.402944 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:15:42.403786 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:15:42.404415 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:15:42.419680 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:15:42.420744 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:15:42.421846 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:15:42.423051 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:15:42.423898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:15:42.424497 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:15:42.437346 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:15:42.438300 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:15:42.439491 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:15:42.440643 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:15:42.441517 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:15:42.442158 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:15:42.457050 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:15:42.458074 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:15:42.459278 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:15:42.460541 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:15:42.461433 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:15:42.462035 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:15:42.475023 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:15:42.476075 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:15:42.477221 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:15:42.479239 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:15:42.480240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:15:42.481001 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:15:42.495956 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:15:42.497049 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:15:42.498185 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:15:42.519408 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:15:42.520075 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:15:42.525884 [debug] [Dummy-1   ]: Command end result
[0m16:15:42.570979 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:15:42.573906 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:15:42.585346 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:15:42.587544 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.259111, "process_in_blocks": "0", "process_kernel_time": 1.55, "process_mem_max_rss": "441300", "process_out_blocks": "0", "process_user_time": 6.37}
[0m16:15:42.588433 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:15:42.588065 after 5.26 seconds
[0m16:15:42.589173 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:17:05.915092 | 2deb9cf0-b555-4b83-ac39-9c18048dd9b8 ==============================
[0m16:17:05.915092 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:17:05.916479 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:17:06.335970 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:17:07.108994 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:17:07.547596 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:17:07.548306 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:17:07.769809 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:17:07.773205 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:17:07.835071 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:17:07.838954 [info ] [Dummy-1   ]: 
[0m16:17:07.839701 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:17:07.840254 [info ] [Dummy-1   ]: 
[0m16:17:07.841250 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:17:07.849327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:17:08.007268 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:17:08.007989 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:17:08.008911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:08.953220 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.944 seconds
[0m16:17:08.958706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m16:17:08.984498 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:17:08.985243 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:17:08.985810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:09.934713 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.949 seconds
[0m16:17:09.941106 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:17:09.941791 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:17:10.096728 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.154 seconds
[0m16:17:10.099876 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:17:10.100542 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:17:10.239885 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.139 seconds
[0m16:17:10.242640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:17:10.255497 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:17:10.256202 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:17:10.256722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:11.321608 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.065 seconds
[0m16:17:11.324355 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:17:11.325008 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:17:11.453885 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.128 seconds
[0m16:17:11.456559 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:17:11.457207 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:17:11.592911 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.135 seconds
[0m16:17:11.600670 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:17:11.601722 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:17:11.603139 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:17:11.603880 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:17:11.623865 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:17:11.624885 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:17:11.686341 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:17:11.688370 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:17:11.689311 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:17:11.690048 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:17:13.080976 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.391 seconds
[0m16:17:13.119527 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.51s]
[0m16:17:13.120636 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:17:13.122785 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:17:13.124093 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:17:13.124952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:17:13.125597 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:17:13.168011 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:17:13.169198 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:17:13.213858 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:17:13.216959 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:17:13.218176 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(relative_path: str):
    asset_path = dbt.config.get("asset_path")
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{dbt.config.get("docs_stage_path")}/qa'), F.col('relative_path')),
            get_response_format(F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:17:13.219311 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:17:17.516298 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d31-0206-cee1-0032-318704d765da
[0m16:17:17.517179 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
    df = model(dbt, session)
  File "_udf_code.py", line 39, in model
    get_response_format(F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    asset_path = dbt.config.get("asset_path")
NameError: name 'dbt' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:17:17.523217 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:17:17.525019 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.40s]
[0m16:17:17.526150 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:17:17.527758 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:17:17.531064 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:17:17.531682 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:17:17.532244 [info ] [Dummy-1   ]: 
[0m16:17:17.532801 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.69 seconds (9.69s).
[0m16:17:17.534074 [debug] [Dummy-1   ]: Command end result
[0m16:17:17.581099 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:17:17.584198 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:17:17.593027 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:17:17.593654 [info ] [Dummy-1   ]: 
[0m16:17:17.594430 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:17:17.594994 [info ] [Dummy-1   ]: 
[0m16:17:17.595830 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:17:17.596410 [info ] [Dummy-1   ]: 
[0m16:17:17.596953 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:17:17.599077 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.791387, "process_in_blocks": "0", "process_kernel_time": 1.4, "process_mem_max_rss": "433864", "process_out_blocks": "0", "process_user_time": 6.35}
[0m16:17:17.599874 [debug] [Dummy-1   ]: Command `cli run` failed at 16:17:17.599576 after 11.79 seconds
[0m16:17:17.600523 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:18:43.111063 | ccb497da-c85c-4b3a-8fa5-caafb61f9607 ==============================
[0m16:18:43.111063 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:18:43.112234 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:18:43.510231 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:18:44.285735 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:18:44.703261 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:18:44.703988 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:18:44.918244 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:18:44.921360 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:18:44.983017 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:18:44.986758 [info ] [Dummy-1   ]: 
[0m16:18:44.987473 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:18:44.988053 [info ] [Dummy-1   ]: 
[0m16:18:44.989046 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:18:44.996539 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:18:45.141391 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:18:45.142149 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:18:45.142720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:46.278949 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.136 seconds
[0m16:18:46.284278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m16:18:46.308790 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:18:46.309670 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:18:46.310244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:47.538042 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.228 seconds
[0m16:18:47.544195 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:18:47.544930 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:18:47.765673 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.220 seconds
[0m16:18:47.768223 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:18:47.769049 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:18:47.941596 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.172 seconds
[0m16:18:47.944174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:18:47.955077 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:18:47.955726 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:18:47.956223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:49.114007 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.158 seconds
[0m16:18:49.116607 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:18:49.117230 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:18:49.290045 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.172 seconds
[0m16:18:49.292847 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:18:49.293453 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:18:49.435037 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.141 seconds
[0m16:18:49.444549 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:18:49.445519 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:18:49.446347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m16:18:49.447416 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:18:49.466753 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:18:49.467768 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:18:49.529929 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:18:49.531970 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:18:49.532721 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:18:49.533363 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:18:50.949870 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.416 seconds
[0m16:18:50.986451 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.54s]
[0m16:18:50.987520 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:18:50.989697 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:18:50.990864 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:18:50.991683 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:18:50.992300 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:18:51.033163 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:18:51.034210 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:18:51.077930 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:18:51.081021 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:18:51.082202 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(relative_path: str):
    asset_path = dbt.config.get("asset_path")
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{dbt.config.get("docs_stage_path")}/qa'), F.col('relative_path')),
            get_response_format(F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:18:51.083130 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:18:54.634511 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d32-0206-e114-0032-318704d56f26
[0m16:18:54.635287 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
    df = model(dbt, session)
  File "_udf_code.py", line 39, in model
    get_response_format(F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    asset_path = dbt.config.get("asset_path")
NameError: name 'dbt' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:18:54.641006 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:18:54.642586 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.65s]
[0m16:18:54.643614 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:18:54.645099 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:18:54.648059 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:18:54.648735 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:18:54.649358 [info ] [Dummy-1   ]: 
[0m16:18:54.649967 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.66 seconds (9.66s).
[0m16:18:54.651255 [debug] [Dummy-1   ]: Command end result
[0m16:18:54.696381 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:18:54.699347 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:18:54.707670 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:18:54.708273 [info ] [Dummy-1   ]: 
[0m16:18:54.709059 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:18:54.709618 [info ] [Dummy-1   ]: 
[0m16:18:54.710495 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:18:54.711061 [info ] [Dummy-1   ]: 
[0m16:18:54.711599 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:18:54.713526 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.704956, "process_in_blocks": "0", "process_kernel_time": 1.15, "process_mem_max_rss": "436256", "process_out_blocks": "0", "process_user_time": 6.13}
[0m16:18:54.714290 [debug] [Dummy-1   ]: Command `cli run` failed at 16:18:54.713996 after 11.71 seconds
[0m16:18:54.714886 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:31:15.671690 | 2b75aeaa-8bce-4508-a768-1fc0e320338a ==============================
[0m16:31:15.671690 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:31:15.672868 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:31:16.065794 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:31:16.860298 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:31:17.283493 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:17.284208 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:17.497812 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:31:17.500997 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:31:17.562443 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:31:17.566144 [info ] [Dummy-1   ]: 
[0m16:31:17.566783 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:31:17.567315 [info ] [Dummy-1   ]: 
[0m16:31:17.568289 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:31:17.575977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:31:17.724822 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:31:17.725565 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:31:17.726138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:18.673208 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.947 seconds
[0m16:31:18.680453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_bronze_zone)
[0m16:31:18.704534 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:31:18.705210 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:31:18.705819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:20.226470 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.520 seconds
[0m16:31:20.232586 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:31:20.233262 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:31:20.370174 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.136 seconds
[0m16:31:20.373171 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:31:20.373843 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:31:20.495896 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m16:31:20.498679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:31:20.511265 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:31:20.511966 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:31:20.512558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:21.416123 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.903 seconds
[0m16:31:21.418733 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:31:21.419404 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:31:22.313654 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.893 seconds
[0m16:31:22.316181 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:31:22.316790 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:31:22.453559 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m16:31:22.461307 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:31:22.462350 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:31:22.463715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:31:22.464414 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:31:22.483912 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:31:22.484919 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:31:22.545950 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:31:22.547971 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:31:22.548836 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:31:22.549516 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:31:23.845434 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.296 seconds
[0m16:31:23.882132 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.42s]
[0m16:31:23.883199 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:31:23.885300 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:31:23.886455 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:31:23.887264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:31:23.887900 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:31:23.928864 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:31:23.929882 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:31:23.973310 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:31:23.976347 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:31:23.977554 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(relative_path: str):
    asset_path = dbt.config.get("asset_path")
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{dbt.config.get("docs_stage_path")}/qa'), F.col('relative_path')),
            get_response_format(F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:31:23.978586 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:31:29.323705 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d3f-0206-e1f0-0032-318704d6ec1e
[0m16:31:29.324526 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
    df = model(dbt, session)
  File "_udf_code.py", line 39, in model
    get_response_format(F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    asset_path = dbt.config.get("asset_path")
NameError: name 'dbt' is not defined
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:31:29.330376 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:31:29.332075 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 5.44s]
[0m16:31:29.333156 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:31:29.334706 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:31:29.337885 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:31:29.338567 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:31:29.339160 [info ] [Dummy-1   ]: 
[0m16:31:29.339728 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 11.77 seconds (11.77s).
[0m16:31:29.340987 [debug] [Dummy-1   ]: Command end result
[0m16:31:29.386561 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:31:29.389578 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:31:29.398001 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:31:29.398679 [info ] [Dummy-1   ]: 
[0m16:31:29.399380 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:31:29.399958 [info ] [Dummy-1   ]: 
[0m16:31:29.400770 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
      df = model(dbt, session)
    File "_udf_code.py", line 39, in model
      get_response_format(F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      asset_path = dbt.config.get("asset_path")
  NameError: name 'dbt' is not defined
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:31:29.401324 [info ] [Dummy-1   ]: 
[0m16:31:29.401851 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:31:29.403776 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.835051, "process_in_blocks": "0", "process_kernel_time": 1.31, "process_mem_max_rss": "433796", "process_out_blocks": "0", "process_user_time": 6.2}
[0m16:31:29.404509 [debug] [Dummy-1   ]: Command `cli run` failed at 16:31:29.404237 after 13.84 seconds
[0m16:31:29.405114 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:35:03.161476 | 306dfbeb-b32e-4211-aef7-32c903dfe3d5 ==============================
[0m16:35:03.161476 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:35:03.162612 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:35:03.542654 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:35:04.289496 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:35:04.694355 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:35:04.695638 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m16:35:05.350940 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:35:05.353788 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:35:05.401234 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:35:05.405594 [info ] [Dummy-1   ]: 
[0m16:35:05.406256 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:35:05.406723 [info ] [Dummy-1   ]: 
[0m16:35:05.428922 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:35:05.437502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:35:05.567977 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:35:05.568846 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:35:05.569374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:06.394774 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.825 seconds
[0m16:35:06.400777 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:35:06.401433 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:35:06.553901 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.152 seconds
[0m16:35:06.557437 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:35:06.558114 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:35:06.676286 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.117 seconds
[0m16:35:06.679101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:35:06.691441 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:35:06.692097 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:35:06.692602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:07.483077 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.790 seconds
[0m16:35:07.485593 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:35:07.486226 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:35:07.606836 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.120 seconds
[0m16:35:07.609313 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:35:07.609932 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:35:07.756381 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.146 seconds
[0m16:35:07.783295 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:35:07.784159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m16:35:07.784916 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:35:07.804923 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:35:07.806029 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:35:07.807142 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:35:07.808457 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:35:07.809380 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:35:07.810091 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:35:07.822111 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:35:07.823213 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:35:07.824336 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:35:07.825517 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:35:07.826608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:35:07.827265 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:35:07.840810 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:35:07.841827 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:35:07.842912 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:35:07.844103 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:35:07.845225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:35:07.845962 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:35:07.870960 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:35:07.872153 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:35:07.873343 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:35:07.874552 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:35:07.875455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:35:07.876207 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:35:07.889424 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:35:07.890404 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:35:07.891448 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:35:07.892616 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:35:07.893452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:35:07.894131 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:35:07.908571 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:35:07.909493 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:35:07.910536 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:35:07.911610 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:35:07.912449 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:35:07.913126 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:35:07.925834 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:35:07.926875 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:35:07.927894 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:35:07.929046 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:35:07.929918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:35:07.930503 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:35:07.944364 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:35:07.945456 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:35:07.946515 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:35:07.947574 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:35:07.948430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:35:07.949094 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:35:07.961606 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:35:07.962505 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:35:07.963507 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:35:07.964543 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:35:07.965324 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:35:07.965970 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:35:07.980307 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:35:07.981347 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:35:07.982460 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:35:07.983590 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:35:07.984443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:35:07.985069 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:35:08.134322 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:35:08.135264 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:35:08.136296 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:35:08.137359 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:35:08.138252 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:35:08.139004 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:35:08.151602 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:35:08.152559 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:35:08.153584 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:35:08.154907 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:35:08.155686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:35:08.156256 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:35:08.170570 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:35:08.171530 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:35:08.172556 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:35:08.173634 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:35:08.174462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:35:08.175075 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:35:08.190607 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:35:08.191525 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:35:08.192518 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:35:08.193612 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:35:08.194465 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:35:08.195096 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:35:08.209145 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:35:08.210199 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:35:08.211260 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:35:08.212377 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:35:08.213277 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:35:08.213942 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:35:08.251380 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:35:08.252342 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:35:08.253347 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:35:08.254513 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:35:08.255265 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:35:08.255828 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:35:08.270199 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:35:08.271150 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:35:08.272168 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:35:08.274061 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:35:08.274907 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:35:08.275513 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:35:08.287405 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:35:08.288317 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:35:08.289470 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:35:08.290832 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:35:08.291619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:35:08.292217 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:35:08.303448 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:35:08.304298 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:35:08.305260 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:35:08.306389 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:35:08.307478 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:35:08.308048 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:35:08.322586 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:35:08.323529 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:35:08.324548 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:35:08.325634 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:35:08.326417 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:35:08.326971 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:35:08.339353 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:35:08.340269 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:35:08.341256 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:35:08.342384 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:35:08.343159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:35:08.343739 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:35:08.357124 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:35:08.358106 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:35:08.359177 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:35:08.360302 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:35:08.361183 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:35:08.361892 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:35:08.374246 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:35:08.375204 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:35:08.376211 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:35:08.377331 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:35:08.378198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:35:08.378937 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:35:08.397985 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:35:08.399331 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:35:08.400744 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:35:08.402327 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:35:08.403165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:35:08.404119 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:35:08.427133 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:35:08.428065 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:35:08.429194 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:35:08.430346 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:35:08.431144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:35:08.431739 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:35:08.445937 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:35:08.446852 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:35:08.447857 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:35:08.449099 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:35:08.449976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:35:08.450622 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:35:08.465113 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:35:08.466031 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:35:08.467040 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:35:08.468127 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:35:08.468950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:35:08.469607 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:35:08.482170 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:35:08.483042 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:35:08.484031 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:35:08.485146 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:35:08.485929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:35:08.486498 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:35:08.500429 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:35:08.501307 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:35:08.502320 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:35:08.503421 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:35:08.504176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:35:08.504734 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:35:08.517065 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:35:08.517957 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:35:08.519026 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:35:08.520116 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:35:08.520881 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:35:08.521448 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:35:08.535271 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:35:08.536158 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:35:08.537149 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:35:08.538288 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:35:08.539114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:35:08.539683 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:35:08.551942 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:35:08.552825 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:35:08.553946 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:35:08.556381 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:35:08.556913 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:35:08.562694 [debug] [Dummy-1   ]: Command end result
[0m16:35:08.605884 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:35:08.608601 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:35:08.619418 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:35:08.621517 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.5589714, "process_in_blocks": "0", "process_kernel_time": 1.52, "process_mem_max_rss": "439332", "process_out_blocks": "0", "process_user_time": 6.41}
[0m16:35:08.622253 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:35:08.621968 after 5.56 seconds
[0m16:35:08.622809 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:37:54.206667 | 9f732453-44e6-4ef8-895c-8d3beb9df4b4 ==============================
[0m16:37:54.206667 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:37:54.207756 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m16:37:54.580265 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:37:55.398486 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:37:55.803908 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:55.804591 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:56.010141 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:37:56.012781 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:37:56.069968 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:37:56.073346 [info ] [Dummy-1   ]: 
[0m16:37:56.073948 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:37:56.074432 [info ] [Dummy-1   ]: 
[0m16:37:56.075266 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:37:56.082292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:37:56.234806 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:37:56.235521 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:37:56.236082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:57.033019 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.797 seconds
[0m16:37:57.038323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:37:57.061596 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:37:57.062260 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:37:57.062747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:57.742140 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.679 seconds
[0m16:37:57.747934 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:37:57.748655 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:37:57.898068 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.149 seconds
[0m16:37:57.900833 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:37:57.901409 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:37:57.969329 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.067 seconds
[0m16:37:57.971903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:37:57.984081 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:37:57.984670 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:37:57.985150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:58.809681 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.824 seconds
[0m16:37:58.812183 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:37:58.812761 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:37:58.911616 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.098 seconds
[0m16:37:58.914111 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:37:58.914764 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:37:59.081574 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.166 seconds
[0m16:37:59.088687 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:37:59.089615 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:37:59.090819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:37:59.091447 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:37:59.110337 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:37:59.111255 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:37:59.168747 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:37:59.170644 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:37:59.171378 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:37:59.172005 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:38:00.111022 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.939 seconds
[0m16:38:00.145180 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.05s]
[0m16:38:00.146195 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:38:00.148147 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:38:00.149276 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:38:00.150051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:38:00.150633 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:38:00.188925 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:38:00.189919 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:38:00.231664 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:38:00.234609 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:38:00.235732 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset_path")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset_path': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:38:00.236670 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:38:04.319154 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d46-0206-cee1-0032-318704d76882
[0m16:38:04.319938 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:38:04.325537 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/{relative_path}.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:38:04.326994 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.18s]
[0m16:38:04.327964 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:38:04.329473 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/{relative_path}.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:38:04.332394 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:38:04.332926 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m16:38:04.333404 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:38:04.333941 [info ] [Dummy-1   ]: 
[0m16:38:04.334467 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m16:38:04.335615 [debug] [Dummy-1   ]: Command end result
[0m16:38:04.378931 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:38:04.381506 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:38:04.389557 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:38:04.390140 [info ] [Dummy-1   ]: 
[0m16:38:04.390812 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:38:04.391321 [info ] [Dummy-1   ]: 
[0m16:38:04.392107 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/{relative_path}.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:38:04.392662 [info ] [Dummy-1   ]: 
[0m16:38:04.393188 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:38:04.395029 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.284812, "process_in_blocks": "0", "process_kernel_time": 1.26, "process_mem_max_rss": "440532", "process_out_blocks": "0", "process_user_time": 5.83}
[0m16:38:04.395709 [debug] [Dummy-1   ]: Command `cli run` failed at 16:38:04.395437 after 10.29 seconds
[0m16:38:04.396268 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:38:32.967290 | 08147b36-340d-4bb4-a233-72426d5001f0 ==============================
[0m16:38:32.967290 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:38:32.968459 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:38:33.341622 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:38:34.173223 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:38:34.571357 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:34.572491 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m16:38:35.213945 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:38:35.216870 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:38:35.263166 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:38:35.267458 [info ] [Dummy-1   ]: 
[0m16:38:35.268140 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:38:35.268774 [info ] [Dummy-1   ]: 
[0m16:38:35.298888 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:38:35.307611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:38:35.480826 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:38:35.481723 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:38:35.482382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:36.257303 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.775 seconds
[0m16:38:36.263299 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:38:36.263994 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:38:36.368447 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.104 seconds
[0m16:38:36.371937 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:38:36.372508 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:38:36.501837 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.129 seconds
[0m16:38:36.504502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:38:36.516717 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:38:36.517324 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:38:36.517826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:37.189188 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.671 seconds
[0m16:38:37.191679 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:38:37.192294 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:38:37.264345 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.071 seconds
[0m16:38:37.266716 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:38:37.267328 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:38:37.381516 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m16:38:37.389370 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:38:37.390814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m16:38:37.391391 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:38:37.411132 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:38:37.412147 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:38:37.413242 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:38:37.414460 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:38:37.415329 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:38:37.415935 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:38:37.428067 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:38:37.429235 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:38:37.430367 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:38:37.431763 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:38:37.432936 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:38:37.433557 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:38:37.447106 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:38:37.448020 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:38:37.449216 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:38:37.450465 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:38:37.451587 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:38:37.452231 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:38:37.476701 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:38:37.477794 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:38:37.479039 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:38:37.480296 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:38:37.481170 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:38:37.481863 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:38:37.494987 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:38:37.495931 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:38:37.496969 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:38:37.498144 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:38:37.499091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:38:37.499699 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:38:37.513908 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:38:37.514906 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:38:37.515956 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:38:37.517050 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:38:37.517863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:38:37.518600 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:38:37.531402 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:38:37.532404 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:38:37.533528 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:38:37.534620 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:38:37.535434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:38:37.536026 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:38:37.550411 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:38:37.551370 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:38:37.552412 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:38:37.553466 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:38:37.554301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:38:37.554948 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:38:37.567733 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:38:37.568758 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:38:37.569840 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:38:37.570934 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:38:37.571733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:38:37.572357 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:38:37.586483 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:38:37.587547 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:38:37.588652 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:38:37.589710 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:38:37.590509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:38:37.591119 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:38:37.740387 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:38:37.741313 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:38:37.742363 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:38:37.743417 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:38:37.744201 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:38:37.744784 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:38:37.757186 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:38:37.758248 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:38:37.759380 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:38:37.760671 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:38:37.761447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:38:37.762059 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:38:37.776048 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:38:37.776977 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:38:37.778004 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:38:37.779132 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:38:37.779924 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:38:37.780546 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:38:37.795413 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:38:37.796337 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:38:37.797367 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:38:37.798552 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:38:37.799339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:38:37.799929 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:38:37.813383 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:38:37.814271 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:38:37.815272 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:38:37.816490 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:38:37.817310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:38:37.817908 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:38:37.854975 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:38:37.855993 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:38:37.856984 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:38:37.858118 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:38:37.859003 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:38:37.859637 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:38:37.874155 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:38:37.875075 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:38:37.876056 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:38:37.877985 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:38:37.878951 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:38:37.879553 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:38:37.891462 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:38:37.892297 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:38:37.893275 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:38:37.894634 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:38:37.895451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:38:37.896025 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:38:37.907378 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:38:37.908237 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:38:37.909323 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:38:37.910490 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:38:37.911624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:38:37.912226 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:38:37.926562 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:38:37.927425 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:38:37.928523 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:38:37.929664 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:38:37.930455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:38:37.931019 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:38:37.943297 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:38:37.944146 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:38:37.945108 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:38:37.946194 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:38:37.946923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:38:37.947478 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:38:37.960674 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:38:37.961551 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:38:37.962563 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:38:37.963685 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:38:37.964460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:38:37.965019 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:38:37.976913 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:38:37.977734 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:38:37.978800 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:38:37.979898 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:38:37.980651 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:38:37.981206 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:38:37.993974 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:38:37.994806 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:38:37.995763 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:38:37.996806 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:38:37.997566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:38:37.998162 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:38:38.017950 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:38:38.018856 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:38:38.019838 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:38:38.020891 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:38:38.021631 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:38:38.022222 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:38:38.035677 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:38:38.036516 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:38:38.037478 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:38:38.038596 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:38:38.039353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:38:38.039909 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:38:38.053657 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:38:38.054496 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:38:38.055445 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:38:38.056475 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:38:38.057222 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:38:38.057798 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:38:38.069693 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:38:38.070640 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:38:38.071661 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:38:38.072719 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:38:38.073447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:38:38.074055 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:38:38.087952 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:38:38.088862 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:38:38.089856 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:38:38.090928 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:38:38.091646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:38:38.092199 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:38:38.104067 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:38:38.104878 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:38:38.105848 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:38:38.106891 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:38:38.107652 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:38:38.108210 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:38:38.121665 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:38:38.122589 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:38:38.123560 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:38:38.124618 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:38:38.125364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:38:38.125948 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:38:38.137945 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:38:38.138866 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:38:38.139820 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:38:38.142276 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:38:38.142796 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:38:38.148551 [debug] [Dummy-1   ]: Command end result
[0m16:38:38.191670 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:38:38.194376 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:38:38.205211 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:38:38.207224 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.336615, "process_in_blocks": "0", "process_kernel_time": 1.26, "process_mem_max_rss": "437376", "process_out_blocks": "0", "process_user_time": 6.72}
[0m16:38:38.207934 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:38:38.207655 after 5.34 seconds
[0m16:38:38.208568 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:39:42.845902 | ba611349-42e0-4e19-8aa9-2940e1b975be ==============================
[0m16:39:42.845902 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:39:42.847006 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:39:43.227298 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:39:44.040980 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:39:44.451296 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:44.451961 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:44.658275 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:39:44.661258 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:39:44.719291 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:39:44.722713 [info ] [Dummy-1   ]: 
[0m16:39:44.723317 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:39:44.723798 [info ] [Dummy-1   ]: 
[0m16:39:44.724636 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:39:44.731842 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:39:44.904395 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:39:44.905105 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:39:44.905707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:45.711875 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.806 seconds
[0m16:39:45.717062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:39:45.740777 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:39:45.741495 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:39:45.742047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:46.571881 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.830 seconds
[0m16:39:46.577744 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:39:46.578433 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:39:46.704699 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.126 seconds
[0m16:39:46.707532 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:39:46.708140 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:39:46.837811 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.129 seconds
[0m16:39:46.840450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:39:46.852892 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:39:46.853516 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:39:46.854069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:47.817152 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.963 seconds
[0m16:39:47.819892 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:39:47.820503 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:39:47.935852 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.115 seconds
[0m16:39:47.938406 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:39:47.939065 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:39:48.025510 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.086 seconds
[0m16:39:48.032698 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:39:48.033699 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:39:48.035016 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:39:48.035677 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:39:48.054877 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:39:48.055854 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:39:48.116770 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:39:48.118796 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:39:48.119538 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:39:48.120146 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:39:49.041294 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.921 seconds
[0m16:39:49.076401 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.04s]
[0m16:39:49.077432 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:39:49.079450 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:39:49.080582 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:39:49.081416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:39:49.082042 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:39:49.121615 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:39:49.122639 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:39:49.165509 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:39:49.168588 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:39:49.169787 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset-paths")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset-paths': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:39:49.170723 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:39:52.519272 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d47-0206-cee1-0032-318704d76972
[0m16:39:52.520100 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'{asset_path}/{relative_path}.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:39:52.525736 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/{relative_path}.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:39:52.527257 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.45s]
[0m16:39:52.528252 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:39:52.529784 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/{relative_path}.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:39:52.532680 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:39:52.533218 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m16:39:52.533674 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:39:52.534226 [info ] [Dummy-1   ]: 
[0m16:39:52.534751 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.81 seconds (7.81s).
[0m16:39:52.535922 [debug] [Dummy-1   ]: Command end result
[0m16:39:52.580468 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:39:52.583244 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:39:52.591424 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:39:52.591996 [info ] [Dummy-1   ]: 
[0m16:39:52.592646 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:39:52.593156 [info ] [Dummy-1   ]: 
[0m16:39:52.593974 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/{relative_path}.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/Column["RELATIVE_PATH"].json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:39:52.594543 [info ] [Dummy-1   ]: 
[0m16:39:52.595069 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:39:52.596914 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.848986, "process_in_blocks": "0", "process_kernel_time": 1.5, "process_mem_max_rss": "439540", "process_out_blocks": "0", "process_user_time": 5.62}
[0m16:39:52.597603 [debug] [Dummy-1   ]: Command `cli run` failed at 16:39:52.597335 after 9.85 seconds
[0m16:39:52.598183 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:40:49.415437 | a6cabb14-f975-4a8a-bd2f-79fedf4e4b4f ==============================
[0m16:40:49.415437 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:40:49.416696 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:40:49.798954 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:40:50.590894 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:40:51.008029 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:40:51.009226 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m16:40:51.661458 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:40:51.664273 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:40:51.711295 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:40:51.715654 [info ] [Dummy-1   ]: 
[0m16:40:51.716305 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:40:51.716831 [info ] [Dummy-1   ]: 
[0m16:40:51.717796 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:40:51.726526 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m16:40:51.883675 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:40:51.884392 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:40:51.884925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:52.799775 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.915 seconds
[0m16:40:52.805655 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:40:52.806267 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:40:52.895935 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.089 seconds
[0m16:40:52.899417 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:40:52.900128 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:40:52.999098 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m16:40:53.001557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:40:53.012263 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:40:53.013030 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:40:53.013591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:53.719608 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.706 seconds
[0m16:40:53.722126 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:40:53.722714 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:40:53.852334 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.129 seconds
[0m16:40:53.855082 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:40:53.855737 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:40:53.953677 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.097 seconds
[0m16:40:53.994245 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:40:53.995102 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m16:40:53.995708 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:40:54.019484 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:40:54.020732 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:40:54.021982 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:40:54.023302 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:40:54.024247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:40:54.024905 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:40:54.037214 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:40:54.038223 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:40:54.039407 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:40:54.040667 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:40:54.041817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:40:54.042437 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:40:54.056550 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:40:54.057591 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:40:54.058928 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:40:54.060218 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:40:54.061397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:40:54.062050 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:40:54.087607 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:40:54.088712 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:40:54.089836 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:40:54.091062 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:40:54.091929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:40:54.092521 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:40:54.105679 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:40:54.106761 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:40:54.107901 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:40:54.109246 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:40:54.110122 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:40:54.110746 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:40:54.125157 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:40:54.126095 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:40:54.127143 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:40:54.128314 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:40:54.129355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:40:54.129982 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:40:54.142797 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:40:54.143756 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:40:54.144803 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:40:54.145864 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:40:54.146696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:40:54.147276 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:40:54.161434 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:40:54.163398 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:40:54.164524 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:40:54.165588 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:40:54.166361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:40:54.166929 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:40:54.180025 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:40:54.181059 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:40:54.182121 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:40:54.183229 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:40:54.184188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:40:54.184920 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:40:54.199223 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:40:54.200399 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:40:54.201418 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:40:54.202482 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:40:54.203308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:40:54.203911 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:40:54.354258 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:40:54.355186 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:40:54.356239 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:40:54.357316 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:40:54.358103 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:40:54.358764 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:40:54.371899 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:40:54.372832 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:40:54.373882 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:40:54.374964 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:40:54.375823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:40:54.376440 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:40:54.391060 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:40:54.392113 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:40:54.393160 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:40:54.394267 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:40:54.395081 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:40:54.395720 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:40:54.411696 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:40:54.412687 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:40:54.413740 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:40:54.414856 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:40:54.415673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:40:54.416245 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:40:54.430257 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:40:54.431212 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:40:54.432284 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:40:54.433480 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:40:54.434353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:40:54.434967 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:40:54.472965 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:40:54.473994 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:40:54.475049 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:40:54.476209 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:40:54.476996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:40:54.477618 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:40:54.492350 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:40:54.493297 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:40:54.494296 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:40:54.496101 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:40:54.497068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:40:54.497686 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:40:54.509977 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:40:54.510920 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:40:54.511960 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:40:54.513158 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:40:54.513948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:40:54.514518 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:40:54.526100 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:40:54.526988 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:40:54.528006 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:40:54.529217 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:40:54.530347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:40:54.530957 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:40:54.545972 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:40:54.546861 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:40:54.547888 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:40:54.549129 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:40:54.549991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:40:54.550611 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:40:54.563309 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:40:54.564254 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:40:54.565260 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:40:54.566412 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:40:54.567174 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:40:54.567844 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:40:54.581370 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:40:54.582381 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:40:54.583422 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:40:54.584561 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:40:54.585401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:40:54.586005 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:40:54.598451 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:40:54.599439 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:40:54.600492 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:40:54.601881 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:40:54.602700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:40:54.603273 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:40:54.616648 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:40:54.617519 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:40:54.618586 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:40:54.619761 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:40:54.620586 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:40:54.621178 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:40:54.641674 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:40:54.642600 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:40:54.643632 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:40:54.644772 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:40:54.645563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:40:54.646141 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:40:54.660452 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:40:54.661379 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:40:54.662382 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:40:54.663509 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:40:54.664282 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:40:54.667168 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:40:54.679848 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:40:54.680734 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:40:54.681723 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:40:54.682847 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:40:54.683677 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:40:54.684295 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:40:54.696976 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:40:54.697886 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:40:54.698955 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:40:54.700109 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:40:54.700904 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:40:54.701471 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:40:54.715994 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:40:54.716907 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:40:54.717908 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:40:54.719108 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:40:54.719920 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:40:54.720484 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:40:54.733107 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:40:54.733977 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:40:54.734949 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:40:54.736089 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:40:54.736840 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:40:54.737406 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:40:54.751862 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:40:54.752774 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:40:54.753772 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:40:54.754902 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:40:54.755705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:40:54.756278 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:40:54.768940 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:40:54.769841 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:40:54.770846 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:40:54.773349 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:40:54.773903 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:40:54.779786 [debug] [Dummy-1   ]: Command end result
[0m16:40:54.823710 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:40:54.826467 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:40:54.837401 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:40:54.839563 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.5233455, "process_in_blocks": "0", "process_kernel_time": 1.29, "process_mem_max_rss": "443724", "process_out_blocks": "0", "process_user_time": 6.74}
[0m16:40:54.840313 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:40:54.840029 after 5.52 seconds
[0m16:40:54.840883 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:41:32.572273 | 4cdd5100-1837-4c0c-b05d-2a2943f1a691 ==============================
[0m16:41:32.572273 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:41:32.573331 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:41:32.942414 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:41:33.680726 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:41:34.070076 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:34.070745 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:34.269826 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:41:34.272253 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:41:34.326813 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:41:34.330122 [info ] [Dummy-1   ]: 
[0m16:41:34.330800 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:41:34.331311 [info ] [Dummy-1   ]: 
[0m16:41:34.332197 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:41:34.339025 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:41:34.482429 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:41:34.483108 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:41:34.483646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:35.253046 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.769 seconds
[0m16:41:35.257941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management, now list_incident_management_gold_zone)
[0m16:41:35.280691 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:41:35.281272 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:41:35.281775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:36.062740 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.781 seconds
[0m16:41:36.068602 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:41:36.069243 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:41:36.172904 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.103 seconds
[0m16:41:36.175354 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:41:36.175989 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:41:36.277578 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m16:41:36.280052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:41:36.290741 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:41:36.291397 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:41:36.291900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:37.108890 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.817 seconds
[0m16:41:37.111459 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:41:37.112106 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:41:37.228425 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.116 seconds
[0m16:41:37.231088 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:41:37.231666 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:41:37.421274 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.189 seconds
[0m16:41:37.430197 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:41:37.431104 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:41:37.431845 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m16:41:37.432858 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:41:37.451614 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:41:37.452524 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:41:37.510042 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:41:37.511912 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:41:37.512604 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:41:37.513225 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:41:38.532341 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.019 seconds
[0m16:41:38.566252 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.13s]
[0m16:41:38.567263 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:41:38.569214 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:41:38.570271 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:41:38.571039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:41:38.571639 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:41:38.609573 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:41:38.610551 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:41:38.651744 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:41:38.654658 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:41:38.655771 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'{asset_path}/global_inm_policy_schema.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset-paths")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset-paths': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:41:38.656694 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:41:41.892456 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d49-0206-cee1-0032-318704d76aea
[0m16:41:41.893231 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'{asset_path}/global_inm_policy_schema.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'None/global_inm_policy_schema.json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:41:41.898757 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:41:41.900196 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.33s]
[0m16:41:41.901175 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:41:41.902628 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:41:41.905438 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:41:41.905999 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:41:41.906521 [info ] [Dummy-1   ]: 
[0m16:41:41.907041 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m16:41:41.908218 [debug] [Dummy-1   ]: Command end result
[0m16:41:41.950244 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:41:41.952484 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:41:41.960194 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:41:41.960697 [info ] [Dummy-1   ]: 
[0m16:41:41.961331 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:41:41.961846 [info ] [Dummy-1   ]: 
[0m16:41:41.962646 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'{asset_path}/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'None/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:41:41.963191 [info ] [Dummy-1   ]: 
[0m16:41:41.963707 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:41:41.965417 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.488312, "process_in_blocks": "0", "process_kernel_time": 1.36, "process_mem_max_rss": "445764", "process_out_blocks": "0", "process_user_time": 5.49}
[0m16:41:41.966114 [debug] [Dummy-1   ]: Command `cli run` failed at 16:41:41.965840 after 9.49 seconds
[0m16:41:41.966670 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:44:35.362108 | 68705cfa-344f-413a-ab4e-86ba07f5159b ==============================
[0m16:44:35.362108 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:44:35.363156 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m16:44:35.730385 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:44:36.514417 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:44:36.904045 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:44:36.905098 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m16:44:37.533666 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:44:37.536201 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:44:37.580112 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:44:37.584219 [info ] [Dummy-1   ]: 
[0m16:44:37.584890 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:44:37.585435 [info ] [Dummy-1   ]: 
[0m16:44:37.586391 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:44:37.594623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m16:44:37.740395 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:44:37.741040 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:44:37.741543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:38.627844 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.886 seconds
[0m16:44:38.633668 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:44:38.634307 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:44:38.752300 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.117 seconds
[0m16:44:38.755379 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:44:38.756015 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:44:38.857686 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m16:44:38.860002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:44:38.870146 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:44:38.870728 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:44:38.871259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:39.702144 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.831 seconds
[0m16:44:39.704667 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:44:39.705244 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:44:39.855417 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.150 seconds
[0m16:44:39.858089 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:44:39.858758 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:44:39.970959 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m16:44:39.993488 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:44:39.994270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m16:44:39.994881 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:44:40.014188 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:44:40.015040 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:44:40.016077 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:44:40.017186 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:44:40.017991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:44:40.018661 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:44:40.029664 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:44:40.030532 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:44:40.031496 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:44:40.032510 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:44:40.033476 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:44:40.034126 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:44:40.046751 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:44:40.047678 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:44:40.048767 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:44:40.049839 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:44:40.050883 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:44:40.051563 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:44:40.074747 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:44:40.075594 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:44:40.076569 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:44:40.077584 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:44:40.078425 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:44:40.079033 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:44:40.090713 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:44:40.091680 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:44:40.092675 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:44:40.093699 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:44:40.094529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:44:40.095158 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:44:40.108270 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:44:40.109204 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:44:40.110208 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:44:40.111183 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:44:40.111903 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:44:40.112469 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:44:40.124323 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:44:40.125129 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:44:40.126109 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:44:40.127070 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:44:40.127861 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:44:40.128501 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:44:40.141348 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:44:40.142127 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:44:40.143067 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:44:40.143999 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:44:40.144737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:44:40.145302 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:44:40.156955 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:44:40.157781 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:44:40.158802 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:44:40.159744 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:44:40.160441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:44:40.161006 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:44:40.173838 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:44:40.174625 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:44:40.175547 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:44:40.176452 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:44:40.177147 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:44:40.177705 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:44:40.307069 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:44:40.307986 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:44:40.309025 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:44:40.310034 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:44:40.310788 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:44:40.311354 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:44:40.323005 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:44:40.323784 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:44:40.324703 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:44:40.325617 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:44:40.326338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:44:40.326910 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:44:40.339673 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:44:40.340448 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:44:40.341376 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:44:40.342319 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:44:40.343017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:44:40.343682 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:44:40.358016 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:44:40.358876 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:44:40.359828 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:44:40.360783 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:44:40.361495 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:44:40.362079 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:44:40.374374 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:44:40.375159 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:44:40.376083 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:44:40.377050 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:44:40.377766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:44:40.378446 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:44:40.413674 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:44:40.414523 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:44:40.415487 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:44:40.416488 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:44:40.417216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:44:40.417791 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:44:40.431128 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:44:40.431918 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:44:40.432851 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:44:40.434527 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:44:40.435328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:44:40.435894 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:44:40.446986 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:44:40.447771 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:44:40.448773 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:44:40.449796 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:44:40.450554 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:44:40.451110 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:44:40.461789 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:44:40.462563 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:44:40.463479 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:44:40.464433 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:44:40.465409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:44:40.465988 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:44:40.479395 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:44:40.480188 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:44:40.481119 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:44:40.482129 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:44:40.482908 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:44:40.483497 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:44:40.494941 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:44:40.495720 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:44:40.496639 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:44:40.497590 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:44:40.498313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:44:40.498964 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:44:40.510944 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:44:40.511701 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:44:40.512619 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:44:40.513568 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:44:40.514293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:44:40.514850 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:44:40.526000 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:44:40.526763 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:44:40.527674 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:44:40.528818 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:44:40.529593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:44:40.530224 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:44:40.542289 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:44:40.543089 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:44:40.544028 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:44:40.545032 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:44:40.545762 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:44:40.546356 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:44:40.565484 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:44:40.566298 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:44:40.567260 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:44:40.568237 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:44:40.569040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:44:40.569626 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:44:40.582724 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:44:40.583523 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:44:40.584478 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:44:40.585448 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:44:40.586224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:44:40.588808 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:44:40.600461 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:44:40.601251 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:44:40.602209 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:44:40.603182 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:44:40.603920 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:44:40.604486 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:44:40.615850 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:44:40.616647 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:44:40.617579 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:44:40.618613 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:44:40.619401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:44:40.619986 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:44:40.632986 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:44:40.633768 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:44:40.634709 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:44:40.635648 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:44:40.636344 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:44:40.636905 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:44:40.648143 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:44:40.648993 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:44:40.649926 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:44:40.650875 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:44:40.651583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:44:40.652149 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:44:40.664944 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:44:40.665713 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:44:40.666681 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:44:40.667628 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:44:40.668331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:44:40.668982 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:44:40.680243 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:44:40.681031 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:44:40.681979 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:44:40.684017 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:44:40.684566 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:44:40.690266 [debug] [Dummy-1   ]: Command end result
[0m16:44:40.731097 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:44:40.733378 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:44:40.743655 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:44:40.745512 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.47893, "process_in_blocks": "0", "process_kernel_time": 1.27, "process_mem_max_rss": "439932", "process_out_blocks": "0", "process_user_time": 6.49}
[0m16:44:40.746229 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:44:40.745945 after 5.48 seconds
[0m16:44:40.746780 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:44:55.707135 | c8d29c98-8247-41e1-9f48-9abc13cb0237 ==============================
[0m16:44:55.707135 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:44:55.708346 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:44:56.101957 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:44:56.892340 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:44:57.319907 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:57.320600 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:57.532922 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:44:57.536068 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:44:57.596759 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:44:57.600499 [info ] [Dummy-1   ]: 
[0m16:44:57.601159 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:44:57.601653 [info ] [Dummy-1   ]: 
[0m16:44:57.602640 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:44:57.610055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:44:57.763000 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:44:57.763732 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:44:57.764306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:58.890313 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.126 seconds
[0m16:44:58.895477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m16:44:58.919887 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:44:58.920590 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:44:58.921149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:00.144870 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.224 seconds
[0m16:45:00.150828 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:45:00.151587 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:45:00.288221 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.136 seconds
[0m16:45:00.291013 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:45:00.291651 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:45:00.435733 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.143 seconds
[0m16:45:00.438172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:45:00.449156 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:45:00.449845 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:45:00.450358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:01.766595 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.316 seconds
[0m16:45:01.769454 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:45:01.770105 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:45:02.019824 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.249 seconds
[0m16:45:02.022636 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:45:02.023264 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:45:02.205702 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.182 seconds
[0m16:45:02.215151 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:45:02.216185 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:45:02.217007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m16:45:02.218073 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:45:02.237504 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:45:02.238609 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:45:02.300005 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:45:02.302036 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:45:02.302793 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:45:02.303441 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:45:03.863057 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.559 seconds
[0m16:45:03.899581 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.68s]
[0m16:45:03.900669 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:45:03.902738 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:45:03.903898 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:45:03.904716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:45:03.905317 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:45:03.946251 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:45:03.947314 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:45:03.991021 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:45:03.994089 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:45:03.995286 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'../../assets/global_inm_policy_schema.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset-paths")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset-paths': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:45:03.996286 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:45:07.833475 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d4d-0206-df66-0032-318704d7b586
[0m16:45:07.834335 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'../../assets/global_inm_policy_schema.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: '../../assets/global_inm_policy_schema.json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:45:07.840251 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'../../assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: '../../assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:45:07.841935 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.94s]
[0m16:45:07.842988 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:45:07.844542 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'../../assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: '../../assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:45:07.847642 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:45:07.848276 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m16:45:07.848884 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:45:07.849429 [info ] [Dummy-1   ]: 
[0m16:45:07.849973 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.25 seconds (10.25s).
[0m16:45:07.851196 [debug] [Dummy-1   ]: Command end result
[0m16:45:07.897320 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:45:07.900369 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:45:07.908864 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:45:07.909464 [info ] [Dummy-1   ]: 
[0m16:45:07.910144 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:45:07.910662 [info ] [Dummy-1   ]: 
[0m16:45:07.911473 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'../../assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: '../../assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:45:07.912066 [info ] [Dummy-1   ]: 
[0m16:45:07.912599 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:45:07.914489 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.307465, "process_in_blocks": "0", "process_kernel_time": 1.35, "process_mem_max_rss": "428044", "process_out_blocks": "0", "process_user_time": 5.98}
[0m16:45:07.915194 [debug] [Dummy-1   ]: Command `cli run` failed at 16:45:07.914917 after 12.31 seconds
[0m16:45:07.915805 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:47:00.576414 | 59bfdf90-f6b6-4e0f-9554-2c8ced823c66 ==============================
[0m16:47:00.576414 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:47:00.577640 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:47:00.974653 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:47:01.705636 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:47:02.132425 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:47:02.133573 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m16:47:02.818152 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:47:02.821190 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:47:02.872572 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:47:02.877110 [info ] [Dummy-1   ]: 
[0m16:47:02.877846 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:47:02.878500 [info ] [Dummy-1   ]: 
[0m16:47:02.879567 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:47:02.888338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:47:03.022569 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:47:03.023281 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:47:03.023969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:03.810910 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.787 seconds
[0m16:47:03.817001 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:47:03.817717 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:47:03.898318 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.080 seconds
[0m16:47:03.902214 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:47:03.902858 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:47:03.975091 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.072 seconds
[0m16:47:03.977792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:47:03.990568 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:47:03.991215 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:47:03.991743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:04.722128 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.730 seconds
[0m16:47:04.724736 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:47:04.725398 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:47:04.830933 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.105 seconds
[0m16:47:04.833419 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:47:04.834028 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:47:04.914195 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.079 seconds
[0m16:47:04.922319 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:47:04.923192 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m16:47:04.923854 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:47:04.944141 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:47:04.945185 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:47:04.946311 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:47:04.947646 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:47:04.948631 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:47:04.949302 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:47:04.961681 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:47:04.962649 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:47:04.963764 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:47:04.965006 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:47:04.966165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:47:04.966776 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:47:04.980573 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:47:04.981506 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:47:04.982579 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:47:04.983841 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:47:04.984962 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:47:04.985617 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:47:05.011821 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:47:05.012838 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:47:05.013970 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:47:05.015249 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:47:05.016166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:47:05.016762 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:47:05.030445 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:47:05.031445 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:47:05.032539 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:47:05.033818 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:47:05.034680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:47:05.035266 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:47:05.050290 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:47:05.051288 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:47:05.052395 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:47:05.053548 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:47:05.054421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:47:05.055020 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:47:05.068166 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:47:05.069229 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:47:05.070313 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:47:05.071485 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:47:05.072439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:47:05.073038 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:47:05.087589 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:47:05.088678 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:47:05.089778 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:47:05.090915 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:47:05.091803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:47:05.092524 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:47:05.105840 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:47:05.106809 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:47:05.107857 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:47:05.109146 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:47:05.110021 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:47:05.110647 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:47:05.125642 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:47:05.126778 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:47:05.127893 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:47:05.129169 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:47:05.130070 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:47:05.130700 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:47:05.293221 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:47:05.294230 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:47:05.295296 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:47:05.296457 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:47:05.297277 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:47:05.297867 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:47:05.310995 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:47:05.312063 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:47:05.313236 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:47:05.314658 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:47:05.315602 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:47:05.316345 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:47:05.331497 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:47:05.332604 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:47:05.333639 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:47:05.334813 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:47:05.335909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:47:05.336598 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:47:05.353072 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:47:05.354065 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:47:05.355130 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:47:05.356371 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:47:05.357224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:47:05.357851 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:47:05.372510 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:47:05.373440 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:47:05.374481 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:47:05.375704 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:47:05.376531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:47:05.377177 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:47:05.416549 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:47:05.417529 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:47:05.418669 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:47:05.419924 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:47:05.420878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:47:05.421502 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:47:05.436526 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:47:05.437452 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:47:05.438579 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:47:05.440577 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:47:05.441628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:47:05.442272 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:47:05.454707 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:47:05.455747 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:47:05.456775 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:47:05.458153 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:47:05.459173 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:47:05.459854 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:47:05.471613 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:47:05.472545 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:47:05.473584 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:47:05.474852 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:47:05.475935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:47:05.476573 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:47:05.492368 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:47:05.493379 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:47:05.494434 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:47:05.495626 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:47:05.496444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:47:05.497018 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:47:05.510183 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:47:05.511227 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:47:05.512296 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:47:05.513490 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:47:05.514310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:47:05.514883 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:47:05.528822 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:47:05.529783 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:47:05.530863 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:47:05.532137 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:47:05.532983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:47:05.533559 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:47:05.546202 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:47:05.547168 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:47:05.548251 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:47:05.549553 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:47:05.550385 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:47:05.550954 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:47:05.564583 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:47:05.565501 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:47:05.566548 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:47:05.567824 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:47:05.568794 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:47:05.569460 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:47:05.590831 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:47:05.591907 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:47:05.593012 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:47:05.594219 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:47:05.595122 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:47:05.595793 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:47:05.610453 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:47:05.611378 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:47:05.612455 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:47:05.613645 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:47:05.614474 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:47:05.615117 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:47:05.630183 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:47:05.631111 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:47:05.632244 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:47:05.633439 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:47:05.634297 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:47:05.634929 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:47:05.648074 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:47:05.649130 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:47:05.650192 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:47:05.651378 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:47:05.652224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:47:05.652827 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:47:05.667353 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:47:05.668425 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:47:05.669600 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:47:05.670815 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:47:05.671657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:47:05.672287 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:47:05.685185 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:47:05.686138 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:47:05.687144 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:47:05.688343 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:47:05.689327 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:47:05.689976 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:47:05.704393 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:47:05.705328 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:47:05.706360 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:47:05.707566 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:47:05.708519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:47:05.709214 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:47:05.722096 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:47:05.723025 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:47:05.724102 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:47:05.726686 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:47:05.727237 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:47:05.733212 [debug] [Dummy-1   ]: Command end result
[0m16:47:05.778463 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:47:05.781313 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:47:05.792690 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:47:05.795168 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.3214273, "process_in_blocks": "0", "process_kernel_time": 1.27, "process_mem_max_rss": "443772", "process_out_blocks": "0", "process_user_time": 7.02}
[0m16:47:05.796027 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:47:05.795702 after 5.32 seconds
[0m16:47:05.796685 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:49:28.219965 | c70e6c25-e69b-4c69-b177-5c72bb77e133 ==============================
[0m16:49:28.219965 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:49:28.221144 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:49:28.615664 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:49:29.405235 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:49:29.818467 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:29.819253 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:30.033782 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:49:30.036681 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:49:30.099363 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:49:30.103066 [info ] [Dummy-1   ]: 
[0m16:49:30.103787 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:49:30.104317 [info ] [Dummy-1   ]: 
[0m16:49:30.105286 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:49:30.112872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:49:30.265012 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:49:30.265849 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:49:30.266465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:30.991970 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.725 seconds
[0m16:49:31.010473 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m16:49:31.035707 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:49:31.036393 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:49:31.036911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:31.742991 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.706 seconds
[0m16:49:31.749053 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:49:31.749791 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:49:31.861370 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.111 seconds
[0m16:49:31.864226 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:49:31.864847 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:49:31.993689 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m16:49:31.996383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m16:49:32.009045 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:49:32.009687 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:49:32.010244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:33.297843 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.287 seconds
[0m16:49:33.300507 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:49:33.301136 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:49:33.410496 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.109 seconds
[0m16:49:33.412965 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:49:33.413601 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:49:33.511787 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.097 seconds
[0m16:49:33.519251 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:49:33.520276 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:49:33.521604 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m16:49:33.522320 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:49:33.541634 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:49:33.542634 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:49:33.603224 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:49:33.605247 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:49:33.606032 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:49:33.606702 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:49:34.698640 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.092 seconds
[0m16:49:34.735406 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.21s]
[0m16:49:34.736475 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:49:34.738538 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:49:34.739628 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:49:34.740435 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:49:34.741047 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:49:34.781527 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:49:34.782570 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:49:34.825895 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:49:34.828994 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:49:34.830201 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'../assets/global_inm_policy_schema.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset-paths")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset-paths': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:49:34.831164 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:49:38.411454 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d51-0206-d87f-0032-318704d777aa
[0m16:49:38.412289 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'../assets/global_inm_policy_schema.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: '../assets/global_inm_policy_schema.json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:49:38.418079 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'../assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: '../assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:49:38.419787 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.68s]
[0m16:49:38.420831 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:49:38.422396 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'../assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: '../assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:49:38.425535 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:49:38.426151 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m16:49:38.426614 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:49:38.427148 [info ] [Dummy-1   ]: 
[0m16:49:38.427681 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 8.32 seconds (8.32s).
[0m16:49:38.429035 [debug] [Dummy-1   ]: Command end result
[0m16:49:38.474799 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:49:38.477718 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:49:38.486243 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:49:38.486866 [info ] [Dummy-1   ]: 
[0m16:49:38.487590 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:49:38.488133 [info ] [Dummy-1   ]: 
[0m16:49:38.489103 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'../assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: '../assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:49:38.489709 [info ] [Dummy-1   ]: 
[0m16:49:38.490277 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:49:38.492208 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.37511, "process_in_blocks": "0", "process_kernel_time": 1.53, "process_mem_max_rss": "435328", "process_out_blocks": "0", "process_user_time": 5.93}
[0m16:49:38.492912 [debug] [Dummy-1   ]: Command `cli run` failed at 16:49:38.492637 after 10.38 seconds
[0m16:49:38.493487 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:54:45.592339 | 745f5dc4-e067-4881-8e31-7c2875256317 ==============================
[0m16:54:45.592339 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:54:45.593474 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/tmp/dbt/logs', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m16:54:45.977194 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:54:46.771737 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:54:47.179025 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:54:47.180201 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m16:54:47.841916 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:54:47.844824 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:54:47.894143 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:54:47.898568 [info ] [Dummy-1   ]: 
[0m16:54:47.899221 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:54:47.899780 [info ] [Dummy-1   ]: 
[0m16:54:47.900719 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:54:47.909458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m16:54:48.081148 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:54:48.081847 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:54:48.082397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:49.205056 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.122 seconds
[0m16:54:49.211055 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:54:49.211713 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:54:49.316060 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.104 seconds
[0m16:54:49.319436 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:54:49.320115 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:54:49.439538 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.119 seconds
[0m16:54:49.441959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:54:49.452583 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:54:49.453239 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:54:49.453759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:50.235704 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.782 seconds
[0m16:54:50.238269 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:54:50.239017 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:54:50.345997 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.106 seconds
[0m16:54:50.348840 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:54:50.349445 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:54:50.461882 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m16:54:50.472444 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m16:54:50.473337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.users)
[0m16:54:50.473940 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m16:54:50.494104 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m16:54:50.495093 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m16:54:50.496300 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m16:54:50.497529 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:54:50.498479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m16:54:50.499144 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:54:50.511061 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:54:50.512024 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:54:50.513153 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:54:50.514366 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m16:54:50.515585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m16:54:50.516274 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m16:54:50.529890 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m16:54:50.530855 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m16:54:50.531960 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m16:54:50.533140 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:54:50.534151 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m16:54:50.534789 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:54:50.560054 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m16:54:50.561037 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:54:50.562093 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m16:54:50.563299 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:54:50.564205 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m16:54:50.564797 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:54:50.577725 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m16:54:50.578736 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:54:50.579838 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m16:54:50.581207 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:54:50.582218 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m16:54:50.582838 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:54:50.597207 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m16:54:50.598261 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:54:50.599418 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m16:54:50.600553 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:54:50.601390 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m16:54:50.602017 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:54:50.614901 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m16:54:50.615907 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:54:50.616965 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m16:54:50.618056 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:54:50.618961 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m16:54:50.619571 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:54:50.633727 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m16:54:50.634640 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:54:50.635669 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m16:54:50.636730 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:54:50.637531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m16:54:50.638114 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:54:50.651299 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m16:54:50.652229 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:54:50.653237 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m16:54:50.654290 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:54:50.655077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m16:54:50.655684 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:54:50.670164 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m16:54:50.671094 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:54:50.672135 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m16:54:50.673201 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:54:50.673983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m16:54:50.674565 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:54:50.827715 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m16:54:50.828772 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:54:50.829831 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m16:54:50.830906 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:54:50.831710 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m16:54:50.832302 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:54:50.845434 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m16:54:50.846372 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:54:50.847396 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m16:54:50.848545 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:54:50.849330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m16:54:50.849911 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:54:50.864618 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m16:54:50.865510 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:54:50.866613 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m16:54:50.867764 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:54:50.868601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m16:54:50.869185 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:54:50.884903 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m16:54:50.885838 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:54:50.886862 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m16:54:50.887974 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m16:54:50.888824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m16:54:50.889408 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m16:54:50.903317 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m16:54:50.904258 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m16:54:50.905275 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m16:54:50.906446 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:54:50.907224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m16:54:50.907816 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:54:50.945943 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:54:50.946926 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:54:50.947979 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:54:50.949237 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m16:54:50.950052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m16:54:50.950636 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m16:54:50.965381 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m16:54:50.966264 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m16:54:50.967275 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m16:54:50.969276 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m16:54:50.970190 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m16:54:50.970765 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m16:54:50.982916 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m16:54:50.983832 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m16:54:50.984850 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m16:54:50.986025 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m16:54:50.986785 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m16:54:50.987339 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m16:54:50.999042 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m16:54:50.999960 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m16:54:51.000990 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m16:54:51.002120 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m16:54:51.003178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m16:54:51.003775 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m16:54:51.018646 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m16:54:51.019544 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m16:54:51.020567 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m16:54:51.021707 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m16:54:51.022569 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m16:54:51.023189 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m16:54:51.035964 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m16:54:51.036856 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m16:54:51.037875 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m16:54:51.039078 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m16:54:51.039871 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m16:54:51.040443 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m16:54:51.053967 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m16:54:51.054829 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m16:54:51.055879 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m16:54:51.057059 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m16:54:51.057811 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m16:54:51.058446 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m16:54:51.070843 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m16:54:51.071769 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m16:54:51.072830 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m16:54:51.074204 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m16:54:51.075079 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m16:54:51.075703 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m16:54:51.088928 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m16:54:51.089803 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m16:54:51.090811 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m16:54:51.091992 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:54:51.092778 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m16:54:51.093382 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:54:51.113919 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m16:54:51.114839 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:54:51.115874 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m16:54:51.117090 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:54:51.117933 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m16:54:51.118632 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:54:51.132994 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m16:54:51.133921 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:54:51.134922 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m16:54:51.136073 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:54:51.136891 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m16:54:51.140015 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:54:51.152952 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m16:54:51.153885 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:54:51.154899 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m16:54:51.156073 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:54:51.156874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m16:54:51.157445 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:54:51.170199 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m16:54:51.171093 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:54:51.172112 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m16:54:51.173258 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:54:51.174018 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m16:54:51.174586 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:54:51.189394 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m16:54:51.190321 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:54:51.191319 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m16:54:51.192459 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:54:51.193216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m16:54:51.193785 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:54:51.206674 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m16:54:51.207612 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:54:51.208759 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m16:54:51.209919 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:54:51.210709 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m16:54:51.211287 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:54:51.225884 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m16:54:51.226827 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:54:51.227846 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m16:54:51.229070 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:54:51.229853 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m16:54:51.230419 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:54:51.243026 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m16:54:51.244003 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:54:51.245011 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m16:54:51.247479 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:54:51.248047 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m16:54:51.253835 [debug] [Dummy-1   ]: Command end result
[0m16:54:51.298109 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:54:51.301078 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:54:51.312206 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:54:51.314344 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.819895, "process_in_blocks": "0", "process_kernel_time": 1.28, "process_mem_max_rss": "441548", "process_out_blocks": "0", "process_user_time": 6.71}
[0m16:54:51.315080 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 16:54:51.314802 after 5.82 seconds
[0m16:54:51.315674 [debug] [Dummy-1   ]: Flushing usage events


============================== 16:56:57.608662 | 78e87634-b1a1-4ea2-bd70-e3a3f53032a7 ==============================
[0m16:56:57.608662 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m16:56:57.609918 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:56:57.996625 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m16:56:58.808083 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:56:59.228276 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:56:59.229486 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m16:56:59.442212 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:56:59.445306 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:56:59.507015 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m16:56:59.510807 [info ] [Dummy-1   ]: 
[0m16:56:59.511542 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m16:56:59.512130 [info ] [Dummy-1   ]: 
[0m16:56:59.513093 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m16:56:59.520631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m16:56:59.675571 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m16:56:59.676273 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m16:56:59.676822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:00.468301 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.791 seconds
[0m16:57:00.473748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_gold_zone'
[0m16:57:00.497698 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:57:00.498471 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:57:00.499088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:01.249711 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.750 seconds
[0m16:57:01.255651 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:57:01.256342 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m16:57:01.352229 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.095 seconds
[0m16:57:01.354714 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m16:57:01.355360 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:57:01.496832 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.141 seconds
[0m16:57:01.499446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now list_incident_management_bronze_zone)
[0m16:57:01.510338 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:57:01.511015 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:57:01.511551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:02.353924 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.842 seconds
[0m16:57:02.356589 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:57:02.357260 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m16:57:02.468239 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.110 seconds
[0m16:57:02.471116 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m16:57:02.471822 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:57:02.590043 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.117 seconds
[0m16:57:02.601657 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m16:57:02.602683 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m16:57:02.603489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now model.incident_management.v_qualify_new_documents)
[0m16:57:02.604582 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m16:57:02.623795 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m16:57:02.624795 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m16:57:02.695219 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m16:57:02.697254 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m16:57:02.697998 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m16:57:02.698724 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:57:03.941234 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.242 seconds
[0m16:57:03.976847 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 1.37s]
[0m16:57:03.977904 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m16:57:03.979875 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m16:57:03.981095 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m16:57:03.981902 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m16:57:03.982478 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m16:57:04.022380 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m16:57:04.023376 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m16:57:04.066249 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m16:57:04.069346 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m16:57:04.070541 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'assets/global_inm_policy_schema.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset-paths")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset-paths': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m16:57:04.071513 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:57:07.202224 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d59-0206-e114-0032-318704d7f36e
[0m16:57:07.203013 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'assets/global_inm_policy_schema.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'assets/global_inm_policy_schema.json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m16:57:07.208638 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:57:07.210081 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 3.23s]
[0m16:57:07.211051 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m16:57:07.212486 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m16:57:07.215249 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m16:57:07.215812 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m16:57:07.216265 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m16:57:07.216830 [info ] [Dummy-1   ]: 
[0m16:57:07.217358 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.70 seconds (7.70s).
[0m16:57:07.218619 [debug] [Dummy-1   ]: Command end result
[0m16:57:07.262058 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m16:57:07.264729 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m16:57:07.272551 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m16:57:07.273076 [info ] [Dummy-1   ]: 
[0m16:57:07.273764 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:57:07.274268 [info ] [Dummy-1   ]: 
[0m16:57:07.275051 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'assets/global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'assets/global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m16:57:07.275614 [info ] [Dummy-1   ]: 
[0m16:57:07.276146 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:57:07.277913 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.771845, "process_in_blocks": "0", "process_kernel_time": 1.27, "process_mem_max_rss": "435108", "process_out_blocks": "0", "process_user_time": 6.05}
[0m16:57:07.278671 [debug] [Dummy-1   ]: Command `cli run` failed at 16:57:07.278322 after 9.77 seconds
[0m16:57:07.279246 [debug] [Dummy-1   ]: Flushing usage events


============================== 17:00:32.523035 | d31d0332-6f45-4848-8fec-ded00541087a ==============================
[0m17:00:32.523035 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m17:00:32.524201 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m17:00:32.908858 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m17:00:33.710816 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:00:34.126865 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:00:34.128029 [debug] [Dummy-1   ]: Partial parsing: updated file: incident_management://models/bronze_zone/document_question_extracts.py
[0m17:00:34.795137 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:00:34.798157 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:00:34.847489 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m17:00:34.852039 [info ] [Dummy-1   ]: 
[0m17:00:34.852686 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m17:00:34.853159 [info ] [Dummy-1   ]: 
[0m17:00:34.853993 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m17:00:34.862593 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m17:00:35.054919 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:00:35.055692 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:00:35.056270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:36.510935 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.454 seconds
[0m17:00:36.516971 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:00:36.517615 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m17:00:36.641737 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.123 seconds
[0m17:00:36.645431 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:00:36.646066 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:00:36.790285 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.144 seconds
[0m17:00:36.793008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m17:00:36.805312 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:00:36.806030 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:00:36.806575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:37.552440 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.746 seconds
[0m17:00:37.555014 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:00:37.555659 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m17:00:37.640338 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.084 seconds
[0m17:00:37.642803 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:00:37.643404 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:00:37.754162 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m17:00:37.762398 [debug] [Thread-2 (]: Began running node model.incident_management.users
[0m17:00:37.763251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.users)
[0m17:00:37.763870 [debug] [Thread-2 (]: Began compiling node model.incident_management.users
[0m17:00:37.783775 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.users"
[0m17:00:37.784718 [debug] [Thread-2 (]: Began executing node model.incident_management.users
[0m17:00:37.785786 [debug] [Thread-2 (]: Finished running node model.incident_management.users
[0m17:00:37.787023 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m17:00:37.787954 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.users, now model.incident_management.v_qualify_new_documents)
[0m17:00:37.788627 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m17:00:37.800838 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m17:00:37.801789 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m17:00:37.802852 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m17:00:37.804073 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_slack_messages
[0m17:00:37.805226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.v_qualify_slack_messages)
[0m17:00:37.805844 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_slack_messages
[0m17:00:37.819476 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_slack_messages"
[0m17:00:37.820429 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_slack_messages
[0m17:00:37.821484 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_slack_messages
[0m17:00:37.822683 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m17:00:37.823847 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_slack_messages, now test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c)
[0m17:00:37.824479 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m17:00:37.849729 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c"
[0m17:00:37.850788 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m17:00:37.851909 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c
[0m17:00:37.853123 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m17:00:37.853983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_channel_id.c215ee3d7c, now test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b)
[0m17:00:37.854574 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m17:00:37.867809 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b"
[0m17:00:37.868813 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m17:00:37.869868 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b
[0m17:00:37.871090 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m17:00:37.871947 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_event_ts.8b545f1d7b, now test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2)
[0m17:00:37.872525 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m17:00:37.886915 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2"
[0m17:00:37.887848 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m17:00:37.888958 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2
[0m17:00:37.890063 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m17:00:37.890866 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_doc_metadata_file_id.b8ec34c9b2, now test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc)
[0m17:00:37.891450 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m17:00:37.904350 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc"
[0m17:00:37.905248 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m17:00:37.906310 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc
[0m17:00:37.907461 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m17:00:37.908418 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_file_hashes_hash_value.af662aaabc, now test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44)
[0m17:00:37.909055 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m17:00:37.923202 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44"
[0m17:00:37.924167 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m17:00:37.925223 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44
[0m17:00:37.926309 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m17:00:37.927121 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_conversationid.425c949d44, now test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc)
[0m17:00:37.927715 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m17:00:37.940766 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc"
[0m17:00:37.941699 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m17:00:37.942742 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc
[0m17:00:37.943823 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m17:00:37.944619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_members_lastupdated.3f8dd11efc, now test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185)
[0m17:00:37.945183 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m17:00:37.959924 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185"
[0m17:00:37.960821 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m17:00:37.961811 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185
[0m17:00:37.962864 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m17:00:37.963650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_slack_messages_ts.472b618185, now test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23)
[0m17:00:37.964222 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m17:00:38.118324 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23"
[0m17:00:38.119373 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m17:00:38.120411 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23
[0m17:00:38.121469 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m17:00:38.122248 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_created_at.1978bf3b23, now test.incident_management.source_not_null_bronze_zone_users_email.36447ce580)
[0m17:00:38.122812 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m17:00:38.135657 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_email.36447ce580"
[0m17:00:38.136570 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m17:00:38.137553 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_email.36447ce580
[0m17:00:38.138924 [debug] [Thread-2 (]: Began running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m17:00:38.139754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_email.36447ce580, now test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8)
[0m17:00:38.140329 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m17:00:38.154888 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8"
[0m17:00:38.155819 [debug] [Thread-2 (]: Began executing node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m17:00:38.156821 [debug] [Thread-2 (]: Finished running node test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8
[0m17:00:38.157883 [debug] [Thread-2 (]: Began running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m17:00:38.158744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_not_null_bronze_zone_users_id.88848c2ec8, now test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d)
[0m17:00:38.159323 [debug] [Thread-2 (]: Began compiling node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m17:00:38.175178 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d"
[0m17:00:38.176167 [debug] [Thread-2 (]: Began executing node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m17:00:38.177193 [debug] [Thread-2 (]: Finished running node test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d
[0m17:00:38.178316 [debug] [Thread-2 (]: Began running node model.incident_management.document_full_extracts
[0m17:00:38.179243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.source_unique_bronze_zone_users_email.fec1fcf20d, now model.incident_management.document_full_extracts)
[0m17:00:38.179834 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_full_extracts
[0m17:00:38.193912 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_full_extracts"
[0m17:00:38.194841 [debug] [Thread-2 (]: Began executing node model.incident_management.document_full_extracts
[0m17:00:38.195872 [debug] [Thread-2 (]: Finished running node model.incident_management.document_full_extracts
[0m17:00:38.197045 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m17:00:38.197844 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_full_extracts, now model.incident_management.document_question_extracts)
[0m17:00:38.198474 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m17:00:38.236963 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m17:00:38.237870 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m17:00:38.238953 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m17:00:38.240143 [debug] [Thread-2 (]: Began running node model.incident_management.incidents
[0m17:00:38.240935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.document_question_extracts, now model.incident_management.incidents)
[0m17:00:38.241490 [debug] [Thread-2 (]: Began compiling node model.incident_management.incidents
[0m17:00:38.256173 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incidents"
[0m17:00:38.257071 [debug] [Thread-2 (]: Began executing node model.incident_management.incidents
[0m17:00:38.258070 [debug] [Thread-2 (]: Finished running node model.incident_management.incidents
[0m17:00:38.260218 [debug] [Thread-2 (]: Began running node model.incident_management.active_incidents
[0m17:00:38.261187 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incidents, now model.incident_management.active_incidents)
[0m17:00:38.261784 [debug] [Thread-2 (]: Began compiling node model.incident_management.active_incidents
[0m17:00:38.274245 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.active_incidents"
[0m17:00:38.275176 [debug] [Thread-2 (]: Began executing node model.incident_management.active_incidents
[0m17:00:38.276194 [debug] [Thread-2 (]: Finished running node model.incident_management.active_incidents
[0m17:00:38.277552 [debug] [Thread-2 (]: Began running node model.incident_management.closed_incidents
[0m17:00:38.278326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.active_incidents, now model.incident_management.closed_incidents)
[0m17:00:38.278999 [debug] [Thread-2 (]: Began compiling node model.incident_management.closed_incidents
[0m17:00:38.290595 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.closed_incidents"
[0m17:00:38.291529 [debug] [Thread-2 (]: Began executing node model.incident_management.closed_incidents
[0m17:00:38.292569 [debug] [Thread-2 (]: Finished running node model.incident_management.closed_incidents
[0m17:00:38.293724 [debug] [Thread-2 (]: Began running node model.incident_management.incident_attachments
[0m17:00:38.294945 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.closed_incidents, now model.incident_management.incident_attachments)
[0m17:00:38.295553 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_attachments
[0m17:00:38.310578 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_attachments"
[0m17:00:38.311453 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_attachments
[0m17:00:38.312499 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_attachments
[0m17:00:38.313659 [debug] [Thread-2 (]: Began running node model.incident_management.incident_comment_history
[0m17:00:38.314434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_attachments, now model.incident_management.incident_comment_history)
[0m17:00:38.315001 [debug] [Thread-2 (]: Began compiling node model.incident_management.incident_comment_history
[0m17:00:38.327712 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.incident_comment_history"
[0m17:00:38.328685 [debug] [Thread-2 (]: Began executing node model.incident_management.incident_comment_history
[0m17:00:38.329718 [debug] [Thread-2 (]: Finished running node model.incident_management.incident_comment_history
[0m17:00:38.330878 [debug] [Thread-2 (]: Began running node model.incident_management.monthly_incident_trends
[0m17:00:38.331653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.incident_comment_history, now model.incident_management.monthly_incident_trends)
[0m17:00:38.332241 [debug] [Thread-2 (]: Began compiling node model.incident_management.monthly_incident_trends
[0m17:00:38.345676 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.monthly_incident_trends"
[0m17:00:38.346543 [debug] [Thread-2 (]: Began executing node model.incident_management.monthly_incident_trends
[0m17:00:38.347549 [debug] [Thread-2 (]: Finished running node model.incident_management.monthly_incident_trends
[0m17:00:38.348785 [debug] [Thread-2 (]: Began running node model.incident_management.v_slack_msg_incident_number
[0m17:00:38.349626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.monthly_incident_trends, now model.incident_management.v_slack_msg_incident_number)
[0m17:00:38.350207 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_slack_msg_incident_number
[0m17:00:38.362466 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_slack_msg_incident_number"
[0m17:00:38.363341 [debug] [Thread-2 (]: Began executing node model.incident_management.v_slack_msg_incident_number
[0m17:00:38.364372 [debug] [Thread-2 (]: Finished running node model.incident_management.v_slack_msg_incident_number
[0m17:00:38.365504 [debug] [Thread-2 (]: Began running node model.incident_management.weekly_incident_trends
[0m17:00:38.366261 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_slack_msg_incident_number, now model.incident_management.weekly_incident_trends)
[0m17:00:38.366821 [debug] [Thread-2 (]: Began compiling node model.incident_management.weekly_incident_trends
[0m17:00:38.380163 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.weekly_incident_trends"
[0m17:00:38.381056 [debug] [Thread-2 (]: Began executing node model.incident_management.weekly_incident_trends
[0m17:00:38.382086 [debug] [Thread-2 (]: Finished running node model.incident_management.weekly_incident_trends
[0m17:00:38.383229 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m17:00:38.384052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.weekly_incident_trends, now test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c)
[0m17:00:38.384635 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m17:00:38.405423 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c"
[0m17:00:38.406327 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m17:00:38.407333 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c
[0m17:00:38.408531 [debug] [Thread-2 (]: Began running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m17:00:38.409339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_priority__low__medium__high__critical.663517691c, now test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4)
[0m17:00:38.409914 [debug] [Thread-2 (]: Began compiling node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m17:00:38.424097 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4"
[0m17:00:38.425034 [debug] [Thread-2 (]: Began executing node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m17:00:38.426019 [debug] [Thread-2 (]: Finished running node test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4
[0m17:00:38.427129 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m17:00:38.427896 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.accepted_values_closed_incidents_status__closed__resolved.ebedd591a4, now test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a)
[0m17:00:38.428538 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m17:00:38.443124 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a"
[0m17:00:38.444094 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m17:00:38.445108 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a
[0m17:00:38.446216 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m17:00:38.446993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_closed_at.ff47a7249a, now test.incident_management.not_null_closed_incidents_created_at.f144a202e9)
[0m17:00:38.447570 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m17:00:38.460490 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_created_at.f144a202e9"
[0m17:00:38.461383 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m17:00:38.462367 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_created_at.f144a202e9
[0m17:00:38.463499 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m17:00:38.464388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_created_at.f144a202e9, now test.incident_management.not_null_closed_incidents_incident_number.f083158543)
[0m17:00:38.465014 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m17:00:38.479388 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_incident_number.f083158543"
[0m17:00:38.480331 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m17:00:38.481326 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_incident_number.f083158543
[0m17:00:38.482454 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m17:00:38.483222 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_incident_number.f083158543, now test.incident_management.not_null_closed_incidents_title.bf5e3f1d33)
[0m17:00:38.483824 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m17:00:38.496550 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_title.bf5e3f1d33"
[0m17:00:38.497468 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m17:00:38.498516 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_title.bf5e3f1d33
[0m17:00:38.499712 [debug] [Thread-2 (]: Began running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m17:00:38.500531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_title.bf5e3f1d33, now test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a)
[0m17:00:38.501117 [debug] [Thread-2 (]: Began compiling node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m17:00:38.515219 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a"
[0m17:00:38.516159 [debug] [Thread-2 (]: Began executing node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m17:00:38.517167 [debug] [Thread-2 (]: Finished running node test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a
[0m17:00:38.518303 [debug] [Thread-2 (]: Began running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m17:00:38.519170 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.incident_management.not_null_closed_incidents_total_resolution_hours.838e65647a, now test.incident_management.unique_closed_incidents_incident_number.dd9483020e)
[0m17:00:38.519782 [debug] [Thread-2 (]: Began compiling node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m17:00:38.532501 [debug] [Thread-2 (]: Writing injected SQL for node "test.incident_management.unique_closed_incidents_incident_number.dd9483020e"
[0m17:00:38.533420 [debug] [Thread-2 (]: Began executing node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m17:00:38.534427 [debug] [Thread-2 (]: Finished running node test.incident_management.unique_closed_incidents_incident_number.dd9483020e
[0m17:00:38.536958 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m17:00:38.537509 [debug] [Dummy-1   ]: Connection 'test.incident_management.unique_closed_incidents_incident_number.dd9483020e' was properly closed.
[0m17:00:38.543321 [debug] [Dummy-1   ]: Command end result
[0m17:00:38.587772 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:00:38.590677 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:00:38.601722 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m17:00:38.603830 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.1794243, "process_in_blocks": "0", "process_kernel_time": 1.36, "process_mem_max_rss": "442892", "process_out_blocks": "0", "process_user_time": 6.87}
[0m17:00:38.604575 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 17:00:38.604293 after 6.18 seconds
[0m17:00:38.605162 [debug] [Dummy-1   ]: Flushing usage events


============================== 17:01:01.624913 | 7e83ba00-13a6-4bbe-8444-6c0af9989498 ==============================
[0m17:01:01.624913 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m17:01:01.626191 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m17:01:02.028143 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m17:01:02.794662 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:01:03.266944 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:03.267705 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:03.484026 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:01:03.487212 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:01:03.549688 [info ] [Dummy-1   ]: Found 13 models, 19 data tests, 6 sources, 482 macros
[0m17:01:03.553454 [info ] [Dummy-1   ]: 
[0m17:01:03.554210 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m17:01:03.554826 [info ] [Dummy-1   ]: 
[0m17:01:03.555860 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m17:01:03.563673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management'
[0m17:01:03.719597 [debug] [ThreadPool]: Using snowflake connection "list_incident_management"
[0m17:01:03.720277 [debug] [ThreadPool]: On list_incident_management: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management"} */
show terse schemas in database incident_management
    limit 10000
[0m17:01:03.720808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:04.854285 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.133 seconds
[0m17:01:04.859754 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_incident_management_bronze_zone'
[0m17:01:04.884097 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:01:04.884768 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:01:04.885276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:06.407458 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.522 seconds
[0m17:01:06.413614 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:01:06.414341 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
show objects in incident_management.bronze_zone
    limit 10000
    
;
[0m17:01:06.644336 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.229 seconds
[0m17:01:06.647283 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_bronze_zone"
[0m17:01:06.647991 [debug] [ThreadPool]: On list_incident_management_bronze_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_bronze_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:01:06.815436 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.167 seconds
[0m17:01:06.818169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_incident_management_bronze_zone, now list_incident_management_gold_zone)
[0m17:01:06.831002 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:01:06.831691 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session set quoted_identifiers_ignore_case = false;
[0m17:01:06.832243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:08.260920 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.428 seconds
[0m17:01:08.263575 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:01:08.264215 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
show objects in incident_management.gold_zone
    limit 10000
    
;
[0m17:01:08.480472 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.216 seconds
[0m17:01:08.483084 [debug] [ThreadPool]: Using snowflake connection "list_incident_management_gold_zone"
[0m17:01:08.483714 [debug] [ThreadPool]: On list_incident_management_gold_zone: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "connection_name": "list_incident_management_gold_zone"} */
alter session unset quoted_identifiers_ignore_case;
[0m17:01:08.751810 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.267 seconds
[0m17:01:08.759830 [debug] [Thread-2 (]: Began running node model.incident_management.v_qualify_new_documents
[0m17:01:08.760863 [info ] [Thread-2 (]: 1 of 2 START sql view model bronze_zone.v_qualify_new_documents ................ [RUN]
[0m17:01:08.761665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_incident_management_gold_zone, now model.incident_management.v_qualify_new_documents)
[0m17:01:08.762334 [debug] [Thread-2 (]: Began compiling node model.incident_management.v_qualify_new_documents
[0m17:01:08.781919 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.v_qualify_new_documents"
[0m17:01:08.782941 [debug] [Thread-2 (]: Began executing node model.incident_management.v_qualify_new_documents
[0m17:01:08.844689 [debug] [Thread-2 (]: Writing runtime sql for node "model.incident_management.v_qualify_new_documents"
[0m17:01:08.846711 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.v_qualify_new_documents"
[0m17:01:08.847471 [debug] [Thread-2 (]: On model.incident_management.v_qualify_new_documents: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.v_qualify_new_documents"} */
create or replace   view incident_management.bronze_zone.v_qualify_new_documents
  
   as (
    

select
   *,
    case 
        when contains(relative_path, 'qa') then 'question'
        when contains(relative_path, 'full') then 'full'
        else 'full'
    end as analysis_type,
    split_part(relative_path, '.', 2) as extension
from incident_management.bronze_zone.documents_stream
WHERE relative_path is not null
and array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )
and size > 0
  );
[0m17:01:08.848150 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:01:11.086353 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.238 seconds
[0m17:01:11.122278 [info ] [Thread-2 (]: 1 of 2 OK created sql view model bronze_zone.v_qualify_new_documents ........... [[32mSUCCESS 1[0m in 2.36s]
[0m17:01:11.123334 [debug] [Thread-2 (]: Finished running node model.incident_management.v_qualify_new_documents
[0m17:01:11.125354 [debug] [Thread-2 (]: Began running node model.incident_management.document_question_extracts
[0m17:01:11.126492 [info ] [Thread-2 (]: 2 of 2 START python table model bronze_zone.document_question_extracts ......... [RUN]
[0m17:01:11.127300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.incident_management.v_qualify_new_documents, now model.incident_management.document_question_extracts)
[0m17:01:11.127910 [debug] [Thread-2 (]: Began compiling node model.incident_management.document_question_extracts
[0m17:01:11.167926 [debug] [Thread-2 (]: Writing injected SQL for node "model.incident_management.document_question_extracts"
[0m17:01:11.169019 [debug] [Thread-2 (]: Began executing node model.incident_management.document_question_extracts
[0m17:01:11.212788 [debug] [Thread-2 (]: Writing runtime python for node "model.incident_management.document_question_extracts"
[0m17:01:11.215885 [debug] [Thread-2 (]: Using snowflake connection "model.incident_management.document_question_extracts"
[0m17:01:11.217104 [debug] [Thread-2 (]: On model.incident_management.document_question_extracts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "incident_management", "target_name": "dev", "node_id": "model.incident_management.document_question_extracts"} */
WITH document_question_extracts__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
import snowflake.snowpark.functions as F
from snowflake.snowpark import Session
import json

def get_response_format(asset_path: str, relative_path: str):
    with open(f'global_inm_policy_schema.json', 'r') as f:
        response_format = json.load(f)
    return response_format

def model(dbt, session: Session):
    dbt.config(
        materialized='table',
        description='Table to store question extracts from documents'
    )
    
    asset_path = dbt.config.get("asset-paths")
    docs_stage = dbt.config.get("docs_stage_path")
    
    # Get the upstream model
    v_qualify_new_documents = dbt.ref('v_qualify_new_documents')
    
    # Filter for question analysis type
    document_all_pages = v_qualify_new_documents.filter(
        F.col('analysis_type') == 'question'
    )
    
    # Add AI_EXTRACT column
    # Note: AI_EXTRACT with TO_FILE and response_format needs to be done via SQL expression
    document_all_pages = document_all_pages.with_column(
        'question_extracts_json',
        F.call_builtin(
            'AI_EXTRACT',
            F.call_builtin('TO_FILE', F.lit(f'{docs_stage}/qa'), F.col('relative_path')),
            get_response_format(asset_path, F.col('relative_path'))
        )
    )
    
    return document_all_pages


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"v_qualify_new_documents": "incident_management.bronze_zone.v_qualify_new_documents"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'asset-paths': None, 'docs_stage_path': None}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "incident_management"
    schema = "bronze_zone"
    identifier = "document_question_extracts"
    
    def __repr__(self):
        return 'incident_management.bronze_zone.document_question_extracts'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('incident_management.bronze_zone.document_question_extracts', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL document_question_extracts__dbt_sp();
[0m17:01:11.218099 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:01:15.622811 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02d5d-0206-e0d0-0032-318704d788ae
[0m17:01:15.623670 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 118, in main
    df = model(dbt, session)
  File "_udf_code.py", line 41, in model
    get_response_format(asset_path, F.col('relative_path'))
  File "_udf_code.py", line 13, in get_response_format
    with open(f'global_inm_policy_schema.json', 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'global_inm_policy_schema.json'
 in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
[0m17:01:15.629512 [debug] [Thread-2 (]: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m17:01:15.631187 [error] [Thread-2 (]: 2 of 2 ERROR creating python table model bronze_zone.document_question_extracts  [[31mERROR[0m in 4.50s]
[0m17:01:15.632250 [debug] [Thread-2 (]: Finished running node model.incident_management.document_question_extracts
[0m17:01:15.633838 [debug] [Thread-5 (]: Marking all children of 'model.incident_management.document_question_extracts' to be skipped because of status 'error'.  Reason: Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py.
[0m17:01:15.637231 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m17:01:15.637841 [debug] [Dummy-1   ]: Connection 'list_incident_management' was properly closed.
[0m17:01:15.638399 [debug] [Dummy-1   ]: Connection 'model.incident_management.document_question_extracts' was properly closed.
[0m17:01:15.639009 [info ] [Dummy-1   ]: 
[0m17:01:15.639563 [info ] [Dummy-1   ]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.08 seconds (12.08s).
[0m17:01:15.640821 [debug] [Dummy-1   ]: Command end result
[0m17:01:15.686982 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m17:01:15.690082 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m17:01:15.698635 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m17:01:15.699279 [info ] [Dummy-1   ]: 
[0m17:01:15.699987 [info ] [Dummy-1   ]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:01:15.700586 [info ] [Dummy-1   ]: 
[0m17:01:15.701454 [error] [Dummy-1   ]:   Database Error in model document_question_extracts (models/bronze_zone/document_question_extracts.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 118, in main
      df = model(dbt, session)
    File "_udf_code.py", line 41, in model
      get_response_format(asset_path, F.col('relative_path'))
    File "_udf_code.py", line 13, in get_response_format
      with open(f'global_inm_policy_schema.json', 'r') as f:
  FileNotFoundError: [Errno 2] No such file or directory: 'global_inm_policy_schema.json'
   in function DOCUMENT_QUESTION_EXTRACTS__DBT_SP with handler main
  compiled code at /tmp/dbt/target/run/incident_management/models/bronze_zone/document_question_extracts.py
[0m17:01:15.702085 [info ] [Dummy-1   ]: 
[0m17:01:15.702641 [info ] [Dummy-1   ]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:01:15.704682 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.183983, "process_in_blocks": "0", "process_kernel_time": 1.4, "process_mem_max_rss": "430584", "process_out_blocks": "0", "process_user_time": 6.13}
[0m17:01:15.705417 [debug] [Dummy-1   ]: Command `cli run` failed at 17:01:15.705133 after 14.19 seconds
[0m17:01:15.706067 [debug] [Dummy-1   ]: Flushing usage events
