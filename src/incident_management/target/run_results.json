{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-11-09T20:09:33.785571Z", "invocation_id": "12c59e8d-13ac-4b1e-83f3-c312a1c91261", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T20:09:17.548897Z", "completed_at": "2025-11-09T20:09:17.568011Z"}, {"name": "execute", "started_at": "2025-11-09T20:09:17.568908Z", "completed_at": "2025-11-09T20:09:18.797999Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.2507343292236328, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c04859-0106-e9ca-0032-3187053fd8f6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.incident_management.v_qualify_new_documents", "compiled": true, "compiled_code": "\n\nselect\n   *,\n    case \n        when contains(relative_path, 'qa') then 'question'\n        when contains(relative_path, 'full') then 'full'\n        else 'slack'\n    end as doc_type,\n    split_part(relative_path, '.', 2) as extension\nfrom incident_management.bronze_zone.documents_stream\nWHERE relative_path is not null\nand array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )\nand size > 0", "relation_name": "incident_management.bronze_zone.v_qualify_new_documents", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T20:09:18.807293Z", "completed_at": "2025-11-09T20:09:18.821593Z"}, {"name": "execute", "started_at": "2025-11-09T20:09:18.822259Z", "completed_at": "2025-11-09T20:09:33.778274Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 14.972609519958496, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c04859-0106-e9ca-0032-3187053fd926"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.incident_management.document_full_extracts", "compiled": true, "compiled_code": "\n\nwith \ndocuments_raw_extracts as(\n    select\n        *,\n        AI_PARSE_DOCUMENT (\n            TO_FILE('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS',relative_path),\n             {\n                'mode': 'LAYOUT'\n                ,'page_split': True\n             }\n        ) as raw_extracts\n        FROM incident_management.bronze_zone.v_qualify_new_documents\n        WHERE lower(doc_type) = 'full'\n),\ndocuments_chunked_extracts as\n(\n    select \n    og1.* exclude (raw_extracts),\n    SNOWFLAKE.CORTEX.SPLIT_TEXT_MARKDOWN_HEADER(\n        lf1.value:content::STRING,\n        OBJECT_CONSTRUCT('#', 'header_1', '##', 'header_2'),\n        500,\n        5\n    ) as page_chunks,\n    lf1.index::int as page_num\n    from documents_raw_extracts og1,\n    LATERAL FLATTEN(input => raw_extracts:pages) lf1\n)\n\nselect \n    og2.* exclude (page_chunks),\n    lf2.value['chunk']::varchar as chunk,\n    lf2.value['headers']::object as headers\nfrom documents_chunked_extracts og2,\nlateral flatten(input => page_chunks) lf2", "relation_name": "incident_management.bronze_zone.document_full_extracts", "batch_results": null}], "elapsed_time": 19.570576190948486, "args": {"printer_width": 80, "write_json": true, "print": true, "source_freshness_run_project_hooks": false, "favor_state": false, "quiet": false, "exclude": [], "vars": {}, "partial_parse_file_diff": true, "log_level_file": "debug", "require_batched_execution_for_custom_microbatch_strategy": false, "require_explicit_package_overrides_for_builtin_materializations": true, "state_modified_compare_vars": false, "log_format_file": "debug", "which": "run", "log_file_max_bytes": 10485760, "warn_error_options": {"include": [], "exclude": []}, "target_path": "/tmp/dbt/target/", "macro_debugging": false, "use_colors": true, "introspect": true, "require_yaml_configuration_for_mf_time_spines": false, "invocation_command": "dbt ", "target": "dev", "version_check": true, "profiles_dir": "/tmp/dbt/", "cache_selected_only": false, "select": ["+bronze_zone.document_full_extracts"], "static_parser": true, "log_level": "info", "empty": false, "project_dir": "/tmp/dbt", "use_colors_file": true, "populate_cache": true, "require_nested_cumulative_type_params": false, "require_resource_names_without_spaces": false, "log_format": "default", "show_resource_report": false, "indirect_selection": "eager", "strict_mode": false, "send_anonymous_usage_stats": false, "log_path": "/tmp/dbt/logs", "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_more_unrendered_values": false, "partial_parse": true, "defer": false}}