{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-11-09T20:39:57.522733Z", "invocation_id": "3c4974be-ed8f-4e14-8c54-dcbe203cb8ec", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T20:39:53.660840Z", "completed_at": "2025-11-09T20:39:53.681814Z"}, {"name": "execute", "started_at": "2025-11-09T20:39:53.682516Z", "completed_at": "2025-11-09T20:39:54.842687Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1833956241607666, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c04877-0106-f4e2-0032-318705415eb6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.incident_management.v_qualify_new_documents", "compiled": true, "compiled_code": "\n\nselect\n   *,\n    case \n        when contains(relative_path, 'qa') then 'question'\n        when contains(relative_path, 'full') then 'full'\n        else 'slack'\n    end as doc_type,\n    split_part(relative_path, '.', 2) as extension\nfrom incident_management.bronze_zone.documents_stream\nWHERE relative_path is not null\nand array_contains(extension::VARIANT, ['pdf', 'docx', 'doc', 'txt', 'text', 'html', 'md', 'pptx', 'ppt', 'png', 'eml', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'tif', 'webp', 'htm'] )\nand size > 0", "relation_name": "incident_management.bronze_zone.v_qualify_new_documents", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-09T20:39:54.851747Z", "completed_at": "2025-11-09T20:39:55.031958Z"}, {"name": "execute", "started_at": "2025-11-09T20:39:55.032632Z", "completed_at": "2025-11-09T20:39:56.802445Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.9522294998168945, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c04877-0106-f4e2-0032-318705415ede"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.incident_management.document_full_extracts", "compiled": true, "compiled_code": "\n\nwith \ndocuments_raw_extracts as(\n    select\n        *,\n        AI_PARSE_DOCUMENT (\n            TO_FILE('@INCIDENT_MANAGEMENT.bronze_zone.DOCUMENTS',relative_path),\n             {\n                'mode': 'LAYOUT'\n                ,'page_split': True\n             }\n        ) as raw_extracts\n        FROM incident_management.bronze_zone.v_qualify_new_documents\n        WHERE lower(doc_type) = 'full'\n),\ndocuments_chunked_extracts as\n(\n    select \n    og1.* exclude (raw_extracts),\n    SNOWFLAKE.CORTEX.SPLIT_TEXT_MARKDOWN_HEADER(\n        lf1.value:content::STRING,\n        OBJECT_CONSTRUCT('#', 'header_1', '##', 'header_2'),\n        500,\n        5\n    ) as page_chunks,\n    lf1.index::int as page_num\n    from documents_raw_extracts og1,\n    LATERAL FLATTEN(input => raw_extracts:pages) lf1\n)\n\nselect \n    og2.* exclude (page_chunks),\n    lf2.value['chunk']::varchar as chunk,\n    lf2.value['headers']::object as headers\nfrom documents_chunked_extracts og2,\nlateral flatten(input => page_chunks) lf2", "relation_name": "incident_management.bronze_zone.document_full_extracts", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-11-09T20:39:56.809316Z", "completed_at": "2025-11-09T20:39:56.821877Z"}, {"name": "execute", "started_at": "2025-11-09T20:39:56.822617Z", "completed_at": "2025-11-09T20:39:57.508257Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7064070701599121, "adapter_response": {}, "message": "Database Error in model incm_semantic_view_1 (models/semantic_views/incm_semantic_view_1.sql)\n  010226 (42601): SQL compilation error:\n  No queryable expression is defined in the semantic view.\n  compiled code at /tmp/dbt/target/run/incident_management/models/semantic_views/incm_semantic_view_1.sql", "failures": null, "unique_id": "model.incident_management.incm_semantic_view_1", "compiled": true, "compiled_code": "\n\nTABLES(\n  incident_management.bronze_zone.document_full_extracts\n)", "relation_name": "incident_management.semantic_views.incm_semantic_view_1", "batch_results": null}], "elapsed_time": 8.665582180023193, "args": {"log_format": "default", "target": "dev", "indirect_selection": "eager", "populate_cache": true, "exclude": [], "use_colors_file": true, "invocation_command": "dbt ", "vars": {}, "log_level_file": "debug", "macro_debugging": false, "strict_mode": false, "require_nested_cumulative_type_params": false, "partial_parse": true, "write_json": true, "print": true, "require_batched_execution_for_custom_microbatch_strategy": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_yaml_configuration_for_mf_time_spines": false, "printer_width": 80, "profiles_dir": "/tmp/dbt/", "project_dir": "/tmp/dbt", "empty": false, "which": "run", "skip_nodes_if_on_run_start_fails": false, "log_format_file": "debug", "target_path": "/tmp/dbt/target/", "partial_parse_file_diff": true, "log_path": "/tmp/dbt/logs", "defer": false, "show_resource_report": false, "require_resource_names_without_spaces": false, "source_freshness_run_project_hooks": false, "state_modified_compare_vars": false, "static_parser": true, "quiet": false, "send_anonymous_usage_stats": false, "version_check": true, "use_colors": true, "state_modified_compare_more_unrendered_values": false, "introspect": true, "cache_selected_only": false, "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "log_level": "info", "favor_state": false, "select": ["+semantic_views.incm_semantic_view_1"]}}